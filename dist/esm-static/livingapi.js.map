{"version":3,"file":"livingapi.js","sources":["../../src/livingapi.js"],"sourcesContent":["/*!\n * LivingAPI JavaScript Library\n * https://my.living-apps.de/docs/LivingAPI.html\n *\n * Copyright 2017-2019 by LivingLogic AG, Bayreuth/Germany\n * Copyright 2017-2019 by Walter Dörwald\n *\n * All Rights Reserved\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n// Version of this Javascript package\nimport { version } from '../package.json';\n\nexport { version };\n\nimport * as ul4 from '@livinglogic/ul4';\n\n\nexport class Base extends ul4.Proto\n{\n\tconstructor(id)\n\t{\n\t\tsuper();\n\t\tthis.id = id;\n\t}\n\n\tget ul4onid()\n\t{\n\t\treturn this.id;\n\t}\n\n\tul4ondump(encoder)\n\t{\n\t\tfor (let i = 0; i < this._ul4onattrs.length; ++i)\n\t\t\tencoder.dump(this._dumpUL4ONAttr(this._ul4onattrs[i]));\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\treturn this[name];\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tlet i = 0;\n\t\tfor (let iter = decoder.loadcontent(); ; ++i)\n\t\t{\n\t\t\tlet iteritem = iter.next();\n\t\t\tif (iteritem.done)\n\t\t\t\tbreak;\n\t\t\tif (i < this._ul4onattrs.length)\n\t\t\t\tthis._loadUL4ONAttr(this._ul4onattrs[i], iteritem.value);\n\t\t}\n\t\tfor (; i < this._ul4onattrs.length; ++i)\n\t\t\tthis._setDefaultUL4ONAttr(this._ul4onattrs[i]);\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tthis[name] = value;\n\t}\n\n\t_setDefaultUL4ONAttr(name)\n\t{\n\t\tthis[name] = null;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (this._ul4attrs.has(name))\n\t\t{\n\t\t\tlet value = this[name];\n\t\t\tif (typeof(value) === \"function\")\n\t\t\t{\n\t\t\t\tlet realvalue = value.bind(this);\n\t\t\t\trealvalue._ul4_name = value._ul4_name || value.name;\n\t\t\t\trealvalue._ul4_signature = value._ul4_signature;\n\t\t\t\trealvalue._ul4_needsobject = value._ul4_needsobject;\n\t\t\t\trealvalue._ul4_needscontext = value._ul4_needscontext;\n\t\t\t\treturn realvalue;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\t\tthrow new ul4.AttributeError(this, name);\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \">\";\n\t}\n\n\ttoString()\n\t{\n\t\treturn this[ul4.symbols.repr]();\n\t}\n};\n\n\nexport class Handler\n{\n\tsave(record)\n\t{\n\t}\n\n\tdelete(record)\n\t{\n\t}\n};\n\n\nexport class Globals extends Base\n{\n\tstatic classdoc = \"Global information\";\n\n\tconstructor(id)\n\t{\n\t\tsuper(id);\n\t\tthis.version = null;\n\t\tthis.hostname = null;\n\t\tthis.platform = null;\n\t\tthis.user = null;\n\t\tthis.lang = null;\n\t\tthis.app = null;\n\t\tthis.record = null;\n\t\tthis.maxdbactions = null;\n\t\tthis.maxtemplateruntime = null;\n\t\tthis.flashmessages = null;\n\t\tthis.handler = new Handler();\n\t}\n\n\t// distance between two geo coordinates (see https://de.wikipedia.org/wiki/Orthodrome#Genauere_Formel_zur_Abstandsberechnung_auf_der_Erde)\n\tstatic geodist(geo1, geo2)\n\t{\n\t\tlet sqsin = function sqsin(x) {x = Math.sin(x); return x*x};\n\t\tlet sqcos = function sqsos(x) {x = Math.cos(x); return x*x};\n\t\tconst deg2rad = Math.PI/180; // Conversion factor degree -> radians\n\t\tconst radius = 6378.137; // Equatorial radius of earth in km\n\t\tconst flat = 1/298.257223563; // Earth flattening\n\n\t\tconst lat1 = geo1.lat * deg2rad;\n\t\tconst long1 = geo1.long * deg2rad;\n\t\tconst lat2 = geo2.lat * deg2rad;\n\t\tconst long2 = geo2.long * deg2rad;\n\t\tconst F = (lat1 + lat2)/2;\n\t\tconst G = (lat1 - lat2)/2;\n\t\tconst l = (long1 - long2)/2;\n\t\tconst S = sqsin(G) * sqcos(l) + sqcos(F) * sqsin(l);\n\t\tconst C = sqcos(G) * sqcos(l) + sqsin(F) * sqsin(l);\n\t\tconst w = Math.atan(Math.sqrt(S/C));\n\t\tconst D = 2 * w * radius;\n\t\tconst T = Math.sqrt(S*C)/w;\n\t\tconst H1 = (3*T-1)/(2*C);\n\t\tconst H2 = (3*T+1)/(2*S);\n\t\tconst s = D * (1 + flat * H1 * sqsin(F) * sqcos(G) - flat * H2 * sqcos(F) * sqsin(G));\n\t\treturn s;\n\t}\n\n\tscaledURL(url, width, height, type=\"fill\", enlarge=true, gravity=\"sm\", quality=null, rotate=null, blur=null, sharpen=null, format=null, cache=true)\n\t{\n\t\tlet filename = null;\n\n\t\tif (url instanceof File)\n\t\t{\n\t\t\turl = \"https://\" + this.hostname + url.url;\n\t\t\tfilename = encodeURIComponent(url.filename);\n\t\t\tif (filename != url.filename)\n\t\t\t\tfilename = null;\n\t\t}\n\n\t\tlet result = \"\";\n\n\t\tif (cache)\n\t\t\tresult += \"/imgproxycache/insecure\";\n\t\telse\n\t\t\tresult += \"/imgproxy/insecure\";\n\n\t\tif (type !== \"fit\")\n\t\t\tresult += \"/rt:\" + type;\n\n\t\tif (width !== null && width !== undefined)\n\t\t\tresult += \"/w:\" + width;\n\n\t\tif (height !== null && height !== undefined)\n\t\t\tresult += \"/h:\" + height;\n\n\t\tif (enlarge)\n\t\t\tresult += \"/el:1\";\n\n\t\tif (gravity !== null && gravity !== undefined)\n\t\t\tresult += \"/g:\" + gravity;\n\n\t\tif (quality !== null && quality !== undefined)\n\t\t\tresult += \"/q:\" + quality;\n\n\t\tif (rotate !== null && rotate % 360 != 0)\n\t\t\tresult += \"/rot:\" + rotatet;\n\n\t\tif (blur !== null && blur !== undefined)\n\t\t\tresult += \"/bl:\" + blur;\n\n\t\tif (sharpen !== null && sharpen !== undefined)\n\t\t\tresult += \"/sh:\" + sharpen;\n\n\t\tif (format !== null && format !== undefined)\n\t\t\tresult += \"/f:\" + format;\n\n\t\tif (filename !== null && filename !== undefined)\n\t\t\tresult += \"/fn:\" + filename;\n\n\t\tresult += \"/plain/\" + encodeURIComponent(url);\n\n\t\treturn result;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Globals version=\" + ul4._repr(this.version) + \">\";\n\t}\n};\n\nGlobals.prototype._ul4onattrs = [\"version\", \"platform\", \"user\", \"maxdbactions\", \"maxtemplateruntime\", \"flashmessages\", \"lang\", \"datasources\", \"hostname\", \"app\", \"record\", \"google_api_key\", \"mode\", \"view_template_id\", \"email_template_id\", \"view_id\"];\nGlobals.prototype._ul4attrs = new Set([\"version\", \"hostname\", \"platform\", \"user\", \"lang\", \"app\", \"record\", \"maxdbactions\", \"maxtemplateruntime\", \"flashmessages\", \"mode\"]);\n\n\nexport class FlashMessage extends Base\n{\n\tstatic classdoc = \"A flash message in a web page\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<FlashMessage type=\" + ul4._repr(this.type) + \" title=\" + ul4._repr(this.title) + \">\";\n\t}\n};\n\nFlashMessage.prototype._ul4onattrs = [\"timestamp\", \"type\", \"title\", \"message\"];\nFlashMessage.prototype._ul4attrs = new Set([\"timestamp\", \"type\", \"title\", \"message\"]);\n\n\nexport class App extends Base\n{\n\tstatic classdoc = \"A LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<App id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n\n\tinsert(values={})\n\t{\n\t\tlet record = this[ul4.symbols.call](values);\n\t\tthis.globals.handler.save(this);\n\t\treturn record;\n\t}\n\n\tget layout_controls()\n\t{\n\t\tif (this.active_view === null)\n\t\t\treturn new Map();\n\t\treturn this.active_view.layout_controls;\n\t}\n\n\t[ul4.symbols.call](values={})\n\t{\n\t\tlet record = new Record(null, this);\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let identifier of values.keys())\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, values, null, null);\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let identifier in values)\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, new Map(ul4._list(ul4.dicttype.items(values))), null, null);\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\t\treturn record;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t{\n\t\t\tif (!this.controls.has(name.substr(2)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.controls.get(name.substr(2));\n\t\t}\n\t\telse\n\t\t\treturn super[ul4.symbols.getattr](name);\n\t}\n\n\tget active_view()\n\t{\n\t\treturn this._active_view;\n\t}\n\n\tset active_view(view)\n\t{\n\t\tif (view === null)\n\t\t\t;\n\t\telse if (typeof(view) === \"string\")\n\t\t{\n\t\t\tif (this.views !== null && this.views.has(view))\n\t\t\t\tview = this.views.get(view);\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" not found!\");\n\t\t}\n\t\telse if (view instanceof View)\n\t\t{\n\t\t\tif (view.app === this)\n\t\t\t\t;\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" belongs to the wrong app!\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new ul4.TypeError(ul4._repr(view) + \" is not a view!\");\n\t\t}\n\n\t\tthis._active_view = view;\n\t}\n};\n\n\nApp.prototype._ul4onattrs = [\"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"iconlarge\", \"iconsmall\", \"createdby\", \"controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"datamanagement_identifier\", \"basetable\", \"primarykey\", \"insertprocedure\", \"updateprocedure\", \"deleteprocedure\", \"templates\", \"createdat\", \"updatedat\", \"updatedby\", \"superid\", \"favorite\", \"_active_view\"];\nApp.prototype._ul4attrs = new Set([\"id\", \"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"iconlarge\", \"iconsmall\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"datamanagement_identifier\", \"insert\", \"favorite\", \"_active_view\"]);\nul4.expose(App.prototype[ul4.symbols.call], [\"**values\"], {\"needsobject\": true});\nul4.expose(App.prototype.insert, [\"**values\"], {\"needsobject\": true});\n\n\nexport class View extends Base\n{\n\tstatic classdoc = \"An input form for a LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<View id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nView.prototype._ul4onattrs = [\"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\"];\nView.prototype._ul4attrs = new Set([\"id\", \"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\"]);\n\n\nexport class DataSourceData extends Base\n{\n\tstatic classdoc = \"The data resulting from a data source configuration\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<DataSource.Data id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nDataSourceData.prototype._ul4onattrs = [\"identifier\", \"app\", \"apps\"];\nDataSourceData.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"app\", \"apps\"]);\n\n\nexport class Record extends Base\n{\n\tstatic classdoc = \"A record of a LivingApp application\";\n\n\tconstructor(id, app)\n\t{\n\t\tsuper(id);\n\t\tthis.app = app;\n\t\tthis.createdat = null;\n\t\tthis.createdby = null;\n\t\tthis.updatedat = null;\n\t\tthis.updatedby = null;\n\t\tthis.updatecount = 0;\n\t\tthis._sparsevalues = new Map();\n\t\tthis._values = null;\n\t\tthis._fields = null;\n\t\tthis.children = new Map();\n\t\tthis.attachments = null;\n\t\tthis.errors = [];\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparsefieldlookupdata = null;\n\t\tthis._is_deleted = false;\n\t\tthis._is_new = true;\n\t}\n\n\t_make_fields(defaults, values, errors, lookupdata)\n\t{\n\t\tlet fields = new Map();\n\n\t\tfor (let control of this.app.controls.values())\n\t\t{\n\t\t\tlet identifier = control.identifier;\n\t\t\tlet value = null;\n\t\t\tif (values !== null)\n\t\t\t{\n\t\t\t\tif (defaults && !values.has(identifier))\n\t\t\t\t\tvalue = control.default;\n\t\t\t\telse if (values.has(identifier))\n\t\t\t\t\tvalue = values.get(identifier);\n\t\t\t}\n\t\t\tlet field = new Field(control, this, value);\n\t\t\tfields.set(identifier, field);\n\t\t\tif (errors !== null && errors.has(identifier))\n\t\t\t\tfield.errors = errors.get(identifier);\n\t\t\tif (lookupdata !== null && lookupdata.has(identifier))\n\t\t\t\tfield.lookupdata = lookupdata.get(identifier);\n\t\t}\n\n\t\tthis._fields = fields;\n\t\tthis._sparsevalues = null;\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparselookupdata = null;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [\"<Record id=\", ul4._repr(this.id)];\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.control.priority && !field.is_empty())\n\t\t\t{\n\t\t\t\tv.push(\" v_\");\n\t\t\t\tv.push(field.control.identifier);\n\t\t\t\tv.push(\"=\");\n\t\t\t\tv.push(ul4._repr(field.value)); // FIXME: This might lead to infinite recursions\n\t\t\t}\n\t\t}\n\t\tv.push(\" state=\");\n\t\tv.push(ul4._repr(this.state));\n\t\tv.push(\">\");\n\t\treturn v.join(\"\");\n\t}\n\n\tget state()\n\t{\n\t\tif (this._is_deleted)\n\t\t\treturn \"deleted\";\n\t\telse if (this._is_new)\n\t\t\treturn \"new\";\n\t\telse if (this.is_dirty())\n\t\t\treturn \"dirty\";\n\t\telse\n\t\t\treturn \"saved\";\n\t}\n\n\tget values()\n\t{\n\t\tif (this._values === null)\n\t\t{\n\t\t\tthis._values = new Map();\n\t\t\tfor (let field of this.fields.values())\n\t\t\t{\n\t\t\t\tthis._values.set(field.control.identifier, field.value);\n\t\t\t}\n\t\t}\n\t\treturn this._values;\n\t}\n\n\tget fields()\n\t{\n\t\tif (this._fields === null)\n\t\t\tthis._make_fields(false, this._sparsevalues, this._sparsefielderrors, this._sparsefieldlookupdata)\n\t\treturn this._fields;\n\t}\n\n\tis_dirty()\n\t{\n\t\tif (this.id === null)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.is_dirty())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\thas_errors()\n\t{\n\t\tif (this.errors.length !== 0)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.has_errors())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\tlet result = this.app.globals.handler.delete(this);\n\t\tthis._is_deleted = true;\n\t\treturn result;\n\t}\n\n\tsave()\n\t{\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\tupdate(values={})\n\t{\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let [key, value] of values.entries())\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\tfields.get(key).value = value;\n\t\t\t}\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let key in values)\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\trecord.fields.get(key).value = values[key];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\tsearch(search)\n\t{\n\t\tfor (let identifier in search)\n\t\t{\n\t\t\tlet fieldsearch = search[identifier];\n\t\t\tif (ul4._bool(fieldsearch))\n\t\t\t{\n\t\t\t\tif (!this.fields.get(identifier).search(fieldsearch))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tsuper.ul4onload(decoder);\n\t\tthis._is_new = false;\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"values\")\n\t\t\treturn this._sparsevalues;\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"values\")\n\t\t{\n\t\t\tthis._sparsevalues = value;\n\t\t\tthis._values = null;\n\t\t\tthis._fields = null;\n\t\t}\n\t\telse\n\t\t\tthis[name] = value;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\treturn this.children.get(name.substr(2))\n\t\telse if (name.startsWith(\"f_\"))\n\t\t\treturn this.fields.get(name.substr(2))\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\treturn this.values.get(name.substr(2))\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\tthis.children[name.substr(2)] = value;\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\tthis.fields.get(name.substr(2)).value = value;\n\t\telse\n\t\t\tthrow new ul4.AttributeError(this, name);\n\t}\n};\n\nRecord.prototype._ul4onattrs = [\"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"_sparsevalues\", \"attachments\", \"children\", \"errors\", \"_sparsefielderrors\", \"_sparsefieldlookupdata\"];\nRecord.prototype._ul4attrs = new Set([\"id\", \"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"values\", \"attachments\", \"children\", \"errors\"]);\nul4.expose(Record.prototype.is_dirty, []);\nul4.expose(Record.prototype.has_errors, []);\nul4.expose(Record.prototype.delete, []);\nul4.expose(Record.prototype.save, []);\nul4.expose(Record.prototype.update, [\"**values\"], {\"needsobject\": true});\n\n\nexport class Field extends Base\n{\n\tstatic classdoc = \"Holds the value of a field of a record (and related information)\";\n\n\tconstructor(control, record, value)\n\t{\n\t\tsuper(null);\n\t\tthis.control = control;\n\t\tthis.record = record;\n\t\tthis._label = null;\n\t\tthis._value = value;\n\t\tthis._dirty = false;\n\t\tthis._lookupdate = null;\n\t\tthis.errors = [];\n\t}\n\n\tget value()\n\t{\n\t\treturn this._value;\n\t}\n\n\tset value(value)\n\t{\n\t\tlet oldvalue = this._value;\n\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\n\t\tif (ul4._ne(oldvalue, change.value))\n\t\t{\n\t\t\tthis.record.values.set(this.control.identifier, change.value);\n\t\t\tthis._value = change.value;\n\t\t\tthis._dirty = true;\n\t\t}\n\t\tthis.errors = change.errors;\n\t}\n\n\t_validate(change)\n\t{\n\t\t// Do nothing, i.e. accept the value unchanged and without errors\n\t}\n\n\tget label()\n\t{\n\t\tif (this._label !== null)\n\t\t\treturn this._label;\n\t\treturn this.control.label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.control.globals;\n\t}\n\n\tis_empty()\n\t{\n\t\treturn this._value === null || (ul4._islist(this._value) && this._value.length === 0);\n\t}\n\n\tis_dirty()\n\t{\n\t\treturn this._dirty;\n\t}\n\n\thas_errors()\n\t{\n\t\treturn this.errors.length !== 0;\n\t}\n\n\tsearch(searchvalue)\n\t{\n\t\treturn this.control.search(this.value, searchvalue);\n\t}\n\n\tmsg_field_required(value)\n\t{\n\t\tswitch (this.globals.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn `\"${this.label}\" wird benötigt!`;\n\t\t\tdefault:\n\t\t\t\treturn `\"${this.label}\" is required!`;\n\t\t}\n\t}\n\n\tmsg_field_wrong_type(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support the type ${ul4._type(value).name}!`;\n\t}\n\n\tmsg_bool_truerequired(value)\n\t{\n\t\treturn `\"${this.label}\" only accepts \"Yes\"!`;\n\t}\n\n\tmsg_string_tooshort(value)\n\t{\n\t\treturn `\"${this.label}\" is too short. Tou must use at least ${this.control.minlength} characters!`;\n\t}\n\n\tmsg_string_toolong(value)\n\t{\n\t\treturn `\"${this.label}\" is too long. You may use at most ${this.control.maxlength} characters!`;\n\t}\n\n\tmsg_email_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid email address!`;\n\t}\n\n\tmsg_url_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid URL!`;\n\t}\n\n\tmsg_tel_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid phone number!`;\n\t}\n\n\tmsg_date_format(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support this date format!`;\n\t}\n\n\tmsg_lookup_wrongitem(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" doesn't belong to this lookup!`;\n\t}\n\n\tmsg_lookup_unknownkey(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" is unknown!`;\n\t}\n\n\tmsg_applookup_wrongrecord(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" doesn't belong to the correct app!`;\n\t}\n\n\tmsg_applookup_unknownkey(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" can't be found!`;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet s = \"<Field identifier=\";\n\t\ts += ul4._repr(this.control.identifier)\n\t\tif (this._dirty)\n\t\t\ts += \" is_dirty()=True\";\n\t\tif (this.errors.length > 0)\n\t\t\ts += \" has_errors()=True\";\n\t\ts += \">\"\n\t\treturn s;\n\t}\n};\n\nField.prototype._ul4onattrs = [\"control\", \"record\", \"label\", \"value\", \"errors\", \"enabled\", \"writable\", \"visible\"];\nField.prototype._ul4attrs = new Set([\"control\", \"record\", \"label\", \"value\", \"errors\", \"enabled\", \"writable\", \"visible\"]);\n\n\nexport class BoolField extends Field\n{\n\tstatic classdoc = \"Holds the value of a bool field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) === \"boolean\")\n\t\t{\n\t\t\tif (this.control.required && !change.value)\n\t\t\t\tchange.errors.push(this.msg_bool_truerequired(change.value));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class IntField extends Field\n{\n\tstatic classdoc = \"Holds the value of an int field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) !== \"number\" || Math.round(change.value) !== change.value)\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t}\n\t}\n};\n\n\nexport class NumberField extends Field\n{\n\tstatic classdoc = \"Holds the value of a number field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) !== \"number\")\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t}\n\t}\n};\n\n\nexport class StringField extends Field\n{\n\tstatic classdoc = \"Holds the value of a string field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet minlength = this.control.minlength;\n\t\t\tlet maxlength = this.control.maxlength;\n\t\t\tif (minlength !== null && change.value.length < minlength)\n\t\t\t\tchange.errors.push(this.msg_string_tooshort(change.value))\n\t\t\tif (maxlength !== null && change.value.length > maxlength)\n\t\t\t\tchange.errors.push(this.msg_string_toolong(change.value))\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class EmailField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/email field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/i;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_email_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class URLField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/url field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tlet url = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\turl = new URL(change.value);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t\tif (url !== null && url.protocol !== \"http:\" && url.protocol !== \"https:\")\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class TelField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/tel field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^\\\\+?[0-9 /()-]+$/;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_tel_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class TextAreaField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/textarea field of a record (and related information)\";\n};\n\n\nexport class HTMLField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/html field of a record (and related information)\";\n};\n\n\nexport class GeoField extends Field\n{\n\tstatic classdoc = \"Holds the value of a geo field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof Geo))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class FileField extends Field\n{\n\tstatic classdoc = \"Holds the value of a file field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof File))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class FileSignatureField extends FileField\n{\n\tstatic classdoc = \"Holds the value of a file/signature field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\t// FIXME: Implement handling of data URLs.\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class DateFieldBase extends Field\n{\n\tstatic classdoc = \"Holds the value of a date field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (change.value instanceof Date)\n\t\t{\n\t\t\tchange.value = this._convert(new Date(change.value.getTime()));\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = null;\n\t\t\tif (change.value.length === 10)\n\t\t\t\tvalue = new Date(change.value + \"T00:00:00\");\n\t\t\telse if (change.value.length === 16)\n\t\t\t\tvalue = new Date(change.value + \":00\");\n\t\t\telse if (change.value.length === 19)\n\t\t\t\tvalue = new Date(change.value);\n\n\t\t\tif (value === null || Number.isNaN(value.getYear()))\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_date_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = this._convert(value);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class DateField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/date field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\treturn new ul4.Date_(date.getFullYear(), date.getMonth()+1, date.getDate());\n\t}\n};\n\n\nexport class DatetimeMinuteField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/datetimeminute field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\t// Get rid of seconds and milliseconds\n\t\tdate.setSeconds(0);\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n\nexport class DatetimeSecondField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/datetimesecond field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\t// Get rid of milliseconds\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n\nexport class LookupFieldBase extends Field\n{\n\tstatic classdoc = \"Base type of LookupField and MultipleLookupField\";\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdate !== null)\n\t\t\treturn this._lookupdate;\n\t\telse\n\t\t\treturn this.control.lookupdata;\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tthis._lookupdate = value;\n\t}\n\n\t_find_lookupitem(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\t// If `lookupdata`} is `null`, this is probably an interface,\n\t\t\t// so we can't validate anything (note that interfaces will however go\n\t\t\t// away in the future)\n\t\t\tif (this.lookupdata === null)\n\t\t\t\treturn;\n\t\t\tlet lookupitem = this.lookupdata.get(v);\n\t\t\tif (lookupitem === undefined)\n\t\t\t{\n\t\t\t\t// If the lookup control is auto expandable,\n\t\t\t\t// the user may have given us a label\n\t\t\t\tif (this.control.autoexpandable)\n\t\t\t\t{\n\t\t\t\t\t// Search for the LookupItem with that label\n\t\t\t\t\tfor (let search_lookupitem of this.lookupdata.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (v === search_lookupitem.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchange.value = search_lookupitem;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// If we couldn't find the label, keep the label as it is.\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchange.errors.push(this.msg_lookup_unknownkey(v))\n\t\t\t\t\tchange.value = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = lookupitem;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof LookupItem)\n\t\t{\n\t\t\tlet value = this.control.lookupdata.get(v.key);\n\t\t\tif (value !== v)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_lookup_wrongitem(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class LookupField extends LookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a lookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (v === null || v === \"\" || this.control.nonekey === v)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t}\n\t}\n};\n\n\nexport class MultipleLookupField extends LookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a multiple lookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.nonekey === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_lookupitem(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nexport class AppLookupFieldBase extends Field\n{\n\tstatic classdoc = \"Base type of AppLookupField and MultipleAppLookupField\";\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdata !== null)\n\t\t\treturn this._lookupdata;\n\t\telse\n\t\t{\n\t\t\tif (this.control.lookup_app.records !== null)\n\t\t\t\treturn this.control.lookup_app.records;\n\t\t}\n\t\treturn new Map();\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tthis._lookupdata = value;\n\t}\n\n\t_find_record(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\tlet record = this.lookupdata.get(v);\n\t\t\tif (record === undefined)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_unknownkey(v))\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = record;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof Record)\n\t\t{\n\t\t\tif (v.app !== this.control.lookup_app)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_wrongrecord(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class AppLookupField extends AppLookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a applookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tthis._find_record(change);\n\t}\n};\n\n\nexport class MultipleAppLookupField extends AppLookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a multiple applookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.nonekey === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_record(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_record(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nexport class Control extends Base\n{\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.app.globals;\n\t}\n\n\tget fulltype()\n\t{\n\t\treturn this.subtype ? this.type + \"/\" + this.subtype : this.type;\n\t}\n\n\tget label()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn this._label;\n\t\tlet label = view_control.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t}\n\n\tget default()\n\t{\n\t\treturn null;\n\t}\n\n\tget top()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.top : null;\n\t}\n\n\tget left()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.left : null;\n\t}\n\n\tget width()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.width : null;\n\t}\n\n\tget height()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.height : null;\n\t}\n\n\tget liveupdate()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.liveupdate : false;\n\t}\n\n\tget tabindex()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.tabindex : null;\n\t}\n\n\tget required()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.required : false;\n\t}\n\n\tget mode()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.mode : \"edit\";\n\t}\n\n\tget labelpos()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelpos : \"left\";\n\t}\n\n\tget labelwidth()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelwidth : null;\n\t}\n\n\tget autoalign()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.autoalign : true;\n\t}\n\n\tget in_active_view()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null;\n\t}\n\n\t_view_control()\n\t{\n\t\tif (this.app._active_view === null)\n\t\t\treturn null;\n\t\tlet view_control = this.app._active_view.controls.get(this.identifier);\n\t\treturn view_control ?? null;\n\t}\n\n\t_logsearch(value, search)\n\t{\n\t\t//console.log(\"Searching for \" + ul4._repr(search.value) + \" in \" + ul4._repr(this) + \" with operator \" + search.operator + \" in value \" + ul4._repr(value));\n\t}\n\n\t// base implemntation, always returns ``false`` (i.e. \"not found\")\n\t// ``value`` is the value of the field\n\t// ``search`` is an object with information what we're searching for\n\t// keys in ``search`` are: ``operator`` (and ``value`` (if required by the operator))\n\tsearch(value, search)\n\t{\n\t\treturn false;\n\t}\n};\n\nControl.prototype.type = null;\nControl.prototype.subtype = null;\nControl.prototype._ul4onattrs = [\"identifier\", \"fieldname\", \"app\", \"_label\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\"];\nControl.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"fieldname\", \"app\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\", \"fulltype\", \"label\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"tabindex\", \"required\", \"mode\", \"labelpos\", \"autoalign\", \"in_active_view\"]);\n\n\nexport class BoolControl extends Control\n{\n\tstatic classdoc = \"A LivingApps boolean field (type 'bool')\";\n\n\t// ``search`` must by ``null``, ``false`` or ``true``\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nBoolControl.prototype.type = \"bool\";\nBoolControl.prototype.fieldtype = BoolField;\n\n\nexport class IntControl extends Control\n{\n\tstatic classdoc = \"A LivingApps integer field (type 'int')\";\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nIntControl.prototype.type = \"int\";\nIntControl.prototype.fieldtype = IntField;\n\n\nclass PlaceholderControl extends Control\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/select')\";\n\n\tget placeholder()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.placeholder;\n\t}\n};\n\nPlaceholderControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"placeholder\"]);\n\n\nexport class NumberControl extends PlaceholderControl\n{\n\tstatic classdoc = \"A LivingApps number field (type 'number')\";\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"range\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn false;\n\t\t\treturn (search.minvalue === null || search.minvalue <= value) && (search.maxvalue === null || value < search.maxvalue);\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nNumberControl.prototype.type = \"number\";\nNumberControl.prototype.fieldtype = NumberField;\n\n\nexport class StringControl extends PlaceholderControl\n{\n\t_user_placeholder(user, placeholder)\n\t{\n\t\tif (placeholder === null)\n\t\t\treturn null;\n\t\tswitch (placeholder)\n\t\t{\n\t\t\tcase \"{gender}\":\n\t\t\t\treturn user !== null ? user.gender : null;\n\t\t\tcase \"{title}\":\n\t\t\t\treturn user !== null ? user.title : null;\n\t\t\tcase \"{firstname}\":\n\t\t\t\treturn user !== null ? user.firstname : null;\n\t\t\tcase \"{surname}\":\n\t\t\t\treturn user !== null ? user.surname : null;\n\t\t\tcase \"{account}\":\n\t\t\t\treturn user !== null ? user.email : null;\n\t\t\tcase \"{streetname}\":\n\t\t\t\treturn user !== null ? user.streetname : null;\n\t\t\tcase \"{streetnumber}\":\n\t\t\t\treturn user !== null ? user.streetnumber : null;\n\t\t\tcase \"{street}\":\n\t\t\t\tif (user === null)\n\t\t\t\t\treturn null;\n\t\t\t\telse if (user.street === null)\n\t\t\t\t\treturn user.streetnumber;\n\t\t\t\telse if (user.streetnumber === null)\n\t\t\t\t\treturn user.street;\n\t\t\t\telse\n\t\t\t\t\treturn user.street + \" \" + user.streetnumber;\n\t\t\tcase \"{zip}\":\n\t\t\t\treturn user !== null ? user.zip : null;\n\t\t\tcase \"{phone}\":\n\t\t\t\treturn user !== null ? user.phone : null;\n\t\t\tcase \"{fax}\":\n\t\t\t\treturn user !== null ? user.fax : null;\n\t\t\tcase \"{company}\":\n\t\t\t\treturn user !== null ? user.company : null;\n\t\t\tcase \"{city}\":\n\t\t\t\treturn user !== null ? user.city : null;\n\t\t\tcase \"{summary}\":\n\t\t\t\treturn user !== null ? user.summary : null;\n\t\t\tcase \"{interests}\":\n\t\t\t\treturn user !== null ? user.interests : null;\n\t\t\tcase \"{personal_website}\":\n\t\t\t\treturn user !== null ? user.personal_website : null;\n\t\t\tcase \"{company_website}\":\n\t\t\t\treturn user !== null ? user.company_website : null;\n\t\t\tcase \"{position}\":\n\t\t\t\treturn user !== null ? user.position : null;\n\t\t\tcase \"{department}\":\n\t\t\t\treturn user !== null ? user.department : null;\n\t\t\tcase \"{today}\":\n\t\t\t\treturn ul4.today();\n\t\t\tdefault:\n\t\t\t\treturn placeholder;\n\t\t}\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this._user_placeholder(this.app.globals.user, view_control.default);\n\t}\n\n\tget minlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 0;\n\t\tlet minlength = view_control.minlength;\n\t\tif (minlength === null || minlength < 0)\n\t\t\treturn 0;\n\t\treturn minlength;\n\t}\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 4000;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength === null || maxlength < 0 || maxlength > 4000)\n\t\t\treturn 4000;\n\t\treturn maxlength;\n\t}\n\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (search.value === null || value === null)\n\t\t\t\treturn search.value === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(search.value.toLowerCase()) >= 0;\n\t\t}\n\t}\n};\n\nStringControl.prototype.type = \"string\";\n\n\nexport class TextControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps text field (type 'string/text')\";\n};\n\nTextControl.prototype.subtype = \"text\";\nTextControl.prototype.fieldtype = StringField;\n\n\nexport class EmailControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps email field (type 'string/email')\";\n};\n\nEmailControl.prototype.subtype = \"email\";\nEmailControl.prototype.fieldtype = EmailField;\n\n\nexport class URLControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps URL field (type 'string/url')\";\n};\n\nURLControl.prototype.subtype = \"url\";\nURLControl.prototype.fieldtype = URLField;\n\n\nexport class TelControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps phone number field (type 'string/tel')\";\n};\n\nTelControl.prototype.subtype = \"tel\";\nTelControl.prototype.fieldtype = TelField;\n\n\nexport class TextAreaControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps textarea field (type 'string/textarea')\";\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\t// We only get the encrypted text in encryption mode, so we can't check its length\n\t\tif (this.encrypted !== null)\n\t\t\treturn null;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength < 0)\n\t\t\treturn null;\n\t\treturn maxlength;\n\t}\n};\n\nTextAreaControl.prototype.subtype = \"textarea\";\nTextAreaControl.prototype.fieldtype = TextAreaField;\nTextAreaControl.prototype._ul4onattrs = [...StringControl.prototype._ul4onattrs, \"encrypted\"];\nTextAreaControl.prototype._ul4attrs = new Set([...StringControl.prototype._ul4attrs, \"encrypted\"]);\n\n\nexport class HTMLControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps HTML field (type 'string/html')\";\n};\n\nHTMLControl.prototype.subtype = \"html\";\nHTMLControl.prototype.fieldtype = HTMLField;\n\n\nexport class DateControl extends PlaceholderControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/date')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn view_control.default === \"{today}\" ? ul4.today() : null;\n\t}\n\n\tformatstring(language)\n\t{\n\t\tlanguage = language || this.app.language;\n\n\t\tif (language === \"de\")\n\t\t\treturn \"%d.%m.%Y\";\n\t\telse\n\t\t\treturn \"%m/%d/%Y\";\n\t}\n\n\t// searchvalue must be ``null``, a ``Date`` object or a string\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\n\t\tlet searchvalue = search.value;\n\t\tif (Object.prototype.toString.call(searchvalue) == \"[object Date]\")\n\t\t\tsearchvalue = ul4._format(searchvalue, this.formatstring(), this.app.language);\n\t\tif (value !== null)\n\t\t\tvalue = ul4._format(value, this.formatstring(), this.app.language);\n\n\t\tif (search.operator === \"equals\")\n\t\t\treturn searchvalue === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (searchvalue === null || value === null)\n\t\t\t\treturn searchvalue === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(searchvalue.toLowerCase()) >= 0;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nDateControl.prototype.type = \"date\";\nDateControl.prototype.subtype = \"date\";\nDateControl.prototype.fieldtype = DateField;\n\n\nexport class DatetimeMinuteControl extends DateControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/datetimeminute')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setSeconds(0);\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tformatstring(language)\n\t{\n\t\tlanguage = language || this.app.language;\n\n\t\tif (language === \"de\")\n\t\t\treturn \"%d.%m.%Y %H:%M\";\n\t\telse\n\t\t\treturn \"%m/%d/%Y %H:%M\";\n\t}\n};\n\nDatetimeMinuteControl.prototype.subtype = \"datetimeminute\";\nDatetimeMinuteControl.prototype.fieldtype = DatetimeMinuteField;\n\n\nexport class DatetimeSecondControl extends DateControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/datetimesecond')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tformatstring(language)\n\t{\n\t\tlanguage = language || this.app.language;\n\n\t\tif (language === \"de\")\n\t\t\treturn \"%d.%m.%Y %H:%M:%S\";\n\t\telse\n\t\t\treturn \"%m/%d/%Y %H:%M:%S\";\n\t}\n};\n\nDatetimeSecondControl.prototype.subtype = \"datetimesecond\";\nDatetimeSecondControl.prototype.fieldtype = DatetimeSecondField;\n\n\nexport class LookupControl extends Control\n{\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this.lookupdata.get(view_control) ?? null;\n\t}\n\n\tget autoexpandable()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn false;\n\t\treturn view_control.autoexpandable;\n\t}\n\n\tget nonekey()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonekey;\n\t}\n\n\tget nonelabel()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonelabel;\n\t}\n\n\t// ``search.value`` must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn search.value === null;\n\t\t\telse\n\t\t\t\treturn value.key === search.value;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nLookupControl.prototype.type = \"lookup\";\nLookupControl.prototype.fieldtype = LookupField;\nLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookupdata\"];\nLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookupdata\"]);\n\n\nexport class LookupSelectControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/select')\";\n\n};\n\nLookupSelectControl.prototype.subtype = \"select\";\n\n\nexport class LookupRadioControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/radio')\";\n\n};\n\nLookupRadioControl.prototype.subtype = \"radio\";\n\n\nexport class LookupChoiceControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/choice')\";\n\n};\n\nLookupChoiceControl.prototype.subtype = \"choice\";\n\n\nexport class AppLookupControl extends Control\n{\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (value === null || search.value === null)\n\t\t\treturn value === search.value;\n\t\telse\n\t\t\treturn value.search(search);\n\t}\n};\n\nAppLookupControl.prototype.type = \"applookup\";\nAppLookupControl.prototype.fieldtype = AppLookupField;\nAppLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"];\nAppLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"]);\n\n\nexport class AppLookupSelectControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/select')\";\n\n};\n\nAppLookupSelectControl.prototype.subtype = \"select\";\n\n\nexport class AppLookupRadioControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/radio')\";\n\n};\n\nAppLookupRadioControl.prototype.subtype = \"radio\";\n\n\nexport class AppLookupChoiceControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/choice')\";\n\n};\n\nAppLookupChoiceControl.prototype.subtype = \"choice\";\n\n\nexport class MultipleLookupControl extends LookupControl\n{\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tlet defaultValue = this.lookupdata.get(view_control)\n\n\t\treturn (defaultValue !== undefined) ? [defaultValue] : [];\n\t}\n\n\t// search.value must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tfor (let item of value)\n\t\t\t{\n\t\t\t\tif (item.key === search.value)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleLookupControl.prototype.subtype = \"multiplelookup\";\nMultipleLookupControl.prototype.fieldtype = MultipleLookupField;\n\n\nexport class MultipleLookupSelectControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/select')\";\n\n};\n\nMultipleLookupSelectControl.prototype.subtype = \"select\";\n\n\nexport class MultipleLookupCheckboxControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/checkbox')\";\n\n};\n\nMultipleLookupCheckboxControl.prototype.subtype = \"checkbox\";\n\n\nexport class MultipleLookupChoiceControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/choice')\";\n\n};\n\nMultipleLookupChoiceControl.prototype.subtype = \"choice\";\n\n\nexport class MultipleAppLookupControl extends AppLookupControl\n{\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (search.value === null)\n\t\t\t\treturn value.length === 0;\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let item of value)\n\t\t\t\t{\n\t\t\t\t\tif (item.search(search.value))\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleAppLookupControl.prototype.type = \"multipleapplookup\";\nMultipleAppLookupControl.prototype.fieldtype = MultipleAppLookupField;\n\n\nexport class MultipleAppLookupSelectControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/select')\";\n\n};\n\nMultipleAppLookupSelectControl.prototype.subtype = \"select\";\n\n\nexport class MultipleAppLookupCheckboxControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/checkbox')\";\n\n};\n\nMultipleAppLookupCheckboxControl.prototype.subtype = \"checkbox\";\n\n\nexport class MultipleAppLookupChoiceControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/choice')\";\n};\n\nMultipleAppLookupChoiceControl.prototype.subtype = \"choice\";\n\n\nexport class GeoControl extends Control\n{\n\tstatic classdoc = \"A LivingApps geo field (type 'geo')\";\n};\n\nGeoControl.prototype.type = \"geo\";\nGeoControl.prototype.fieldtype = GeoField;\n\n\nexport class FileControl extends Control\n{\n\tstatic classdoc = \"A LivingApps upload field (type 'file')\";\n};\n\nFileControl.prototype.type = \"file\";\nFileControl.prototype.fieldtype = FileField;\n\n\nexport class FileSignatureControl extends FileControl\n{\n\tstatic classdoc = \"A LivingApps signature image field (type 'file/signature')\";\n};\n\nFileSignatureControl.prototype.subtype = \"signature\";\nFileSignatureControl.prototype.fieldtype = FileSignatureField;\n\n\nexport class ButtonControl extends Control\n{\n};\n\nButtonControl.prototype.type = \"button\";\n\n\nexport class LookupItem extends Base\n{\n\tstatic classdoc = \"An option in a lookup control/field\";\n\n\tget label()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn this._label;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn this._label;\n\t\tlet label = view_lookupitem.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tget visible()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn true;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn true;\n\t\treturn view_lookupitem.visible;\n\t}\n\n\t_view_lookupitem()\n\t{\n\t\tlet identifier = this.control.identifier;\n\t\tlet active_view = this.control.app.active_view;\n\t\tif (active_view !== null && active_view.controls !== null)\n\t\t{\n\t\t\tlet view_control = active_view.controls.get(identifier);\n\t\t\tif (view_control !== undefined && view_control.lookupdata !== undefined && view_control.lookupdata !== null)\n\t\t\t{\n\t\t\t\tlet view_lookupitem = view_control.lookupdata.get(this.key);\n\t\t\t\tif (view_lookupitem !== undefined)\n\t\t\t\t\treturn view_lookupitem;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<LookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \"visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nLookupItem.prototype._ul4onattrs = [\"control\", \"key\", \"_label\"];\nLookupItem.prototype._ul4attrs = new Set([\"id\", \"control\", \"key\", \"label\"]);\n\n\nexport class ViewLookupItem extends Base\n{\n\tstatic classdoc = \"View specific information about a lookup item\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<ViewLookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \" visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nViewLookupItem.prototype._ul4onattrs = [\"key\", \"label\", \"visible\"];\nViewLookupItem.prototype._ul4attrs = new Set([\"key\", \"label\", \"visible\"]);\n\n\nexport class LayoutControl extends Base\n{\n\tstatic classdoc = \"A decoration in an input form\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nLayoutControl.prototype._ul4onattrs = [\"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\"];\nLayoutControl.prototype._ul4attrs = new Set([\"id\", \"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\"]);\n\n\nexport class HTMLLayoutControl extends LayoutControl\n{\n\tstatic classdoc = \"An HTML decoration in an input form\";\n};\n\nHTMLLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"value\"];\nHTMLLayoutControl.prototype._ul4attrs = new Set([LayoutControl.prototype._ul4attrs, \"value\"]);\n\n\nexport class ImageLayoutControl extends LayoutControl\n{\n\tstatic classdoc = \"An image decoration in an input form\";\n};\n\nImageLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"original\", \"scaled\"];\nImageLayoutControl.prototype._ul4attrs = new Set([LayoutControl.prototype._ul4attrs, \"original\", \"scaled\"]);\n\n\nexport class ViewControl extends Base\n{\n\tstatic classdoc = \"Contains view specific information aboutn a control\";\n\n\tget mode()\n\t{\n\t\treturn this._mode ? \"display\" : \"edit\";\n\t}\n};\n\nViewControl.prototype._ul4onattrs = [\"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"_mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"];\nViewControl.prototype._ul4attrs = new Set([\"id\", \"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"]);\n\n\nexport class User extends Base\n{\n\tstatic classdoc = \"A LivingApps user/account\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<User id=\" + ul4._repr(this.id) + \" firstname=\" + ul4._repr(this.firstname) + \" surname=\" + ul4._repr(this.surname) + \" email=\" + ul4._repr(this.email) + \">\";\n\t}\n};\n\nUser.prototype._ul4onattrs = [\"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"avatarsmall\", \"avatarlarge\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"];\nUser.prototype._ul4attrs = new Set([\"id\", \"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"avatarsmall\", \"avatarlarge\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"]);\n\n\nexport class File extends Base\n{\n\tstatic classdoc = \"An uploaded file\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<File id=\" + ul4._repr(this.id) + \" url=\" + ul4._repr(this.url) + \" filename=\" + ul4._repr(this.filename) + \">\";\n\t}\n};\n\nFile.prototype._ul4onattrs = [\"url\", \"filename\", \"mimetype\", \"width\", \"height\", \"internalid\", \"createdat\", \"size\"];\nFile.prototype._ul4attrs = new Set([\"id\", \"url\", \"filename\", \"mimetype\", \"width\", \"height\", \"size\", \"createdat\"]);\n\n\nexport class Geo extends Base\n{\n\tstatic classdoc = \"Geographical coordinates and location information\";\n\n\tconstructor(lat, long, info)\n\t{\n\t\tsuper(null);\n\t\tthis.lat = lat;\n\t\tthis.long = long;\n\t\tthis.info = info;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Geo lat=\" + ul4._repr(this.lat) + \" long=\" + ul4._repr(this.long) + \" info=\" + ul4._repr(this.info) + \">\";\n\t}\n};\n\nGeo.prototype._ul4onattrs = [\"lat\", \"long\", \"info\"];\nGeo.prototype._ul4attrs = new Set([\"lat\", \"long\", \"info\"]);\n\n\nexport class Attachment extends Base\n{\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" label=\" + ul4._repr(this.label) + \">\";\n\t}\n};\n\nAttachment.prototype._ul4onattrs = [\"record\", \"label\", \"active\"];\nAttachment.prototype._ul4attrs = new Set([\"id\", \"record\", \"label\", \"active\"]);\n\n\nexport class NoteAttachment extends Attachment\n{\n\tstatic classdoc = \"A note attachment of a record\";\n\n};\n\nNoteAttachment.prototype.type = \"noteattachment\";\nNoteAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nNoteAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class URLAttachment extends Attachment\n{\n\tstatic classdoc = \"A URL attachment of a record\";\n\n};\n\nURLAttachment.prototype.type = \"urlattachment\";\nURLAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nURLAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class FileAttachment extends Attachment\n{\n\tstatic classdoc = \"A file attachment of a record\";\n\n};\n\nFileAttachment.prototype.type = \"fileattachment\";\nFileAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nFileAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class ImageAttachment extends Attachment\n{\n\tstatic classdoc = \"An image attachment of a record\";\n\n};\n\nImageAttachment.prototype.type = \"imageattachment\";\nImageAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"original\", \"thumb\", \"small\", \"medium\",\"large\"];\nImageAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"original\", \"thumb\", \"small\", \"medium\", \"large\"]);\n\n\nexport class JSONAttachment extends Attachment\n{\n\tstatic classdoc = \"A JSON attachment of a record\";\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"value\")\n\t\t\treturn ul4._asjson(this.value);\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"value\")\n\t\t\tthis.value = ul4._fromjson(value);\n\t\telse\n\t\t\tthis[name] = value\n\t}\n};\n\nJSONAttachment.prototype.type = \"jsonattachment\";\nJSONAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nJSONAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class Installation extends Base\n{\n\tstatic classdoc = \"The installation that created an app\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Installation id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nInstallation.prototype._ul4onattrs = [\"name\"];\nInstallation.prototype._ul4attrs = new Set([\"id\", \"name\"]);\n\n\nexport class Category extends Base\n{\n\tstatic classdoc = \"A navigation category\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [];\n\t\tlet category = this;\n\t\twhile (category !== null)\n\t\t{\n\t\t\tv.splice(0, 0, category.identifier);\n\t\t\tcategory = category.parent;\n\t\t}\n\t\treturn \"<Category id=\" + ul4._repr(this.id) + \" identifierpath=\" + ul4._repr(v.join(\"/\")) +  + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nCategory.prototype._ul4onattrs = [\"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"];\nCategory.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"]);\n\n\nexport class KeyView extends Base\n{\n\tstatic classdoc = \"Object granting access to a view template\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<KeyView id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nKeyView.prototype._ul4onattrs = [\"identifier\", \"name\", \"key\", \"user\"];\nKeyView.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"key\", \"user\"]);\n\n\nexport class AppParameter extends Base\n{\n\tstatic classdoc = \"A parameter of a LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<AppParameter id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nAppParameter.prototype._ul4onattrs = [\"app\", \"identifier\", \"description\", \"value\"];\nAppParameter.prototype._ul4attrs = new Set([\"id\", \"app\", \"identifier\", \"description\", \"value\"]);\n\n\nlet classes = [\n\tGlobals,\n\tFlashMessage,\n\tApp,\n\tView,\n\tDataSourceData,\n\tRecord,\n\tBoolControl,\n\tIntControl,\n\tNumberControl,\n\tTextControl,\n\tEmailControl,\n\tURLControl,\n\tTelControl,\n\tTextAreaControl,\n\tDateControl,\n\tDatetimeMinuteControl,\n\tDatetimeSecondControl,\n\tLookupControl,\n\tLookupSelectControl,\n\tLookupRadioControl,\n\tLookupChoiceControl,\n\tAppLookupControl,\n\tAppLookupSelectControl,\n\tAppLookupRadioControl,\n\tAppLookupChoiceControl,\n\tMultipleLookupControl,\n\tMultipleLookupSelectControl,\n\tMultipleLookupCheckboxControl,\n\tMultipleLookupChoiceControl,\n\tMultipleAppLookupControl,\n\tMultipleAppLookupSelectControl,\n\tMultipleAppLookupCheckboxControl,\n\tMultipleAppLookupChoiceControl,\n\tGeoControl,\n\tFileControl,\n\tFileSignatureControl,\n\tButtonControl,\n\tField,\n\tBoolField,\n\tStringField,\n\tEmailField,\n\tURLField,\n\tTelField,\n\tTextAreaField,\n\tHTMLField,\n\tIntField,\n\tNumberField,\n\tGeoField,\n\tFileField,\n\tFileSignatureField,\n\tDateFieldBase,\n\tDateField,\n\tDatetimeMinuteField,\n\tDatetimeSecondField,\n\tLookupFieldBase,\n\tLookupField,\n\tMultipleLookupField,\n\tAppLookupFieldBase,\n\tAppLookupField,\n\tMultipleAppLookupField,\n\tLookupItem,\n\tViewLookupItem,\n\tLayoutControl,\n\tHTMLLayoutControl,\n\tImageLayoutControl,\n\tViewControl,\n\tUser,\n\tFile,\n\tGeo,\n\tNoteAttachment,\n\tURLAttachment,\n\tFileAttachment,\n\tImageAttachment,\n\tJSONAttachment,\n\tInstallation,\n\tCategory,\n\tKeyView,\n\tAppParameter\n];\n\nfor (let constructor of classes)\n{\n\tul4.register(\"de.livinglogic.livingapi.\" + constructor.name.toLowerCase(), constructor);\n}\n"],"names":["Base","ul4","Proto","id","this","encoder","i","_ul4onattrs","length","dump","_dumpUL4ONAttr","name","decoder","iter","loadcontent","iteritem","next","done","_loadUL4ONAttr","value","_setDefaultUL4ONAttr","symbols","getattr","_ul4attrs","has","realvalue","bind","_ul4_name","_ul4_signature","_ul4_needsobject","_ul4_needscontext","AttributeError","repr","constructor","Handler","record","Globals","version","hostname","platform","user","lang","app","maxdbactions","maxtemplateruntime","flashmessages","handler","url","width","height","type","enlarge","gravity","quality","rotate","blur","sharpen","format","cache","filename","File","encodeURIComponent","result","rotatet","_repr","geo1","geo2","sqsin","x","Math","sin","sqcos","sqsos","cos","deg2rad","PI","flat","lat1","lat","long1","lat2","F","G","l","S","C","w","atan","sqrt","D","T","H2","prototype","Set","FlashMessage","title","call","App","values","globals","save","active_view","Map","layout_controls","Record","_ismap","keys","identifier","fields","ArgumentError","_make_fields","_isobject","TypeError","_list","dicttype","items","startsWith","controls","substr","get","_active_view","view","views","ValueError","View","expose","insert","DataSourceData","setattr","createdat","createdby","updatedat","updatedby","updatecount","_sparsevalues","_values","_fields","children","attachments","errors","_sparsefielderrors","_sparsefieldlookupdata","_is_deleted","_is_new","defaults","lookupdata","control","field","Field","set","_sparselookupdata","v","priority","is_empty","push","state","join","is_dirty","has_errors","entries","key","search","fieldsearch","_bool","update","_label","_value","_dirty","_lookupdate","oldvalue","change","_validate","_ne","label","_islist","searchvalue","_type","minlength","maxlength","s","BoolField","required","msg_field_required","msg_bool_truerequired","msg_field_wrong_type","IntField","round","NumberField","StringField","msg_string_tooshort","msg_string_toolong","EmailField","test","msg_email_format","URLField","URL","exc","msg_url_format","protocol","TelField","msg_tel_format","TextAreaField","HTMLField","GeoField","Geo","FileField","FileSignatureField","DateFieldBase","Date","_convert","getTime","Number","isNaN","getYear","msg_date_format","DateField","date","Date_","getFullYear","getMonth","getDate","DatetimeMinuteField","setSeconds","setMilliseconds","DatetimeSecondField","LookupFieldBase","lookupitem","undefined","autoexpandable","search_lookupitem","msg_lookup_unknownkey","LookupItem","msg_lookup_wrongitem","LookupField","nonekey","_find_lookupitem","MultipleLookupField","islist","Object","toString","newvalue","singlechange","AppLookupFieldBase","_lookupdata","lookup_app","records","msg_applookup_unknownkey","msg_applookup_wrongrecord","AppLookupField","_find_record","MultipleAppLookupField","Control","subtype","view_control","_view_control","top","left","liveupdate","tabindex","mode","labelpos","labelwidth","autoalign","BoolControl","_logsearch","operator","fieldtype","IntControl","PlaceholderControl","placeholder","NumberControl","minvalue","maxvalue","StringControl","gender","firstname","surname","email","streetname","streetnumber","street","zip","phone","fax","company","city","summary","interests","personal_website","company_website","position","department","today","_user_placeholder","toLowerCase","indexOf","TextControl","EmailControl","URLControl","TelControl","TextAreaControl","encrypted","HTMLControl","DateControl","language","_format","formatstring","DatetimeMinuteControl","now","DatetimeSecondControl","LookupControl","lookupnonekey","lookupnonelabel","LookupSelectControl","LookupRadioControl","LookupChoiceControl","AppLookupControl","AppLookupSelectControl","AppLookupRadioControl","AppLookupChoiceControl","MultipleLookupControl","defaultValue","MultipleLookupSelectControl","MultipleLookupCheckboxControl","MultipleLookupChoiceControl","MultipleAppLookupControl","MultipleAppLookupSelectControl","MultipleAppLookupCheckboxControl","MultipleAppLookupChoiceControl","GeoControl","FileControl","FileSignatureControl","ButtonControl","view_lookupitem","_view_lookupitem","visible","ViewLookupItem","LayoutControl","HTMLLayoutControl","ImageLayoutControl","ViewControl","_mode","User","long","info","Attachment","NoteAttachment","URLAttachment","FileAttachment","ImageAttachment","JSONAttachment","_asjson","_fromjson","Installation","Category","category","splice","parent","KeyView","AppParameter","register"],"mappings":"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"}