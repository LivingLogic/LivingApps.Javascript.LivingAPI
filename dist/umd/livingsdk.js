!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("core-js/modules/es6.array.sort"),require("core-js/modules/es6.object.set-prototype-of"),require("core-js/modules/es6.array.find"),require("core-js/modules/es6.array.last-index-of"),require("core-js/modules/es6.regexp.split"),require("core-js/modules/es6.array.index-of"),require("core-js/modules/es6.regexp.to-string"),require("core-js/modules/es6.date.to-string"),require("core-js/modules/es6.object.create"),require("core-js/modules/es6.object.assign"),require("core-js/modules/es6.function.name"),require("core-js/modules/es6.regexp.match"),require("core-js/modules/es6.regexp.replace"),require("core-js/modules/es6.set"),require("core-js/modules/es6.array.for-each"),require("core-js/modules/web.dom.iterable"),require("core-js/modules/es6.array.iterator"),require("core-js/modules/es6.string.iterator"),require("core-js/modules/es6.map"),require("core-js/modules/es6.regexp.search"),require("core-js/modules/es6.string.starts-with"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("core-js/modules/es6.function.bind"),require("core-js/modules/es6.date.now"),require("core-js/modules/es6.promise"),require("axios"),require("https")):"function"==typeof define&&define.amd?define(["exports","core-js/modules/es6.array.sort","core-js/modules/es6.object.set-prototype-of","core-js/modules/es6.array.find","core-js/modules/es6.array.last-index-of","core-js/modules/es6.regexp.split","core-js/modules/es6.array.index-of","core-js/modules/es6.regexp.to-string","core-js/modules/es6.date.to-string","core-js/modules/es6.object.create","core-js/modules/es6.object.assign","core-js/modules/es6.function.name","core-js/modules/es6.regexp.match","core-js/modules/es6.regexp.replace","core-js/modules/es6.set","core-js/modules/es6.array.for-each","core-js/modules/web.dom.iterable","core-js/modules/es6.array.iterator","core-js/modules/es6.string.iterator","core-js/modules/es6.map","core-js/modules/es6.regexp.search","core-js/modules/es6.string.starts-with","core-js/modules/es7.symbol.async-iterator","core-js/modules/es6.symbol","core-js/modules/es6.function.bind","core-js/modules/es6.date.now","core-js/modules/es6.promise","axios","https"],e):e(t.livingsdk={},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,t.axios,t.https)}(this,function(t,e,r,n,o,i,a,u,s,l,c,h,p,_,f,d,v,m,y,g,b,k,S,w,A,x,T,j,C){"use strict";function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function P(t,e,r){return e&&D(t.prototype,e),r&&D(t,r),t}function L(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e){return(B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function q(t,e,r){return(q=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&B(o,r.prototype),o}).apply(null,arguments)}function V(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t,e,r){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function N(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}j=j&&j.hasOwnProperty("default")?j.default:j;var R={},Y="object"===("undefined"==typeof module?"undefined":M(module))&&module.exports;R.version="46",R._registry={},R._havemap="function"==typeof Map&&"function"==typeof Map.prototype.forEach,R._havemapconstructor=function(){if(R._havemap)try{if(1==new Map([[1,2]]).size)return!0}catch(t){}return!1}(),R._haveset="function"==typeof Set&&"function"==typeof Set.prototype.forEach,R._havesetconstructor=function(){if(R._haveset){try{if(2==new Set([1,2]).size)return!0}catch(t){}return!1}return!1}(),R._havemap?(R._makemap=function(){for(var t=new Map,e=0;e<arguments.length;++e){var r=F(e<0||arguments.length<=e?void 0:arguments[e],2),n=r[0],o=r[1];t.set(n,o)}return t},R._setmap=function(t,e,r){t.__proto__===Map.prototype?t.set(e,r):t[e]=r},R._emptymap=function(){return new Map},R._getmap=function(t,e,r){return t.__proto__===Map.prototype?t.get(e):t[e]}):(R._makemap=function(){for(var t={},e=0;e<arguments.length;++e){var r=F(e<0||arguments.length<=e?void 0:arguments[e],2),n=r[0],o=r[1];t[n]=o}return t},R._setmap=function(t,e,r){t[e]=r},R._emptymap=function(){return{}},R._getmap=function(t,e,r){return t[e]}),R._haveset?R._emptyset=function(){return new Set}:R._emptyset=function(){return new R._Set},R._makeset=function(){for(var t=R._emptyset(),e=0;e<arguments.length;++e)t.add(e<0||arguments.length<=e?void 0:arguments[e]);return t},R.register=function(t,e){e.prototype.ul4onname=t,R._registry[t]=e},R.dumps=function(t,e){var r=new R.Encoder(e);return r.dump(t),r.finish()},R.loads=function(t,e){return new R.Decoder(t,e).load()},R.Encoder=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;E(this,e),this.indent=t,this.data=[],this._level=0,this._strings2index={},this._ids2index={},this._backrefs=0}return P(e,[{key:"_line",value:function(t){if(null!==this.indent)for(var e=0;e<this._level;++e)this.data.push(this.indent);else this.data.length&&this.data.push(" ");if(this.data.push(t),!(arguments.length<=1)&&arguments.length-1){var r=this.indent;this.indent=null;for(var n=0;n<(arguments.length<=1?0:arguments.length-1);++n)this.dump(n+1<1||arguments.length<=n+1?void 0:arguments[n+1]);this.indent=r}null!==this.indent&&this.data.push("\n")}},{key:"finish",value:function(){return this.data.join("")}},{key:"dump",value:function(t){if(null===t)this._line("n");else if("boolean"==typeof t)this._line(t?"bT":"bF");else if("number"==typeof t){var e=Math.round(t)==t?"i":"f";this._line(e+t)}else if("string"==typeof t){var r=this._strings2index[t];if(void 0!==r)this._line("^"+r);else{this._strings2index[t]=this._backrefs++;var n=R._str_repr(t).replace("<","\\x3c");this._line("S"+n)}}else if(R._iscolor(t))this._line("c",t.r(),t.g(),t.b(),t.a());else if(R._isdate(t))this._line("x",t.year(),t.month(),t.day());else if(R._isdatetime(t))this._line("z",t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),1e3*t.getMilliseconds());else if(R._istimedelta(t))this._line("t",t.days(),t.seconds(),t.microseconds());else if(R._ismonthdelta(t))this._line("m",t.months());else if(t instanceof R.slice)this._line("r",t.start,t.stop);else if(t.ul4onname&&t.ul4ondump){if(t.__id__){var o=this._ids2index[t.__id__];if(void 0!==o)return void this._line("^"+o);this._ids2index[t.__id__]=this._backrefs++}this._line("O",t.ul4onname),++this._level,t.ul4ondump(this),--this._level,this._line(")")}else if(R._islist(t)){this._line("l"),++this._level;for(var i=0;i<t.length;++i)this.dump(t[i]);--this._level,this._line("]")}else if(R._ismap(t))this._line("e"),++this._level,t.forEach(function(t,e){this.dump(e),this.dump(t)},this),--this._level,this._line("}");else if(R._isdict(t)){for(var a in this._line("d"),++this._level,t)this.dump(a),this.dump(t[a]);--this._level,this._line("}")}else{if(!R._isset(t))throw new R.ValueError("can't create UL4ON dump of object "+R._repr(t));this._line("y"),++this._level,t.forEach(function(t){this.dump(t)},this),--this._level,this._line("}")}}}]),e}(),R.Decoder=function(){function r(t,e){E(this,r),this.data=t,this.pos=0,this.backrefs=[],this.registry=void 0===e?null:e,this.stack=[]}return P(r,[{key:"readchar",value:function(){if(this.pos>=this.data.length)throw new R.ValueError("UL4 decoder at EOF");return this.data.charAt(this.pos++)}},{key:"readcharoreof",value:function(){return this.pos>=this.data.length?null:this.data.charAt(this.pos++)}},{key:"readblackchar",value:function(){for(var t=/\s/;;){if(this.pos>=this.data.length)throw new R.ValueError("UL4 decoder at EOF at position "+this.pos+" with path "+this.stack.join("/"));var e=this.data.charAt(this.pos++);if(!e.match(t))return e}}},{key:"read",value:function(t){this.pos+t>this.length&&(t=this.length-this.pos);var e=this.data.substring(this.pos,this.pos+t);return this.pos+=t,e}},{key:"backup",value:function(){--this.pos}},{key:"readnumber",value:function(){for(var t=/[-+0123456789.eE]/,e="";;){var r=this.readcharoreof();if(null===r||!r.match(t)){var n=parseFloat(e);if(isNaN(n))throw new R.ValueError("invalid number, got "+R._repr("value")+" at position "+this.pos+" with path "+this.stack.join("/"));return n}e+=r}}},{key:"_beginfakeloading",value:function(){var t=this.backrefs.length;return this.backrefs.push(null),t}},{key:"_endfakeloading",value:function(t,e){this.backrefs[t]=e}},{key:"_readescape",value:function(t,e){var r=this.read(e);if(r.length!=e)throw new R.ValueError("broken escape "+R._repr("\\"+t+r)+" at position "+this.pos+" with path "+this.stack.join("/"));var n=parseInt(r,16);if(isNaN(n))throw new R.ValueError("broken escape "+R._repr("\\"+t+r)+" at position "+this.pos+" with path "+this.stack.join("/"));return String.fromCharCode(n)}},{key:"load",value:function(){var t,e=this.readblackchar();switch(e){case"^":return this.backrefs[this.readnumber()];case"n":case"N":return"N"===e&&this.backrefs.push(null),null;case"b":case"B":if("T"===(t=this.readchar()))t=!0;else{if("F"!==t)throw new R.ValueError("wrong value for boolean, expected 'T' or 'F', got "+R._repr(t)+" at position "+this.pos+" with path "+this.stack.join("/"));t=!1}return"B"===e&&this.backrefs.push(t),t;case"i":case"I":case"f":case"F":return t=this.readnumber(),"I"!==e&&"F"!==e||this.backrefs.push(t),t;case"s":case"S":t=[];for(var r=this.readblackchar();;){var n=this.readchar();if(n==r)break;if("\\"==n){var o=this.readchar();"\\"==o?t.push("\\"):"n"==o?t.push("\n"):"r"==o?t.push("\r"):"t"==o?t.push("\t"):"f"==o?t.push("\f"):"b"==o?t.push("\b"):"a"==o?t.push(""):"'"==o?t.push("'"):'"'==o?t.push('"'):"x"==o?t.push(this._readescape("x",2)):"u"==o?t.push(this._readescape("u",4)):"U"==o?t.push(this._readescape("U",8)):t.push("\\"+o)}else t.push(n)}return t=t.join(""),"S"===e&&this.backrefs.push(t),t;case"c":case"C":return t=new R.Color,"C"===e&&this.backrefs.push(t),t._r=this.load(),t._g=this.load(),t._b=this.load(),t._a=this.load(),t;case"x":case"X":var i=this.load(),a=this.load(),u=this.load();return t=new R.Date(i,a,u),"X"===e&&this.backrefs.push(t),t;case"z":case"Z":return(t=new Date).setFullYear(this.load()),t.setDate(1),t.setMonth(this.load()-1),t.setDate(this.load()),t.setHours(this.load()),t.setMinutes(this.load()),t.setSeconds(this.load()),t.setMilliseconds(this.load()/1e3),"Z"===e&&this.backrefs.push(t),t;case"t":case"T":return(t=new R.TimeDelta)._days=this.load(),t._seconds=this.load(),t._microseconds=this.load(),"T"===e&&this.backrefs.push(t),t;case"r":case"R":return t=new R.slice,"R"===e&&this.backrefs.push(t),t.start=this.load(),t.stop=this.load(),t;case"m":case"M":return t=new R.MonthDelta,"M"===e&&this.backrefs.push(t),t._months=this.load(),t;case"l":case"L":for(this.stack.push("list"),t=[],"L"===e&&this.backrefs.push(t);"]"!==(e=this.readblackchar());)this.backup(),t.push(this.load());return this.stack.pop(),t;case"d":case"D":case"e":case"E":if(!R._havemap&&("e"==e||"E"==e))throw new R.ValueError("ordered dictionaries are not supported at position "+this.pos+" with path "+this.stack.join("/"));for(t=R._emptymap(),this.stack.push("d"===e||"D"===e?"dict":"odict"),"D"!==e&&"E"!==e||this.backrefs.push(t);"}"!==(e=this.readblackchar());){this.backup();var s=this.load(),l=this.load();R._setmap(t,s,l)}return this.stack.pop(),t;case"y":case"Y":for(this.stack.push("set"),t=R._makeset(),"Y"===e&&this.backrefs.push(t);"}"!==(e=this.readblackchar());)this.backup(),t.add(this.load());return this.stack.pop(),t;case"o":case"O":var c;"O"===e&&(c=this._beginfakeloading());var h,p=this.load();if(this.stack.push(p),null!==this.registry?void 0===(h=this.registry[p])&&(h=R._registry[p]):h=R._registry[p],void 0===h)throw new R.ValueError("can't load object of type "+R._repr(p)+" at position "+this.pos+" with path "+this.stack.join("/"));if(t=new h,"O"===e&&this._endfakeloading(c,t),t.ul4onload(this),")"!==(e=this.readblackchar()))throw new R.ValueError("object terminator ')' for object of type '"+p+"' expected, got "+R._repr(e)+" at position "+this.pos+" with path "+this.stack.join("/"));return this.stack.pop(),t;default:throw new R.ValueError("unknown typecode "+R._repr(e)+" at position "+this.pos+" with path "+this.stack.join("/"))}}},{key:"loadcontent",value:function(){var e=this;return{next:function(){var t=e.readblackchar();return e.backup(),")"==t?{done:!0}:{done:!1,value:e.load()}}}}}]),r}(),R._rvalidchars=/^[\],:{}\s]*$/,R._rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,R._rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,R._rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,R._inherit=function(t,e){return Object.assign(Object.create(t),e)},R._map2object=function(t){if(R._ismap(t)){var r={};return t.forEach(function(t,e){if("string"!=typeof e)throw new R.TypeError("keys must be strings");r[e]=t}),r}return t},R._bound=function(t,e){return t<0?0:e<t?e:t},R._stacktrace=function(t){var e=(t instanceof R.Exception?t.constructor.name+": ":"")+t.toString();return t.context&&(e=R._stacktrace(t.context)+"\n\n"+e),e},R._internal_call=function(t,e,r,n,o,i,a,u,s){var l;if(a)if(null===o){if(u.length)throw new R.ArgumentError(R._repr(e)+" doesn't support positional arguments!");l=[s]}else l=[o.bindObject(r,u,s)];else{if(null===o)throw new R.ArgumentError(R._repr(e)+" doesn't support positional arguments!");l=o.bindArray(r,u,s)}return i&&l.unshift(t),e.apply(n,l)},R._callfunction=function(t,e,r,n){var o=e._ul4_name||e.name;if(void 0===e._ul4_signature||void 0===e._ul4_needsobject||void 0===e._ul4_needscontext)throw new R.TypeError(R._repr(e)+" is not callable by UL4");return R._internal_call(t,e,o,R,e._ul4_signature,e._ul4_needscontext,e._ul4_needsobject,r,n)},R._callobject=function(t,e,r,n){if(void 0===e._ul4_callsignature||void 0===e._ul4_callneedsobject||void 0===e._ul4_callneedscontext)throw new R.TypeError(R._repr(e)+" is not callable by UL4");return R._internal_call(t,e.__call__,e.name,e,e._ul4_callsignature,e._ul4_callneedscontext,e._ul4_callneedsobject,r,n)},R._callrender=function(t,e,r,n){if(void 0===e._ul4_rendersignature||void 0===e._ul4_renderneedsobject||void 0===e._ul4_renderneedscontext)throw new R.TypeError(R._repr(e)+" is not renderable by UL4");return R._internal_call(t,e.__render__,e.name,e,e._ul4_rendersignature,e._ul4_renderneedscontext,e._ul4_renderneedsobject,r,n)},R._call=function(t,e,r,n){if("function"==typeof e)return R._callfunction(t,e,r,n);if(e&&"function"==typeof e.__call__)return R._callobject(t,e,r,n);throw new R.TypeError(R._type(e)+" is not callable")},R._unpackvar=function(t,e){if(R._islist(t)){for(var r=[],n=R._iter(e),o=0;;++o){var i=n.next();if(i.done){if(o===t.length)break;throw new R.ValueError("need "+t.length+" value"+(1===t.length?"":"s")+" to unpack, got "+o)}if(!(o<t.length))throw new R.ValueError("too many values to unpack (expected "+t.length+")");r=r.concat(R._unpackvar(t[o],i.value))}return r}return[[t,e]]},R._formatsource=function(t){for(var e=[],r=0,n=!1,o=0;o<t.length;++o){var i=t[o];if("number"==typeof i)r+=i,n=!0;else{if(n){e.push("\n");for(var a=0;a<r;++a)e.push("\t");n=!1}e.push(i)}}return n&&e.push("\n"),e.join("")},R._eq=function(r,n){var t=["boolean","number"];if(r&&"function"==typeof r.__eq__)return r.__eq__(n);if(n&&"function"==typeof n.__eq__)return n.__eq__(r);if(null===r)return null===n;if(-1!=t.indexOf(M(r)))return-1!=t.indexOf(M(n))&&r==n;if("string"==typeof r)return"string"==typeof n&&r==n;if(R._isdatetime(r))return!!R._isdatetime(n)&&r.getTime()==n.getTime();if(R._islist(r)){if(R._islist(n)){if(r===n)return!0;if(r.length!=n.length)return!1;for(var e=0;e<r.length;++e)if(!R._eq(r[e],n[e]))return!1;return!0}return!1}if(R._isobject(r)){if(R._isobject(n)){if(r===n)return!0;for(var o in r){if(!n.hasOwnProperty(o))return!1;if(!R._eq(r[o],n[o]))return!1}for(var i in n)if(!r.hasOwnProperty(i))return!1;return!0}if(R._ismap(n)){for(var a in r){if(!n.has(a))return!1;if(!R._eq(r[a],n.get(a)))return!1}var u=!0;return n.forEach(function(t,e){r.hasOwnProperty(e)||(u=!1)},this),u}return!1}if(R._ismap(r)){if(R._isobject(n)){for(var s in r.forEach(function(t,e){return!!n.hasOwnProperty(e)&&(!!R._eq(r.get(e),n[e])&&void 0)},this),n)if(!r.has(s))return!1;return!0}if(R._ismap(n)){if(r===n)return!0;if(r.size!=n.size)return!1;var l=!0;return r.forEach(function(t,e){n.has(e)&&R._eq(r.get(e),n.get(e))||(l=!1)}),l}return!1}if(R._isset(r)){if(R._isset(n)){if(r===n)return!0;if(r.size!=n.size)return!1;var c=!0;return r.forEach(function(t){n.has(t)||(c=!1)}),c}return!1}return r===n},R._ne=function(t,e){return t&&"function"==typeof t.__ne__?t.__ne__(e):e&&"function"==typeof e.__ne__?e.__ne__(t):!R._eq(t,e)},R._unorderable=function(t,e,r){throw new R.TypeError("unorderable types: "+R._type(e)+" "+t+" "+R._type(r))},R._cmp=function(t,e,r){var n=["boolean","number"];if(-1!=n.indexOf(M(e))){if(-1!=n.indexOf(M(r)))return(r<e)-(e<r)}else if("string"==typeof e){if("string"==typeof r)return(r<e)-(e<r)}else if(R._isdatetime(e)){if(R._isdatetime(r)){var o=e.getTime(),i=r.getTime();return(i<o)-(o<i)}}else if(R._islist(e)){if(R._islist(r)){if(e===r)return 0;for(var a=0;a<e.length;++a){if(a>=r.length)return 1;var u=R._cmp(t,e[a],r[a]);if(u)return u}return r.length>e.length?-1:0}}else if((R._isset(e)||R._isul4set(e))&&(R._isset(r)||R._isul4set(r))){for(var s=!1,l=!1,c=_iter(e);;){var h=c.next();if(h.done)break;if(!r.has(h.value)){s=!0;break}}for(var p=_iter(r);;){var _=p.next();if(_.done)break;if(!e.has(_.value)){l=!0;break}}return s?l?null:1:l?-1:0}return R._unorderable(t,e,r)},R._lt=function(t,e){var r=["boolean","number"];if(t&&"function"==typeof t.__lt__)return t.__lt__(e);if(-1!=r.indexOf(M(t))){if(-1!=r.indexOf(M(e)))return t<e}else if("string"==typeof t){if("string"==typeof e)return t<e}else if(R._isdatetime(t)){if(R._isdatetime(e))return t.getTime()<e.getTime()}else if(R._islist(t)){if(R._islist(e)){if(t===e)return!1;for(var n=0;n<t.length;++n){if(n>=e.length)return!1;if(!R._eq(t[n],e[n]))return R._lt(t[n],e[n])}return t.length<e.length}}else if(R._isset(t)){if(R._isset(e)){if(R._isset(e)){for(var o in t)e.has(t[o])||(in1only=!0);for(var i in e)t.has(e[i])||(in2only=!0)}else if(R._isul4set(e)){for(var a in t)e.items[t[a]]||(in1only=!0);for(var u in e.items)if(!t.has(u)){in2only=!0;break}}}else if(R._isul4set(e)){if(R._isset(e)){for(var s in t.items)if(!e.has(s)){in1only=!0;break}for(var l in e)t.items[e[l]]||(in2only=!0)}else if(R._isul4set(e)){for(var c in t.items)if(!e.items[c]){in1only=!0;break}for(var h in e.items)if(!t.items[h]){in2only=!0;break}}}else R._unorderable(operator,t,e);return in1only?in2only?null:1:in2only?-1:0}R._unorderable("<",t,e)},R._le=function(e,r){var t=["boolean","number"];if(e&&"function"==typeof e.__le__)return e.__le__(r);if(-1!=t.indexOf(M(e))){if(-1!=t.indexOf(M(r)))return e<=r}else if("string"==typeof e){if("string"==typeof r)return e<=r}else if(R._isdatetime(e)){if(R._isdatetime(r))return e.getTime()<=r.getTime()}else if(R._islist(e)){if(R._islist(r)){if(e===r)return!0;for(var n=0;n<e.length;++n){if(n>=r.length)return!1;if(!R._eq(e[n],r[n]))return R._lt(e[n],r[n])}return e.length<=r.length}}else if(R._isset(e)||R._isul4set(e)){var o=!1,i=!1;if(R._isset(r)){if(R._isset(r))e.forEach(function(t){r.has(t)||(o=!0)}),r.forEach(function(t){e.has(t)||(i=!0)});else if(R._isul4set(r))for(var a in e.forEach(function(t){r.items[t]||(o=!0)}),r.items)if(!e.has(a)){i=!0;break}}else if(R._isul4set(r)){if(R._isset(r)){for(var u in e.items)if(!r.has(u)){o=!0;break}r.forEach(function(t){e.items[t]||(i=!0)})}else if(R._isul4set(r)){for(var s in e.items)if(!r.items[s]){o=!0;break}for(var l in r.items)if(!e.items[l]){i=!0;break}}}else R._unorderable(operator,e,r);return o?i?null:1:i?-1:0}R._unorderable("<=",e,r)},R._gt=function(e,r){var t=["boolean","number"];if(e&&"function"==typeof e.__gt__)return e.__gt__(r);if(-1!=t.indexOf(M(e))){if(-1!=t.indexOf(M(r)))return r<e}else if("string"==typeof e){if("string"==typeof r)return r<e}else if(R._isdatetime(e)){if(R._isdatetime(r))return e.getTime()>r.getTime()}else if(R._islist(e)){if(R._islist(r)){if(e===r)return!1;for(var n=0;n<e.length;++n){if(n>=r.length)return!0;if(!R._eq(e[n],r[n]))return R._gt(e[n],r[n])}return e.length>r.length}}else if(R._isset(e)||R._isul4set(e)){var o=!1,i=!1;if(R._isset(r))R._isset(r)?(e.forEach(function(t){r.has(t)||(o=!0)}),r.forEach(function(t){e.has(t)||(i=!0)})):R._isul4set(r)&&(e.forEach(function(t){r.items[t]||(o=!0)}),r.forEach(function(t){e.has(t)||(i=!0)}));else if(R._isul4set(r)){if(R._isset(r)){for(var a in e.items)if(!r.has(a)){o=!0;break}r.forEach(function(t){e.items[t]||(i=!0)})}else if(R._isul4set(r)){for(var u in e.items)if(!r.items[u]){o=!0;break}for(var s in r.items)if(!e.items[s]){i=!0;break}}}else R._unorderable(operator,e,r);return o?i?null:1:i?-1:0}R._unorderable(">",e,r)},R._ge=function(r,e){var t=["boolean","number"];if(r&&"function"==typeof r.__ge__)return r.__ge__(e);if(-1!=t.indexOf(M(r))){if(-1!=t.indexOf(M(e)))return e<=r}else if("string"==typeof r){if("string"==typeof e)return e<=r}else if(R._isdatetime(r)){if(R._isdatetime(e))return r.getTime()>=e.getTime()}else if(R._islist(r)){if(R._islist(e)){if(r===e)return!0;for(var n=0;n<r.length;++n){if(n>=e.length)return!0;if(!R._eq(r[n],e[n]))return R._gt(r[n],e[n])}return r.length>=e.length}}else if(R._isset(r)||R._isul4set(r)){var o=!1,i=!1;if(R._isset(e)){if(R._isset(e))r.forEach(function(t){e.has(t)||(o=!0)}),e.forEach(function(t){r.has(t)||(i=!0)});else if(R._isul4set(e))for(var a in r.forEach(function(t){e.items[t]||(o=!0)}),e.items)if(!r.has(a)){i=!0;break}}else if(R._isul4set(e)){if(R._isset(e)){for(var u in r.items)if(!e.has(u)){o=!0;break}e.forEach(function(t,e){r.items[t]||(i=!0)})}else if(R._isul4set(e)){for(var s in r.items)if(!e.items[s]){o=!0;break}for(var l in e.items)if(!r.items[l]){i=!0;break}}}else R._unorderable(operator,r,e);return o?i?null:1:i?-1:0}R._unorderable(">=",r,e)},R._iter=function(t){if("string"==typeof t||R._islist(t))return{index:0,next:function(){return this.index<t.length?{value:t[this.index++],done:!1}:{done:!0}}};if(R._isiter(t))return t;if(null!==t&&"function"==typeof t.__iter__)return t.__iter__();if(R._ismap(t)){var r=[];return t.forEach(function(t,e){r.push(e)}),{index:0,next:function(){return this.index>=r.length?{done:!0}:{value:r[this.index++],done:!1}}}}if(R._isset(t)){var e=[];return t.forEach(function(t){e.push(t)}),{index:0,next:function(){return this.index>=e.length?{done:!0}:{value:e[this.index++],done:!1}}}}if(R._isul4set(t))return R._iter(t.items);if(R._isobject(t)){var n=[];for(var o in t)n.push(o);return{index:0,next:function(){return this.index>=n.length?{done:!0}:{value:n[this.index++],done:!1}}}}throw new R.TypeError(R._type(t)+" object is not iterable")},R._str_repr=function(t,e){for(var r="",n=!1,o=!1,i=0;i<t.length;++i){var a=t[i];if('"'==a){if(o=!0,n)break}else if("'"==a&&(n=!0,o))break}for(var u=n&&!o?'"':"'",s=0;s<t.length;++s){var l=t[s];switch(l){case'"':r+=u==l?'\\"':l;break;case"'":r+=u==l?"\\'":l;break;case"\\":r+="\\\\";break;case"\t":r+="\\t";break;case"\n":r+="\\n";break;case"\r":r+="\\r";break;default:var c=l.charCodeAt(0),h=void 0;r+=0===(h=c<32?2:c<127?0:e||/[\u007f-\u00a0\u00ad\u0378-\u0379\u0380-\u0383\u038b\u038d\u03a2\u0530\u0557-\u0558\u0560\u0588\u058b-\u058c\u0590\u05c8-\u05cf\u05eb-\u05ef\u05f5-\u0605\u061c-\u061d\u06dd\u070e-\u070f\u074b-\u074c\u07b2-\u07bf\u07fb-\u07ff\u082e-\u082f\u083f\u085c-\u085d\u085f-\u089f\u08b5-\u08e2\u0984\u098d-\u098e\u0991-\u0992\u09a9\u09b1\u09b3-\u09b5\u09ba-\u09bb\u09c5-\u09c6\u09c9-\u09ca\u09cf-\u09d6\u09d8-\u09db\u09de\u09e4-\u09e5\u09fc-\u0a00\u0a04\u0a0b-\u0a0e\u0a11-\u0a12\u0a29\u0a31\u0a34\u0a37\u0a3a-\u0a3b\u0a3d\u0a43-\u0a46\u0a49-\u0a4a\u0a4e-\u0a50\u0a52-\u0a58\u0a5d\u0a5f-\u0a65\u0a76-\u0a80\u0a84\u0a8e\u0a92\u0aa9\u0ab1\u0ab4\u0aba-\u0abb\u0ac6\u0aca\u0ace-\u0acf\u0ad1-\u0adf\u0ae4-\u0ae5\u0af2-\u0af8\u0afa-\u0b00\u0b04\u0b0d-\u0b0e\u0b11-\u0b12\u0b29\u0b31\u0b34\u0b3a-\u0b3b\u0b45-\u0b46\u0b49-\u0b4a\u0b4e-\u0b55\u0b58-\u0b5b\u0b5e\u0b64-\u0b65\u0b78-\u0b81\u0b84\u0b8b-\u0b8d\u0b91\u0b96-\u0b98\u0b9b\u0b9d\u0ba0-\u0ba2\u0ba5-\u0ba7\u0bab-\u0bad\u0bba-\u0bbd\u0bc3-\u0bc5\u0bc9\u0bce-\u0bcf\u0bd1-\u0bd6\u0bd8-\u0be5\u0bfb-\u0bff\u0c04\u0c0d\u0c11\u0c29\u0c3a-\u0c3c\u0c45\u0c49\u0c4e-\u0c54\u0c57\u0c5b-\u0c5f\u0c64-\u0c65\u0c70-\u0c77\u0c80\u0c84\u0c8d\u0c91\u0ca9\u0cb4\u0cba-\u0cbb\u0cc5\u0cc9\u0cce-\u0cd4\u0cd7-\u0cdd\u0cdf\u0ce4-\u0ce5\u0cf0\u0cf3-\u0d00\u0d04\u0d0d\u0d11\u0d3b-\u0d3c\u0d45\u0d49\u0d4f-\u0d56\u0d58-\u0d5e\u0d64-\u0d65\u0d76-\u0d78\u0d80-\u0d81\u0d84\u0d97-\u0d99\u0db2\u0dbc\u0dbe-\u0dbf\u0dc7-\u0dc9\u0dcb-\u0dce\u0dd5\u0dd7\u0de0-\u0de5\u0df0-\u0df1\u0df5-\u0e00\u0e3b-\u0e3e\u0e5c-\u0e80\u0e83\u0e85-\u0e86\u0e89\u0e8b-\u0e8c\u0e8e-\u0e93\u0e98\u0ea0\u0ea4\u0ea6\u0ea8-\u0ea9\u0eac\u0eba\u0ebe-\u0ebf\u0ec5\u0ec7\u0ece-\u0ecf\u0eda-\u0edb\u0ee0-\u0eff\u0f48\u0f6d-\u0f70\u0f98\u0fbd\u0fcd\u0fdb-\u0fff\u10c6\u10c8-\u10cc\u10ce-\u10cf\u1249\u124e-\u124f\u1257\u1259\u125e-\u125f\u1289\u128e-\u128f\u12b1\u12b6-\u12b7\u12bf\u12c1\u12c6-\u12c7\u12d7\u1311\u1316-\u1317\u135b-\u135c\u137d-\u137f\u139a-\u139f\u13f6-\u13f7\u13fe-\u13ff\u1680\u169d-\u169f\u16f9-\u16ff\u170d\u1715-\u171f\u1737-\u173f\u1754-\u175f\u176d\u1771\u1774-\u177f\u17de-\u17df\u17ea-\u17ef\u17fa-\u17ff\u180e-\u180f\u181a-\u181f\u1878-\u187f\u18ab-\u18af\u18f6-\u18ff\u191f\u192c-\u192f\u193c-\u193f\u1941-\u1943\u196e-\u196f\u1975-\u197f\u19ac-\u19af\u19ca-\u19cf\u19db-\u19dd\u1a1c-\u1a1d\u1a5f\u1a7d-\u1a7e\u1a8a-\u1a8f\u1a9a-\u1a9f\u1aae-\u1aaf\u1abf-\u1aff\u1b4c-\u1b4f\u1b7d-\u1b7f\u1bf4-\u1bfb\u1c38-\u1c3a\u1c4a-\u1c4c\u1c80-\u1cbf\u1cc8-\u1ccf\u1cf7\u1cfa-\u1cff\u1df6-\u1dfb\u1f16-\u1f17\u1f1e-\u1f1f\u1f46-\u1f47\u1f4e-\u1f4f\u1f58\u1f5a\u1f5c\u1f5e\u1f7e-\u1f7f\u1fb5\u1fc5\u1fd4-\u1fd5\u1fdc\u1ff0-\u1ff1\u1ff5\u1fff-\u200f\u2028-\u202f\u205f-\u206f\u2072-\u2073\u208f\u209d-\u209f\u20bf-\u20cf\u20f1-\u20ff\u218c-\u218f\u23fb-\u23ff\u2427-\u243f\u244b-\u245f\u2b74-\u2b75\u2b96-\u2b97\u2bba-\u2bbc\u2bc9\u2bd2-\u2beb\u2bf0-\u2bff\u2c2f\u2c5f\u2cf4-\u2cf8\u2d26\u2d28-\u2d2c\u2d2e-\u2d2f\u2d68-\u2d6e\u2d71-\u2d7e\u2d97-\u2d9f\u2da7\u2daf\u2db7\u2dbf\u2dc7\u2dcf\u2dd7\u2ddf\u2e43-\u2e7f\u2e9a\u2ef4-\u2eff\u2fd6-\u2fef\u2ffc-\u3000\u3040\u3097-\u3098\u3100-\u3104\u312e-\u3130\u318f\u31bb-\u31bf\u31e4-\u31ef\u321f\u32ff\u4db6-\u4dbf\u9fd6-\u9fff\ua48d-\ua48f\ua4c7-\ua4cf\ua62c-\ua63f\ua6f8-\ua6ff\ua7ae-\ua7af\ua7b8-\ua7f6\ua82c-\ua82f\ua83a-\ua83f\ua878-\ua87f\ua8c5-\ua8cd\ua8da-\ua8df\ua8fe-\ua8ff\ua954-\ua95e\ua97d-\ua97f\ua9ce\ua9da-\ua9dd\ua9ff\uaa37-\uaa3f\uaa4e-\uaa4f\uaa5a-\uaa5b\uaac3-\uaada\uaaf7-\uab00\uab07-\uab08\uab0f-\uab10\uab17-\uab1f\uab27\uab2f\uab66-\uab6f\uabee-\uabef\uabfa-\uabff\ud7a4-\ud7af\ud7c7-\ud7ca\ud7fc-\uf8ff\ufa6e-\ufa6f\ufada-\ufaff\ufb07-\ufb12\ufb18-\ufb1c\ufb37\ufb3d\ufb3f\ufb42\ufb45\ufbc2-\ufbd2\ufd40-\ufd4f\ufd90-\ufd91\ufdc8-\ufdef\ufdfe-\ufdff\ufe1a-\ufe1f\ufe53\ufe67\ufe6c-\ufe6f\ufe75\ufefd-\uff00\uffbf-\uffc1\uffc8-\uffc9\uffd0-\uffd1\uffd8-\uffd9\uffdd-\uffdf\uffe7\uffef-\ufffb\ufffe-\uffff]/.test(l)?c<=255?2:c<=65535?4:8:0)?l:2===h?"\\x"+R._lpad(c.toString(16),"0",2):4===h?"\\u"+R._lpad(c.toString(16),"0",4):"\\U"+R._lpad(c.toString(16),"0",8)}}return u+r+u},R._date_repr=function(t,e){var r=t._date.getFullYear(),n=t._date.getMonth()+1,o=t._date.getDate();return"@("+r+"-"+R._lpad(n.toString(),"0",2)+"-"+R._lpad(o.toString(),"0",2)+")"},R._datetime_repr=function(t,e){var r=t.getFullYear(),n=t.getMonth()+1,o=t.getDate(),i=t.getHours(),a=t.getMinutes(),u=t.getSeconds(),s=t.getMilliseconds(),l="@("+r+"-"+R._lpad(n.toString(),"0",2)+"-"+R._lpad(o.toString(),"0",2)+"T";return(i||a||u||s)&&(l+=R._lpad(i.toString(),"0",2)+":"+R._lpad(a.toString(),"0",2),(u||s)&&(l+=":"+R._lpad(u.toString(),"0",2),s&&(l+="."+R._lpad(s.toString(),"0",3)+"000"))),l+=")"},R._map_repr=function(t,r){var n=[];n.push("{");var o=0;return t.forEach(function(t,e){o++&&n.push(", "),n.push(R._repr_internal(e,r)),n.push(": "),n.push(R._repr_internal(t,r))}),n.push("}"),n.join("")},R._list_repr=function(t,e){var r=[];r.push("[");for(var n=0;n<t.length;++n){var o=t[n];n&&r.push(", "),r.push(R._repr_internal(o,e))}return r.push("]"),r.join("")},R._set_repr=function(t,e){var r=[];if(r.push("{"),t.size){var n=0;t.forEach(function(t){n++&&r.push(", "),r.push(R._repr_internal(t,e))})}else r.push("/");return r.push("}"),r.join("")},R._object_repr=function(t,e){var r=[];r.push("{");var n=0;for(var o in t)t.hasOwnProperty(o)&&(n++&&r.push(", "),r.push(R._repr_internal(o,e)),r.push(": "),r.push(R._repr_internal(t[o],e)));return r.push("}"),r.join("")},R._repr_internal=function(t,e){return null===t?"None":!1===t?"False":!0===t?"True":"string"==typeof t?R._str_repr(t,e):"number"==typeof t?""+t:"function"==typeof t?t._ul4_name||t.name?"<function "+(t._ul4_name||t.name)+">":"<anonymous function>":R._isdate(t)?R._date_repr(t,e):R._isdatetime(t)?R._datetime_repr(t,e):void 0===t?"<undefined>":"object"===M(t)&&"function"==typeof t.__repr__?t.__repr__():R._islist(t)?R._list_repr(t,e):R._ismap(t)?R._map_repr(t,e):R._isset(t)?R._set_repr(t,e):R._isobject(t)?R._object_repr(t,e):"?"},R._repr=function(t){return R._repr_internal(t,!1)},R._ascii=function(t){return R._repr_internal(t,!0)},R._date_str=function(t){var e=t._date.getFullYear(),r=t._date.getMonth()+1,n=t._date.getDate();return e+"-"+R._lpad(r.toString(),"0",2)+"-"+R._lpad(n.toString(),"0",2)},R._datetime_str=function(t){var e=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),o=t.getHours(),i=t.getMinutes(),a=t.getSeconds(),u=t.getMilliseconds(),s=e+"-"+R._lpad(r.toString(),"0",2)+"-"+R._lpad(n.toString(),"0",2)+" "+R._lpad(o.toString(),"0",2)+":"+R._lpad(i.toString(),"0",2);return(a||u)&&(s+=":"+R._lpad(a.toString(),"0",2),u&&(s+="."+R._lpad(u.toString(),"0",3)+"000")),s},R._str=function(t){return void 0===t?"":null===t?"":!1===t?"False":!0===t?"True":"string"==typeof t?t:"number"==typeof t?t.toString():R._isdate(t)?R._date_str(t):R._isdatetime(t)?R._datetime_str(t):R._islist(t)?R._list_repr(t):R._isset(t)?R._set_repr(t):R._ismap(t)?R._map_repr(t):"object"===M(t)&&"function"==typeof t.__str__?t.__str__():"object"===M(t)&&"function"==typeof t.__repr__?t.__repr__():R._isobject(t)?R._object_repr(t):"?"},R._bool=function(t){if(null==t||!1===t||0===t||""===t)return!1;if(M(t),"function"==typeof t.__bool__)return t.__bool__();if(R._islist(t))return 0!==t.length;if(R._ismap(t)||R._isset(t))return 0!=t.size;if(R._isobject(t)){for(var e in t)if(t.hasOwnProperty(e))return!0;return!1}return!0},R._int=function(t,e){var r;if(null!==e){if("string"!=typeof t||!R._isint(e))throw new R.TypeError("int() requires a string and an integer");if("NaN"==(r=parseInt(t,e)).toString())throw new R.TypeError("invalid literal for int()");return r}if("string"==typeof t){if("NaN"==(r=parseInt(t)).toString())throw new R.TypeError("invalid literal for int()");return r}if("number"==typeof t)return Math.floor(t);if(!0===t)return 1;if(!1===t)return 0;throw new R.TypeError("int() argument must be a string or a number")},R._float=function(t){if("string"==typeof t)return parseFloat(t);if("number"==typeof t)return t;if(!0===t)return 1;if(!1===t)return 0;throw new R.TypeError("float() argument must be a string or a number")},R._list=function(t){for(var e=R._iter(t),r=[];;){var n=e.next();if(n.done)return r;r.push(n.value)}},R._set=function(t){for(var e=R._iter(t),r=R._emptyset();;){var n=e.next();if(n.done)return r;r.add(n.value)}},R._len=function(t){if("string"==typeof t||R._islist(t))return t.length;if(R._ismap(t)||R._isset(t))return t.size;if(R._isobject(t)){var e=0;for(var r in t)++e;return e}throw new R.TypeError("object of type '"+R._type(t)+"' has no len()")},R._type=function(t){return null===t?"none":!1===t||!0===t?"bool":void 0===t?"undefined":"number"==typeof t?Math.round(t)==t?"int":"float":"function"==typeof t?"function":"function"==typeof t.ul4type?t.ul4type():R.Protocol.get(t).ul4type(t)},R._mod=function(t,e){var r=Math.floor(t/e),n=t-r*e;return 0!==n&&(e<0&&0<n||0<e&&n<0)&&(n+=e,--r),t-r*e},R._getattr=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=R.Protocol.get(e);try{return n.getattr(e,t)}catch(t){if(t instanceof R.AttributeError&&t.obj===e)return r;throw t}},R._hasattr=function(t,e){return R.Protocol.get(t).hasattr(t,e)},R._dir=function(t){return R.Protocol.get(t).dir()},R._any=function(t){if("string"==typeof t){for(var e=0;e<t.length;++e)if("\0"!==t[e])return!0;return!1}for(var r=R._iter(t);;){var n=r.next();if(n.done)return!1;if(R._bool(n.value))return!0}},R._all=function(t){if("string"==typeof t){for(var e=0;e<t.length;++e)if("\0"===t[e])return!1;return!0}for(var r=R._iter(t);;){var n=r.next();if(n.done)return!0;if(!R._bool(n.value))return!1}},R._isundefined=function(t){return void 0===t},R._isdefined=function(t){return void 0!==t},R._isnone=function(t){return null===t},R._isbool=function(t){return"boolean"==typeof t},R._isint=function(t){return"number"==typeof t&&Math.round(t)==t},R._isfloat=function(t){return"number"==typeof t&&Math.round(t)!=t},R._isstr=function(t){return"string"==typeof t},R._isdatetime=function(t){return"[object Date]"==Object.prototype.toString.call(t)},R._isdate=function(t){return t instanceof R.Date},R._iscolor=function(t){return t instanceof R.Color},R._istimedelta=function(t){return t instanceof R.TimeDelta},R._ismonthdelta=function(t){return t instanceof R.MonthDelta},R._istemplate=function(t){return t instanceof R.Template||t instanceof R.TemplateClosure},R._isfunction=function(t){return"function"==typeof t||"[object Object]"==Object.prototype.toString.call(t)&&(t instanceof R.Template||t instanceof R.TemplateClosure)},R._islist=function(t){return"[object Array]"==Object.prototype.toString.call(t)},R._isset=function(t){return"[object Set]"==Object.prototype.toString.call(t)},R._isexception=function(t){return t instanceof R.Exception},R._isul4set=function(t){return t instanceof R._Set},R._isanyset=function(t){return R._isset(t)||R._isul4set(t)},R._isiter=function(t){return null!==t&&"object"===M(t)&&"function"==typeof t.next},R._isobject=function(t){return"[object Object]"==Object.prototype.toString.call(t)&&void 0===t.__type__&&!(t instanceof R.Proto)},R._havemap?(R._ismap=function(t){return null!==t&&"object"===M(t)&&"object"===M(t.__proto__)&&t.__proto__===Map.prototype},R._isdict=function(t){return R._isobject(t)||R._ismap(t)}):(R._ismap=function(t){return!1},R._isdict=function(t){return R._isobject(t)}),R._str_repeat=function(t,e){for(var r="";0<e;--e)r+=t;return r},R._list_repeat=function(t,e){for(var r=[];0<e;--e)for(var n=0;n<t.length;++n)r.push(t[n]);return r},R._str_json=function(t){for(var e="",r=0;r<t.length;++r){var n=t[r];switch(n){case"\r":e+="\\r";break;case"\n":e+="\\n";break;case"\t":e+="\\t";break;case"\\":e+="\\\\";break;case'"':e+='\\"';break;case"<":e+="\\u003c";break;default:var o=n.charCodeAt(0);e+=32<=o&&o<128?n:"\\u"+R._lpad(o.toString(16),"0",4)}}return'"'+e+'"'},R._asjson=function(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!1===t)return"false";if(!0===t)return"true";if("string"==typeof t)return R._str_json(t);if("number"==typeof t)return""+t;if(R._islist(t)){var e=[];e.push("[");for(var r=0;r<t.length;++r)0!=r&&e.push(", "),e.push(R._asjson(t[r]));return e.push("]"),e.join("")}if(R._ismap(t)){var n=[];n.push("{");var o=0;return t.forEach(function(t,e){o++&&n.push(", "),n.push(R._asjson(e)),n.push(": "),n.push(R._asjson(t))}),n.push("}"),n.join("")}if(R._isobject(t)){var i=[];i.push("{");var a=0;for(var u in t)a++&&i.push(", "),i.push(R._asjson(u)),i.push(": "),i.push(R._asjson(t[u]));return i.push("}"),i.join("")}if(R._isdate(t))return"new ul4.Date("+t._date.getFullYear()+", "+(t._date.getMonth()+1)+", "+t._date.getDate()+")";if(R._isdatetime(t))return"new Date("+t.getFullYear()+", "+t.getMonth()+", "+t.getDate()+", "+t.getHours()+", "+t.getMinutes()+", "+t.getSeconds()+", "+t.getMilliseconds()+")";if(R._istimedelta(t))return"new ul4.TimeDelta("+t._days+", "+t._seconds+", "+t._microseconds+")";if(R._ismonthdelta(t))return"new ul4.MonthDelta("+t._months+")";if(R._iscolor(t))return"new ul4.Color("+t._r+", "+t._g+", "+t._b+", "+t._a+")";if(R._istemplate(t))return"ul4.Template.loads("+R._repr(t.dumps())+")";throw new R.TypeError("asjson() requires a serializable object")},R._fromjson=function(t){if(t=R.StrProtocol.strip(t),root.JSON&&root.JSON.parse)return root.JSON.parse(t);if(R._rvalidchars.test(t.replace(R._rvalidescape,"@").replace(R._rvalidtokens,"]").replace(R._rvalidbraces,"")))return new Function("return "+t)();throw new R.TypeError("invalid JSON")},R._asul4on=function(t){return R.dumps(t)},R._fromul4on=function(t){return R.loads(t)},R._format_datetime=function(t,e,r){for(var n={de:{ms:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],ml:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],ws:["So","Mo","Di","Mi","Do","Fr","Sa"],wl:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},en:{ms:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ml:["January","February","March","April","May","June","July","August","September","October","November","December"],ws:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wl:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],xf:"%m/%d/%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %I:%M:%S %p"},fr:{ms:["janv.","févr.","mars","avril","mai","juin","juil.","août","sept.","oct.","nov.","déc."],ml:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],ws:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wl:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],xf:"%d/%m/%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},es:{ms:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],ml:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],ws:["dom","lun","mar","mié","jue","vie","sáb"],wl:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],xf:"%d/%m/%y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},it:{ms:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],ml:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],ws:["dom","lun","mar","mer","gio","ven","sab"],wl:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],xf:"%d/%m/%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},da:{ms:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],ml:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],ws:["søn","man","tir","ons","tor","fre","lør"],wl:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],xf:"%d-%m-%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},sv:{ms:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],ml:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],ws:["sön","mån","tis","ons","tor","fre","lör"],wl:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],xf:"%Y-%m-%d",Xf:"%H.%M.%S",cf:"%a %d %b %Y %H.%M.%S"},nl:{ms:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],ml:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],ws:["zo","ma","di","wo","do","vr","za"],wl:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],xf:"%d-%m-%y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},pt:{ms:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],ml:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],ws:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],wl:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],xf:"%d-%m-%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},cs:{ms:["led","úno","bře","dub","kvě","čen","čec","srp","zář","říj","lis","pro"],ml:["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],ws:["Ne","Po","Út","St","Čt","Pá","So"],wl:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d. %B %Y, %H:%M:%S"},sk:{ms:["jan","feb","mar","apr","máj","jún","júl","aug","sep","okt","nov","dec"],ml:["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],ws:["Ne","Po","Ut","St","Št","Pi","So"],wl:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d. %B %Y, %H:%M:%S"},pl:{ms:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],ml:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],ws:["nie","pon","wto","śro","czw","pią","sob"],wl:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a, %d %b %Y, %H:%M:%S"},hr:{ms:["Sij","Vel","Ožu","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],ml:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],ws:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],wl:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},sr:{ms:["јан","феб","мар","апр","мај","јун","јул","авг","сеп","окт","нов","дец"],ml:["јануар","фебруар","март","април","мај","јун","јул","август","септембар","октобар","новембар","децембар"],ws:["нед","пон","уто","сре","чет","пет","суб"],wl:["недеља","понедељак","уторак","среда","четвртак","петак","субота"],xf:"%d.%m.%Y.",Xf:"%H:%M:%S",cf:"%A, %d. %B %Y. %H:%M:%S"},ro:{ms:["ian","feb","mar","apr","mai","iun","iul","aug","sep","oct","nov","dec"],ml:["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],ws:["Du","Lu","Ma","Mi","Jo","Vi","Sb"],wl:["duminică","luni","marţi","miercuri","joi","vineri","sâmbătă"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},hu:{ms:["jan","febr","márc","ápr","máj","jún","júl","aug","szept","okt","nov","dec"],ml:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],ws:["v","h","k","sze","cs","p","szo"],wl:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],xf:"%Y-%m-%d",Xf:"%H.%M.%S",cf:"%Y. %b. %d., %A, %H.%M.%S"},tr:{ms:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],ml:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],ws:["Paz","Pzt","Sal","Çrş","Prş","Cum","Cts"],wl:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],xf:"%d-%m-%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},ru:{ms:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],ml:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],ws:["Вск","Пнд","Втр","Срд","Чтв","Птн","Сбт"],wl:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],xf:"%d.%m.%Y",Xf:"%H:%M:%S",cf:"%a %d %b %Y %H:%M:%S"},zh:{ms:[" 1月"," 2月"," 3月"," 4月"," 5月"," 6月"," 7月"," 8月"," 9月","10月","11月","12月"],ml:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],ws:["日","一","二","三","四","五","六"],wl:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],xf:"%Y年%b%d日",Xf:"%H时%M分%S秒",cf:"%Y年%b%d日 %A %H时%M分%S秒"},ko:{ms:[" 1월"," 2월"," 3월"," 4월"," 5월"," 6월"," 7월"," 8월"," 9월","10월","11월","12월"],ml:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],ws:["일","월","화","수","목","금","토"],wl:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],xf:"%Y년 %B %d일",Xf:"%H시 %M분 %S초",cf:"%Y년 %B %d일 (%a) %p %I시 %M분 %S초"},ja:{ms:[" 1月"," 2月"," 3月"," 4月"," 5月"," 6月"," 7月"," 8月"," 9月","10月","11月","12月"],ml:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],ws:["日","月","火","水","木","金","土"],wl:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],xf:"%Y年%B%d日",Xf:"%H時%M分%S秒",cf:"%Y年%B%d日 %H時%M分%S秒"}}[r],o=[],i=!1,a=0;a<e.length;++a){var u=e[a];if(i){switch(u){case"a":u=n.ws[t.getDay()];break;case"A":u=n.wl[t.getDay()];break;case"b":u=n.ms[t.getMonth()];break;case"B":u=n.ml[t.getMonth()];break;case"c":u=R._format(t,n.cf,r);break;case"d":u=R._lpad(t.getDate(),"0",2);break;case"f":u=R._lpad(t.getMilliseconds(),"0",3)+"000";break;case"H":u=R._lpad(t.getHours(),"0",2);break;case"I":u=R._lpad((t.getHours()-1)%12+1,"0",2);break;case"j":u=R._lpad(R.DateTimeProtocol.yearday(t),"0",3);break;case"m":u=R._lpad(t.getMonth()+1,"0",2);break;case"M":u=R._lpad(t.getMinutes(),"0",2);break;case"p":u=t.getHours()<12?"AM":"PM";break;case"S":u=R._lpad(t.getSeconds(),"0",2);break;case"U":u=R._lpad(R._week4format(t,6),"0",2);break;case"w":u=t.getDay();break;case"W":u=R._lpad(R._week4format(t,0),"0",2);break;case"x":u=R._format(t,n.xf,r);break;case"X":u=R._format(t,n.Xf,r);break;case"y":u=(t.getFullYear()%100).toString();break;case"Y":u=t.getFullYear().toString();break;case"z":case"Z":u=""}o.push(u),i=!1}else"%"==u?i=!0:o.push(u)}return o.join("")},R._format_int=function(t,e,r){var n=e,o=" ",i=">",a="-",u=!1,s=0,l="d";if(/[bcdoxXn]$/.test(n)&&(l=n.substring(n.length-1),n=n.substring(0,n.length-1)),/\d+$/.test(n)){var c=/\d+$/.exec(n);n=n.replace(/\d+$/,""),/^0/.test(c)&&(i="=",o="0"),s=parseInt(c)}if(/#$/.test(n)&&(u=!0,n=n.substring(0,n.length-1)),/[+ -]$/.test(n)){if("c"==l)throw new R.ValueError("sign not allowed for integer format type 'c'");a=n.substring(n.length-1),n=n.substring(0,n.length-1)}if(3<=n.length)throw new R.ValueError("illegal integer format string "+R._repr(e));if(2==n.length){if(!/[<>=^]$/.test(n))throw new R.ValueError("illegal integer format string "+R._repr(e));i=n[1],o=n[0]}else if(1==n.length){if(!/^[<>=^]$/.test(n))throw new R.ValueError("illegal integer format string "+R._repr(e));i=n}var h,p=t<0;switch(p&&(t=-t),l){case"b":h=t.toString(2);break;case"c":if(p||65535<t)throw new R.ValueError("value out of bounds for c format");h=String.fromCharCode(t);break;case"d":h=t.toString();break;case"o":h=t.toString(8);break;case"x":h=t.toString(16);break;case"X":h=t.toString(16).toUpperCase();break;case"n":h=t.toString()}if("="===i)(p||"-"!==a)&&--s,!u||"b"!==l&&"o"!==l&&"x"!==l&&"X"!==l||(s-=2),h.length<s&&(h=R._str_repeat(o,s-h.length)+h),!u||"b"!==l&&"o"!==l&&"x"!==l&&"X"!==l||(h="0"+l+h),p?h="-"+h:"-"!=a&&(h=a+h);else if(!u||"b"!=l&&"o"!=l&&"x"!=l&&"X"!=l||(h="0"+l+h),p?h="-"+h:"-"!=a&&(h=a+h),h.length<s)if("<"==i)h+=R._str_repeat(o,s-h.length);else if(">"==i)h=R._str_repeat(o,s-h.length)+h;else{var _=s-h.length,f=Math.floor(_/2),d=_-f;h=R._str_repeat(o,f)+h+R._str_repeat(o,d)}return h},R._format=function(t,e,r){if(null==r)r="en";else{var n={de:null,en:null,fr:null,es:null,it:null,da:null,sv:null,nl:null,pt:null,cs:null,sk:null,pl:null,hr:null,sr:null,ro:null,hu:null,tr:null,ru:null,zh:null,ko:null,ja:null};void 0===n[r=r.toLowerCase()]&&void 0===n[r=r.split(/_/)[0]]&&(r="en")}return R._isdate(t)?R._format_datetime(t._date,e,r):R._isdatetime(t)?R._format_datetime(t,e,r):R._isint(t)?R._format_int(t,e,r):!0===t?R._format_int(1,e,r):!1===t?R._format_int(0,e,r):void 0},R._lpad=function(t,e,r){for("number"==typeof t&&(t=t.toString());t.length<r;)t=e+t;return t},R._rpad=function(t,e,r){for("number"==typeof t&&(t=t.toString());t.length<r;)t+=e;return t};var U=1;R.Proto=function(){function t(){E(this,t),this.__id__=U++}return P(t,[{key:"ul4type",value:function(){return this.constructor.name}},{key:"__eq__",value:function(t){return this===t}},{key:"__ne__",value:function(t){return!this.__eq__(t)}},{key:"__bool__",value:function(){return!0}}]),t}(),R.Signature=function(t){function i(){var t;E(this,i),(t=V(this,O(i).call(this))).args=[],t.argNames={},t.remargs=null;for(var e=!1,r=t.remkwargs=null,n=0;n<arguments.length;++n){var o=n<0||arguments.length<=n?void 0:arguments[n];e?(t.args.push({name:r,defaultValue:o}),e=!(t.argNames[r]=!0)):"="===o.substr(o.length-1)?(r=o.substr(0,o.length-1),e=!0):"**"===o.substr(0,2)?t.remkwargs=o.substr(2):"*"===o.substr(0,1)?t.remargs=o.substr(1):(t.args.push({name:o}),t.argNames[o]=!0)}return t}return L(i,R.Proto),P(i,[{key:"bindArray",value:function(t,e,r){for(var n=[],o=null!==t?t+"() ":"",i=0;i<this.args.length;++i){var a=this.args[i];if(i<e.length){if(r.hasOwnProperty(a.name))throw new R.ArgumentError(o+"argument "+R._repr(a.name)+" (position "+i+") specified multiple times");n.push(e[i])}else if(r.hasOwnProperty(a.name))n.push(r[a.name]);else{if(!a.hasOwnProperty("defaultValue"))throw new R.ArgumentError("required "+o+"argument "+R._repr(a.name)+" (position "+i+") missing");n.push(a.defaultValue)}}if(null===this.remargs){if(e.length>this.args.length){var u=null===t?"expected":t+"() expects";throw new R.ArgumentError(u+" at most "+this.args.length+" positional argument"+(1!=this.args.length?"s":"")+", "+e.length+" given")}}else n.push(e.slice(this.args.length));if(null===this.remkwargs){for(var s in r)if(!this.argNames[s])throw null===t?new R.ArgumentError("an argument named "+R._repr(s)+" isn't supported"):new R.ArgumentError(t+"() doesn't support an argument named "+R._repr(s))}else{var l=R._emptymap();for(var c in r)this.argNames[c]||R._setmap(l,c,r[c]);n.push(l)}return n}},{key:"bindObject",value:function(t,e,r){e=this.bindArray(t,e,r);var n,o={};for(n=0;n<this.args.length;++n)o[this.args[n].name]=e[n];return null!==this.remargs&&(o[this.remargs]=e[n++]),null!==this.remkwargs&&(o[this.remkwargs]=e[n++]),o}},{key:"__repr__",value:function(){return"<Signature "+this.toString()+">"}},{key:"__str__",value:function(){return this.toString()}},{key:"toString",value:function(){for(var t=[],e=0;e<this.args.length;++e){var r=this.args[e];r.hasOwnProperty("defaultValue")?t.push(r.name+"="+R._repr(r.defaultValue)):t.push(r.name)}return null!==this.remargs&&t.push("*"+this.remargs),null!==this.remkwargs&&t.push("**"+this.remkwargs),"("+t.join(", ")+")"}}]),i}(),R._Set=function(){function t(){E(this,t),this.items={},this.add.apply(this,arguments)}return P(t,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0;n<e.length;++n)this.items[e[n]]=!0}},{key:"clear",value:function(){this.items={}}},{key:"__getattr__",value:function(t){var e=this;switch(t){case"add":return R.expose(function(t){e.add.apply(e,N(t))},["*items"]);default:throw new R.AttributeError(this,t)}}},{key:"__contains__",value:function(t){return this.items[t]||!1}},{key:"has",value:function(t){return this.items[t]||!1}},{key:"__bool__",value:function(){for(var t in this.items)if(this.items.hasOwnProperty(t))return!0;return!1}},{key:"__repr__",value:function(){var t=[];t.push("{");var e=0;for(var r in this.items)this.items.hasOwnProperty(r)&&(e++&&t.push(", "),t.push(R._repr(r)));return e||t.push("/"),t.push("}"),t.join("")}},{key:"__eq__",value:function(t){if(R._isset(t)){var e=0;for(var r in this.items){if(!t.has(r))return!1;++e}return t.size==e}if(R._isul4set(t)){var n=0;for(var o in this.items){if(!t[o])return!1;++n}for(var i in t.items)--n;return 0==n}return!1}},{key:"__le__",value:function(t){if(R._isset(t)){for(var e in this.items)if(!t.has(e))return!1;return!0}if(R._isul4set(t)){for(var r in this.items)if(!t.items[r])return!1;return!0}R._unorderable("<",this,t)}},{key:"__ge__",value:function(t){if(R._isset(t))return t.forEach(function(t){if(!this.items[t])return!1},this),!0;if(R._isul4set(t)){for(var e in t.items)if(!this.items[e])return!1;return!0}R._unorderable("<=",this,t)}}]),t}(),R._Set.prototype.__type__="set",R.expose=function(t,e,r){(r=r||{}).name&&(t._ul4_name=r.name),R._islist(e)&&(e=q(R.Signature,N(e))),t._ul4_signature=e,t._ul4_needsobject=r.needsobject||!1,t._ul4_needscontext=r.needscontext||!1},R.Protocol=function(){function t(){E(this,t)}return P(t,[{key:"ul4type",value:function(){return this.constructor.name}},{key:"dir",value:function(){return this.attrs}},{key:"get",value:function(t){return R._isstr(t)?R.StrProtocol:R._islist(t)?R.ListProtocol:R._isdate(t)?R.DateProtocol:R._isset(t)?R.SetProtocol:R._ismap(t)?R.MapProtocol:R._isdatetime(t)?R.DateTimeProtocol:R._isobject(t)?R.ObjectProtocol:R.Protocol}},{key:"getattr",value:function(n,t){if(null==n)throw new R.AttributeError(n,t);if("function"==typeof n.__getattr__)return n.__getattr__(t);if(this.attrs.has(t)){var o=this[t],e=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.apply(this,[n].concat(e))};return e.name=o.name,e._ul4_name=o._ul4_name||o.name,e._ul4_signature=o._ul4_signature,e._ul4_needsobject=o._ul4_needsobject,e._ul4_needscontext=o._ul4_needscontext,e}throw new R.AttributeError(n,t)}},{key:"hasattr",value:function(t,e){if(null==t)return!1;if("function"!=typeof t.__getattr__)return this.attrs.has(e);try{return t.__getattr__(e),!0}catch(t){if(t instanceof R.AttributeError&&t.obj===object)return!1;throw t}}}]),t}(),R.Protocol=R.Protocol.prototype,R.Protocol.attrs=R._emptyset(),R.StrProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"str"}},{key:"count",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._count(t,e,r,n)}},{key:"find",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._find(t,e,r,n)}},{key:"rfind",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._rfind(t,e,r,n)}},{key:"replace",value:function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=t.length);for(var o=[];t.length;){var i=t.indexOf(e);if(-1===i||!n--){o.push(t);break}o.push(t.substr(0,i)),o.push(r),t=t.substr(i+e.length)}return o.join("")}},{key:"strip",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof(e=e||" \r\n\t"))throw new R.TypeError("strip() requires a string argument");for(;t&&0<=e.indexOf(t[0]);)t=t.substr(1);for(;t&&0<=e.indexOf(t[t.length-1]);)t=t.substr(0,t.length-1);return t}},{key:"lstrip",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof(e=e||" \r\n\t"))throw new R.TypeError("lstrip() requires a string argument");for(;t&&0<=e.indexOf(t[0]);)t=t.substr(1);return t}},{key:"rstrip",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"!=typeof(e=e||" \r\n\t"))throw new R.TypeError("rstrip() requires a string argument");for(;t&&0<=e.indexOf(t[t.length-1]);)t=t.substr(0,t.length-1);return t}},{key:"split",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(null!==e&&"string"!=typeof e)throw new R.TypeError("split() requires a string");if(null===r){var n=t.split(null!==e?e:/[ \n\r\t]+/);return null===e&&(n.length&&!n[0].length&&n.splice(0,1),n.length&&!n[n.length-1].length&&n.splice(-1)),n}if(null!==e){for(var o=[];t.length;){var i=t.indexOf(e);if(-1===i||!r--){o.push(t);break}o.push(t.substr(0,i)),t=t.substr(i+e.length)}return o}for(var a=[];t.length;){t=R.StrProtocol.lstrip(t,null);var u=void 0;(u=r--?t.split(/[ \n\r\t]+/,1)[0]:t).length&&a.push(u),t=t.substr(u.length)}return a}},{key:"rsplit",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(null!==e&&"string"!=typeof e)throw new R.TypeError("rsplit() requires a string as second argument");if(null===r){var n=t.split(null!==e?e:/[ \n\r\t]+/);return null===e&&(n.length&&!n[0].length&&n.splice(0,1),n.length&&!n[n.length-1].length&&n.splice(-1)),n}if(null!==e){for(var o=[];t.length;){var i=t.lastIndexOf(e);if(-1===i||!r--){o.unshift(t);break}o.unshift(t.substr(i+e.length)),t=t.substr(0,i)}return o}for(var a=[];t.length;){t=R.StrProtocol.rstrip(t);var u=void 0;(u=r--?(u=t.split(/[ \n\r\t]+/))[u.length-1]:t).length&&a.unshift(u),t=t.substr(0,t.length-u.length)}return a}},{key:"splitlines",value:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=0,o=[],i=t.length;for(n=0,startpos=0;;){if(i<=n)return startpos!=n&&o.push(t.substring(startpos)),o;var a=(void 0,"\n"===(e=t[n])||"\v"==e||"\f"==e||""==e||""==e||""==e||""==e||"\u2028"==e||"\u2029"==e?1:"\r"===e?n==i-1?1:"\n"===t[n+1]?2:1:0);if(a){var u=n+(r?a:0);o.push(t.substring(startpos,u)),n+=a,startpos=n}else++n}}},{key:"lower",value:function(t){return t.toLowerCase()}},{key:"upper",value:function(t){return t.toUpperCase()}},{key:"capitalize",value:function(t){return t.length&&(t=t[0].toUpperCase()+t.slice(1).toLowerCase()),t}},{key:"join",value:function(t,e){for(var r=[],n=R._iter(e);;){var o=n.next();if(o.done)break;r.push(o.value)}return r.join(t)}},{key:"startswith",value:function(t,e){if("string"==typeof e)return t.substr(0,e.length)===e;if(R._islist(e)){for(var r=0;r<e.length;++r){var n=e[r];if(t.substr(0,n.length)===n)return!0}return!1}throw new R.TypeError("startswith() argument must be string")}},{key:"endswith",value:function(t,e){if("string"==typeof e)return t.substr(t.length-e.length)===e;if(R._islist(e)){for(var r=0;r<e.length;++r){var n=e[r];if(t.substr(t.length-n.length)===n)return!0}return!1}throw new R.TypeError("endswith() argument must be string or list of strings")}}]),e}(),R.StrProtocol=R.StrProtocol.prototype,R.StrProtocol.attrs=R._makeset("split","rsplit","splitlines","strip","lstrip","rstrip","upper","lower","capitalize","startswith","endswith","replace","count","find","rfind","join"),R.expose(R.StrProtocol.count,["sub","start=",null,"end=",null]),R.expose(R.StrProtocol.find,["sub","start=",null,"end=",null]),R.expose(R.StrProtocol.rfind,["sub","start=",null,"end=",null]),R.expose(R.StrProtocol.replace,["old","new","count=",null]),R.expose(R.StrProtocol.strip,["chars=",null]),R.expose(R.StrProtocol.lstrip,["chars=",null]),R.expose(R.StrProtocol.rstrip,["chars=",null]),R.expose(R.StrProtocol.split,["sep=",null,"count=",null]),R.expose(R.StrProtocol.rsplit,["sep=",null,"count=",null]),R.expose(R.StrProtocol.splitlines,["keepends=",!1]),R.expose(R.StrProtocol.lower,[]),R.expose(R.StrProtocol.upper,[]),R.expose(R.StrProtocol.capitalize,[]),R.expose(R.StrProtocol.join,["iterable"]),R.expose(R.StrProtocol.startswith,["prefix"]),R.expose(R.StrProtocol.endswith,["suffix"]),R.ListProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"list"}},{key:"append",value:function(t,e){for(var r=0;r<e.length;++r)t.push(e[r]);return null}},{key:"insert",value:function(t,e,r){e<0&&(e+=t.length);for(var n=0;n<r.length;++n)t.splice(e++,0,r[n]);return null}},{key:"pop",value:function(t,e){e<0&&(e+=t.length);var r=t[e];return t.splice(e,1),r}},{key:"count",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._count(t,e,r,n)}},{key:"find",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._find(t,e,r,n)}},{key:"rfind",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return R._rfind(t,e,r,n)}}]),e}(),R.ListProtocol=R.ListProtocol.prototype,R.ListProtocol.attrs=R._makeset("append","insert","pop","count","find","rfind"),R.expose(R.ListProtocol.append,["*items"]),R.expose(R.ListProtocol.insert,["pos","*items"]),R.expose(R.ListProtocol.pop,["pos=",-1]),R.expose(R.ListProtocol.count,["sub","start=",null,"end=",null]),R.expose(R.ListProtocol.find,["sub","start=",null,"end=",null]),R.expose(R.ListProtocol.rfind,["sub","start=",null,"end=",null]),R.MapProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"dict"}},{key:"getattr",value:function(n,t){if(this.attrs.has(t)){var o=this[t],e=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.apply(this,[n].concat(e))};return e.name=o.name,e._ul4_name=o._ul4_name||o.name,e._ul4_signature=o._ul4_signature,e._ul4_needsobject=o._ul4_needsobject,e._ul4_needscontext=o._ul4_needscontext,e}return n.get(t)}},{key:"get",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return t.has(e)?t.get(e):r}},{key:"items",value:function(t){var r=[];return t.forEach(function(t,e){r.push([e,t])}),r}},{key:"values",value:function(t){var r=[];return t.forEach(function(t,e){r.push(t)}),r}},{key:"update",value:function(t,e,r){return R._update(t,e,r)}},{key:"clear",value:function(t){return t.clear(),null}}]),e}(),R.MapProtocol=R.MapProtocol.prototype,R.MapProtocol.attrs=R._makeset("get","items","values","update","clear"),R.expose(R.MapProtocol.get,["key","default=",null]),R.expose(R.MapProtocol.items,[]),R.expose(R.MapProtocol.values,[]),R.expose(R.MapProtocol.update,["*other","**kwargs"]),R.expose(R.MapProtocol.clear,[]),R.SetProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"set"}},{key:"add",value:function(t,e){for(var r=0;r<e.length;++r)t.add(e[r])}},{key:"clear",value:function(t){return t.clear(),null}}]),e}(),R.SetProtocol=R.SetProtocol.prototype,R.SetProtocol.attrs=R._makeset("add","clear"),R.expose(R.SetProtocol.add,["*items"]),R.expose(R.SetProtocol.clear,[]),R.DateProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"date"}},{key:"weekday",value:function(t){return R.DateTimeProtocol.weekday(t._date)}},{key:"calendar",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;return R.DateTimeProtocol.calendar(t._date,e,r)}},{key:"week",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;return R.DateProtocol.calendar(t,e,r)[1]}},{key:"day",value:function(t){return t._date.getDate()}},{key:"month",value:function(t){return t._date.getMonth()+1}},{key:"year",value:function(t){return t._date.getFullYear()}},{key:"mimeformat",value:function(t){var e=t._date;return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][R.DateTimeProtocol.weekday(e)]+", "+R._lpad(e.getDate(),"0",2)+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getFullYear()}},{key:"isoformat",value:function(t){var e=t._date;return e.getFullYear()+"-"+R._lpad((e.getMonth()+1).toString(),"0",2)+"-"+R._lpad(e.getDate().toString(),"0",2)}},{key:"yearday",value:function(t){return R.DateTimeProtocol.yearday(t._date)}}]),e}(),R.DateProtocol=R.DateProtocol.prototype,R.DateProtocol.attrs=R._makeset("weekday","week","calendar","day","month","year","mimeformat","isoformat","yearday"),R.expose(R.DateProtocol.weekday,[]),R.expose(R.DateProtocol.calendar,["firstweekday=",0,"mindaysinfirstweek=",4]),R.expose(R.DateProtocol.week,["firstweekday=",0,"mindaysinfirstweek=",4]),R.expose(R.DateProtocol.day,[]),R.expose(R.DateProtocol.month,[]),R.expose(R.DateProtocol.year,[]),R.expose(R.DateProtocol.mimeformat,[]),R.expose(R.DateProtocol.isoformat,[]),R.expose(R.DateProtocol.yearday,[]),R.DateTimeProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"datetime"}},{key:"weekday",value:function(t){var e=t.getDay();return e?e-1:6}},{key:"calendar",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;e=R._mod(e,7),r<1?r=1:7<r&&(r=7);for(var n=1;-1<=n;--n){var o=t.getFullYear()+n,i=new Date(o,0,r),a=R._mod(R.DateTimeProtocol.weekday(i)-e,7),u=i.getFullYear(),s=i.getMonth(),l=i.getDate()-a,c=new Date(u,s,l);if(t.getTime()>=c.getTime()){var h=R.SubAST.prototype._do(t,c);return[o,Math.floor(h.days()/7)+1,R.DateTimeProtocol.weekday(t)]}}}},{key:"week",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;return R.DateTimeProtocol.calendar(t,e,r)[1]}},{key:"day",value:function(t){return t.getDate()}},{key:"month",value:function(t){return t.getMonth()+1}},{key:"year",value:function(t){return t.getFullYear()}},{key:"hour",value:function(t){return t.getHours()}},{key:"minute",value:function(t){return t.getMinutes()}},{key:"second",value:function(t){return t.getSeconds()}},{key:"microsecond",value:function(t){return 1e3*t.getMilliseconds()}},{key:"mimeformat",value:function(t){return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][R.DateTimeProtocol.weekday(t)]+", "+R._lpad(t.getDate(),"0",2)+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+" "+t.getFullYear()+" "+R._lpad(t.getHours(),"0",2)+":"+R._lpad(t.getMinutes(),"0",2)+":"+R._lpad(t.getSeconds(),"0",2)+" GMT"}},{key:"isoformat",value:function(t){var e=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),o=t.getHours(),i=t.getMinutes(),a=t.getSeconds(),u=t.getMilliseconds(),s=e+"-"+R._lpad(r.toString(),"0",2)+"-"+R._lpad(n.toString(),"0",2)+"T"+R._lpad(o.toString(),"0",2)+":"+R._lpad(i.toString(),"0",2)+":"+R._lpad(a.toString(),"0",2);return u&&(s+="."+R._lpad(u.toString(),"0",3)+"000"),s}},{key:"yearday",value:function(t){var e=R._isleap(t)?1:0,r=t.getDate();switch(t.getMonth()){case 0:return r;case 1:return 31+r;case 2:return 59+e+r;case 3:return 59+e+31+r;case 4:return 59+e+31+30+r;case 5:return 59+e+31+30+31+r;case 6:return 59+e+31+30+31+30+r;case 7:return 59+e+31+30+31+30+31+r;case 8:return 59+e+31+30+31+30+31+31+r;case 9:return 59+e+31+30+31+30+31+31+30+r;case 10:return 59+e+31+30+31+30+31+31+30+31+r;case 11:return 59+e+31+30+31+30+31+31+30+31+30+r}}}]),e}(),R.DateTimeProtocol=R.DateTimeProtocol.prototype,R.DateTimeProtocol.attrs=R._makeset("weekday","week","calendar","day","month","year","hour","minute","second","microsecond","mimeformat","isoformat","yearday"),R.expose(R.DateTimeProtocol.weekday,[]),R.expose(R.DateTimeProtocol.calendar,["firstweekday=",0,"mindaysinfirstweek=",4]),R.expose(R.DateTimeProtocol.week,["firstweekday=",0,"mindaysinfirstweek=",4]),R.expose(R.DateTimeProtocol.day,[]),R.expose(R.DateTimeProtocol.month,[]),R.expose(R.DateTimeProtocol.year,[]),R.expose(R.DateTimeProtocol.hour,[]),R.expose(R.DateTimeProtocol.minute,[]),R.expose(R.DateTimeProtocol.second,[]),R.expose(R.DateTimeProtocol.microsecond,[]),R.expose(R.DateTimeProtocol.mimeformat,[]),R.expose(R.DateTimeProtocol.isoformat,[]),R.expose(R.DateTimeProtocol.yearday,[]),R.ObjectProtocol=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Protocol.constructor),P(e,[{key:"ul4type",value:function(t){return"dict"}},{key:"getattr",value:function(n,t){var o;if("function"!=typeof(o=n&&"function"==typeof n.__getattr__?n.__getattr__(t):n[t]))return o;var e=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.apply(n,e)};return e._ul4_name=o._ul4_name||o.name,e._ul4_signature=o._ul4_signature,e._ul4_needsobject=o._ul4_needsobject,e._ul4_needscontext=o._ul4_needscontext,e}},{key:"get",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t[e];return void 0===n?r:n}},{key:"items",value:function(t){var e=[];for(var r in t)e.push([r,t[r]]);return e}},{key:"values",value:function(t){var e=[];for(var r in t)e.push(t[r]);return e}},{key:"clear",value:function(t){for(var e in t)delete t[e]}}]),e}(),R.ObjectProtocol=R.ObjectProtocol.prototype,R.ObjectProtocol.attrs=R._makeset("get","items","values","update","clear"),R.expose(R.ObjectProtocol.get,["key","default=",null]),R.expose(R.ObjectProtocol.items,[]),R.expose(R.ObjectProtocol.values,[]),R.expose(R.ObjectProtocol.clear,[]),R.Context=function(){function e(t){E(this,e),null==t&&(t={}),this.vars=t,this.indents=[],this.escapes=[],this._output=[]}return P(e,[{key:"inheritvars",value:function(){var t=Object.create(this);return t.vars=Object.create(this.vars),t}},{key:"withindent",value:function(t){var e=Object.create(this);return null!==t&&(e.indents=this.indents.slice(),e.indents.push(t)),e}},{key:"replaceoutput",value:function(){var t=Object.create(this);return t._output=[],t}},{key:"clone",value:function(t){return Object.create(this)}},{key:"output",value:function(t){for(var e=0;e<this.escapes.length;++e){t=(0,this.escapes[e])(t)}this._output.push(t)}},{key:"getoutput",value:function(){return this._output.join("")}},{key:"get",value:function(t){return this.vars[t]}},{key:"set",value:function(t,e){this.vars[t]=e}}]),e}(),R.Exception=function(t,e,r){var n=new Error(t,e,r);return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n.__id__=U++,n.context=null,n},R.Exception.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(R.Exception,Error):R.Exception.__proto__=Error,R.Exception.prototype.__getattr__=function(t){switch(t){case"context":return this.context;default:throw new R.AttributeError(this,t)}},R.InternalException=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Exception),e}(),R.ReturnException=function(t){function r(t){var e;return E(this,r),(e=V(this,O(r).call(this,"return"))).result=t,e}return L(r,R.InternalException),r}(),R.BreakException=function(t){function e(){return E(this,e),V(this,O(e).call(this,"break"))}return L(e,R.InternalException),e}(),R.ContinueException=function(t){function e(){return E(this,e),V(this,O(e).call(this,"continue"))}return L(e,R.InternalException),e}(),R.SyntaxError=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Exception),e}(),R.LValueRequiredError=function(t){function e(){return E(this,e),V(this,O(e).call(this,"lvalue required"))}return L(e,R.SyntaxError),e}(),R.TypeError=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Exception),e}(),R.ValueError=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Exception),e}(),R.ArgumentError=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.Exception),e}(),R.NotSubscriptableError=function(t){function r(t){var e;return E(this,r),(e=V(this,O(r).call(this,"Object of type "+_type(t)+" is not subscriptable"))).obj=t,e}return L(r,R.Exception),P(r,[{key:"toString",value:function(){return"Object of type "+_type(this.obj)+" is not subscriptable"}}]),r}(),R.ZeroDivisionError=function(t){function e(){return E(this,e),V(this,O(e).call(this,"division by zero"))}return L(e,R.Exception),e}(),R.IndexError=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,"index "+R._repr(e)+" out of range"))).obj=t,r.index=e,r}return L(n,R.Exception),P(n,[{key:"toString",value:function(){return"index "+this.index+" out of range for "+R._type(this.obj)}}]),n}(),R.AttributeError=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,"object of type "+R._type(t)+" has no attribute "+R._repr(e)))).obj=t,r.attrname=e,r}return L(n,R.Exception),n}(),R.LocationError=function(t){function r(t){var e;return E(this,r),(e=V(this,O(r).call(this,"nested exception in "+R._repr(t)))).location=t,e}return L(r,R.Exception),P(r,[{key:"_templateprefix",value:function(){var t=this.location.template,e=[];null!==t.parenttemplate?e.push("in local template "):e.push("in template ");for(var r=!0;null!=t;)r?r=!1:e.push(" in "),e.push(t.name?R._repr(t.name):"(unnamed)"),t=t.parenttemplate;return e.join("")}},{key:"toString",value:function(){this.location.template;var t=this._templateprefix(),e=this.location.sourceprefix,r=this.location.source,n=this.location.sourcesuffix,o=(e=R._repr(e).slice(1,-1))+(r=R._repr(r).slice(1,-1))+(n=R._repr(n).slice(1,-1)),i=R._str_repeat(" ",e.length)+R._str_repeat("~",r.length);return t+": "+("offset "+this.location.pos.start+":"+this.location.pos.stop+"; line "+this.location.line+"; col "+this.location.col)+"\n"+o+"\n"+i}},{key:"__getattr__",value:function(t){switch(t){case"context":return this.context;case"location":return this.location;default:throw new R.AttributeError(this,t)}}}]),r}(),R.AST=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this))).template=t,r.pos=e,r._line=null,r._col=null,r}return L(n,R.Proto),P(n,[{key:"_calculateLineCol",value:function(){this._line=1,this._col=1;for(var t=this.pos.start,e=0;e<t;++e)"\n"===this.template.source[e]?(++this._line,this._col=1):++this._col}},{key:"__getattr__",value:function(t){if("type"===t||"fullsource"===t||"source"===t||"sourceprefix"===t||"sourcesuffix"===t||"line"===t||"col"===t)return this[t];if(0<=this._ul4onattrs.indexOf(t))return this[t];throw new R.AttributeError(this,t)}},{key:"__setitem__",value:function(t,e){throw new R.TypeError("object is immutable")}},{key:"__str__",value:function(){var t=[];return this._str(t),R._formatsource(t)}},{key:"__repr__",value:function(){var t=[];return this._repr(t),R._formatsource(t)}},{key:"_decorate_exception",value:function(t){for(;void 0!==t.context&&null!==t.context;)t=t.context;t.context=new R.LocationError(this)}},{key:"_handle_eval",value:function(t){try{return this._eval(t)}catch(t){throw t instanceof R.InternalException||t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_handle_eval_set",value:function(t,e){try{return this._eval_set(t,e)}catch(t){throw t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_eval_set",value:function(t,e){throw new R.LValueRequiredError}},{key:"_handle_eval_modify",value:function(t,e,r){try{return this._eval_modify(t,e,r)}catch(t){throw t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_eval_modify",value:function(t,e,r){throw new R.LValueRequiredError}},{key:"_repr",value:function(t){}},{key:"_str",value:function(t){t.push(this.source.replace(/\r?\n/g," "))}},{key:"ul4ondump",value:function(t){for(var e=0;e<this._ul4onattrs.length;++e){var r=this._ul4onattrs[e];t.dump(this[r])}}},{key:"ul4onload",value:function(t){for(var e=0;e<this._ul4onattrs.length;++e){this[this._ul4onattrs[e]]=t.load()}}},{key:"fullsource",get:function(){return this.template._source}},{key:"source",get:function(){return this.pos.of(this.template._source)}},{key:"sourceprefix",get:function(){for(var t=this.pos.start,e=t,r=this.fullsource,n=40,o="…";0<n;){if(0===t){o="";break}if("\n"===r.charAt(t-1)){o="";break}--n,--t}return o+r.substring(t,e)}},{key:"sourcesuffix",get:function(){for(var t=this.pos.stop,e=t,r=this.fullsource,n=40,o="…";0<n;){if(t>=r.length){o="";break}if("\n"===r.charAt(t)){o="";break}--n,++t}return r.substring(e,t)+o}},{key:"line",get:function(){return null===this._line&&this._calculateLineCol(),this._line}},{key:"col",get:function(){return null===this._col&&this._calculateLineCol(),this._col}}]),n}(),R.AST.prototype._ul4onattrs=["template","pos"],R.TextAST=function(t){function r(t,e){return E(this,r),V(this,O(r).call(this,t,e))}return L(r,R.AST),P(r,[{key:"_eval",value:function(t){t.output(this.text)}},{key:"_str",value:function(t){t.push("text "),t.push(R._repr(this.text))}},{key:"_repr",value:function(t){t.push("<TextAST "),t.push(R._repr(this.text)),t.push(">")}},{key:"text",get:function(){return this.source}}]),r}(),R.IndentAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e)))._text=r,n}return L(o,R.TextAST),P(o,[{key:"_eval",value:function(t){for(var e=0;e<t.indents.length;++e){var r=t.indents[e];t.output(r)}t.output(this.text)}},{key:"ul4ondump",value:function(t){I(O(o.prototype),"ul4ondump",this).call(this,t),this._text===this.source?t.dump(null):t.dump(this._text)}},{key:"ul4onload",value:function(t){I(O(o.prototype),"ul4onload",this).call(this,t),this._text=t.load()}},{key:"_str",value:function(t){t.push("indent "),t.push(R._repr(this.text))}},{key:"_repr",value:function(t){t.push("<IndentAST "),t.push(R._repr(this.text)),t.push(">")}},{key:"text",get:function(){return void 0!==this.template?null===this._text?this.source:this._text:null}}]),o}(),R.LineEndAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.TextAST),P(e,[{key:"_str",value:function(t){t.push("lineend "),t.push(R._repr(this.text))}},{key:"_repr",value:function(t){t.push("<LineEndAST "),t.push(R._repr(this.text)),t.push(">")}}]),e}(),R.CodeAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.AST),e}(),R.ConstAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).value=r,n}return L(o,R.CodeAST),P(o,[{key:"_repr",value:function(t){t.push("<ConstAST value="),t.push(R._repr(this.value)),t.push(">")}},{key:"_eval",value:function(t){return this.value}}]),o}(),R.ConstAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["value"]),R.ItemArgBase=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.CodeAST),P(e,[{key:"_handle_eval_list",value:function(t,e){try{return this._eval_list(t,e)}catch(t){throw t instanceof R.InternalException||t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_handle_eval_set",value:function(t,e){try{return this._eval_set(t,e)}catch(t){throw t instanceof R.InternalException||t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_handle_eval_dict",value:function(t,e){try{return this._eval_dict(t,e)}catch(t){throw t instanceof R.InternalException||t instanceof R.LocationError||this._decorate_exception(t),t}}},{key:"_handle_eval_call",value:function(t,e,r){try{return this._eval_call(t,e,r)}catch(t){throw t instanceof R.InternalException||t instanceof R.LocationError||this._decorate_exception(t),t}}}]),e}(),R.SeqItemAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).value=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<SeqItemAST value="),t.push(R._repr(this.value)),t.push(">")}},{key:"_eval_list",value:function(t,e){var r=this.value._handle_eval(t);e.push(r)}},{key:"_eval_set",value:function(t,e){var r=this.value._handle_eval(t);e.add(r)}}]),o}(),R.SeqItemAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["value"]),R.UnpackSeqItemAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).value=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<UnpackSeqItemAST value="),t.push(R._repr(this.value)),t.push(">")}},{key:"_eval_list",value:function(t,e){for(var r=this.value._handle_eval(t),n=R._iter(r);;){var o=n.next();if(o.done)break;e.push(o.value)}}},{key:"_eval_set",value:function(t,e){for(var r=this.value._handle_eval(t),n=R._iter(r);;){var o=n.next();if(o.done)break;e.add(o.value)}}}]),o}(),R.UnpackSeqItemAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["value"]),R.DictItemAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).key=r,o.value=n,o}return L(i,R.ItemArgBase),P(i,[{key:"_repr",value:function(t){t.push("<DictItemAST key="),t.push(R._repr(this.key)),t.push(" value="),t.push(R._repr(this.value)),t.push(">")}},{key:"_eval_dict",value:function(t,e){var r=this.key._handle_eval(t),n=this.value._handle_eval(t);R._setmap(e,r,n)}}]),i}(),R.DictItemAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["key","value"]),R.UnpackDictItemAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).item=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<UnpackDictItemAST item="),t.push(R._repr(this.item)),t.push(">")}},{key:"_eval_dict",value:function(t,r){var e=this.item._handle_eval(t);if(R._islist(e))for(var n=0;n<e.length;++n){var o=e[n];if(!R._islist(o)||2!=o.length)throw new R.ArgumentError("** requires a list of (key, value) pairs");R._setmap(r,o[0],o[1])}else if(R._ismap(e))e.forEach(function(t,e){R._setmap(r,e,t)});else if(R._isobject(e))for(var i in e)R._setmap(r,i,e[i])}}]),o}(),R.UnpackDictItemAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["item"]),R.PosArgAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).value=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<PosArgAST value="),this.value._repr(t),t.push(">")}},{key:"_eval_call",value:function(t,e,r){var n=this.value._handle_eval(t);e.push(n)}}]),o}(),R.PosArgAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["value"]),R.KeywordArgAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).name=r,o.value=n,o}return L(i,R.ItemArgBase),P(i,[{key:"_repr",value:function(t){t.push("<KeywordArgAST name="),t.push(R._repr(this.name)),t.push(" value="),this.value._repr(t),t.push(">")}},{key:"_eval_call",value:function(t,e,r){if(r.hasOwnProperty(this.name))throw new R.ArgumentError("duplicate keyword argument "+this.name);var n=this.value._handle_eval(t);r[this.name]=n}}]),i}(),R.KeywordArgAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["name","value"]),R.UnpackListArgAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).item=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<UnpackListArgAST item="),this.item._repr(t),t.push(">")}},{key:"_eval_call",value:function(t,e,r){var n=this.item._handle_eval(t);e.push.apply(e,N(n))}}]),o}(),R.UnpackListArgAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["item"]),R.UnpackDictArgAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).item=r,n}return L(o,R.ItemArgBase),P(o,[{key:"_repr",value:function(t){t.push("<UnpackDictArgAST item="),this.item._repr(t),t.push(">")}},{key:"_eval_call",value:function(t,e,r){var n=this.item._handle_eval(t);if(R._islist(n))for(var o=0;o<n.length;++o){var i=n[o];if(!R._islist(i)||2!=i.length)throw new R.ArgumentError("** requires a list of (key, value) pairs");var a=F(i,2),u=a[0],s=a[1];if(r.hasOwnProperty(u))throw new R.ArgumentError("duplicate keyword argument "+u);r[u]=s}else if(R._ismap(n))n.forEach(function(t,e){if(r.hasOwnProperty(e))throw new R.ArgumentError("duplicate keyword argument "+e);r[e]=t});else if(R._isobject(n))for(var u in n){if(r.hasOwnProperty(u))throw new R.ArgumentError("duplicate keyword argument "+u);r[u]=n[u]}}}]),o}(),R.UnpackDictArgAST.prototype._ul4onattrs=R.ItemArgBase.prototype._ul4onattrs.concat(["item"]),R.ListAST=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,t,e))).items=[],r}return L(n,R.CodeAST),P(n,[{key:"_repr",value:function(t){t.push("<ListAST");for(var e=0;e<this.items.length;++e){var r=this.items[e];t.push(" "),r._repr(t)}t.push(">")}},{key:"_eval",value:function(t){for(var e=[],r=0;r<this.items.length;++r){this.items[r]._handle_eval_list(t,e)}return e}}]),n}(),R.ListAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["items"]),R.ListCompAST=function(t){function u(t,e,r,n,o,i){var a;return E(this,u),(a=V(this,O(u).call(this,t,e))).item=r,a.varname=n,a.container=o,a.condition=i,a}return L(u,R.CodeAST),P(u,[{key:"_repr",value:function(t){t.push("<ListCompAST"),t.push(" item="),this.item._repr(t),t.push(" varname="),t.push(R._repr(this.varname)),t.push(" container="),this.container._repr(t),null!==this.condition&&(t.push(" condition="),this.condition._repr(t)),t.push(">")}},{key:"_eval",value:function(t){for(var e=this.container._handle_eval(t),r=t.inheritvars(),n=[],o=R._iter(e);;){var i=o.next();if(i.done)break;for(var a=R._unpackvar(this.varname,i.value),u=0;u<a.length;++u){var s=F(a[u],2),l=s[0],c=s[1];l._handle_eval_set(r,c)}(null===this.condition||R._bool(this.condition._handle_eval(r)))&&n.push(this.item._handle_eval(r))}return n}}]),u}(),R.ListCompAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["item","varname","container","condition"]),R.SetAST=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,t,e))).items=[],r}return L(n,R.CodeAST),P(n,[{key:"_repr",value:function(t){t.push("<SetAST");for(var e=0;e<this.items.length;++e){var r=this.items[e];t.push(" "),r._repr(t)}t.push(">")}},{key:"_eval",value:function(t){for(var e=R._emptyset(),r=0;r<this.items.length;++r){this.items[r]._handle_eval_set(t,e)}return e}}]),n}(),R.SetAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["items"]),R.SetCompAST=function(t){function u(t,e,r,n,o,i){var a;return E(this,u),(a=V(this,O(u).call(this,t,e))).item=r,a.varname=n,a.container=o,a.condition=i,a}return L(u,R.CodeAST),P(u,[{key:"__getattr__",value:function(t){switch(t){case"item":return this.item;case"varname":return this.varname;case"container":return this.container;case"condition":return this.condition;default:return I(O(u.prototype),"__getattr__",this).call(this,t)}}},{key:"_repr",value:function(t){t.push("<SetCompAST"),t.push(" item="),this.item._repr(t),t.push(" varname="),this.varname._repr(t),t.push(" container="),this.container._repr(t),null!==this.condition&&(t.push(" condition="),this.condition._repr(t)),t.push(">")}},{key:"_eval",value:function(t){for(var e=this.container._handle_eval(t),r=t.inheritvars(),n=R._emptyset(),o=R._iter(e);;){var i=o.next();if(i.done)break;for(var a=R._unpackvar(this.varname,i.value),u=0;u<a.length;++u){var s=F(a[u],2),l=s[0],c=s[1];l._handle_eval_set(r,c)}(null===this.condition||R._bool(this.condition._handle_eval(r)))&&n.add(this.item._handle_eval(r))}return n}}]),u}(),R.SetCompAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["item","varname","container","condition"]),R.DictAST=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,t,e))).items=[],r}return L(n,R.CodeAST),P(n,[{key:"__getattr__",value:function(t){switch(t){case"items":return this.items;default:return I(O(n.prototype),"__getattr__",this).call(this,t)}}},{key:"_repr",value:function(t){t.push("<DictAST");for(var e=0;e<this.items.length;++e){var r=this.items[e];t.push(" "),r._repr(t)}t.push(">")}},{key:"_eval",value:function(t){for(var e=R._emptymap(),r=0;r<this.items.length;++r){this.items[r]._handle_eval_dict(t,e)}return e}}]),n}(),R.DictAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["items"]),R.DictCompAST=function(t){function s(t,e,r,n,o,i,a){var u;return E(this,s),(u=V(this,O(s).call(this,t,e))).key=r,u.value=n,u.varname=o,u.container=i,u.condition=a,u}return L(s,R.CodeAST),P(s,[{key:"_repr",value:function(t){t.push("<DictCompAST"),t.push(" key="),this.key._repr(t),t.push(" value="),this.value._repr(t),t.push(" varname="),this.varname._repr(t),t.push(" container="),this.container._repr(t),null!==this.condition&&(t.push(" condition="),this.condition._repr(t)),t.push(">")}},{key:"_eval",value:function(t){for(var e=this.container._handle_eval(t),r=t.inheritvars(),n=R._emptymap(),o=R._iter(e);;){var i=o.next();if(i.done)break;for(var a=R._unpackvar(this.varname,i.value),u=0;u<a.length;++u){var s=F(a[u],2),l=s[0],c=s[1];l._handle_eval_set(r,c)}if(null===this.condition||R._bool(this.condition._handle_eval(r))){var h=this.key._handle_eval(r);c=this.value._handle_eval(r);R._setmap(n,h,c)}}return n}}]),s}(),R.DictCompAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["key","value","varname","container","condition"]),R.GenExprAST=function(t){function u(t,e,r,n,o,i){var a;return E(this,u),(a=V(this,O(u).call(this,t,e))).item=r,a.varname=n,a.container=o,a.condition=i,a}return L(u,R.CodeAST),P(u,[{key:"_repr",value:function(t){t.push("<GenExprAST"),t.push(" item="),this.item._repr(t),t.push(" varname="),this.varname._repr(t),t.push(" container="),this.container._repr(t),null!==this.condition&&(t.push(" condition="),this.condition._repr(t)),t.push(">")}},{key:"_eval",value:function(t){var e=this.container._handle_eval(t),a=R._iter(e),u=t.inheritvars(),s=this;return{next:function(){for(;;){var t=a.next();if(t.done)return t;for(var e=R._unpackvar(s.varname,t.value),r=0;r<e.length;++r){var n=F(e[r],2),o=n[0],i=n[1];o._handle_eval_set(u,i)}if(null===s.condition||R._bool(s.condition._handle_eval(u)))return{value:i=s.item._handle_eval(u),done:!1}}}}}}]),u}(),R.GenExprAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["item","varname","container","condition"]),R.VarAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).name=r,n}return L(o,R.CodeAST),P(o,[{key:"_repr",value:function(t){t.push("<VarAST name="),t.push(R._repr(this.name)),t.push(">")}},{key:"_eval",value:function(t){return this._get(t,this.name)}},{key:"_eval_set",value:function(t,e){this._set(t,this.name,e)}},{key:"_eval_modify",value:function(t,e,r){this._modify(t,e,this.name,r)}},{key:"_get",value:function(t,e){var r=t.get(e);return void 0===r&&(r=R.functions[e]),r}},{key:"_set",value:function(t,e,r){t.set(e,r)}},{key:"_modify",value:function(t,e,r,n){var o=e._ido(t.get(r),n);t.set(r,o)}}]),o}(),R.VarAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["name"]),R.UnaryAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).obj=r,n}return L(o,R.CodeAST),P(o,[{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(" obj="),this.obj._repr(t),t.push(">")}},{key:"_eval",value:function(t){var e=this.obj._handle_eval(t);return this._do(e)}}]),o}(),R.UnaryAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["obj"]),R.NegAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_do",value:function(t){return null!==t&&"function"==typeof t.__neg__?t.__neg__():-t}}]),e}(),R.BitNotAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_do",value:function(t){return-t-1}}]),e}(),R.NotAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_do",value:function(t){return!R._bool(t)}}]),e}(),R.IfAST=function(t){function a(t,e,r,n,o){var i;return E(this,a),(i=V(this,O(a).call(this,t,e))).objif=r,i.objcond=n,i.objelse=o,i}return L(a,R.CodeAST),P(a,[{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(1),t.push("objif="),this.objif._repr(t),t.push(0),t.push("objcond="),this.objcond._repr(t),t.push(0),t.push("objelse="),this.objelse._repr(t),t.push(-1),t.push(">")}},{key:"_eval",value:function(t){var e=this.objcond._handle_eval(t);return R._bool(e)?this.objif._handle_eval(t):this.objelse._handle_eval(t)}}]),a}(),R.IfAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["objif","objcond","objelse"]),R.ReturnAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_eval",value:function(t){var e=this.obj._handle_eval(t);throw new R.ReturnException(e)}},{key:"_str",value:function(t){t.push("return "),this.obj._str(t)}}]),e}(),R.PrintAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_eval",value:function(t){var e=this.obj._handle_eval(t),r=R._str(e);t.output(r)}},{key:"_str",value:function(t){t.push("print "),this.obj._str(t)}}]),e}(),R.PrintXAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.UnaryAST),P(e,[{key:"_eval",value:function(t){var e=this.obj._handle_eval(t),r=R._xmlescape(e);t.output(r)}},{key:"_str",value:function(t){t.push("printx "),this.obj._str(t)}}]),e}(),R.BinaryAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).obj1=r,o.obj2=n,o}return L(i,R.CodeAST),P(i,[{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(" obj1="),this.obj1._repr(t),t.push(" obj2="),this.obj2._repr(t),t.push(">")}},{key:"_eval",value:function(t){var e=this.obj1._handle_eval(t),r=this.obj2._handle_eval(t);return this._do(e,r)}}]),i}(),R.BinaryAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["obj1","obj2"]),R.ItemAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return this._get(t,e)}},{key:"_eval_set",value:function(t,e){var r=this.obj1._handle_eval(t),n=this.obj2._handle_eval(t);this._set(r,n,e)}},{key:"_eval_modify",value:function(t,e,r){var n=this.obj1._handle_eval(t),o=this.obj2._handle_eval(t);this._modify(e,n,o,r)}},{key:"_get",value:function(t,e){if("string"==typeof t||R._islist(t)){if(e instanceof R.slice){var r=e.start,n=e.stop;return null==r&&(r=0),null==n&&(n=t.length),t.slice(r,n)}var o=e;if(e<0&&(e+=t.length),e<0||e>=t.length)throw new R.IndexError(t,o);return t[e]}if(t&&"function"==typeof t.__getitem__)return t.__getitem__(e);if(R._ismap(t))return t.get(e);throw new R.TypeError(R._type(t)+" object is not subscriptable")}},{key:"_set",value:function(t,e,r){if(R._islist(t))if(e instanceof R.slice){var n=e.start,o=e.stop;null===n?n=0:n<0&&(n+=t.length),n<0?n=0:n>t.length&&(n=t.length),null===o?o=t.length:o<0&&(o+=t.length),o<0?o=0:o>t.length&&(o=t.length),o<n&&(o=n),t.splice(n,o-n);for(var i=R._iter(r);;){var a=i.next();if(a.done)break;t.splice(n++,0,a.value)}}else{var u=e;if(e<0&&(e+=t.length),e<0||e>=t.length)throw new R.IndexError(t,u);t[e]=r}else if(t&&"function"==typeof t.__setitem__)t.__setitem__(e,r);else if(R._ismap(t))t.set(e,r);else{if(!R._isobject(t))throw new R.NotSubscriptableError(t);t[e]=r}}},{key:"_modify",value:function(t,e,r,n){this._set(e,r,t._ido(this._get(e,r),n))}}]),e}(),R.IsAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return t===e}}]),e}(),R.IsNotAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return t!==e}}]),e}(),R.EQAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._eq(t,e)}}]),e}(),R.NEAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._ne(t,e)}}]),e}(),R.LTAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._lt(t,e)}}]),e}(),R.LEAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._le(t,e)}}]),e}(),R.GTAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._gt(t,e)}}]),e}(),R.GEAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._ge(t,e)}}]),e}(),R.ContainsAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if("string"==typeof t&&"string"==typeof e)return-1!==e.indexOf(t);if(R._islist(e))return-1!==e.indexOf(t);if(e&&"function"==typeof e.__contains__)return e.__contains__(t);if(R._ismap(e)||R._isset(e))return e.has(t);if(R._isobject(e)){for(var r in e)if(r===t)return!0;return!1}if(R._iscolor(e))return e._r===t||e._g===t||e._b===t||e._a===t;throw new R.TypeError(R._type(e)+" object is not iterable")}}]),e}(),R.NotContainsAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return!R.ContainsAST.prototype._do(t,e)}}]),e}(),R.AddAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(t&&"function"==typeof t.__add__)return t.__add__(e);if(e&&"function"==typeof e.__radd__)return e.__radd__(t);if(null===t||null===e)throw new R.TypeError(R._type(this.obj1)+" + "+R._type(this.obj2)+" is not supported");return R._islist(t)&&R._islist(e)?N(t).concat(N(e)):t+e}},{key:"_ido",value:function(t,e){return R._islist(t)&&R._islist(e)?(R.ListProtocol.append(t,e),t):this._do(t,e)}}]),e}(),R.SubAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(t&&"function"==typeof t.__sub__)return t.__sub__(e);if(e&&"function"==typeof e.__rsub__)return e.__rsub__(t);if(R._isdate(t)&&R._isdate(e))return this._date_sub(t,e);if(R._isdatetime(t)&&R._isdatetime(e))return this._datetime_sub(t,e);if(null===t||null===e)throw new R.TypeError(R._type(this.obj1)+" - "+R._type(this.obj2)+" is not supported");return t-e}},{key:"_date_sub",value:function(t,e){return this._datetime_sub(t._date,e._date)}},{key:"_datetime_sub",value:function(t,e){var r=t<e;if(r){var n=t;t=e,e=n}for(var o=t.getFullYear(),i=R.DateTimeProtocol.yearday(t),a=e.getFullYear(),u=R.DateTimeProtocol.yearday(e),s=0;a<o;)s+=R.DateProtocol.yearday(R._date(a,12,31)),++a;s+=i-u;var l=t.getHours(),c=t.getMinutes(),h=t.getSeconds(),p=e.getHours(),_=e.getMinutes(),f=h-e.getSeconds()+60*(c-_+60*(l-p)),d=t.getMilliseconds()-e.getMilliseconds();return r&&(s=-s,f=-f,d=-d),new R.TimeDelta(s,f,1e3*d)}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.MulAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(t&&"function"==typeof t.__mul__)return t.__mul__(e);if(e&&"function"==typeof e.__rmul__)return e.__rmul__(t);if(null===t||null===e)throw new R.TypeError(R._type(t)+" * "+R._type(e)+" not supported");if(R._isint(t)||R._isbool(t)){if("string"==typeof e){if(t<0)throw new R.ValueError("repetition counter must be positive");return R._str_repeat(e,t)}if(R._islist(e)){if(t<0)throw new R.ValueError("repetition counter must be positive");return R._list_repeat(e,t)}}else if(R._isint(e)||R._isbool(e)){if("string"==typeof t){if(e<0)throw new R.ValueError("repetition counter must be positive");return R._str_repeat(t,e)}if(R._islist(t)){if(e<0)throw new R.ValueError("repetition counter must be positive");return R._list_repeat(t,e)}}return t*e}},{key:"_ido",value:function(t,e){if(R._islist(t)&&R._isint(e)){if(0<e)for(var r=0,n=t.length*e;t.length<n;)t.push(t[r++]);else t.splice(0,t.length);return t}return this._do(t,e)}}]),e}(),R.FloorDivAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(t&&"function"==typeof t.__floordiv__)return t.__floordiv__(e);if(e&&"function"==typeof e.__rfloordiv__)return e.__rfloordiv__(t);if(null===t||null===e)throw new R.TypeError(R._type(t)+" // "+R._type(e)+" not supported");if("number"==typeof t&&"number"==typeof e&&0===e)throw new R.ZeroDivisionError;return Math.floor(t/e)}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.TrueDivAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(t&&"function"==typeof t.__truediv__)return t.__truediv__(e);if(e&&"function"==typeof e.__rtruediv__)return e.__rtruediv__(t);if(null===t||null===e)throw new R.TypeError(R._type(t)+" / "+R._type(e)+" not supported");if("number"==typeof t&&"number"==typeof e&&0===e)throw new R.ZeroDivisionError;return t/e}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.ModAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return R._mod(t,e)}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.ShiftLeftAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(!1===e?e=0:!0===e&&(e=1),e<0)return R.ShiftRightAST.prototype._do(t,-e);for(!1===t?t=0:!0===t&&(t=1);e--;)t*=2;return t}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.ShiftRightAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){if(!1===e?e=0:!0===e&&(e=1),e<0)return R.ShiftLeftAST.prototype._do(t,-e);for(!1===t?t=0:!0===t&&(t=1);e--;)t/=2;return Math.floor(t)}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.BitAndAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return!1===e?e=0:!0===e&&(e=1),t&e}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.BitXOrAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return!1===e?e=0:!0===e&&(e=1),t^e}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.BitOrAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_do",value:function(t,e){return!1===e?e=0:!0===e&&(e=1),t|e}},{key:"_ido",value:function(t,e){return this._do(t,e)}}]),e}(),R.AndAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_eval",value:function(t){var e=this.obj1._handle_eval(t);return R._bool(e)?this.obj2._handle_eval(t):e}}]),e}(),R.OrAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BinaryAST),P(e,[{key:"_eval",value:function(t){var e=this.obj1._handle_eval(t);return R._bool(e)?e:this.obj2._handle_eval(t)}}]),e}(),R.AttrAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).obj=r,o.attrname=n,o}return L(i,R.CodeAST),P(i,[{key:"_repr",value:function(t){t.push("<AttrAST"),t.push(" obj="),this.obj._repr(t),t.push(" attrname="),t.push(R._repr(this.attrname)),t.push(">")}},{key:"_eval",value:function(t){var e=this.obj._handle_eval(t);return this._get(e,this.attrname)}},{key:"_eval_set",value:function(t,e){var r=this.obj._handle_eval(t);this._set(r,this.attrname,e)}},{key:"_eval_modify",value:function(t,e,r){var n=this.obj._handle_eval(t);this._modify(e,n,this.attrname,r)}},{key:"_get",value:function(e,t){var r=R.Protocol.get(e);try{return r.getattr(e,t)}catch(t){if(t instanceof R.AttributeError&&t.obj===e)return;throw t}}},{key:"_set",value:function(t,e,r){if("object"===M(t)&&"function"==typeof t.__setattr__)t.__setattr__(e,r);else if(R._ismap(t))t.set(e,r);else{if(!R._isobject(t))throw new R.TypeError(R._type(t)+" object has no writable attributes");t[e]=r}}},{key:"_modify",value:function(t,e,r,n){var o=this._get(e,r),i=t._ido(o,n);this._set(e,r,i)}}]),i}(),R.AttrAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["obj","attrname"]),R.CallAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).obj=r,o.args=n,o}return L(i,R.CodeAST),P(i,[{key:"_repr",value:function(t){t.push("<CallAST"),t.push(" obj="),this.obj._repr(t);for(var e=0;e<this.args.length;++e){var r=this.args[e];t.push(" "),r._repr(t)}t.push(">")}},{key:"_makeargs",value:function(t){for(var e=[],r={},n=0;n<this.args.length;++n){this.args[n]._handle_eval_call(t,e,r)}return{args:e,kwargs:r}}},{key:"_handle_eval",value:function(t){try{return this._eval(t)}catch(t){throw this._decorate_exception(t),t}}},{key:"_eval",value:function(t){var e=this.obj._handle_eval(t),r=this._makeargs(t);return R._call(t,e,r.args,r.kwargs)}}]),i}(),R.CallAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["obj","args"]),R.RenderAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e,r,n))).indent=null,o}return L(i,R.CallAST),P(i,[{key:"_repr",value:function(t){t.push("<"),t.push(this._reprname),t.push("<RenderAST"),t.push(" indent="),t.push(R._repr(this.indent)),t.push(" obj="),this.obj._repr(t),t.push(0);for(var e=0;e<this.args.length;++e){var r=this.args[e];t.push(" "),r._repr(t),t.push(0)}t.push(-1),t.push(">")}},{key:"_str",value:function(t){t.push("render "),t.push(this.tag.code.replace(/\r?\n/g," ")),null!==this.indent&&(t.push(" with indent "),t.push(R._repr(this.indent.text)))}},{key:"_handle_eval",value:function(t){var e=t.withindent(null!==this.indent?this.indent.text:null),r=this.obj._handle_eval(e),n=this._makeargs(e);this._handle_additional_arguments(e,n);try{return R._callrender(e,r,n.args,n.kwargs)}catch(t){throw this._decorate_exception(t),t}}},{key:"_handle_additional_arguments",value:function(t,e){}}]),i}(),R.RenderAST.prototype._ul4onattrs=R.CallAST.prototype._ul4onattrs.concat(["indent"]),R.RenderAST.prototype._reprname="RenderAST",R.RenderXAST=function(t){function r(){return E(this,r),V(this,O(r).apply(this,arguments))}return L(r,R.RenderAST),P(r,[{key:"_handle_eval",value:function(t){t.escapes.push(R._xmlescape);var e=null;try{e=I(O(r.prototype),"_handle_eval",this).call(this,t)}finally{t.escapes.splice(t.escapes.length-1,1)}return e}}]),r}(),R.RenderBlockAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.RenderAST),P(e,[{key:"_handle_additional_arguments",value:function(t,e){if(e.kwargs.hasOwnProperty("content"))throw new R.ArgumentError("duplicate keyword argument content");var r=new R.TemplateClosure(this.content,this.content.signature,t.vars);e.kwargs.content=r}}]),e}(),R.RenderBlockAST.prototype._ul4onattrs=R.RenderAST.prototype._ul4onattrs.concat(["content"]),R.RenderBlocksAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.RenderAST),P(e,[{key:"_handle_additional_arguments",value:function(t,e){var r=t.inheritvars();for(var n in R.BlockAST.prototype._eval.call(this,r),r.vars)if(r.vars.hasOwnProperty(n)){if(n in e.kwargs)throw new R.ArgumentError("duplicate keyword argument "+n);e.kwargs[n]=r.get(n)}}}]),e}(),R.RenderBlocksAST.prototype._ul4onattrs=R.RenderAST.prototype._ul4onattrs.concat(["content"]),R.slice=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this))).start=t,r.stop=e,r}return L(n,R.Proto),P(n,[{key:"of",value:function(t){var e=this.start||0,r=null===this.stop?t.length:this.stop;return t.slice(e,r)}},{key:"__repr__",value:function(){return"slice("+R._repr(this.start)+", "+R._repr(this.stop)+", None)"}},{key:"__getattr__",value:function(t){switch(t){case"start":return this.start;case"stop":return this.stop;default:throw new R.AttributeError(this,t)}}}]),n}(),R.SliceAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).index1=r,o.index2=n,o}return L(i,R.CodeAST),P(i,[{key:"_repr",value:function(t){t.push("<SliceAST"),null!==this.index1&&(t.push(" index1="),this.index1._repr(t)),null!==this.index2&&(t.push(" index2="),this.index2._repr(t)),t.push(">")}},{key:"_eval",value:function(t){var e=null!==this.index1?this.index1._handle_eval(t):null,r=null!==this.index2?this.index2._handle_eval(t):null;return new R.slice(e,r)}}]),i}(),R.SliceAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["index1","index2"]),R.SetVarAST=function(t){function i(t,e,r,n){var o;return E(this,i),(o=V(this,O(i).call(this,t,e))).lvalue=r,o.value=n,o}return L(i,R.CodeAST),P(i,[{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(" lvalue="),t.push(R._repr(this.lvalue)),t.push(" value="),this.value._repr(t),t.push(">")}},{key:"_eval",value:function(t){for(var e=this.value._handle_eval(t),r=R._unpackvar(this.lvalue,e),n=0;n<r.length;++n){var o=F(r[n],2),i=o[0],a=o[1];i._handle_eval_set(t,a)}}}]),i}(),R.SetVarAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["lvalue","value"]),R.ModifyVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.SetVarAST),P(e,[{key:"_eval",value:function(t){for(var e=this.value._handle_eval(t),r=R._unpackvar(this.lvalue,e),n=0;n<r.length;++n){var o=F(r[n],2),i=o[0],a=o[1];i._handle_eval_modify(t,this._operator,a)}}}]),e}(),R.AddVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.AddVarAST.prototype._operator=R.AddAST.prototype,R.SubVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.SubVarAST.prototype._operator=R.SubAST.prototype,R.MulVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.MulVarAST.prototype._operator=R.MulAST.prototype,R.TrueDivVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.TrueDivVarAST.prototype._operator=R.TrueDivAST.prototype,R.FloorDivVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.FloorDivVarAST.prototype._operator=R.FloorDivAST.prototype,R.ModVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.ModVarAST.prototype._operator=R.ModAST.prototype,R.ShiftLeftVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.ShiftLeftVarAST.prototype._operator=R.ShiftLeftAST.prototype,R.ShiftRightVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.ShiftRightVarAST.prototype._operator=R.ShiftRightAST.prototype,R.BitAndVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.BitAndVarAST.prototype._operator=R.BitAndAST.prototype,R.BitXOrVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.BitXOrVarAST.prototype._operator=R.BitXOrAST.prototype,R.BitOrVarAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ModifyVarAST),e}(),R.BitOrVarAST.prototype._operator=R.BitOrAST.prototype,R.BlockAST=function(t){function n(t,e){var r;return E(this,n),(r=V(this,O(n).call(this,t,e))).content=[],r}return L(n,R.CodeAST),P(n,[{key:"_eval",value:function(t){for(var e=0;e<this.content.length;++e){this.content[e]._handle_eval(t)}}},{key:"_str",value:function(t){if(this.content.length)for(var e=0;e<this.content.length;++e){this.content[e]._str(t),t.push(0)}else t.push("pass"),t.push(0)}}]),n}(),R.BlockAST.prototype._ul4onattrs=R.CodeAST.prototype._ul4onattrs.concat(["content"]),R.ForBlockAST=function(t){function l(t,e,r,n){var o;return E(this,l),(o=V(this,O(l).call(this,t,e))).varname=r,o.container=n,o}return L(l,R.BlockAST),P(l,[{key:"_repr",value:function(t){t.push("<ForBlockAST"),t.push(" varname="),t.push(R._repr(this.varname)),t.push(" container="),this.container._repr(t),t.push(">")}},{key:"_str_varname",value:function(t,e){if(R._islist(e)){t.push("(");for(var r=0;r<e.length;++r)r&&t.push(", "),this._str_varname(t,e[r]);1==e.length&&t.push(","),t.push(")")}else e._str(t)}},{key:"_eval",value:function(t){for(var e=this.container._handle_eval(t),r=R._iter(e);;){var n=r.next();if(n.done)break;for(var o=R._unpackvar(this.varname,n.value),i=0;i<o.length;++i){var a=F(o[i],2),u=a[0],s=a[1];u._handle_eval_set(t,s)}try{I(O(l.prototype),"_eval",this).call(this,t)}catch(t){if(t instanceof R.BreakException)break;if(!(t instanceof R.ContinueException))throw t}}}},{key:"_str",value:function(t){t.push("for "),this._str_varname(t,this.varname),t.push(" in "),this.container._str(t),t.push(":"),t.push(1),R.BlockAST.prototype._str.call(this,t),t.push(-1)}}]),l}(),R.ForBlockAST.prototype._ul4onattrs=R.BlockAST.prototype._ul4onattrs.concat(["varname","container"]),R.WhileBlockAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).condition=r,n}return L(o,R.BlockAST),P(o,[{key:"_repr",value:function(t){t.push("<WhileAST"),t.push(" condition="),this.condition._repr(t),t.push(">")}},{key:"_str",value:function(t){t.push("while "),this.condition._repr(t),t.push(":"),t.push(1),R.BlockAST.prototype._str.call(this,t),t.push(-1)}},{key:"_eval",value:function(t){for(;;){var e=this.condition._handle_eval(t);if(!R._bool(e))break;try{I(O(o.prototype),"_eval",this).call(this,t)}catch(t){if(t instanceof R.BreakException)break;if(!(t instanceof R.ContinueException))throw t}}}}]),o}(),R.WhileBlockAST.prototype._ul4onattrs=R.BlockAST.prototype._ul4onattrs.concat(["condition"]),R.BreakAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.CodeAST),P(e,[{key:"_eval",value:function(t){throw new R.BreakException}},{key:"_str",value:function(t){t.push("break"),t.push(0)}},{key:"_repr",value:function(t){t.push("<BreakAST>")}}]),e}(),R.ContinueAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.CodeAST),P(e,[{key:"_eval",value:function(t){throw new R.ContinueException}},{key:"_str",value:function(t){t.push("continue"),t.push(0)}},{key:"_repr",value:function(t){t.push("<ContinueAST>")}}]),e}(),R.CondBlockAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BlockAST),P(e,[{key:"_eval",value:function(t){for(var e=0;e<this.content.length;++e){var r=this.content[e];if(r._execute(t)){r._handle_eval(t);break}}}}]),e}(),R.ConditionalBlockAST=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this,t,e))).condition=r,n}return L(o,R.BlockAST),P(o,[{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(" condition="),this.condition._repr(t),t.push(">")}},{key:"_str",value:function(t){t.push(this._strname),t.push(" "),this.condition._str(t),t.push(":"),t.push(1),R.BlockAST.prototype._str.call(this,t),t.push(-1)}},{key:"_execute",value:function(t){var e=this.condition._handle_eval(t);return R._bool(e)}}]),o}(),R.ConditionalBlockAST.prototype._ul4onattrs=R.BlockAST.prototype._ul4onattrs.concat(["condition"]),R.IfBlockAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ConditionalBlockAST),e}(),R.IfBlockAST.prototype._strname="if",R.ElIfBlockAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.ConditionalBlockAST),e}(),R.ElIfBlockAST.prototype._strname="else if",R.ElseBlockAST=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,R.BlockAST),P(e,[{key:"_repr",value:function(t){t.push("<ElseAST"),t.push(">")}},{key:"_str",value:function(t){t.push("else:"),t.push(1),R.BlockAST.prototype._str.call(this,t),t.push(-1)}},{key:"_execute",value:function(t){return!0}}]),e}(),R.Template=function(t){function l(t,e,r,n,o,i,a,u){var s;return E(this,l),(s=V(this,O(l).call(this,t,e)))._source=r,s.name=n,s.whitespace=o,s.startdelim=i,s.enddelim=a,s.docpos=null,s.signature=u,s._asts=null,s._ul4_callsignature=u,s._ul4_rendersignature=u,s.parenttemplate=null,s}return L(l,R.BlockAST),P(l,[{key:"__getattr__",value:function(t){var r=this;switch(t){case"content":return this.content;case"source":return this.source;case"name":return this.name;case"whitespace":return this.whitespace;case"startdelim":return this.startdelim;case"enddelim":return this.enddelim;case"doc":return this.doc();case"signature":return this.signature;case"parenttemplate":return this.parenttemplate;case"render":var e=function(t,e){r._renderbound(t,e)};return R.expose(e,this.signature,{needscontext:!0,needsobject:!0}),e;case"renders":var n=function(t,e){return r._rendersbound(t,e)};return R.expose(n,this.signature,{needscontext:!0,needsobject:!0}),n;default:return I(O(l.prototype),"__getattr__",this).call(this,t)}}},{key:"ul4ondump",value:function(t){var e;if(t.dump(R.version),t.dump(this.name),t.dump(this._source),t.dump(this.whitespace),t.dump(this.startdelim),t.dump(this.enddelim),t.dump(this.docpos),t.dump(this.parenttemplate),null===this.signature||this.signature instanceof R.SignatureAST)e=this.signature;else{e=[];for(var r=0;r<this.signature.args.length;++r){var n=this.signature.args[r];void 0===n.defaultValue?e.push(n.name):e.push(n.name+"=",n.defaultValue)}null!==this.signature.remargs&&e.push("*"+this.signature.remargs),null!==this.signature.remkwargs&&e.push("**"+this.signature.remkwargs)}t.dump(e),I(O(l.prototype),"ul4ondump",this).call(this,t)}},{key:"ul4onload",value:function(t){var e,r=t.load();if(null===r)throw new R.ValueError("UL4ON doesn't support templates in 'source' format in Javascript implementation");if(r!==R.version)throw new R.ValueError("invalid version, expected "+R.version+", got "+r);this.name=t.load(),this._source=t.load(),this.whitespace=t.load(),this.startdelim=t.load(),this.enddelim=t.load(),this.docpos=t.load(),this.parenttemplate=t.load(),e=t.load(),R._islist(e)&&(e=q(R.Signature,N(e))),this.signature=e,this._ul4_callsignature=e,this._ul4_rendersignature=e,I(O(l.prototype),"ul4onload",this).call(this,t)}},{key:"loads",value:function(t){return R.loads(t)}},{key:"_eval",value:function(t){var e=null;null!==this.signature&&(e=this.signature._handle_eval(t));var r=new R.TemplateClosure(this,e,t.vars);t.set(this.name,r)}},{key:"_repr",value:function(t){t.push("<Template"),null!==this.name&&(t.push(" name="),t.push(R._repr(this.name))),t.push(" whitespace="),t.push(R._repr(this.whitespace)),"<?"!==this.startdelim&&(t.push(" startdelim="),t.push(R._repr(this.startdelim))),"?>"!==this.enddelim&&(t.push(" enddelim="),t.push(R._repr(this.enddelim))),t.push(">")}},{key:"_str",value:function(t){t.push("def "),t.push(this.name?this.name:"unnamed"),t.push(":"),t.push(1),R.BlockAST.prototype._str.call(this,t),t.push(-1)}},{key:"_renderbound",value:function(t,e){var r=t.clone();r.vars=e;try{R.BlockAST.prototype._eval.call(this,r)}catch(t){if(!(t instanceof R.ReturnException))throw t}}},{key:"__render__",value:function(t,e){this._renderbound(t,e)}},{key:"render",value:function(t,e){this._renderbound(t,e)}},{key:"_rendersbound",value:function(t,e){var r=t.replaceoutput();return this._renderbound(r,e),r.getoutput()}},{key:"renders",value:function(t){t=t||{};var e=new R.Context;return null!==this.signature&&(t=this.signature.bindObject(this.name,[],t)),this._rendersbound(e,t)}},{key:"doc",value:function(){return null!=this.docpos?this.docpos.of(this._source):null}},{key:"_callbound",value:function(t,e){var r=t.clone();r.vars=e;try{R.BlockAST.prototype._eval.call(this,r)}catch(t){if(t instanceof R.ReturnException)return t.result;throw t}return null}},{key:"call",value:function(t){t=t||{};var e=new R.Context;return null!==this.signature&&(t=this.signature.bindObject(this.name,[],t)),this._callbound(e,t)}},{key:"__call__",value:function(t,e){return this._callbound(t,e)}},{key:"ul4type",value:function(){return"template"}}]),l}(),R.Template.prototype._ul4_callneedsobject=!0,R.Template.prototype._ul4_callneedscontext=!0,R.Template.prototype._ul4_renderneedsobject=!0,R.Template.prototype._ul4_renderneedscontext=!0,R.SignatureAST=function(t){function o(t,e){var r;return E(this,o),(r=V(this,O(o).call(this,t,e))).params=[],r}return L(o,R.CodeAST),P(o,[{key:"ul4ondump",value:function(t){I(O(o.prototype),"ul4ondump",this).call(this,t);for(var e=[],r=0;r<this.params.length;++r){var n=this.params[r];null===n[1]?e.push(n[0]):e.push(n)}t.dump(e)}},{key:"ul4onload",value:function(t){I(O(o.prototype),"ul4onload",this).call(this,t);var e=t.load();this.params=[];for(var r=0;r<e.length;++r){var n=e[r];"string"==typeof n?this.params.push([n,null]):this.params.push(n)}}},{key:"_eval",value:function(t){for(var e=[],r=0;r<this.params.length;++r){var n=this.params[r];null===n[1]?e.push(n[0]):(e.push(n[0]+"="),e.push(n[1]._handle_eval(t)))}return q(R.Signature,e)}},{key:"_repr",value:function(t){t.push("<"),t.push(this.constructor.name),t.push(" params="),this.params._repr(t),t.push(">")}}]),o}(),R.TemplateClosure=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this))).template=t,n.signature=e,n.vars=r,n._ul4_callsignature=e,n._ul4_rendersignature=e,n.name=t.name,n.tag=t.tag,n.endtag=t.endtag,n._source=t._source,n.startdelim=t.startdelim,n.enddelim=t.enddelim,n.docpos=t.docpos,n.content=t.content,n}return L(o,R.Proto),P(o,[{key:"__render__",value:function(t,e){this.template._renderbound(t,R._inherit(this.vars,e))}},{key:"render",value:function(t,e){this.template._renderbound(t,R._inherit(this.vars,e))}},{key:"__call__",value:function(t,e){return this.template._callbound(t,R._inherit(this.vars,e))}},{key:"_renderbound",value:function(t,e){this.template._renderbound(t,R._inherit(this.vars,e))}},{key:"_rendersbound",value:function(t,e){return this.template._rendersbound(t,R._inherit(this.vars,e))}},{key:"__getattr__",value:function(t){var r=this;switch(t){case"render":var e=function(t,e){r._renderbound(t,e)};return R.expose(e,this.signature,{needscontext:!0,needsobject:!0}),e;case"renders":var n=function(t,e){return r._rendersbound(t,e)};return R.expose(n,this.signature,{needscontext:!0,needsobject:!0}),n;case"signature":return this.signature;default:return this.template.__getattr__(t)}}},{key:"ul4type",value:function(){return"template"}}]),o}(),R.TemplateClosure.prototype._ul4_callneedsobject=!0,R.TemplateClosure.prototype._ul4_callneedscontext=!0,R.TemplateClosure.prototype._ul4_renderneedsobject=!0,R.TemplateClosure.prototype._ul4_renderneedscontext=!0,R._rgb=function(t,e,r,n){return new this.Color(255*t,255*e,255*r,255*n)},R._xmlescape=function(t){return t=(t=(t=(t=(t=(t=R._str(t)).replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")).replace(/"/g,"&quot;")},R._csv=function(t){return null===t?"":("string"!=typeof t&&(t=R._repr(t)),-1===t.indexOf(",")&&-1===t.indexOf('"')&&-1===t.indexOf("\n")||(t='"'+t.replace(/"/g,'""')+'"'),t)},R._chr=function(t){if("number"!=typeof t)throw new R.TypeError("chr() requires an int");return String.fromCharCode(t)},R._ord=function(t){if("string"!=typeof t||1!=t.length)throw new R.TypeError("ord() requires a string of length 1");return t.charCodeAt(0)},R._hex=function(t){if("number"!=typeof t)throw new R.TypeError("hex() requires an int");return t<0?"-0x"+t.toString(16).substr(1):"0x"+t.toString(16)},R._oct=function(t){if("number"!=typeof t)throw new R.TypeError("oct() requires an int");return t<0?"-0o"+t.toString(8).substr(1):"0o"+t.toString(8)},R._bin=function(t){if("number"!=typeof t)throw new R.TypeError("bin() requires an int");return t<0?"-0b"+t.toString(2).substr(1):"0b"+t.toString(2)},R._min=function(t){if(0==t.length)throw new R.ArgumentError("min() requires at least 1 argument, 0 given");1==t.length&&(t=t[0]);for(var e,r=R._iter(t),n=!0;;){var o=r.next();if(o.done){if(n)throw new R.ValueError("min() argument is an empty sequence!");return e}(n||o.value<e)&&(e=o.value),n=!1}},R._max=function(t){if(0==t.length)throw new R.ArgumentError("max() requires at least 1 argument, 0 given");1==t.length&&(t=t[0]);for(var e,r=R._iter(t),n=!0;;){var o=r.next();if(o.done){if(n)throw new R.ValueError("max() argument is an empty sequence!");return e}(n||o.value>e)&&(e=o.value),n=!1}},R._sum=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=R._iter(t);;){var n=r.next();if(n.done)break;e+=n.value}return e},R._first=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=R._iter(t).next();return r.done?e:r.value},R._last=function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=R._iter(t);;){var n=r.next();if(n.done)break;e=n.value}return e},R._sorted=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(null===r){var o=n?function(t,e){return-R._cmp("<=>",t,e)}:function(t,e){return R._cmp("<=>",t,e)},i=R._list(e);return i.sort(o),i}for(var a=[],u=0,s=R._iter(e);;++u){var l=s.next();if(l.done)break;var c=R._call(t,r,[l.value],{});a.push([c,n?-u:u,l.value])}cmp=function(t,e){var r=R._cmp("<=>",t[0],e[0]);return r||(r=R._cmp("<=>",t[1],e[1])),n?-r:r},a.sort(cmp);for(var h=[],p=0;p<a.length;++p){var _=a[p];h.push(_[2])}return h},R._range=function(t){var e,r,n,o,i;if(t.length<1)throw new R.ArgumentError("required range() argument missing");if(3<t.length)throw new R.ArgumentError("range() expects at most 3 positional arguments, "+t.length+" given");if(1==t.length?(r=t[e=0],n=1):2==t.length?(e=t[0],r=t[1],n=1):3==t.length&&(e=t[0],r=t[1],n=t[2]),0===n)throw new R.ValueError("range() requires a step argument != 0");i=0<n?(o=e,r):(o=r,e);var a=o<i?Math.floor((i-o-1)/Math.abs(n))+1:0;return{index:0,next:function(){return this.index>=a?{done:!0}:{value:e+this.index++*n,done:!1}}}},R._slice=function(t){var e,r,n,o;if(t.length<2)throw new R.ArgumentError("required slice() argument missing");if(4<t.length)throw new R.ArgumentError("slice() expects at most 4 positional arguments, "+t.length+" given");if(2==t.length?(e=t[0],r=0,n=t[1],o=1):3==t.length?(e=t[0],r=null!==t[1]?t[1]:0,n=t[2],o=1):4==t.length&&(e=t[0],r=null!==t[1]?t[1]:0,n=t[2],o=null!==t[3]?t[3]:1),r<0)throw new R.ValueError("slice() requires a start argument >= 0");if(n<0)throw new R.ValueError("slice() requires a stop argument >= 0");if(o<=0)throw new R.ValueError("slice() requires a step argument > 0");var i=r,a=0,u=R._iter(e);return{next:function(){for(var t;a<i;){if((t=u.next()).done)return t;++a}return null!==n&&n<=a?{done:!0}:((t=u.next()).done||(++a,i+=o,null!==n&&n<i&&(i=n)),t)}}},R._urlquote=function(t){return encodeURIComponent(t)},R._urlunquote=function(t){return decodeURIComponent(t)},R._reversed=function(t){return"string"==typeof t||R._islist(t)||(t=R._list(t)),{index:t.length-1,next:function(){return 0<=this.index?{value:t[this.index--],done:!1}:{done:!0}}}},R._random=function(){return Math.random()},R._randrange=function(t){var e,r,n;if(t.length<1)throw new R.ArgumentError("required randrange() argument missing");if(3<t.length)throw new R.ArgumentError("randrange() expects at most 3 positional arguments, "+t.length+" given");1==t.length?(r=t[e=0],n=1):2==t.length?(e=t[0],r=t[1],n=1):3==t.length&&(e=t[0],r=t[1],n=t[2]);var o,i=r-e,a=Math.random();if(0<n)o=Math.floor((i+n-1)/n);else{if(!(n<0))throw new R.ValueError("randrange() requires a step argument != 0");o=Math.floor((i+n+1)/n)}return e+n*Math.floor(a*o)},R._randchoice=function(t){var e=R._iscolor(t);if("string"!=typeof t&&!R._islist(t)&&!e)throw new R.TypeError("randchoice() requires a string or list");return e&&(t=R._list(t)),t[Math.floor(Math.random()*t.length)]},R._round=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(e){var r=Math.pow(10,e);return Math.round(t*r)/r}return Math.round(t)},R._md5=Y?function(t){return require("blueimp-md5")(t)}:function(t){return md5(t)},R._enumerate=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return{iter:R._iter(t),index:e,next:function(){var t=this.iter.next();return t.done?t:{value:[this.index++,t.value],done:!1}}}},R._isfirst=function(t){var r=R._iter(t),n=!0;return{next:function(){var t=r.next(),e=t.done?t:{value:[n,t.value],done:!1};return n=!1,e}}},R._islast=function(t){var r=R._iter(t),n=r.next();return{next:function(){if(n.done)return n;var t=r.next(),e={value:[t.done,n.value],done:!1};return n=t,e}}},R._isfirstlast=function(t){var r=R._iter(t),n=!0,o=r.next();return{next:function(){if(o.done)return o;var t=r.next(),e={value:[n,t.done,o.value],done:!1};return o=t,n=!1,e}}},R._enumfl=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=R._iter(t),n=e,o=!0,i=r.next();return{next:function(){if(i.done)return i;var t=r.next(),e={value:[n++,o,t.done,i.value],done:!1};return i=t,o=!1,e}}},R._zip=function(t){if(t.length){for(var n=[],e=0;e<t.length;++e)n.push(R._iter(t[e]));return{next:function(){for(var t=[],e=0;e<n.length;++e){var r=n[e].next();if(r.done)return r;t.push(r.value)}return{value:t,done:!1}}}}return{next:function(){return{done:!0}}}},R._abs=function(t){return null!==t&&"function"==typeof t.__abs__?t.__abs__():Math.abs(t)},R._date=function(t,e,r){return new R.Date(t,e,r)},R._datetime=function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0;return new Date(t,e-1,r,n,o,i,a/1e3)},R._timedelta=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return new this.TimeDelta(t,e,r)},R._monthdelta=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return new this.MonthDelta(t)},R._hls=function(t,e,r,n){var o,i,a=function(t,e,r){return(r%=1)<1/6?t+(e-t)*r*6:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t};return void 0===n&&(n=1),0===r?R._rgb(e,e,e,n):(o=2*e-(i=e<=.5?e*(1+r):e+r-e*r),R._rgb(a(o,i,t+1/3),a(o,i,t),a(o,i,t-1/3),n))},R._hsv=function(t,e,r,n){if(0===e)return R._rgb(r,r,r,n);var o=Math.floor(6*t),i=6*t-o,a=r*(1-e),u=r*(1-e*i),s=r*(1-e*(1-i));switch(o%6){case 0:return R._rgb(r,s,a,n);case 1:return R._rgb(u,r,a,n);case 2:return R._rgb(a,r,s,n);case 3:return R._rgb(a,u,r,n);case 4:return R._rgb(s,a,r,n);case 5:return R._rgb(r,a,u,n)}},R._get=function(t,e,r){if(R._ismap(t))return t.has(e)?t.get(e):r;if(R._isobject(t)){var n=t[e];return void 0===n?r:n}throw new R.TypeError("get() requires a dict")},R.now=function(){return new Date},R.utcnow=function(){var t=new Date;return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())},R.today=function(){var t=new Date;return new R.Date(t.getFullYear(),t.getMonth()+1,t.getDate())},R.functions={repr:R._repr,ascii:R._ascii,str:R._str,int:R._int,float:R._float,list:R._list,set:R._set,bool:R._bool,len:R._len,type:R._type,format:R._format,any:R._any,all:R._all,zip:R._zip,getattr:R._getattr,hasattr:R._hasattr,dir:R._dir,isundefined:R._isundefined,isdefined:R._isdefined,isnone:R._isnone,isbool:R._isbool,isint:R._isint,isfloat:R._isfloat,isstr:R._isstr,isdate:R._isdate,isdatetime:R._isdatetime,iscolor:R._iscolor,istimedelta:R._istimedelta,ismonthdelta:R._ismonthdelta,istemplate:R._istemplate,isfunction:R._isfunction,islist:R._islist,isset:R._isanyset,isdict:R._isdict,isexception:R._isexception,asjson:R._asjson,fromjson:R._fromjson,asul4on:R._asul4on,fromul4on:R._fromul4on,now:R.now,utcnow:R.utcnow,today:R.today,enumerate:R._enumerate,isfirst:R._isfirst,islast:R._islast,isfirstlast:R._isfirstlast,enumfl:R._enumfl,abs:R._abs,date:R._date,datetime:R._datetime,timedelta:R._timedelta,monthdelta:R._monthdelta,rgb:R._rgb,hls:R._hls,hsv:R._hsv,xmlescape:R._xmlescape,csv:R._csv,chr:R._chr,ord:R._ord,hex:R._hex,oct:R._oct,bin:R._bin,min:R._min,max:R._max,sum:R._sum,first:R._first,last:R._last,sorted:R._sorted,range:R._range,slice:R._slice,urlquote:R._urlquote,urlunquote:R._urlunquote,reversed:R._reversed,random:R._random,randrange:R._randrange,randchoice:R._randchoice,round:R._round,md5:R._md5},R.expose(R._repr,["obj"],{name:"repr"}),R.expose(R._ascii,["obj"],{name:"ascii"}),R.expose(R._str,["obj=",""],{name:"str"}),R.expose(R._int,["obj=",0,"base=",null],{name:"int"}),R.expose(R._float,["obj=",0],{name:"float"}),R.expose(R._list,["iterable=",[]],{name:"list"}),R.expose(R._set,["iterable=",[]],{name:"set"}),R.expose(R._bool,["obj=",!1],{name:"bool"}),R.expose(R._len,["sequence"],{name:"len"}),R.expose(R._type,["obj"],{name:"type"}),R.expose(R._format,["obj","fmt","lang=",null],{name:"format"}),R.expose(R._any,["iterable"],{name:"any"}),R.expose(R._all,["iterable"],{name:"all"}),R.expose(R._zip,["*iterables"],{name:"zip"}),R.expose(R._getattr,["obj","attrname","default=",null],{name:"getattr"}),R.expose(R._hasattr,["obj","attrname"],{name:"hasattr"}),R.expose(R._dir,["obj"],{name:"dir"}),R.expose(R._isundefined,["obj"],{name:"isundefined"}),R.expose(R._isdefined,["obj"],{name:"isdefined"}),R.expose(R._isnone,["obj"],{name:"isnone"}),R.expose(R._isbool,["obj"],{name:"isbool"}),R.expose(R._isint,["obj"],{name:"isint"}),R.expose(R._isfloat,["obj"],{name:"isfloat"}),R.expose(R._isstr,["obj"],{name:"isstr"}),R.expose(R._isdate,["obj"],{name:"isdate"}),R.expose(R._isdatetime,["obj"],{name:"isdatetime"}),R.expose(R._iscolor,["obj"],{name:"iscolor"}),R.expose(R._istimedelta,["obj"],{name:"istimedelta"}),R.expose(R._ismonthdelta,["obj"],{name:"ismonthdelta"}),R.expose(R._istemplate,["obj"],{name:"istemplate"}),R.expose(R._isfunction,["obj"],{name:"isfunction"}),R.expose(R._islist,["obj"],{name:"islist"}),R.expose(R._isanyset,["obj"],{name:"isset"}),R.expose(R._isdict,["obj"],{name:"isdict"}),R.expose(R._isexception,["obj"],{name:"isexception"}),R.expose(R._asjson,["obj"],{name:"asjson"}),R.expose(R._fromjson,["string"],{name:"fromjson"}),R.expose(R._asul4on,["obj"],{name:"asul4on"}),R.expose(R._fromul4on,["string"],{name:"fromul4on"}),R.expose(R.now,[]),R.expose(R.utcnow,[]),R.expose(R.today,[]),R.expose(R._enumerate,["iterable","start=",0],{name:"enumerate"}),R.expose(R._isfirst,["iterable"],{name:"isfirst"}),R.expose(R._islast,["iterable"],{name:"islast"}),R.expose(R._isfirstlast,["iterable"],{name:"isfirstlast"}),R.expose(R._enumfl,["iterable","start=",0],{name:"enumfl"}),R.expose(R._abs,["number"],{name:"abs"}),R.expose(R._date,["year","month","day"],{name:"date"}),R.expose(R._datetime,["year","month","day","hour=",0,"minute=",0,"second=",0,"microsecond=",0],{name:"datetime"}),R.expose(R._timedelta,["days=",0,"seconds=",0,"microseconds=",0],{name:"timedelta"}),R.expose(R._monthdelta,["months=",0],{name:"monthdelta"}),R.expose(R._rgb,["r","g","b","a=",1],{name:"rgb"}),R.expose(R._hls,["h","l","s","a=",1],{name:"hls"}),R.expose(R._hsv,["h","s","v","a=",1],{name:"hsv"}),R.expose(R._xmlescape,["obj"],{name:"xmlescape"}),R.expose(R._csv,["obj"],{name:"csv"}),R.expose(R._chr,["i"],{name:"chr"}),R.expose(R._ord,["c"],{name:"ord"}),R.expose(R._hex,["number"],{name:"hex"}),R.expose(R._oct,["number"],{name:"oct"}),R.expose(R._bin,["number"],{name:"bin"}),R.expose(R._min,["*obj"],{name:"min"}),R.expose(R._max,["*obj"],{name:"max"}),R.expose(R._sum,["iterable","start=",0],{name:"sum"}),R.expose(R._first,["iterable","default=",null],{name:"first"}),R.expose(R._last,["iterable","default=",null],{name:"last"}),R.expose(R._sorted,["iterable","key=",null,"reverse=",!1],{name:"sorted",needscontext:!0}),R.expose(R._range,["*args"],{name:"range"}),R.expose(R._slice,["*args"],{name:"slice"}),R.expose(R._urlquote,["string"],{name:"urlquote"}),R.expose(R._urlunquote,["string"],{name:"urlunquote"}),R.expose(R._reversed,["sequence"],{name:"reversed"}),R.expose(R._random,[],{name:"random"}),R.expose(R._randrange,["*args"],{name:"randrange"}),R.expose(R._randchoice,["sequence"],{name:"randchoice"}),R.expose(R._round,["x","digit=",0],{name:"round"}),R.expose(R._md5,["string"],{name:"md5"}),R._count=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;if(r<0&&(r+=t.length),null===r&&(r=0),n<0&&(n+=t.length),null===n&&(n=t.length),R._isstr(t)&&!e.length){if(n<0||r>t.length||n<r)return 0;var o=n-r+1;return o>t.length+1&&(o=t.length+1),o}r=R._bound(r,t.length),n=R._bound(n,t.length);var i=0;if(R._islist(t)){for(var a=r;a<n;++a)R._eq(t[a],e)&&++i;return i}for(var u=r;-1!=(u=t.indexOf(e,u))&&!(u+e.length>n);)++i,u+=e.length;return i},R._find=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;r<0&&(r+=t.length),null===r&&(r=0),n<0&&(n+=t.length),null===n&&(n=t.length),r=R._bound(r,t.length),n=R._bound(n,t.length),0===r&&n===t.length||(t="string"==typeof t?t.substring(r,n):t.slice(r,n));var o=t.indexOf(e);return-1!==o&&(o+=r),o},R._rfind=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;r<0&&(r+=t.length),null===r&&(r=0),n<0&&(n+=t.length),null===n&&(n=t.length),r=R._bound(r,t.length),n=R._bound(n,t.length),0===r&&n===t.length||(t="string"==typeof t?t.substring(r,n):t.slice(r,n));var o=t.lastIndexOf(e);return-1!==o&&(o+=r),o},R._week4format=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;null===e?e=0:e%=7;var r=R.DateTimeProtocol.yearday(t)+6,n=new Date(t.getFullYear(),0,1).getDay();for(--n<0&&(n=6);n!=e;)--r,7==++n&&(n=0);return Math.floor(r/7)},R._isleap=function(t){return 1===new Date(t.getFullYear(),1,29).getMonth()},R._update=function(r,t,e){if(!R._isdict(r))throw new R.TypeError("update() requires a dict");for(var n=0;n<t.length;++n){var o=t[n];if(R._ismap(o))o.forEach(function(t,e){R._setmap(r,e,t)});else if(R._isobject(o))for(var i in o)R._setmap(r,i,o[i]);else{if(!R._islist(o))throw new R.TypeError("update() requires a dict or a list of (key, value) pairs");for(var a=0;a<o.length;++a){var u=o[a];if(!R._islist(u)||2!=u.length)throw new R.TypeError("update() requires a dict or a list of (key, value) pairs");R._setmap(r,u[0],u[1])}}}return e.forEach(function(t,e){R._setmap(r,e,t)}),null},R.Color=function(t){function i(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:255;return E(this,i),(t=V(this,O(i).call(this)))._r=e,t._g=r,t._b=n,t._a=o,t}return L(i,R.Proto),P(i,[{key:"__repr__",value:function(){var t=R._lpad(this._r.toString(16),"0",2),e=R._lpad(this._g.toString(16),"0",2),r=R._lpad(this._b.toString(16),"0",2),n=R._lpad(this._a.toString(16),"0",2);return 255!==this._a?t[0]===t[1]&&e[0]===e[1]&&r[0]===r[1]&&n[0]===n[1]?"#"+t[0]+e[0]+r[0]+n[0]:"#"+t+e+r+n:t[0]===t[1]&&e[0]===e[1]&&r[0]===r[1]?"#"+t[0]+e[0]+r[0]:"#"+t+e+r}},{key:"__str__",value:function(){if(255!==this._a)return"rgba("+this._r+", "+this._g+", "+this._b+", "+this._a/255+")";var t=R._lpad(this._r.toString(16),"0",2),e=R._lpad(this._g.toString(16),"0",2),r=R._lpad(this._b.toString(16),"0",2);return t[0]===t[1]&&e[0]===e[1]&&r[0]===r[1]?"#"+t[0]+e[0]+r[0]:"#"+t+e+r}},{key:"__iter__",value:function(){return{obj:this,index:0,next:function(){return 0==this.index?(++this.index,{value:this.obj._r,done:!1}):1==this.index?(++this.index,{value:this.obj._g,done:!1}):2==this.index?(++this.index,{value:this.obj._b,done:!1}):3==this.index?(++this.index,{value:this.obj._a,done:!1}):{done:!0}}}}},{key:"__getattr__",value:function(t){var e=this;switch(t){case"r":var r=function(){return e._r};return R.expose(r,[]),r;case"g":var n=function(){return e._g};return R.expose(n,[]),n;case"b":var o=function(){return e._b};return R.expose(o,[]),o;case"a":var i=function(){return e._a};return R.expose(i,[]),i;case"lum":var a=function(){return e.lum()};return R.expose(a,[]),a;case"hls":var u=function(){return e.hls()};return R.expose(u,[]),u;case"hlsa":var s=function(){return e.hlsa()};return R.expose(s,[]),s;case"hsv":var l=function(){return e.hsv()};return R.expose(l,[]),l;case"hsva":var c=function(){return e.hsva()};return R.expose(c,[]),c;case"witha":var h=function(t){return e.witha(t)};return R.expose(h,["a"]),h;case"withlum":var p=function(t){return e.withlum(t)};return R.expose(p,["lum"]),p;case"abslum":var _=function(t){return e.abslum(t)};return R.expose(_,["lum"]),_;case"rellum":var f=function(t){return e.rellum(t)};return R.expose(f,["lum"]),f;default:throw new R.AttributeError(this,t)}}},{key:"__getitem__",value:function(t){var e=t;switch(t<0&&(t+=4),t){case 0:return this._r;case 1:return this._g;case 2:return this._b;case 3:return this._a;default:throw new R.IndexError(this,e)}}},{key:"__eq__",value:function(t){return t instanceof R.Color&&(this._r==t._r&&this._g==t._g&&this._b==t._b&&this._a==t._a)}},{key:"r",value:function(){return this._r}},{key:"g",value:function(){return this._g}},{key:"b",value:function(){return this._b}},{key:"a",value:function(){return this._a}},{key:"lum",value:function(){return this.hls()[1]}},{key:"hls",value:function(){var t,e,r,n,o=this._r/255,i=this._g/255,a=this._b/255,u=Math.max(o,i,a),s=Math.min(o,i,a);return t=(s+u)/2,s==u?[0,t,0]:(e=(u-o)/(u-s),r=(u-i)/(u-s),n=(u-a)/(u-s),[(o==u?n-r:i==u?2+e-n:4+r-e)/6%1,t,t<=.5?(u-s)/(u+s):(u-s)/(2-u-s)])}},{key:"hlsa",value:function(){return this.hls().concat(this._a/255)}},{key:"hsv",value:function(){var t=this._r/255,e=this._g/255,r=this._b/255,n=Math.max(t,e,r),o=Math.min(t,e,r);if(o==n)return[0,0,n];var i=(n-t)/(n-o),a=(n-e)/(n-o),u=(n-r)/(n-o);return[(t==n?u-a:e==n?2+i-u:4+a-i)/6%1,(n-o)/n,n]}},{key:"hsva",value:function(){return this.hsv().concat(this._a/255)}},{key:"witha",value:function(t){if("number"!=typeof t)throw new R.TypeError("witha() requires a number");return new R.Color(this._r,this._g,this._b,t)}},{key:"withlum",value:function(t){if("number"!=typeof t)throw new R.TypeError("witha() requires a number");var e=this.hlsa();return R._hls(e[0],t,e[2],e[3])}},{key:"ul4type",value:function(){return"color"}}]),i}(),R.expose(R.Color.prototype.r,[]),R.expose(R.Color.prototype.g,[]),R.expose(R.Color.prototype.b,[]),R.expose(R.Color.prototype.a,[]),R.expose(R.Color.prototype.lum,[]),R.expose(R.Color.prototype.hls,[]),R.expose(R.Color.prototype.hlsa,[]),R.expose(R.Color.prototype.hsv,[]),R.expose(R.Color.prototype.hsva,[]),R.expose(R.Color.prototype.witha,["a"]),R.expose(R.Color.prototype.withlum,["lum"]);var z=Date;R.Date=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this)))._date=new z(t,e-1,r),n}return L(o,R.Proto),P(o,[{key:"__repr__",value:function(){return"@("+this.__str__()+")"}},{key:"__str__",value:function(){return R._lpad(this._date.getFullYear(),"0",4)+"-"+R._lpad(this._date.getMonth()+1,"0",2)+"-"+R._lpad(this._date.getDate(),"0",2)}},{key:"__eq__",value:function(t){return t instanceof R.Date&&this._date.getTime()===t._date.getTime()}},{key:"__lt__",value:function(t){if(t instanceof R.Date)return this._date<t._date;R._unorderable("<",this,t)}},{key:"__le__",value:function(t){if(t instanceof R.Date)return this._date<=t._date;R._unorderable("<=",this,t)}},{key:"__gt__",value:function(t){if(t instanceof R.Date)return this._date>t._date;R._unorderable(">",this,t)}},{key:"__ge__",value:function(t){if(t instanceof R.Date)return this._date>=t._date;R._unorderable(">=",this,t)}},{key:"year",value:function(){return this._date.getFullYear()}},{key:"month",value:function(){return this._date.getMonth()+1}},{key:"day",value:function(){return this._date.getDate()}},{key:"ul4type",value:function(){return"date"}}]),o}(),R.TimeDelta=function(t){function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;E(this,a),t=V(this,O(a).call(this));var o=Math.floor(1e6*(86400*e+r)+n);n=R.ModAST.prototype._do(o,1e6);var i=Math.floor(o/1e6);return r=R.ModAST.prototype._do(i,86400),e=Math.floor(i/86400),r<0&&(r+=86400,--e),t._microseconds=n,t._seconds=r,t._days=e,t}return L(a,R.Proto),P(a,[{key:"__repr__",value:function(){var t=[],e=!0;return t.push("timedelta("),this._days&&(t.push("days="+this._days),e=!1),this._seconds&&(e||t.push(", "),t.push("seconds="+this._seconds),e=!1),this._microseconds&&(e||t.push(", "),t.push("microseconds="+this._microseconds)),t.push(")"),t.join("")}},{key:"__str__",value:function(){var t=[];this._days&&(t.push(this._days+" day"),-1!==this._days&&1!==this._days&&t.push("s"),t.push(", "));var e=this._seconds%60,r=Math.floor(this._seconds/60),n=Math.floor(r/60);return r%=60,t.push(""+n),t.push(":"),t.push(R._lpad(r.toString(),"0",2)),t.push(":"),t.push(R._lpad(e.toString(),"0",2)),this._microseconds&&(t.push("."),t.push(R._lpad(this._microseconds.toString(),"0",6))),t.join("")}},{key:"__bool__",value:function(){return 0!==this._days||0!==this._seconds||0!==this._microseconds}},{key:"__abs__",value:function(){return this._days<0?new R.TimeDelta(-this._days,-this._seconds,-this._microseconds):this}},{key:"__eq__",value:function(t){return t instanceof R.TimeDelta&&(this._days===t._days&&this._seconds===t._seconds&&this._microseconds===t._microseconds)}},{key:"__lt__",value:function(t){if(t instanceof R.TimeDelta)return this._days!=t._days?this._days<t._days:this._seconds!=t._seconds?this._seconds<t._seconds:this._microseconds<t._microseconds;R._unorderable("<",this,t)}},{key:"__le__",value:function(t){if(t instanceof R.TimeDelta)return this._days!=t._days?this._days<t._days:this._seconds!=t._seconds?this._seconds<t._seconds:this._microseconds<=t._microseconds;R._unorderable("<=",this,t)}},{key:"__gt__",value:function(t){if(t instanceof R.TimeDelta)return this._days!=t._days?this._days>t._days:this._seconds!=t._seconds?this._seconds>t._seconds:this._microseconds>t._microseconds;R._unorderable(">",this,t)}},{key:"__ge__",value:function(t){if(t instanceof R.TimeDelta)return this._days!=t._days?this._days>t._days:this._seconds!=t._seconds?this._seconds>t._seconds:this._microseconds>=t._microseconds;R._unorderable(">=",this,t)}},{key:"__neg__",value:function(){return new R.TimeDelta(-this._days,-this._seconds,-this._microseconds)}},{key:"adddate",value:function(t,e){var r=t._date.getFullYear(),n=t._date.getMonth(),o=t._date.getDate()+e;return new R.Date(r,n,o)}},{key:"_adddatetime",value:function(t,e,r,n){var o=t.getFullYear(),i=t.getMonth(),a=t.getDate()+e,u=t.getHours(),s=t.getMinutes(),l=t.getSeconds()+r,c=t.getMilliseconds()+n/1e3;return new Date(o,i,a,u,s,l,c)}},{key:"__add__",value:function(t){if(t instanceof R.TimeDelta)return new R.TimeDelta(this._days+t._days,this._seconds+t._seconds,this._microseconds+t._microseconds);if(R._isdate(t))return this._adddate(t,this._days);if(R._isdatetime(t))return this._adddatetime(t,this._days,this._seconds,this._microseconds);throw new R.TypeError(R._type(this)+" + "+R._type(t)+" not supported")}},{key:"__radd__",value:function(t){if(R._isdate(t))return this._adddate(t,this._days);if(R._isdatetime(t))return this._adddatetime(t,this._days,this._seconds,this._microseconds);throw new R.TypeError(R._type(this)+" + "+R._type(t)+" not supported")}},{key:"__sub__",value:function(t){if(t instanceof R.TimeDelta)return new R.TimeDelta(this._days-t._days,this._seconds-t._seconds,this._microseconds-t._microseconds);throw new R.TypeError(R._type(this)+" - "+R._type(t)+" not supported")}},{key:"__rsub__",value:function(t){if(R._isdate(t))return this._adddate(t,-this._days);if(R._isdatetime(t))return this._adddatetime(t,-this._days,-this._seconds,-this._microseconds);throw new R.TypeError(R._type(this)+" - "+R._type(t)+" not supported")}},{key:"__mul__",value:function(t){if("number"==typeof t)return new R.TimeDelta(this._days*t,this._seconds*t,this._microseconds*t);throw new R.TypeError(R._type(this)+" * "+R._type(t)+" not supported")}},{key:"__rmul__",value:function(t){if("number"==typeof t)return new R.TimeDelta(this._days*t,this._seconds*t,this._microseconds*t);throw new R.TypeError(R._type(this)+" * "+R._type(t)+" not supported")}},{key:"__truediv__",value:function(t){if("number"==typeof t)return new R.TimeDelta(this._days/t,this._seconds/t,this._microseconds/t);if(t instanceof R.TimeDelta){var e=this._days,r=t._days,n=this._seconds||t._seconds,o=this._microseconds||t._microseconds;return(n||o)&&(e=86400*e+this._seconds,r=86400*r+t._seconds,o&&(e=1e6*e+this._microseconds,r=1e6*r+t._microseconds)),e/r}throw new R.TypeError(R._type(this)+" / "+R._type(t)+" not supported")}},{key:"__getattr__",value:function(t){var e=this;switch(t){case"days":var r=function(){return e._days};return R.expose(r,[]),r;case"seconds":var n=function(){return e._seconds};return R.expose(n,[]),n;case"microseconds":var o=function(){return e._microseconds};return R.expose(o,[]),o;default:throw new R.AttributeError(this,t)}}},{key:"days",value:function(){return this._days}},{key:"seconds",value:function(){return this._seconds}},{key:"microseconds",value:function(){return this._microseconds}},{key:"ul4type",value:function(){return"timedelta"}}]),a}(),R.MonthDelta=function(t){function r(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return E(this,r),(t=V(this,O(r).call(this)))._months=e,t}return L(r,R.Proto),P(r,[{key:"__repr__",value:function(){return this._months?"monthdelta("+this._months+")":"monthdelta()"}},{key:"__str__",value:function(){return this._months?-1!==this._months&&1!==this._months?this._months+" months":this._months+" month":"0 months"}},{key:"toString",value:function(){return this.__str__()}},{key:"__bool__",value:function(){return 0!==this._months}},{key:"__abs__",value:function(){return this._months<0?new R.MonthDelta(-this._months):this}},{key:"__eq__",value:function(t){return t instanceof r&&this._months===t._months}},{key:"__lt__",value:function(t){if(t instanceof R.MonthDelta)return this._months<t._months;R._unorderable("<",this,t)}},{key:"__le__",value:function(t){if(t instanceof R.MonthDelta)return this._months<=t._months;R._unorderable("<=",this,t)}},{key:"__gt__",value:function(t){if(t instanceof R.MonthDelta)return this._months>t._months;R._unorderable(">",this,t)}},{key:"__ge__",value:function(t){if(t instanceof R.MonthDelta)return this._months>=t._months;R._unorderable(">=",this,t)}},{key:"__neg__",value:function(){return new R.MonthDelta(-this._months)}},{key:"_adddate",value:function(t,e){var r=this._adddatetime(t._date,e);return new R.Date(r.getFullYear(),r.getMonth()+1,r.getDate())}},{key:"_adddatetime",value:function(t,e){for(var r=t.getFullYear(),n=t.getMonth()+e,o=t.getDate(),i=t.getHours(),a=t.getMinutes(),u=t.getSeconds(),s=t.getMilliseconds();;){var l=new Date(r,n,1,i,a,u,s).getMonth(),c=new Date(r,n,o,i,a,u,s);if(c.getMonth()===l)return c;--o}}},{key:"__add__",value:function(t){if(R._ismonthdelta(t))return new R.MonthDelta(this._months+t._months);if(R._isdate(t))return this._adddate(t,this._months);if(R._isdatetime(t))return this._adddatetime(t,this._months);throw new R.ArgumentError(R._type(this)+" + "+R._type(t)+" not supported")}},{key:"__radd__",value:function(t){if(R._isdate(t))return this._adddate(t,this._months);if(R._isdatetime(t))return this._adddatetime(t,this._months);throw new R.ArgumentError(R._type(this)+" + "+R._type(t)+" not supported")}},{key:"__sub__",value:function(t){if(R._ismonthdelta(t))return new R.MonthDelta(this._months-t._months);throw new R.ArgumentError(R._type(this)+" - "+R._type(t)+" not supported")}},{key:"__rsub__",value:function(t){if(R._isdate(t))return this._adddate(t,-this._months);if(R._isdatetime(t))return this._adddatetime(t,-this._months);throw new R.ArgumentError(R._type(this)+" - "+R._type(t)+" not supported")}},{key:"__mul__",value:function(t){if("number"==typeof t)return new R.MonthDelta(this._months*Math.floor(t));throw new R.ArgumentError(R._type(this)+" * "+R._type(t)+" not supported")}},{key:"__rmul__",value:function(t){if("number"==typeof t)return new R.MonthDelta(this._months*Math.floor(t));throw new R.ArgumentError(R._type(this)+" * "+R._type(t)+" not supported")}},{key:"__floordiv__",value:function(t){if("number"==typeof t)return new R.MonthDelta(Math.floor(this._months/t));if(R._ismonthdelta(t))return Math.floor(this._months/t._months);throw new R.ArgumentError(R._type(this)+" // "+R._type(t)+" not supported")}},{key:"__truediv__",value:function(t){if(R._ismonthdelta(t))return this._months/t._months;throw new R.ArgumentError(R._type(this)+" / "+R._type(t)+" not supported")}},{key:"__getattr__",value:function(t){var e=this;switch(t){case"months":var r=function(){return e._months};return R.expose(r,[]),r;default:throw new R.AttributeError(this,t)}}},{key:"months",value:function(){return this._months}},{key:"ul4type",value:function(){return"monthdelta"}}]),r}();for(var H=[R.TextAST,R.IndentAST,R.LineEndAST,R.ConstAST,R.SeqItemAST,R.UnpackSeqItemAST,R.DictItemAST,R.UnpackDictItemAST,R.PosArgAST,R.KeywordArgAST,R.UnpackListArgAST,R.UnpackDictArgAST,R.ListAST,R.ListCompAST,R.DictAST,R.DictCompAST,R.SetAST,R.SetCompAST,R.GenExprAST,R.VarAST,R.NotAST,R.NegAST,R.BitNotAST,R.IfAST,R.ReturnAST,R.PrintAST,R.PrintXAST,R.ItemAST,R.IsAST,R.IsNotAST,R.EQAST,R.NEAST,R.LTAST,R.LEAST,R.GTAST,R.GEAST,R.NotContainsAST,R.ContainsAST,R.AddAST,R.SubAST,R.MulAST,R.FloorDivAST,R.TrueDivAST,R.ModAST,R.ShiftLeftAST,R.ShiftRightAST,R.BitAndAST,R.BitXOrAST,R.BitOrAST,R.AndAST,R.OrAST,R.SliceAST,R.AttrAST,R.CallAST,R.RenderAST,R.RenderXAST,R.RenderBlockAST,R.RenderBlocksAST,R.SetVarAST,R.AddVarAST,R.SubVarAST,R.MulVarAST,R.TrueDivVarAST,R.FloorDivVarAST,R.ModVarAST,R.ShiftLeftVarAST,R.ShiftRightVarAST,R.BitAndVarAST,R.BitXOrVarAST,R.BitOrVarAST,R.ForBlockAST,R.WhileBlockAST,R.BreakAST,R.ContinueAST,R.CondBlockAST,R.IfBlockAST,R.ElIfBlockAST,R.ElseBlockAST,R.SignatureAST,R.Template],X=0;X<H.length;++X){var J=H[X],G=J.name;"AST"===G.substr(G.length-3)&&(G=G.substr(0,G.length-3)),G=G.toLowerCase(),J.prototype.type=G,R.register("de.livinglogic.ul4."+G,J)}var K={};K.Base=function(t){function e(){return E(this,e),V(this,O(e).call(this))}return L(e,R.Proto),P(e,[{key:"ul4ondump",value:function(t){for(var e=0;e<this._ul4onattrs.length;++e)t.dump(this._dumpUL4ONAttr(this._ul4onattrs[e]))}},{key:"_dumpUL4ONAttr",value:function(t){return this[t]}},{key:"ul4onload",value:function(t){for(var e=0,r=t.loadcontent();;++e){var n=r.next();if(n.done)break;e<this._ul4onattrs.length&&this._loadUL4ONAttr(this._ul4onattrs[e],n.value)}for(;e<this._ul4onattrs.length;++e)this._setDefaultUL4ONAttr(this._ul4onattrs[e])}},{key:"_loadUL4ONAttr",value:function(t,e){this[t]=e}},{key:"_setDefaultUL4ONAttr",value:function(t){this[t]=null}},{key:"__getattr__",value:function(t){if(this._ul4attrs.has(t)){var e=this[t];if("function"!=typeof e)return e;var r=e.bind(this);return r._ul4_name=e._ul4_name||e.name,r._ul4_signature=e._ul4_signature,r._ul4_needsobject=e._ul4_needsobject,r._ul4_needscontext=e._ul4_needscontext,r}throw new R.AttributeError(this,t)}},{key:"__repr__",value:function(){return"<la."+this.constructor.name+">"}}]),e}(),K.Handler=function(){function t(){E(this,t)}return P(t,[{key:"save",value:function(t){}},{key:"delete",value:function(t){}}]),t}(),K.Globals=function(t){function e(){var t;return E(this,e),(t=V(this,O(e).call(this))).version=null,t.platform=null,t.user=null,t.maxdbactions=null,t.maxtemplateruntime=null,t.flashmessages=null,t.handler=new K.Handler,t}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.Globals version="+R._repr(this.version)+">"}}],[{key:"geodist",value:function(t,e){var r=function(t){return(t=Math.sin(t))*t},n=function(t){return(t=Math.cos(t))*t},o=Math.PI/180,i=1/298.257223563,a=t.lat*o,u=t.long*o,s=e.lat*o,l=(a+s)/2,c=(a-s)/2,h=(u-e.long*o)/2,p=r(c)*n(h)+n(l)*r(h),_=n(c)*n(h)+r(l)*r(h),f=Math.atan(Math.sqrt(p/_)),d=2*f*6378.137,v=Math.sqrt(p*_)/f,m=(3*v+1)/(2*p);return d*(1+i*((3*v-1)/(2*_))*r(l)*n(c)-i*m*n(l)*r(c))}}]),e}(),K.Globals.prototype._ul4onattrs=["version","platform","user","maxdbactions","maxtemplateruntime","flashmessages"],K.Globals.prototype._ul4attrs=R._makeset("version","platform","user","maxdbactions","maxtemplateruntime","flashmessages"),K.FlashMessage=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.FlashMessage type="+R._repr(this.type)+" title="+R._repr(this.title)+">"}}]),e}(),K.FlashMessage.prototype._ul4onattrs=["timestamp","type","title","message"],K.FlashMessage.prototype._ul4attrs=R._makeset("timestamp","type","title","message"),K.App=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.App id="+R._repr(this.id)+" name="+R._repr(this.name)+">"}},{key:"insert",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.__call__(t);return this.globals.handler.save(this),this.globals.Login._insert(this,t)}},{key:"__call__",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=new K.Record(this);if(R._ismap(t)){var r=!0,n=!1,o=void 0;try{for(var i,a=t.entries()[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var u=F(i.value,2),s=u[0],l=u[1];if(!e.fields.has(s))throw new R.ArgumentError("update() get an unexpected keyword argument "+R._repr(s));e.fields.get(s).value=l}}catch(t){n=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}}else{if(!R._isobject(t))throw new R.TypeError("values must be an object or a Map");for(var s in t){if(!e.fields.has(s))throw new R.ArgumentError("update() get an unexpected keyword argument "+R._repr(s));e.fields.get(s).value=t[s]}}return e}},{key:"__getattr__",value:function(t){if(t.startsWith("c_")){if(!this.controls.has(t.substr(2)))throw new R.AttributeError(this,t);return this.controls.get(t.substr(2))}return I(O(e.prototype),"__getattr__",this).call(this,t)}}]),e}(),K.App.prototype._ul4onattrs=["id","globals","name","description","language","startlink","iconlarge","iconsmall","createdby","controls","records","recordcount","installation","categories","params","views","datamanagement_identifier","basetable","primarykey","insertprocedure","updateprocedure","deleteprocedure","templates","createdat","updatedat","updatedby"],K.App.prototype._ul4attrs=R._makeset("id","globals","name","description","language","startlink","iconlarge","iconsmall","createdat","createdby","updatedat","updatedby","controls","records","recordcount","installation","categories","params","views","datamanagement_identifier","insert"),R.expose(K.App.prototype.__call__,["**values"],{needsobject:!0}),R.expose(K.App.prototype.insert,["**values"],{needsobject:!0}),K.View=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.View id="+R._repr(this.id)+" name="+R._repr(this.name)+">"}}]),e}(),K.View.prototype._ul4onattrs=["id","name","app","order","width","height","start","end"],K.View.prototype._ul4attrs=R._makeset("id","name","app","order","width","height","start","end"),K.DataSourceData=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.DataSource.Data id="+R._repr(this.id)+" identifier="+R._repr(this.identifier)+">"}}]),e}(),K.DataSourceData.prototype._ul4onattrs=["id","identifier","app","apps"],K.DataSourceData.prototype._ul4attrs=R._makeset("id","identifier","app","apps"),K.Record=function(t){function r(t){var e;return E(this,r),(e=V(this,O(r).call(this))).id=null,e.app=t,e.createdat=null,e.createdby=null,e.updatedat=null,e.updatedby=null,e.updatecount=0,e._sparsevalues=new Map,e._values=null,e._fields=null,e.children=new Map,e.attachments=null,e.errors=[],e._is_deleted=!1,e}return L(r,K.Base),P(r,[{key:"__repr__",value:function(){var t=["<la.Record id=",R._repr(this.id)],e=!0,r=!1,n=void 0;try{for(var o,i=this.fields.values()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;a.control.priority&&(t.push(" v_"),t.push(a.control.identifier),t.push("="),t.push(R._repr(a.value)))}}catch(t){r=!0,n=t}finally{try{e||null==i.return||i.return()}finally{if(r)throw n}}return t.push(">"),t.join("")}},{key:"is_dirty",value:function(){if(null===this.id)return!0;var t=!0,e=!1,r=void 0;try{for(var n,o=this.fields.values()[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){if(n.value.is_dirty())return!0}}catch(t){e=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}return!1}},{key:"has_errors",value:function(){if(0!==this.errors.length)return!0;var t=!0,e=!1,r=void 0;try{for(var n,o=this.fields.values()[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){if(n.value.has_errors())return!0}}catch(t){e=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}return!1}},{key:"delete",value:function(){return this.app.globals.handler.delete(this)}},{key:"save",value:function(){this.app.globals.handler.save(this)}},{key:"update",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(R._ismap(t)){var e=!0,r=!1,n=void 0;try{for(var o,i=t.entries()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=F(o.value,2),u=a[0],s=a[1];if(!this.fields.has(u))throw new R.ArgumentError("update() get an unexpected keyword argument "+R._repr(u));this.fields.get(u).value=s}}catch(t){r=!0,n=t}finally{try{e||null==i.return||i.return()}finally{if(r)throw n}}}else{if(!R._isobject(t))throw new R.TypeError("values must be an object or a Map");for(var u in t){if(!this.fields.has(u))throw new R.ArgumentError("update() get an unexpected keyword argument "+R._repr(u));this.fields.get(u).value=t[u]}}return this.app.globals.handler.save(this),this.app.globals.Login._update(this,t)}},{key:"search",value:function(t){for(var e in t){var r=t[e];if(R._bool(r)&&!this.fields.get(e).search(r))return!1}return!0}},{key:"_dumpUL4ONAttr",value:function(t){return"values"===t?this._sparsevalues:this[t]}},{key:"_loadUL4ONAttr",value:function(t,e){"values"===t?(this._sparsevalues=e,this._values=null,this._fields=null):this[t]=e}},{key:"__getattr__",value:function(t){return t.startsWith("c_")?this.children.get(t.substr(2)):t.startsWith("f_")?this.fields.get(t.substr(2)):t.startsWith("v_")?this.values.get(t.substr(2)):this[t]}},{key:"__setattr__",value:function(t,e){if(t.startsWith("c_"))this.children[t.substr(2)]=e;else{if(!t.startsWith("v_"))throw new R.AttributeError(this,t);this.fields.get(t.substr(2)).value=e}}},{key:"values",get:function(){if(null===this._values){this._values=R._havemap?new Map:{};var t=!0,e=!1,r=void 0;try{for(var n,o=this.app.controls.entries()[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=F(n.value,2),a=i[0],u=(i[1],this._sparsevalues.get(a));void 0===u&&(u=null),this._values.set(a,u)}}catch(t){e=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}}return this._values}},{key:"fields",get:function(){if(null===this._fields){this._fields=R._havemap?new Map:{};var t=!0,e=!1,r=void 0;try{for(var n,o=this.values.entries()[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=F(n.value,2),a=i[0],u=i[1],s=new K.Field(this.app.controls.get(a),this,u);this._fields.set(a,s)}}catch(t){e=!0,r=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}}return this._fields}}]),r}(),K.Record.prototype._ul4onattrs=["id","app","createdat","createdby","updatedat","updatedby","updatecount","values","attachments","children"],K.Record.prototype._ul4attrs=R._makeset("id","app","createdat","createdby","updatedat","updatedby","updatecount","values","attachments","children"),R.expose(K.Record.prototype.is_dirty,[]),R.expose(K.Record.prototype.has_errors,[]),R.expose(K.Record.prototype.delete,[]),R.expose(K.Record.prototype.save,[]),R.expose(K.Record.prototype.update,["**values"],{needsobject:!0}),K.Control=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la."+this.__type__+" id="+R._repr(this.id)+" identifier="+R._repr(this.identifier)+">"}},{key:"_logsearch",value:function(t,e){}},{key:"asjson",value:function(t){return t}},{key:"search",value:function(t,e){return!1}}]),e}(),K.Control.prototype.type=null,K.Control.prototype.subtype=null,K.Control.prototype._ul4onattrs=["id","identifier","field","app","label","priority","order","default","ininsertprocedure","inupdateprocedure"],K.Control.prototype._ul4attrs=R._makeset("id","identifier","field","app","label","priority","order","default","ininsertprocedure","inupdateprocedure"),K.BoolControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"search",value:function(t,e){return this._logsearch(t,e),"equals"===e.operator&&e.value===t}}]),e}(),K.BoolControl.prototype.type="bool",K.IntControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"search",value:function(t,e){return this._logsearch(t,e),"equals"===e.operator&&e.value===t}}]),e}(),K.IntControl.prototype.type="int",K.NumberControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"search",value:function(t,e){return this._logsearch(t,e),"equals"===e.operator?e.value===t:"range"===e.operator&&(null!==t&&((null===e.minvalue||e.minvalue<=t)&&(null===e.maxvalue||t<e.maxvalue)))}}]),e}(),K.NumberControl.prototype.type="number",K.StringControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"asjson",value:function(t){return t}},{key:"search",value:function(t,e){return this._logsearch(t,e),"equals"===e.operator?e.value===t:"contains"===e.operator?null===e.value||null===t?e.value===t:0<=t.toLowerCase().indexOf(e.value.toLowerCase()):void 0}}]),e}(),K.StringControl.prototype.type="string",K.TextControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.TextControl.prototype.subtype="text",K.EmailControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.EmailControl.prototype.subtype="email",K.URLControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.URLControl.prototype.subtype="url",K.TelControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.TelControl.prototype.subtype="tel",K.PasswordControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.PasswordControl.prototype.subtype="password",K.TextAreaControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.StringControl),e}(),K.TextAreaControl.prototype.subtype="textarea",K.TextAreaControl.prototype._ul4onattrs=K.StringControl.prototype._ul4onattrs.concat(["encrypted"]),K.TextAreaControl.prototype._ul4attrs=R._makeset.apply(R,N(K.StringControl.prototype._ul4attrs).concat(["encrypted"])),K.DateControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"formatstring",value:function(t){return"de"===(t=t||this.app.language)?"%d.%m.%Y":"%m/%d/%Y"}},{key:"asjson",value:function(t){return t}},{key:"search",value:function(t,e){this._logsearch(t,e);var r=e.value;return"[object Date]"==Object.prototype.toString.call(r)&&(r=R._format(r,this.formatstring(),this.app.language)),null!==t&&(t=R._format(t,this.formatstring(),this.app.language)),"equals"===e.operator?r===t:"contains"===e.operator&&(null===r||null===t?r===t:0<=t.toLowerCase().indexOf(r.toLowerCase()))}}]),e}(),K.DateControl.prototype.type="date",K.DateControl.prototype.subtype="date",K.DatetimeMinuteControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.DateControl),P(e,[{key:"formatstring",value:function(t){return"de"===(t=t||this.app.language)?"%d.%m.%Y %H:%M":"%m/%d/%Y %H:%M"}}]),e}(),K.DatetimeMinuteControl.prototype.subtype="datetimeminute",K.DatetimeSecondControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.DateControl),P(e,[{key:"formatstring",value:function(t){return"de"===(t=t||this.app.language)?"%d.%m.%Y %H:%M:%S":"%m/%d/%Y %H:%M:%S"}}]),e}(),K.DatetimeSecondControl.prototype.subtype="datetimesecond",K.LookupControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"search",value:function(t,e){return"equals"===e.operator&&(null===t?null===e.value:t.key===e.value)}}]),e}(),K.LookupControl.prototype.type="lookup",K.LookupControl.prototype._ul4onattrs=K.Control.prototype._ul4onattrs.concat(["lookupdata"]),K.LookupControl.prototype._ul4attrs=R._makeset.apply(R,N(K.Control.prototype._ul4attrs).concat(["lookupdata"])),K.LookupSelectControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.LookupControl),e}(),K.LookupSelectControl.prototype.subtype="select",K.LookupRadioControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.LookupControl),e}(),K.LookupRadioControl.prototype.subtype="radio",K.LookupChoiceControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.LookupControl),e}(),K.LookupChoiceControl.prototype.subtype="choice",K.AppLookupControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"search",value:function(t,e){return null===t||null===e.value?t===e.value:t.search(e)}}]),e}(),K.AppLookupControl.prototype.type="applookup",K.AppLookupControl.prototype._ul4onattrs=K.Control.prototype._ul4onattrs.concat(["lookupapp","lookupcontrols"]),K.AppLookupControl.prototype._ul4attrs=R._makeset.apply(R,N(K.Control.prototype._ul4attrs).concat(["lookupapp","lookupcontrols"])),K.AppLookupSelectControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.AppLookupControl),e}(),K.AppLookupSelectControl.prototype.subtype="select",K.AppLookupRadioControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.AppLookupControl),e}(),K.AppLookupRadioControl.prototype.subtype="radio",K.AppLookupChoiceControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.AppLookupControl),e}(),K.AppLookupChoiceControl.prototype.subtype="choice",K.MultipleLookupControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.LookupControl),P(e,[{key:"search",value:function(t,e){if("equals"!==e.operator)return!1;var r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){if(i.value.key===e.value)return!0}}catch(t){n=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return!1}}]),e}(),K.MultipleLookupControl.prototype.subtype="multiplelookup",K.MultipleLookupSelectControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleLookupControl),e}(),K.MultipleLookupSelectControl.prototype.subtype="select",K.MultipleLookupCheckboxControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleLookupControl),e}(),K.MultipleLookupCheckboxControl.prototype.subtype="checkbox",K.MultipleLookupChoiceControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleLookupControl),e}(),K.MultipleLookupChoiceControl.prototype.subtype="choice",K.MultipleAppLookupControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.AppLookupControl),P(e,[{key:"search",value:function(t,e){if("equals"!==e.operator)return!1;if(null===e.value)return 0===t.length;var r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){if(i.value.search(e.value))return!0}}catch(t){n=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return!1}}]),e}(),K.MultipleAppLookupControl.prototype.type="multipleapplookup",K.MultipleAppLookupSelectControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleAppLookupControl),e}(),K.MultipleAppLookupSelectControl.prototype.subtype="select",K.MultipleAppLookupCheckboxControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleAppLookupControl),e}(),K.MultipleAppLookupCheckboxControl.prototype.subtype="checkbox",K.MultipleAppLookupChoiceControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.MultipleAppLookupControl),e}(),K.MultipleAppLookupChoiceControl.prototype.subtype="choice",K.GeoControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),P(e,[{key:"asjson",value:function(t){return t instanceof K.Geo&&(t="".concat(t.lat,", ").concat(t.long,", ").concat(t.info)),t}}]),e}(),K.GeoControl.prototype.type="geo",K.FileControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),e}(),K.FileControl.prototype.type="file",K.ButtonControl=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Control),e}(),K.ButtonControl.prototype.type="button",K.Field=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this))).control=t,n.record=e,n._value=r,n._dirty=!1,n.errors=[],n}return L(o,K.Base),P(o,[{key:"is_empty",value:function(){return null===this._value||R._islist(this._value)&&0===this._value.length}},{key:"is_dirty",value:function(){return this._dirty}},{key:"has_errors",value:function(){return 0!==this.errors.length}},{key:"search",value:function(t){return this.control.search(this.value,t)}},{key:"__repr__",value:function(){var t="<la.Field identifier=";return t+=R._repr(this.control.identifier),this._dirty&&(t+=" is_dirty()=True"),0!==this.errors.length&&(t+=" has_errors()=True"),t+=">"}},{key:"value",get:function(){return this._value},set:function(t){var e=this._value;R._ne(e,t)&&(this.record.values.set(this.control.identifier,t),this._value=t,this._dirty=!0)}}]),o}(),K.LookupItem=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.LookupItem key="+R._repr(this.key)+" label="+R._repr(this.label)+">"}}]),e}(),K.LookupItem.prototype._ul4onattrs=["key","label"],K.LookupItem.prototype._ul4attrs=R._makeset("key","label"),K.User=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.User id="+R._repr(this.id)+" firstname="+R._repr(this.firstname)+" surname="+R._repr(this.surname)+" email="+R._repr(this.email)+">"}}]),e}(),K.User.prototype._ul4onattrs=["_id","id","gender","firstname","surname","initials","email","language","avatarsmall","avatarlarge","keyviews"],K.User.prototype._ul4attrs=R._makeset("_id","id","gender","firstname","surname","initials","email","language","avatarsmall","avatarlarge","keyviews"),K.File=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.File id="+R._repr(this.id)+" url="+R._repr(this.url)+" filename="+R._repr(this.filename)+">"}}]),e}(),K.File.prototype._ul4onattrs=["id","url","filename","mimetype","width","height","internalid","createdat","size"],K.File.prototype._ul4attrs=R._makeset("id","url","filename","mimetype","width","height","size","createdat"),K.Geo=function(t){function o(t,e,r){var n;return E(this,o),(n=V(this,O(o).call(this))).lat=t,n.long=e,n.info=r,n}return L(o,K.Base),P(o,[{key:"__repr__",value:function(){return"<la.Geo lat="+R._repr(this.lat)+" long="+R._repr(this.long)+" info="+R._repr(this.info)+">"}}]),o}(),K.Geo.prototype._ul4onattrs=["lat","long","info"],K.Geo.prototype._ul4attrs=R._makeset("lat","long","info"),K.Attachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la."+this.__type__+" id="+R._repr(this.id)+" label="+R._repr(this.label)+">"}}]),e}(),K.Attachment.prototype._ul4onattrs=["id","record","label","active"],K.Attachment.prototype._ul4attrs=R._makeset("id","record","label","active"),K.NoteAttachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Attachment),e}(),K.NoteAttachment.prototype.type="noteattachment",K.NoteAttachment.prototype._ul4onattrs=K.Attachment.prototype._ul4onattrs.concat(["value"]),K.NoteAttachment.prototype._ul4attrs=R._makeset.apply(R,N(K.Attachment.prototype._ul4onattrs).concat(["value"])),K.URLAttachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Attachment),e}(),K.URLAttachment.prototype.type="urlattachment",K.URLAttachment.prototype._ul4onattrs=K.Attachment.prototype._ul4onattrs.concat(["value"]),K.URLAttachment.prototype._ul4attrs=R._makeset.apply(R,N(K.Attachment.prototype._ul4onattrs).concat(["value"])),K.FileAttachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Attachment),e}(),K.FileAttachment.prototype.type="fileattachment",K.FileAttachment.prototype._ul4onattrs=K.Attachment.prototype._ul4onattrs.concat(["value"]),K.FileAttachment.prototype._ul4attrs=R._makeset.apply(R,N(K.Attachment.prototype._ul4onattrs).concat(["value"])),K.ImageAttachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Attachment),e}(),K.ImageAttachment.prototype.type="imageattachment",K.ImageAttachment.prototype._ul4onattrs=K.Attachment.prototype._ul4onattrs.concat(["original","thumb","small","medium","large"]),K.ImageAttachment.prototype._ul4attrs=R._makeset.apply(R,N(K.Attachment.prototype._ul4onattrs).concat(["original","thumb","small","medium","large"])),K.JSONAttachment=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Attachment),P(e,[{key:"_dumpUL4ONAttr",value:function(t){return"value"===t?R._asjson(this.value):this[t]}},{key:"_loadUL4ONAttr",value:function(t,e){"value"===t?this.value=R._fromjson(e):this[t]=e}}]),e}(),K.JSONAttachment.prototype.type="jsonattachment",K.JSONAttachment.prototype._ul4onattrs=K.Attachment.prototype._ul4onattrs.concat(["value"]),K.JSONAttachment.prototype._ul4attrs=R._makeset.apply(R,N(K.Attachment.prototype._ul4onattrs).concat(["value"])),K.Installation=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.Installation id="+R._repr(this.id)+" name="+R._repr(this.name)+">"}}]),e}(),K.Installation.prototype._ul4onattrs=["id","name"],K.Installation.prototype._ul4attrs=R._makeset("id","name"),K.Category=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){for(var t=[],e=this;null!==e;)t.splice(0,0,e.identifier),e=e.parent;return"<la.Category id="+R._repr(this.id)+" identifierpath="+R._repr(t.join("/"))+NaN+R._repr(this.name)+">"}}]),e}(),K.Category.prototype._ul4onattrs=["id","identifier","name","order","parent","children","apps"],K.Category.prototype._ul4attrs=R._makeset("id","identifier","name","order","parent","children","apps"),K.KeyView=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.KeyView id="+R._repr(this.id)+" identifier="+R._repr(this.identifier)+">"}}]),e}(),K.KeyView.prototype._ul4onattrs=["id","identifier","name","key","user"],K.KeyView.prototype._ul4attrs=R._makeset("id","identifier","name","key","user"),K.AppParameter=function(t){function e(){return E(this,e),V(this,O(e).apply(this,arguments))}return L(e,K.Base),P(e,[{key:"__repr__",value:function(){return"<la.AppParameter id="+R._repr(this.id)+" identifier="+R._repr(this.identifier)+">"}}]),e}(),K.AppParameter.prototype._ul4onattrs=["id","app","identifier","description","value"],K.AppParameter.prototype._ul4attrs=R._makeset("id","app","identifier","description","value");for(var W=[K.Globals,K.App,K.View,K.DataSourceData,K.Record,K.BoolControl,K.IntControl,K.NumberControl,K.TextControl,K.EmailControl,K.URLControl,K.TelControl,K.PasswordControl,K.TextAreaControl,K.DateControl,K.DatetimeMinuteControl,K.DatetimeSecondControl,K.LookupControl,K.LookupSelectControl,K.LookupRadioControl,K.LookupChoiceControl,K.AppLookupControl,K.AppLookupSelectControl,K.AppLookupRadioControl,K.AppLookupChoiceControl,K.MultipleLookupControl,K.MultipleLookupSelectControl,K.MultipleLookupCheckboxControl,K.MultipleLookupChoiceControl,K.MultipleAppLookupControl,K.MultipleAppLookupSelectControl,K.MultipleAppLookupCheckboxControl,K.MultipleAppLookupChoiceControl,K.GeoControl,K.FileControl,K.ButtonControl,K.Field,K.LookupItem,K.User,K.File,K.Geo,K.NoteAttachment,K.URLAttachment,K.FileAttachment,K.ImageAttachment,K.JSONAttachment,K.Installation,K.Category,K.KeyView,K.AppParameter],$=0;$<W.length;$++){var Q=W[$];R.register("de.livingapps.appdd."+Q.name.toLowerCase(),Q),R.register("de.livinglogic.livingapi."+Q.name.toLowerCase(),Q)}var Z="object"===("undefined"==typeof module?"undefined":M(module))&&module.exports,tt=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length?arguments[1]:void 0,r=2<arguments.length?arguments[2]:void 0;if(E(this,n),this._password=r||"",this._userName=e||"",this._options={url:t.url||"https://my.living-apps.de",loginRequired:void 0===t.loginRequired||t.loginRequired},this._options.url=this._options.url.lastIndexOf("/")===this._options.url.length-1?this._options.url:"".concat(this._options.url,"/"),this.hostName=this._options.url.split("//")[1].substr(0,this._options.url.split("//")[1].length-1),this._options.loginRequired&&!this._userName)throw new Error("[LivingSDK] You want to login without a username");this.session=this.login()}return P(n,[{key:"login",value:function(){if(!this._options.loginRequired)return Promise.resolve(void 0);var t="https://".concat(this.hostName,"/gateway/login");return j.post(t,{username:this._userName,password:this._password},{httpsAgent:Z?new C.Agent({ecdhCurve:"auto"}):void 0,headers:{"Content-Type":"application/json"}}).then(function(t){return t.data.auth_token})}},{key:"get",value:function(e,r){var n=this;return this.session.then(function(t){return j.get("https://".concat(n.hostName,"/gateway/apps/").concat(e).concat(void 0!==r?"?template="+r:""),{httpsAgent:Z?new C.Agent({ecdhCurve:"auto"}):void 0,headers:{"X-La-Auth-Token":void 0!==t?t:"",Accept:"application/la-ul4on"}}).then(function(t){var e;return(e=R.loads(t.data)).get("globals").Login=n,e})})}},{key:"_insert",value:function(o,i){var a=this;return this.session.then(function(t){var e={};for(var r in i){if(!o.controls.has(r))throw new Error("insert() got an unexpected keyword argument ".concat(r));e[r]=o.controls.get(r).asjson(i[r])}var n={};return n.id=o.id,n.data=[{fields:e}],j.post("https://".concat(a.hostName,"/gateway/v1/appdd/").concat(o.id,".json"),{appdd:n},{httpsAgent:Z?new C.Agent({ecdhCurve:"auto"}):void 0,headers:{"X-La-Auth-Token":void 0!==t?t:""}}).then(function(t){return{HTTPstatusCode:t.status,recordid:t.data.id,Record:new K.Record({id:t.data.id,createdat:new Date(Date.now()),updatedat:null,updatedby:null,updatecount:0})}})})}},{key:"_update",value:function(i,a){var u=this;return this.session.then(function(t){var e={},r=i.app;for(var n in a){if(!r.controls.has(n))throw new Error("update() got an unexpected keyword argument ".concat(n));e[n]=a[n]}var o={};return o.id=r.id,o.data=[{id:i.id,fields:e}],console.log("https://".concat(u.hostName,"/gateway/v1/appdd/").concat(r.id,".json")),j.post("https://".concat(u.hostName,"/gateway/v1/appdd/").concat(r.id,".json"),{appdd:o},{httpsAgent:Z?new C.Agent({ecdhCurve:"auto"}):void 0,headers:{"X-La-Auth-Token":void 0!==t?t:"","Content-Type":"application/json"}}).then(function(t){var e=t.data;for(var r in a)i.fields.get(r).value=a[r];return{HTTPstatusCode:t.status,recordid:e.id,Record:i}})})}},{key:"_delete",value:function(e){var r=this,n=e.app;return this.session.then(function(t){return j.delete("https://".concat(r.hostName,"/gateway/v1/appdd/").concat(n.id,"/").concat(e.id,".json"),{httpsAgent:Z?new C.Agent({ecdhCurve:"auto"}):void 0,headers:{"X-La-Auth-Token":void 0!==t?t:""}})})}}]),n}();t.LivingSDK=tt,t.default=tt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=livingsdk.js.map
