{"version":3,"file":"livingapi.js","sources":["../../src/livingapi.js"],"sourcesContent":["/*!\n * LivingAPI JavaScript Library\n * https://my.living-apps.de/docs/LivingAPI.html\n *\n * Copyright 2017-2022 by LivingLogic AG, Bayreuth/Germany\n * Copyright 2017-2022 by Walter Dörwald\n *\n * All Rights Reserved\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n// Version of this Javascript package\nimport { version } from '../package.json';\n\nexport { version };\n\nimport * as ul4 from '@livinglogic/ul4';\n\n\nexport class Base extends ul4.Proto\n{\n\tconstructor(id)\n\t{\n\t\tsuper();\n\t\tthis.id = id;\n\t}\n\n\tget ul4onid()\n\t{\n\t\treturn this.id;\n\t}\n\n\tul4ondump(encoder)\n\t{\n\t\tfor (let i = 0; i < this._ul4onattrs.length; ++i)\n\t\t\tencoder.dump(this._dumpUL4ONAttr(this._ul4onattrs[i]));\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\treturn this[name];\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tlet i = 0;\n\t\tfor (let iter = decoder.loadcontent(); ; ++i)\n\t\t{\n\t\t\tlet iteritem = iter.next();\n\t\t\tif (iteritem.done)\n\t\t\t\tbreak;\n\t\t\tif (i < this._ul4onattrs.length)\n\t\t\t\tthis._loadUL4ONAttr(this._ul4onattrs[i], iteritem.value);\n\t\t}\n\t\tfor (; i < this._ul4onattrs.length; ++i)\n\t\t\tthis._setDefaultUL4ONAttr(this._ul4onattrs[i]);\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tthis[name] = value;\n\t}\n\n\t_setDefaultUL4ONAttr(name)\n\t{\n\t\tthis[name] = null;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (this._ul4attrs.has(name))\n\t\t{\n\t\t\tlet value = this[name];\n\t\t\tif (typeof(value) === \"function\")\n\t\t\t{\n\t\t\t\tlet realvalue = value.bind(this);\n\t\t\t\trealvalue._ul4_name = value._ul4_name || value.name;\n\t\t\t\trealvalue._ul4_signature = value._ul4_signature;\n\t\t\t\trealvalue._ul4_needsobject = value._ul4_needsobject;\n\t\t\t\trealvalue._ul4_needscontext = value._ul4_needscontext;\n\t\t\t\treturn realvalue;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\t\tthrow new ul4.AttributeError(this, name);\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \">\";\n\t}\n\n\ttoString()\n\t{\n\t\treturn this[ul4.symbols.repr]();\n\t}\n};\n\n\nexport class Handler\n{\n\tsave(record)\n\t{\n\t}\n\n\tdelete(record)\n\t{\n\t}\n};\n\n\nexport class Globals extends Base\n{\n\tstatic classdoc = \"Global information\";\n\n\tconstructor(id)\n\t{\n\t\tsuper(id);\n\t\tthis.version = null;\n\t\tthis.hostname = null;\n\t\tthis.platform = null;\n\t\tthis.user = null;\n\t\tthis.lang = null;\n\t\tthis.app = null;\n\t\tthis.record = null;\n\t\tthis.maxdbactions = null;\n\t\tthis.maxtemplateruntime = null;\n\t\tthis.flashmessages = null;\n\t\tthis.handler = new Handler();\n\t}\n\n\t// distance between two geo coordinates (see https://de.wikipedia.org/wiki/Orthodrome#Genauere_Formel_zur_Abstandsberechnung_auf_der_Erde)\n\tstatic geodist(geo1, geo2)\n\t{\n\t\tlet sqsin = function sqsin(x) {x = Math.sin(x); return x*x};\n\t\tlet sqcos = function sqsos(x) {x = Math.cos(x); return x*x};\n\t\tconst deg2rad = Math.PI/180; // Conversion factor degree -> radians\n\t\tconst radius = 6378.137; // Equatorial radius of earth in km\n\t\tconst flat = 1/298.257223563; // Earth flattening\n\n\t\tconst lat1 = geo1.lat * deg2rad;\n\t\tconst long1 = geo1.long * deg2rad;\n\t\tconst lat2 = geo2.lat * deg2rad;\n\t\tconst long2 = geo2.long * deg2rad;\n\t\tconst F = (lat1 + lat2)/2;\n\t\tconst G = (lat1 - lat2)/2;\n\t\tconst l = (long1 - long2)/2;\n\t\tconst S = sqsin(G) * sqcos(l) + sqcos(F) * sqsin(l);\n\t\tconst C = sqcos(G) * sqcos(l) + sqsin(F) * sqsin(l);\n\t\tconst w = Math.atan(Math.sqrt(S/C));\n\t\tconst D = 2 * w * radius;\n\t\tconst T = Math.sqrt(S*C)/w;\n\t\tconst H1 = (3*T-1)/(2*C);\n\t\tconst H2 = (3*T+1)/(2*S);\n\t\tconst s = D * (1 + flat * H1 * sqsin(F) * sqcos(G) - flat * H2 * sqcos(F) * sqsin(G));\n\t\treturn s;\n\t}\n\n\tscaledURL(url, width, height, type=\"fill\", enlarge=true, gravity=\"sm\", quality=null, rotate=null, blur=null, sharpen=null, format=null, cache=true)\n\t{\n\t\tlet filename = null;\n\n\t\tif (url instanceof File)\n\t\t{\n\t\t\turl = \"https://\" + this.hostname + url.url;\n\t\t\tfilename = encodeURIComponent(url.filename);\n\t\t\tif (filename != url.filename)\n\t\t\t\tfilename = null;\n\t\t}\n\n\t\tlet result = \"\";\n\n\t\tif (cache)\n\t\t\tresult += \"/imgproxycache/insecure\";\n\t\telse\n\t\t\tresult += \"/imgproxy/insecure\";\n\n\t\tif (type !== \"fit\")\n\t\t\tresult += \"/rt:\" + type;\n\n\t\tif (width !== null && width !== undefined)\n\t\t\tresult += \"/w:\" + width;\n\n\t\tif (height !== null && height !== undefined)\n\t\t\tresult += \"/h:\" + height;\n\n\t\tif (enlarge)\n\t\t\tresult += \"/el:1\";\n\n\t\tif (gravity !== null && gravity !== undefined)\n\t\t\tresult += \"/g:\" + gravity;\n\n\t\tif (quality !== null && quality !== undefined)\n\t\t\tresult += \"/q:\" + quality;\n\n\t\tif (rotate !== null && rotate % 360 != 0)\n\t\t\tresult += \"/rot:\" + rotatet;\n\n\t\tif (blur !== null && blur !== undefined)\n\t\t\tresult += \"/bl:\" + blur;\n\n\t\tif (sharpen !== null && sharpen !== undefined)\n\t\t\tresult += \"/sh:\" + sharpen;\n\n\t\tif (format !== null && format !== undefined)\n\t\t\tresult += \"/f:\" + format;\n\n\t\tif (filename !== null && filename !== undefined)\n\t\t\tresult += \"/fn:\" + filename;\n\n\t\tresult += \"/plain/\" + encodeURIComponent(url);\n\n\t\treturn result;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Globals version=\" + ul4._repr(this.version) + \">\";\n\t}\n};\n\nGlobals.prototype._ul4onattrs = [\"version\", \"platform\", \"user\", \"maxdbactions\", \"maxtemplateruntime\", \"flashmessages\", \"lang\", \"datasources\", \"hostname\", \"app\", \"record\", \"mode\", \"view_template_id\", \"email_template_id\", \"view_id\"];\nGlobals.prototype._ul4attrs = new Set([\"version\", \"hostname\", \"platform\", \"user\", \"lang\", \"app\", \"record\", \"maxdbactions\", \"maxtemplateruntime\", \"flashmessages\", \"mode\"]);\n\n\nexport class FlashMessage extends Base\n{\n\tstatic classdoc = \"A flash message in a web page\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<FlashMessage type=\" + ul4._repr(this.type) + \" title=\" + ul4._repr(this.title) + \">\";\n\t}\n};\n\nFlashMessage.prototype._ul4onattrs = [\"timestamp\", \"type\", \"title\", \"message\"];\nFlashMessage.prototype._ul4attrs = new Set([\"timestamp\", \"type\", \"title\", \"message\"]);\n\n\nexport class App extends Base\n{\n\tstatic classdoc = \"A LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<App id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n\n\tinsert(values={})\n\t{\n\t\tlet record = this[ul4.symbols.call](values);\n\t\tthis.globals.handler.save(this);\n\t\treturn record;\n\t}\n\n\tget layout_controls()\n\t{\n\t\tif (this.active_view === null)\n\t\t\treturn new Map();\n\t\treturn this.active_view.layout_controls;\n\t}\n\n\t[ul4.symbols.call](values={})\n\t{\n\t\tlet record = new Record(null, this);\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let identifier of values.keys())\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, values, null, null);\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let identifier in values)\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, new Map(ul4._list(ul4.dicttype.items(values))), null, null);\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\t\treturn record;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t{\n\t\t\tif (!this.controls.has(name.substr(2)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.controls.get(name.substr(2));\n\t\t}\n\t\telse if (name.startsWith(\"p_\") && this.params !== null)\n\t\t{\n\t\t\tif (!this.params.has(name.substr(2)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.params.get(name.substr(2));\n\t\t}\n\t\telse if (name.startsWith(\"pv_\") && this.params !== null)\n\t\t{\n\t\t\tif (!this.params.has(name.substr(3)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.params.get(name.substr(3)).value;\n\t\t}\n\t\telse\n\t\t\treturn super[ul4.symbols.getattr](name);\n\t}\n\n\tget active_view()\n\t{\n\t\treturn this._active_view;\n\t}\n\n\tset active_view(view)\n\t{\n\t\tif (view === null)\n\t\t\t;\n\t\telse if (typeof(view) === \"string\")\n\t\t{\n\t\t\tif (this.views !== null && this.views.has(view))\n\t\t\t\tview = this.views.get(view);\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" not found!\");\n\t\t}\n\t\telse if (view instanceof View)\n\t\t{\n\t\t\tif (view.app === this)\n\t\t\t\t;\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" belongs to the wrong app!\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new ul4.TypeError(ul4._repr(view) + \" is not a view!\");\n\t\t}\n\n\t\tthis._active_view = view;\n\t}\n};\n\n\nApp.prototype._ul4onattrs = [\"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"iconlarge\", \"iconsmall\", \"createdby\", \"controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"datamanagement_identifier\", \"basetable\", \"primarykey\", \"insertprocedure\", \"updateprocedure\", \"deleteprocedure\", \"templates\", \"createdat\", \"updatedat\", \"updatedby\", \"superid\", \"favorite\", \"_active_view\"];\nApp.prototype._ul4attrs = new Set([\"id\", \"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"iconlarge\", \"iconsmall\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"datamanagement_identifier\", \"insert\", \"favorite\", \"_active_view\"]);\nul4.expose(App.prototype[ul4.symbols.call], [\"**values\"], {\"needsobject\": true});\nul4.expose(App.prototype.insert, [\"**values\"], {\"needsobject\": true});\n\n\nexport class View extends Base\n{\n\tstatic classdoc = \"An input form for a LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<View id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nView.prototype._ul4onattrs = [\"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\"];\nView.prototype._ul4attrs = new Set([\"id\", \"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\"]);\n\n\nexport class DataSource extends Base\n{\n\tstatic classdoc = \"The data resulting from a data source configuration\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<DataSource id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nDataSource.prototype._ul4onattrs = [\"identifier\", \"app\", \"apps\"];\nDataSource.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"app\", \"apps\"]);\n\n\nexport class Record extends Base\n{\n\tstatic classdoc = \"A record of a LivingApp application\";\n\n\tconstructor(id, app)\n\t{\n\t\tsuper(id);\n\t\tthis.app = app;\n\t\tthis.createdat = null;\n\t\tthis.createdby = null;\n\t\tthis.updatedat = null;\n\t\tthis.updatedby = null;\n\t\tthis.updatecount = 0;\n\t\tthis._sparsevalues = new Map();\n\t\tthis._values = null;\n\t\tthis._fields = null;\n\t\tthis.children = new Map();\n\t\tthis.attachments = null;\n\t\tthis.errors = [];\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparsefieldlookupdata = null;\n\t\tthis._is_deleted = false;\n\t\tthis._is_new = true;\n\t}\n\n\t_make_fields(defaults, values, errors, lookupdata)\n\t{\n\t\tlet fields = new Map();\n\n\t\tfor (let control of this.app.controls.values())\n\t\t{\n\t\t\tlet identifier = control.identifier;\n\t\t\tlet value = null;\n\t\t\tif (values !== null)\n\t\t\t{\n\t\t\t\tif (defaults && !values.has(identifier))\n\t\t\t\t\tvalue = control.default;\n\t\t\t\telse if (values.has(identifier))\n\t\t\t\t\tvalue = values.get(identifier);\n\t\t\t}\n\t\t\tlet field = new control.fieldtype(control, this, value);\n\t\t\tfields.set(identifier, field);\n\t\t\tif (errors !== null && errors.has(identifier))\n\t\t\t\tfield.errors = errors.get(identifier);\n\t\t\tif (lookupdata !== null && lookupdata.has(identifier))\n\t\t\t\tfield.lookupdata = lookupdata.get(identifier);\n\t\t}\n\n\t\tthis._fields = fields;\n\t\tthis._sparsevalues = null;\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparselookupdata = null;\n\t}\n\n\t_in_form()\n\t{\n\t\tlet globals = this.app.globals;\n\n\t\treturn globals.mode !== null && globals.mode.startsWith(\"form/\") && this === globals.record;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [\"<Record id=\", ul4._repr(this.id)];\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.control.priority && !field.is_empty())\n\t\t\t{\n\t\t\t\tv.push(\" v_\");\n\t\t\t\tv.push(field.control.identifier);\n\t\t\t\tv.push(\"=\");\n\t\t\t\tv.push(ul4._repr(field.value)); // FIXME: This might lead to infinite recursions\n\t\t\t}\n\t\t}\n\t\tv.push(\" state=\");\n\t\tv.push(ul4._repr(this.state));\n\t\tv.push(\">\");\n\t\treturn v.join(\"\");\n\t}\n\n\tget state()\n\t{\n\t\tif (this._is_deleted)\n\t\t\treturn \"deleted\";\n\t\telse if (this._is_new)\n\t\t\treturn \"new\";\n\t\telse if (this.is_dirty())\n\t\t\treturn \"dirty\";\n\t\telse\n\t\t\treturn \"saved\";\n\t}\n\n\tget values()\n\t{\n\t\tif (this._values === null)\n\t\t{\n\t\t\tthis._values = new Map();\n\t\t\tfor (let field of this.fields.values())\n\t\t\t{\n\t\t\t\tthis._values.set(field.control.identifier, field.value);\n\t\t\t}\n\t\t}\n\t\treturn this._values;\n\t}\n\n\tget fields()\n\t{\n\t\tif (this._fields === null)\n\t\t\tthis._make_fields(false, this._sparsevalues, this._sparsefielderrors, this._sparsefieldlookupdata)\n\t\treturn this._fields;\n\t}\n\n\tis_dirty()\n\t{\n\t\tif (this.id === null)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.is_dirty())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\thas_errors()\n\t{\n\t\tif (this.errors.length !== 0)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.has_errors())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\tlet result = this.app.globals.handler.delete(this);\n\t\tthis._is_deleted = true;\n\t\treturn result;\n\t}\n\n\tsave()\n\t{\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\tupdate(values={})\n\t{\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let [key, value] of values.entries())\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\tfields.get(key).value = value;\n\t\t\t}\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let key in values)\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\trecord.fields.get(key).value = values[key];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\tsearch(search)\n\t{\n\t\tfor (let identifier in search)\n\t\t{\n\t\t\tlet fieldsearch = search[identifier];\n\t\t\tif (ul4._bool(fieldsearch))\n\t\t\t{\n\t\t\t\tif (!this.fields.get(identifier).search(fieldsearch))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tsuper.ul4onload(decoder);\n\t\tthis._is_new = false;\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"values\")\n\t\t\treturn this._sparsevalues;\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"values\")\n\t\t{\n\t\t\tthis._sparsevalues = value;\n\t\t\tthis._values = null;\n\t\t\tthis._fields = null;\n\t\t}\n\t\telse\n\t\t\tthis[name] = value;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\treturn this.children.get(name.substr(2))\n\t\telse if (name.startsWith(\"f_\"))\n\t\t\treturn this.fields.get(name.substr(2))\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\treturn this.values.get(name.substr(2))\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\tthis.children[name.substr(2)] = value;\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\tthis.fields.get(name.substr(2)).value = value;\n\t\telse\n\t\t\tthrow new ul4.AttributeError(this, name);\n\t}\n};\n\nRecord.prototype._ul4onattrs = [\"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"_sparsevalues\", \"attachments\", \"children\", \"errors\", \"_sparsefielderrors\", \"_sparsefieldlookupdata\"];\nRecord.prototype._ul4attrs = new Set([\"id\", \"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"values\", \"attachments\", \"children\", \"errors\"]);\nul4.expose(Record.prototype.is_dirty, []);\nul4.expose(Record.prototype.has_errors, []);\nul4.expose(Record.prototype.delete, []);\nul4.expose(Record.prototype.save, []);\nul4.expose(Record.prototype.update, [\"**values\"], {\"needsobject\": true});\n\n\nexport class Field extends Base\n{\n\tstatic classdoc = \"Holds the value of a field of a record (and related information)\";\n\n\tconstructor(control, record, value)\n\t{\n\t\tsuper(null);\n\t\tthis.control = control;\n\t\tthis.record = record;\n\t\tthis._label = null;\n\t\tthis._lookupdate = null;\n\t\tthis.errors = [];\n\t\tthis._value = null;\n\t\tif (!this._in_form())\n\t\t\tthis.value = value;\n\t\tthis._dirty = false;\n\t\tthis._enabled = true;\n\t\tthis._visible = true;\n\t}\n\n\tget value()\n\t{\n\t\tif (this._in_form())\n\t\t\treturn this._get_dom_value();\n\t\treturn this._value;\n\t}\n\n\tset value(value)\n\t{\n\t\tlet oldvalue = this._value;\n\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\n\t\tif (ul4._ne(oldvalue, change.value))\n\t\t{\n\t\t\tthis.record.values.set(this.control.identifier, change.value);\n\t\t\tthis._value = change.value;\n\t\t\tthis._dirty = true;\n\t\t}\n\t\tthis.errors = change.errors;\n\t\tif (this._in_form())\n\t\t\tthis._set_dom_value(this._value);\n\t}\n\n\t_validate(change)\n\t{\n\t\t// Do nothing, i.e. accept the value unchanged and without errors\n\t}\n\n\t_set_dom_label()\n\t{\n\t\tif (this._in_form())\n\t\t\tdocument.querySelector(this._sel_label).textContent = this.label;\n\t}\n\n\tget label()\n\t{\n\t\tif (this._label !== null)\n\t\t\treturn this._label;\n\t\treturn this.control.label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t\tthis._set_dom_label();\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.control.globals;\n\t}\n\n\tis_empty()\n\t{\n\t\treturn this._value === null || (ul4._islist(this._value) && this._value.length === 0);\n\t}\n\n\tis_dirty()\n\t{\n\t\treturn this._dirty;\n\t}\n\n\thas_errors()\n\t{\n\t\treturn this.errors.length !== 0;\n\t}\n\n\tsearch(searchvalue)\n\t{\n\t\treturn this.control.search(this.value, searchvalue);\n\t}\n\n\tmsg_field_required(value)\n\t{\n\t\tswitch (this.globals.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn `\"${this.label}\" wird benötigt!`;\n\t\t\tdefault:\n\t\t\t\treturn `\"${this.label}\" is required!`;\n\t\t}\n\t}\n\n\tmsg_field_wrong_type(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support the type ${ul4._type(value).name}!`;\n\t}\n\n\tmsg_bool_truerequired(value)\n\t{\n\t\treturn `\"${this.label}\" only accepts \"Yes\"!`;\n\t}\n\n\tmsg_string_tooshort(value)\n\t{\n\t\treturn `\"${this.label}\" is too short. You must use at least ${this.control.minlength} characters!`;\n\t}\n\n\tmsg_string_toolong(value)\n\t{\n\t\treturn `\"${this.label}\" is too long. You may use at most ${this.control.maxlength} characters!`;\n\t}\n\n\tmsg_email_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid email address!`;\n\t}\n\n\tmsg_url_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid URL!`;\n\t}\n\n\tmsg_tel_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid phone number!`;\n\t}\n\n\tmsg_date_format(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support this date format!`;\n\t}\n\n\tmsg_number_format(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support this number format!`;\n\t}\n\n\tmsg_lookup_wrongitem(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" doesn't belong to this lookup!`;\n\t}\n\n\tmsg_lookup_unknownkey(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" is unknown!`;\n\t}\n\n\tmsg_applookup_wrongrecord(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" doesn't belong to the correct app!`;\n\t}\n\n\tmsg_applookup_unknownkey(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" can't be found!`;\n\t}\n\n\t/*\n\tThe following methods are used in the input form.\n\n\tI.e. the are expected to be executed inside a browser.\n\t**/\n\t_in_form()\n\t{\n\t\treturn this.record._in_form();\n\t}\n\n\tget _sel_root()\n\t{\n\t\treturn \"#livingapps-form .\" + this.control._cssclass_root + \".llft-id-\" + this.control.identifier;\n\t}\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label span\";\n\t}\n\n\tget _sel_control()\n\t{\n\t\treturn this._sel_root + \" \" + this.control._cssclass_control;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\treturn document.querySelector(this._sel_control).value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tdocument.querySelector(this._sel_control).value = value;\n\t}\n\n\t_show()\n\t{\n\t\tlet el = document.querySelector(this._sel_root);\n\t\tel.style.transition = \"height 0.2s ease\";\n\t\tel.style.overflowY = \"hidden\";\n\t\tel.style.height = el.scrollHeight + \"px\";\n\t}\n\n\t_hide()\n\t{\n\t\tlet el = document.querySelector(this._sel_root);\n\t\tel.style.transition = \"height 0.2s ease\";\n\t\tel.style.overflowY = \"hidden\";\n\t\tel.style.height = 0 + \"px\";\n\t}\n\n\tget visible()\n\t{\n\t\treturn this._visible;\n\t}\n\n\tset visible(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tif (value)\n\t\t\t\tthis._show();\n\t\t\telse\n\t\t\t\tthis._hide();\n\t\t}\n\t\tthis._visible = value;\n\t}\n\n\tget enabled()\n\t{\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tlet disabled = !value;\n\t\t\tfor (let node of document.querySelectorAll(this._sel_control))\n\t\t\t\tnode.disabled = disabled;\n\t\t}\n\t\tthis._enabled = value;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet s = \"<Field identifier=\";\n\t\ts += ul4._repr(this.control.identifier)\n\t\tif (this._dirty)\n\t\t\ts += \" is_dirty()=True\";\n\t\tif (this.errors.length > 0)\n\t\t\ts += \" has_errors()=True\";\n\t\ts += \">\"\n\t\treturn s;\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"visible\")\n\t\t\tthis.visible = ul4._bool(value);\n\t\telse if (name === \"enaabled\")\n\t\t\tthis.visible = ul4._bool(value);\n\t\telse\n\t\t\treturn super[ul4.symbols.getattr](name);\n\t}\n};\n\nField.prototype._ul4onattrs = [\"control\", \"record\", \"label\", \"value\", \"errors\", \"enabled\", \"writable\", \"_visible\"];\nField.prototype._ul4attrs = new Set([\"control\", \"record\", \"label\", \"value\", \"errors\", \"enabled\", \"writable\", \"visible\"]);\n\n\nexport class BoolField extends Field\n{\n\tstatic classdoc = \"Holds the value of a bool field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) === \"boolean\")\n\t\t{\n\t\t\tif (this.control.required && !change.value)\n\t\t\t\tchange.errors.push(this.msg_bool_truerequired(change.value));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\treturn document.querySelector(this._sel_control).checked;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tdocument.querySelector(this._sel_control).checked = value;\n\t}\n};\n\n\nexport class IntField extends Field\n{\n\tstatic classdoc = \"Holds the value of an int field of a record (and related information)\";\n\n\t_parse(value)\n\t{\n\t\tif (/^\\s*[-+]?\\d+\\s*$/.test(value))\n\t\t\treturn parseInt(value);\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = this._parse(change.value);\n\t\t\tif (value !== null)\n\t\t\t\tchange.value = value;\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_number_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse if (typeof(change.value) === \"number\")\n\t\t{\n\t\t\tif (Math.round(change.value) !== change.value)\n\t\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\t\t// Keep original floating point number\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tlet testvalue = this._parse(value);\n\t\t\tif (testvalue !== null)\n\t\t\t\tvalue = testvalue;\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tsuper._set_dom_value(value + \"\");\n\t}\n};\n\n\nexport class NumberField extends Field\n{\n\tstatic classdoc = \"Holds the value of a number field of a record (and related information)\";\n\n\t_parse(value)\n\t{\n\t\tif (value === null)\n\t\t\treturn null;\n\n\t\t// Try to ignore thousands separators and return the value as a number\n\t\tlet testvalue = value;\n\t\t// Count decimal delimiters\n\t\tlet seps = \"\";\n\t\tlet commas = 0;\n\t\tlet dots = 0\n\t\tfor (let i = 0; i < value.length; ++i)\n\t\t{\n\t\t\tlet c = value[i];\n\t\t\tif (c == \",\")\n\t\t\t{\n\t\t\t\tcommas++;\n\t\t\t\tseps += c;\n\t\t\t}\n\t\t\telse if (c == \".\")\n\t\t\t{\n\t\t\t\tdots++;\n\t\t\t\tseps += c;\n\t\t\t}\n\t\t}\n\t\tlet convert = null;\n\t\tif (commas == 0)\n\t\t{\n\t\t\tif (dots <= 1)\n\t\t\t\t; // nothing to do\n\t\t\telse\n\t\t\t\tconvert = \"de\";\n\t\t}\n\t\telse if (commas == 1)\n\t\t{\n\t\t\tif (dots == 1)\n\t\t\t\tconvert = (seps == \".,\") ? \"de\" : \"en\";\n\t\t\telse\n\t\t\t\tconvert = \"de\";\n\t\t}\n\t\telse // commas > 1\n\t\t{\n\t\t\tif (dots <= 1)\n\t\t\t\tconvert = \"en\";\n\t\t\telse\n\t\t\t\treturn null; // We can't guess what the user meant\n\t\t}\n\n\t\tif (convert === \"de\")\n\t\t\ttestvalue = testvalue.replace(/\\./g, \"\").replace(/,/g, \".\");\n\t\telse if (convert === \"en\")\n\t\t\ttestvalue = testvalue.replace(/,/g, \"\");\n\t\tlet floatvalue = parseFloat(testvalue);\n\t\tif (isNaN(floatvalue))\n\t\t\treturn value;\n\t\treturn floatvalue;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = this._parse(change.value);\n\t\t\tif (value !== null)\n\t\t\t{\n\t\t\t\tvalue = this._bound_value(value);\n\t\t\t\tif (this.control.precision !== null)\n\t\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\t\tchange.value = value;\n\t\t\t}\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_number_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse if (typeof(change.value) === \"number\")\n\t\t{\n\t\t\tvalue = this._bound_value(value);\n\t\t\tif (this.control.precision !== null)\n\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\tchange.value = value;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_bound_value(value)\n\t{\n\t\tif (this.control.minimum !== null)\n\t\t{\n\t\t\tif (value < this.control.minimum)\n\t\t\t\tvalue = this.control.minimum;\n\t\t}\n\t\tif (this.control.maximum !== null)\n\t\t{\n\t\t\tif (value > this.control.maximum)\n\t\t\t\tvalue = this.control.maximum;\n\t\t}\n\t\treturn value;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tif (typeof(value) == \"string\")\n\t\t\t{\n\t\t\t\tlet testvalue = this._parse(value);\n\t\t\t\tif (testvalue !== null)\n\t\t\t\t\tvalue = testvalue;\n\t\t\t}\n\t\t\tif (typeof(value) === \"number\")\n\t\t\t{\n\t\t\t\tif (this.control.precision !== null)\n\t\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\t\tvalue = this._bound_value(value);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = null;\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (typeof(value) === \"number\")\n\t\t{\n\t\t\tvalue = this._bound_value(value);\n\t\t\tif (this.control.precision !== null)\n\t\t\t\tvalue = value.toFixed(this.control.precision);\n\t\t}\n\t\tvalue += \"\";\n\t\tif (this.globals.lang == \"de\" && this.control.precision === null)\n\t\t\tvalue = value.replace(\".\", \",\");\n\t\tsuper._set_dom_value(value);\n\t}\n};\n\n\nexport class StringField extends Field\n{\n\tstatic classdoc = \"Holds the value of a string field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet minlength = this.control.minlength;\n\t\t\tlet maxlength = this.control.maxlength;\n\t\t\tif (minlength !== null && change.value.length < minlength)\n\t\t\t\tchange.errors.push(this.msg_string_tooshort(change.value))\n\t\t\tif (maxlength !== null && change.value.length > maxlength)\n\t\t\t\tchange.errors.push(this.msg_string_toolong(change.value))\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class EmailField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/email field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/i;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_email_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class URLField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/url field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tlet url = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\turl = new URL(change.value);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t\tif (url !== null && url.protocol !== \"http:\" && url.protocol !== \"https:\")\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class TelField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/tel field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^\\\\+?[0-9 /()-]+$/;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_tel_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class TextAreaField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/textarea field of a record (and related information)\";\n};\n\n\nexport class HTMLField extends StringField\n{\n\tstatic classdoc = \"Holds the value of a string/html field of a record (and related information)\";\n};\n\n\nexport class GeoField extends Field\n{\n\tstatic classdoc = \"Holds the value of a geo field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof Geo))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class FileField extends Field\n{\n\tstatic classdoc = \"Holds the value of a file field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof File))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\t// Always return `null``\n\t\treturn null;\n\t}\n\n\t_set_dom_value()\n\t{\n\t\t// Do nothing\n\t}\n};\n\n\nexport class FileSignatureField extends FileField\n{\n\tstatic classdoc = \"Holds the value of a file/signature field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\t// FIXME: Implement handling of data URLs.\n\t\tsuper._validate(change);\n\t}\n};\n\n\nexport class DateFieldBase extends Field\n{\n\tstatic classdoc = \"Holds the value of a date field of a record (and related information)\";\n\n\t_parse(value, format)\n\t{\n\t\tlet year = null, month = null, day = null, hour = 0, minute = 0, second = 0, ispm = null;\n\n\t\tfunction _int(v, len, min, max)\n\t\t{\n\t\t\tv = v.substring(0, len);\n\t\t\tif (v.length != len)\n\t\t\t\treturn null;\n\t\t\tv = parseInt(v, 10);\n\t\t\tif (isNaN(v) || v < min || v > max)\n\t\t\t\treturn null;\n\t\t\treturn v;\n\t\t}\n\n\t\twhile (value)\n\t\t{\n\t\t\t// Are both `value` and `format` not `null`,\n\t\t\t// i.e. neither `value` nor `format` is exhaused?\n\t\t\tif (!format)\n\t\t\t\treturn null;\n\t\t\tif (format.startsWith(\"%Y\"))\n\t\t\t{\n\t\t\t\tyear = _int(value, 4);\n\t\t\t\tif (year === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(4);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%y\"))\n\t\t\t{\n\t\t\t\tyear = _int(value, 2);\n\t\t\t\tif (year === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%m\"))\n\t\t\t{\n\t\t\t\tmonth = _int(value, 2);\n\t\t\t\tif (month === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%d\"))\n\t\t\t{\n\t\t\t\tday = _int(value, 2);\n\t\t\t\tif (day === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%H\"))\n\t\t\t{\n\t\t\t\thour = _int(value, 2);\n\t\t\t\tif (hour === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%I\"))\n\t\t\t{\n\t\t\t\thour = _int(value, 2);\n\t\t\t\tif (hour === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%M\"))\n\t\t\t{\n\t\t\t\tminute = _int(value, 2);\n\t\t\t\tif (minute === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%S\"))\n\t\t\t{\n\t\t\t\tsecond = _int(value, 2);\n\t\t\t\tif (second === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%p\"))\n\t\t\t{\n\t\t\t\tif (value.toLowerCase().startsWith(\"pm\"))\n\t\t\t\t\tispm = true;\n\t\t\t\telse if (value.toLowerCase().startsWith(\"am\"))\n\t\t\t\t\tispm = false;\n\t\t\t\telse\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%%\"))\n\t\t\t{\n\t\t\t\tif (!value.startsWith(\"%\"))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!value.startsWith(format.substring(0, 1)))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tformat = format.substring(1);\n\t\t\t}\n\t\t}\n\t\t// Are both `value` and `format` `null`?\n\t\t// I.e. both `value` and `format` must be exhausted, otherwise ...\n\t\tif (format)\n\t\t\t// ... `format` has remaining content that the value didn't provide\n\t\t\treturn null;\n\n\t\t// Check existance of values and their range\n\t\tif (year === null)\n\t\t\treturn null;\n\t\tif (month === null || month < 1 || month > 12)\n\t\t\treturn null;\n\t\tif (day === null || day < 1 || day > 31) // FIXME: Use the actuall number of days\n\t\t\treturn null;\n\t\tif (ispm === null)\n\t\t{\n\t\t\tif (hour < 0 || hour > 23)\n\t\t\t\treturn null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (hour < 0 || hour > 11)\n\t\t\t\treturn null;\n\t\t\tif (ispm)\n\t\t\t\thour += 12;\n\t\t}\n\t\tif (minute < 0 || minute > 59)\n\t\t\treturn null;\n\t\tif (minute < 0 || minute > 59)\n\t\t\treturn null;\n\t\tif (second < 0 || second > 60)\n\t\t\treturn null;\n\t\treturn new Date(year, month-1, day, hour, minute, second);\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (change.value instanceof Date)\n\t\t{\n\t\t\tchange.value = this._convert(change.value);\n\t\t}\n\t\telse if (change.value instanceof ul4.Date_)\n\t\t{\n\t\t\tchange.value = this._convert(change.value._date);\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = null;\n\t\t\tfor (let format of this.control.formatstrings_parse())\n\t\t\t{\n\t\t\t\tvalue = this._parse(change.value, format);\n\t\t\t\tif (value !== null)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (value !== null)\n\t\t\t\tchange.value = this._convert(value);\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_date_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (!value)\n\t\t\treturn null;\n\n\t\tfor (let format of this.control.formatstrings_parse())\n\t\t{\n\t\t\tlet date = this._parse(value, format);\n\t\t\tif (date !== null)\n\t\t\t\treturn this._convert(date);\n\t\t}\n\t\treturn null;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (value !== null)\n\t\t\tvalue = ul4._format(value, this.control.formatstring(), this.globals.lang);\n\t\tsuper._set_dom_value(value);\n\t}\n};\n\n\nexport class DateField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/date field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\treturn new ul4.Date_(date.getFullYear(), date.getMonth()+1, date.getDate());\n\t}\n};\n\n\nexport class DatetimeMinuteField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/datetimeminute field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\t// Get rid of seconds and milliseconds\n\t\tdate.setSeconds(0);\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n\nexport class DatetimeSecondField extends DateFieldBase\n{\n\tstatic classdoc = \"Holds the value of a date/datetimesecond field of a record (and related information)\";\n\n\t_convert(date)\n\t{\n\t\t// Get rid of milliseconds\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n\nexport class LookupFieldBase extends Field\n{\n\tstatic classdoc = \"Base type of LookupField and MultipleLookupField\";\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdate !== null)\n\t\t\treturn this._lookupdate;\n\t\telse\n\t\t\treturn this.control.lookupdata;\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tthis._lookupdate = value;\n\t}\n\n\t_find_lookupitem(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\t// If `lookupdata` is `null`, this probably an interface,\n\t\t\t// so we can't validate anything (note that interfaces will however go\n\t\t\t// away in the future)\n\t\t\tif (this.lookupdata === null)\n\t\t\t\treturn;\n\t\t\tlet lookupitem = this.control.lookupdata.get(v);\n\t\t\tif (lookupitem === undefined)\n\t\t\t{\n\t\t\t\t// If the lookup control is auto expandable,\n\t\t\t\t// the user may have given us a label\n\t\t\t\tif (this.control.autoexpandable)\n\t\t\t\t{\n\t\t\t\t\t// Search for the LookupItem with that label\n\t\t\t\t\tfor (let search_lookupitem of this.lookupdata.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (v === search_lookupitem.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchange.value = search_lookupitem;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// If we couldn't find the label, keep the label as it is.\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchange.errors.push(this.msg_lookup_unknownkey(v))\n\t\t\t\t\tchange.value = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = lookupitem;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof LookupItem)\n\t\t{\n\t\t\tlet value = this.control.lookupdata.get(v.key);\n\t\t\tif (value !== v)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_lookup_wrongitem(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class LookupField extends LookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a lookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (v === null || v === \"\" || this.control.nonekey === v)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t}\n\t}\n};\n\n\nexport class LookupRadioField extends LookupField\n{\n\tstatic classdoc = \"Holds the value of a lookup/radio field of a record (and related information)\";\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tfor (let node of document.querySelectorAll(this._sel_control))\n\t\t{\n\t\t\tif (node.checked)\n\t\t\t{\n\t\t\t\tlet key = node.getAttribute(\"value\");\n\t\t\t\treturn this.control.lookupdata.get(key);\n\t\t\t}\n\n\t\t}\n\t\treturn null;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (value instanceof LookupItem)\n\t\t\tvalue = value.key;\n\t\tif (value === null)\n\t\t\tvalue = this.control.nonekey;\n\n\t\tfor (let node of document.querySelectorAll(this._sel_control))\n\t\t\tnode.checked = node.getAttribute(\"value\") === value;\n\t}\n};\n\n\nexport class LookupSelectField extends LookupField\n{\n\tstatic classdoc = \"Holds the value of a lookup/select field of a record (and related information)\";\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tif (value === this.control.nonekey)\n\t\t\t\tvalue = null;\n\t\t\telse\n\t\t\t\tvalue = this.control.lookupdata.get(value);\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tsuper._set_dom_value(change.value != null ? change.value.key : this.control.nonekey);\n\t}\n};\n\n\nexport class LookupChoiceField extends LookupField\n{\n\tstatic classdoc = \"Holds the value of a lookup/choice field of a record (and related information)\";\n};\n\n\nexport class MultipleLookupField extends LookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a multiple lookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.nonekey === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_lookupitem(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nexport class MultipleLookupCheckboxField extends MultipleLookupField\n{\n\tstatic classdoc = \"Holds the value of a multiplelookup/radio field of a record (and related information)\";\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = [];\n\t\tfor (let node of document.querySelectorAll(this._sel_control))\n\t\t{\n\t\t\tif (node.checked)\n\t\t\t{\n\t\t\t\tlet key = node.getAttribute(\"value\");\n\t\t\t\tvalue.push(this.control.lookupdata.get(key));\n\t\t\t}\n\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tlet values = new Set();\n\t\tfor (let value of change.value)\n\t\t\tvalues.add(value.key);\n\n\t\tfor (let node of document.querySelectorAll(this._sel_control))\n\t\t\tnode.checked = values.has(node.getAttribute(\"value\"));\n\t}\n};\n\n\nexport class MultipleLookupSelectField extends MultipleLookupField\n{\n\tstatic classdoc = \"Holds the value of a multiplelookup/select field of a record (and related information)\";\n\n\t_get_dom_value()\n\t{\n\t\tlet value = [];\n\t\tfor (let option of document.querySelector(this._sel_control).querySelectorAll(\"option\"))\n\t\t{\n\t\t\tif (option.selected)\n\t\t\t\tvalue.push(this.control.lookupdata.get(option.getAttribute(\"value\")));\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tlet values = new Set();\n\t\tfor (let value of change.value)\n\t\t\tvalues.add(value.key);\n\t\tfor (let option of document.querySelector(this._sel_control).querySelectorAll(\"option\"))\n\t\t\toption.selected = values.has(option.getAttribute(\"value\"));\n\t}\n};\n\n\nexport class MultipleLookupChoiceField extends MultipleLookupField\n{\n\tstatic classdoc = \"Holds the value of a multiplelookup/choice field of a record (and related information)\";\n};\n\n\nexport class AppLookupFieldBase extends Field\n{\n\tstatic classdoc = \"Base type of AppLookupField and MultipleAppLookupField\";\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdata !== null)\n\t\t\treturn this._lookupdata;\n\t\telse\n\t\t{\n\t\t\tif (this.control.lookup_app.records !== null)\n\t\t\t\treturn this.control.lookup_app.records;\n\t\t}\n\t\treturn new Map();\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tthis._lookupdata = value;\n\t}\n\n\t_find_record(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\tlet record = this.control.lookup_app.records !== null ?\n\t\t\t\tthis.control.lookup_app.records.get(v) :\n\t\t\t\tundefined\n\t\t\t;\n\n\t\t\tif (record === undefined)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_unknownkey(v))\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = record;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof Record)\n\t\t{\n\t\t\tif (v.app !== this.control.lookup_app)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_wrongrecord(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nexport class AppLookupField extends AppLookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a applookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tthis._find_record(change);\n\t}\n};\n\n\nexport class AppLookupSelectField extends AppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `applookup`/`select` field of a record (and related information)\";\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\n\t\tif (this.control.lookup_app.records !== null)\n\t\t{\n\t\t\tvalue = this.control.lookup_app.records.get(value);\n\t\t\tif (value === undefined)\n\t\t\t\tvalue = null;\n\t\t}\n\t\telse\n\t\t\tvalue = null;\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tsuper._set_dom_value(change.value != null ? change.value.id : this.control.nonekey);\n\t}\n};\n\n\nexport class AppLookupRadioField extends AppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `applookup`/`radio` field of a record (and related information)\";\n};\n\n\nexport class AppLookupChoiceField extends AppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `applookup`/`choice` field of a record (and related information)\";\n};\n\n\nexport class MultipleAppLookupField extends AppLookupFieldBase\n{\n\tstatic classdoc = \"Holds the value of a multiple applookup field of a record (and related information)\";\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.nonekey === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_record(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_record(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nexport class MultipleAppLookupCheckboxField extends MultipleAppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `multipleapplookup`/`checkbox` field of a record (and related information)\";\n};\n\n\nexport class MultipleAppLookupSelectField extends MultipleAppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `multipleapplookup`/`select` field of a record (and related information)\";\n};\n\n\nexport class MultipleAppLookupChoiceField extends MultipleAppLookupField\n{\n\tstatic classdoc = \"Holds the value of a `multipleapplookup`/`choice` field of a record (and related information)\";\n};\n\n\nexport class Control extends Base\n{\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.app.globals;\n\t}\n\n\tget fulltype()\n\t{\n\t\treturn this.subtype ? this.type + \"/\" + this.subtype : this.type;\n\t}\n\n\tget label()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn this._label;\n\t\tlet label = view_control.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t}\n\n\tget default()\n\t{\n\t\treturn null;\n\t}\n\n\tget top()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.top : null;\n\t}\n\n\tget left()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.left : null;\n\t}\n\n\tget width()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.width : null;\n\t}\n\n\tget height()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.height : null;\n\t}\n\n\tget liveupdate()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.liveupdate : false;\n\t}\n\n\tget tabindex()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.tabindex : null;\n\t}\n\n\tget required()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.required : false;\n\t}\n\n\tget mode()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (this.app._active_view !== null && view_control === null)\n\t\t\treturn null;\n\t\tif (this.app.globals.mode === null)\n\t\t\treturn \"display\";\n\t\treturn view_control !== null ? view_control.mode : \"edit\";\n\t}\n\n\tget labelpos()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelpos : \"left\";\n\t}\n\n\tget labelwidth()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelwidth : null;\n\t}\n\n\tget autoalign()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.autoalign : true;\n\t}\n\n\tget in_active_view()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null;\n\t}\n\n\t_view_control()\n\t{\n\t\tif (this.app._active_view === null)\n\t\t\treturn null;\n\t\tlet view_control = this.app._active_view.controls.get(this.identifier);\n\t\treturn view_control ?? null;\n\t}\n\n\t_logsearch(value, search)\n\t{\n\t\t//console.log(\"Searching for \" + ul4._repr(search.value) + \" in \" + ul4._repr(this) + \" with operator \" + search.operator + \" in value \" + ul4._repr(value));\n\t}\n\n\t// base implemntation, always returns ``false`` (i.e. \"not found\")\n\t// ``value`` is the value of the field\n\t// ``search`` is an object with information what we're searching for\n\t// keys in ``search`` are: ``operator`` (and ``value`` (if required by the operator))\n\tsearch(value, search)\n\t{\n\t\treturn false;\n\t}\n};\n\nControl.prototype.type = null;\nControl.prototype.subtype = null;\nControl.prototype._ul4onattrs = [\"identifier\", \"fieldname\", \"app\", \"_label\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\"];\nControl.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"fieldname\", \"app\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\", \"fulltype\", \"label\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"tabindex\", \"required\", \"mode\", \"labelpos\", \"autoalign\", \"in_active_view\"]);\nControl.prototype._cssclass_root = \"llft-control\";\nControl.prototype._cssclass_control = \"input\";\n\n\nexport class BoolControl extends Control\n{\n\tstatic classdoc = \"A LivingApps boolean field (type 'bool')\";\n\n\t// ``search`` must by ``null``, ``false`` or ``true``\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nBoolControl.prototype.type = \"bool\";\nBoolControl.prototype.fieldtype = BoolField;\n\n\nexport class IntControl extends Control\n{\n\tstatic classdoc = \"A LivingApps integer field (type 'int')\";\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nIntControl.prototype.type = \"int\";\nIntControl.prototype.fieldtype = IntField;\n\n\nclass PlaceholderControl extends Control\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/select')\";\n\n\tget placeholder()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.placeholder;\n\t}\n};\n\nPlaceholderControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"placeholder\"]);\n\n\nexport class NumberControl extends PlaceholderControl\n{\n\tstatic classdoc = \"A LivingApps number field (type 'number')\";\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"range\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn false;\n\t\t\treturn (search.minvalue === null || search.minvalue <= value) && (search.maxvalue === null || value < search.maxvalue);\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nNumberControl.prototype.type = \"number\";\nNumberControl.prototype.fieldtype = NumberField;\nNumberControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"precision\", \"minimum\", \"maximum\"];\nNumberControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"precision\", \"minimum\", \"maximum\"]);\n\n\nexport class StringControl extends PlaceholderControl\n{\n\t_user_placeholder(user, placeholder)\n\t{\n\t\tif (placeholder === null)\n\t\t\treturn null;\n\t\tswitch (placeholder)\n\t\t{\n\t\t\tcase \"{gender}\":\n\t\t\t\treturn user !== null ? user.gender : null;\n\t\t\tcase \"{title}\":\n\t\t\t\treturn user !== null ? user.title : null;\n\t\t\tcase \"{firstname}\":\n\t\t\t\treturn user !== null ? user.firstname : null;\n\t\t\tcase \"{surname}\":\n\t\t\t\treturn user !== null ? user.surname : null;\n\t\t\tcase \"{account}\":\n\t\t\t\treturn user !== null ? user.email : null;\n\t\t\tcase \"{streetname}\":\n\t\t\t\treturn user !== null ? user.streetname : null;\n\t\t\tcase \"{streetnumber}\":\n\t\t\t\treturn user !== null ? user.streetnumber : null;\n\t\t\tcase \"{street}\":\n\t\t\t\tif (user === null)\n\t\t\t\t\treturn null;\n\t\t\t\telse if (user.street === null)\n\t\t\t\t\treturn user.streetnumber;\n\t\t\t\telse if (user.streetnumber === null)\n\t\t\t\t\treturn user.street;\n\t\t\t\telse\n\t\t\t\t\treturn user.street + \" \" + user.streetnumber;\n\t\t\tcase \"{zip}\":\n\t\t\t\treturn user !== null ? user.zip : null;\n\t\t\tcase \"{phone}\":\n\t\t\t\treturn user !== null ? user.phone : null;\n\t\t\tcase \"{fax}\":\n\t\t\t\treturn user !== null ? user.fax : null;\n\t\t\tcase \"{company}\":\n\t\t\t\treturn user !== null ? user.company : null;\n\t\t\tcase \"{city}\":\n\t\t\t\treturn user !== null ? user.city : null;\n\t\t\tcase \"{summary}\":\n\t\t\t\treturn user !== null ? user.summary : null;\n\t\t\tcase \"{interests}\":\n\t\t\t\treturn user !== null ? user.interests : null;\n\t\t\tcase \"{personal_website}\":\n\t\t\t\treturn user !== null ? user.personal_website : null;\n\t\t\tcase \"{company_website}\":\n\t\t\t\treturn user !== null ? user.company_website : null;\n\t\t\tcase \"{position}\":\n\t\t\t\treturn user !== null ? user.position : null;\n\t\t\tcase \"{department}\":\n\t\t\t\treturn user !== null ? user.department : null;\n\t\t\tcase \"{today}\":\n\t\t\t\treturn ul4.today();\n\t\t\tdefault:\n\t\t\t\treturn placeholder;\n\t\t}\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this._user_placeholder(this.app.globals.user, view_control.default);\n\t}\n\n\tget minlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 0;\n\t\tlet minlength = view_control.minlength;\n\t\tif (minlength === null || minlength < 0)\n\t\t\treturn 0;\n\t\treturn minlength;\n\t}\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 4000;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength === null || maxlength < 0 || maxlength > 4000)\n\t\t\treturn 4000;\n\t\treturn maxlength;\n\t}\n\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (search.value === null || value === null)\n\t\t\t\treturn search.value === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(search.value.toLowerCase()) >= 0;\n\t\t}\n\t}\n};\n\nStringControl.prototype.type = \"string\";\n\n\nexport class TextControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps text field (type 'string/text')\";\n};\n\nTextControl.prototype.subtype = \"text\";\nTextControl.prototype.fieldtype = StringField;\n\n\nexport class EmailControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps email field (type 'string/email')\";\n};\n\nEmailControl.prototype.subtype = \"email\";\nEmailControl.prototype.fieldtype = EmailField;\n\n\nexport class URLControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps URL field (type 'string/url')\";\n};\n\nURLControl.prototype.subtype = \"url\";\nURLControl.prototype.fieldtype = URLField;\n\n\nexport class TelControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps phone number field (type 'string/tel')\";\n};\n\nTelControl.prototype.subtype = \"tel\";\nTelControl.prototype.fieldtype = TelField;\n\n\nexport class TextAreaControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps textarea field (type 'string/textarea')\";\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\t// We only get the encrypted text in encryption mode, so we can't check its length\n\t\tif (this.encrypted !== null)\n\t\t\treturn null;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength < 0)\n\t\t\treturn null;\n\t\treturn maxlength;\n\t}\n};\n\nTextAreaControl.prototype.subtype = \"textarea\";\nTextAreaControl.prototype.fieldtype = TextAreaField;\nTextAreaControl.prototype._ul4onattrs = [...StringControl.prototype._ul4onattrs, \"encrypted\"];\nTextAreaControl.prototype._ul4attrs = new Set([...StringControl.prototype._ul4attrs, \"encrypted\"]);\nTextAreaControl.prototype._cssclass_control = \"textarea\";\n\n\nexport class HTMLControl extends StringControl\n{\n\tstatic classdoc = \"A LivingApps HTML field (type 'string/html')\";\n};\n\nHTMLControl.prototype.subtype = \"html\";\nHTMLControl.prototype.fieldtype = HTMLField;\n\n\nexport class DateControl extends PlaceholderControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/date')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn view_control.default === \"{today}\" ? ul4.today() : null;\n\t}\n\n\tformatstring(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\t\treturn this._formatstrings[lang];\n\t}\n\n\tformatstrings_parse(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\n\t\treturn [\n\t\t\tthis._formatstrings[lang],\n\t\t\t...this._formatstrings[\"intl\"],\n\t\t\tDatetimeMinuteControl.prototype._formatstrings[lang],\n\t\t\t...DatetimeMinuteControl.prototype._formatstrings[\"intl\"],\n\t\t\tDatetimeSecondControl.prototype._formatstrings[lang],\n\t\t\t...DatetimeSecondControl.prototype._formatstrings[\"intl\"]\n\t\t];\n\t}\n\n\t// searchvalue must be ``null``, a ``Date`` object or a string\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\n\t\tlet searchvalue = search.value;\n\t\tif (Object.prototype.toString.call(searchvalue) == \"[object Date]\")\n\t\t\tsearchvalue = ul4._format(searchvalue, this.formatstring(), this.app.language);\n\t\tif (value !== null)\n\t\t\tvalue = ul4._format(value, this.formatstring(), this.app.language);\n\n\t\tif (search.operator === \"equals\")\n\t\t\treturn searchvalue === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (searchvalue === null || value === null)\n\t\t\t\treturn searchvalue === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(searchvalue.toLowerCase()) >= 0;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nDateControl.prototype.type = \"date\";\nDateControl.prototype.subtype = \"date\";\nDateControl.prototype.fieldtype = DateField;\nDateControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y\",\n\t\"fr\": \"%d.%m.%Y\",\n\t\"it\": \"%d.%m.%Y\",\n\t\"en\": \"%m/%d/%Y\",\n\t\"intl\": [\"%Y-%m-%d\"]\n};\n\n\nexport class DatetimeMinuteControl extends DateControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/datetimeminute')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setSeconds(0);\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tformatstrings_parse(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\n\t\treturn [\n\t\t\tthis._formatstrings[lang],\n\t\t\t...this._formatstrings[\"intl\"],\n\t\t\tDatetimeSecondControl.prototype._formatstrings[lang],\n\t\t\t...DatetimeSecondControl.prototype._formatstrings[\"intl\"],\n\t\t\tDateControl.prototype._formatstrings[lang],\n\t\t\t...DateControl.prototype._formatstrings[\"intl\"]\n\t\t];\n\t}\n};\n\nDatetimeMinuteControl.prototype.subtype = \"datetimeminute\";\nDatetimeMinuteControl.prototype.fieldtype = DatetimeMinuteField;\nDatetimeMinuteControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y %H:%M\",\n\t\"fr\": \"%d.%m.%Y %H:%M\",\n\t\"it\": \"%d.%m.%Y %H:%M\",\n\t\"en\": \"%m/%d/%Y %H:%M\",\n\t\"intl\": [\"%Y-%m-%dT%H:%M\", \"%Y-%m-%d %H:%M\"]\n};\n\n\nexport class DatetimeSecondControl extends DateControl\n{\n\tstatic classdoc = \"A LivingApps date field (type 'date/datetimesecond')\";\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n\n\tformatstrings_parse(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\n\t\treturn [\n\t\t\tthis._formatstrings[lang],\n\t\t\t...this._formatstrings[\"intl\"],\n\t\t\tDatetimeMinuteControl.prototype._formatstrings[lang],\n\t\t\t...DatetimeMinuteControl.prototype._formatstrings[\"intl\"],\n\t\t\tDateControl.prototype._formatstrings[lang],\n\t\t\t...DateControl.prototype._formatstrings[\"intl\"]\n\t\t];\n\t}\n};\n\nDatetimeSecondControl.prototype.subtype = \"datetimesecond\";\nDatetimeSecondControl.prototype.fieldtype = DatetimeSecondField;\nDatetimeSecondControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y %H:%M:%S\",\n\t\"fr\": \"%d.%m.%Y %H:%M:%S\",\n\t\"it\": \"%d.%m.%Y %H:%M:%S\",\n\t\"en\": \"%m/%d/%Y %H:%M:%S\",\n\t\"intl\": [\"%Y-%m-%dT%H:%M:%S\", \"%Y-%m-%d %H:%M:%S\"]\n};\n\n\nexport class LookupControl extends Control\n{\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this.lookupdata.get(view_control) ?? null;\n\t}\n\n\tget autoexpandable()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn false;\n\t\treturn view_control.autoexpandable;\n\t}\n\n\tget nonekey()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonekey;\n\t}\n\n\tget nonelabel()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonelabel;\n\t}\n\n\t// ``search.value`` must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn search.value === null;\n\t\t\telse\n\t\t\t\treturn value.key === search.value;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nLookupControl.prototype.type = \"lookup\";\nLookupControl.prototype.fieldtype = LookupField;\nLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookupdata\"];\nLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookupdata\"]);\n\n\nexport class LookupSelectControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/select')\";\n\n};\n\nLookupSelectControl.prototype.subtype = \"select\";\nLookupSelectControl.prototype.fieldtype = LookupSelectField;\nLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nexport class LookupRadioControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/radio')\";\n};\n\nLookupRadioControl.prototype.subtype = \"radio\";\nLookupRadioControl.prototype.fieldtype = LookupRadioField;\nLookupRadioControl.prototype._cssclass_root = \"llft-element\";\n\n\nexport class LookupChoiceControl extends LookupControl\n{\n\tstatic classdoc = \"A LivingApps lookup field (type 'lookup/choice')\";\n\n};\n\nLookupChoiceControl.prototype.subtype = \"choice\";\nLookupChoiceControl.prototype.fieldtype = LookupChoiceField;\n\n\nexport class AppLookupControl extends Control\n{\n\tget nonekey()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonekey;\n\t}\n\n\tget nonelabel()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonelabel;\n\t}\n\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (value === null || search.value === null)\n\t\t\treturn value === search.value;\n\t\telse\n\t\t\treturn value.search(search);\n\t}\n};\n\nAppLookupControl.prototype.type = \"applookup\";\nAppLookupControl.prototype.fieldtype = AppLookupField;\nAppLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"];\nAppLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"]);\n\n\nexport class AppLookupSelectControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/select')\";\n\n};\n\nAppLookupSelectControl.prototype.subtype = \"select\";\nAppLookupSelectControl.prototype.fieldtype = AppLookupSelectField;\nAppLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nexport class AppLookupRadioControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/radio')\";\n\n};\n\nAppLookupRadioControl.prototype.subtype = \"radio\";\nAppLookupRadioControl.prototype.fieldtype = AppLookupRadioField;\n\n\nexport class AppLookupChoiceControl extends AppLookupControl\n{\n\tstatic classdoc = \"A LivingApps applookup field (type 'applookup/choice')\";\n\n};\n\nAppLookupChoiceControl.prototype.subtype = \"choice\";\nAppLookupChoiceControl.prototype.fieldtype = AppLookupChoiceField;\n\n\nexport class MultipleLookupControl extends LookupControl\n{\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tlet defaultValue = this.lookupdata.get(view_control)\n\n\t\treturn (defaultValue !== undefined) ? [defaultValue] : [];\n\t}\n\n\t// search.value must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tfor (let item of value)\n\t\t\t{\n\t\t\t\tif (item.key === search.value)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleLookupControl.prototype.type = \"multiplelookup\";\nMultipleLookupControl.prototype.fieldtype = MultipleLookupField;\n\n\nexport class MultipleLookupCheckboxControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/checkbox')\";\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n};\n\nMultipleLookupCheckboxControl.prototype.subtype = \"checkbox\";\nMultipleLookupCheckboxControl.prototype.fieldtype = MultipleLookupCheckboxField;\nMultipleLookupCheckboxControl.prototype._cssclass_root = \"llft-element\";\n\n\nexport class MultipleLookupSelectControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/select')\";\n\n};\n\nMultipleLookupSelectControl.prototype.subtype = \"select\";\nMultipleLookupSelectControl.prototype.fieldtype = MultipleLookupSelectField;\nMultipleLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nexport class MultipleLookupChoiceControl extends MultipleLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiplelookup field (type 'multiplelookup/choice')\";\n\n};\n\nMultipleLookupChoiceControl.prototype.subtype = \"choice\";\nMultipleLookupChoiceControl.prototype.fieldtype = MultipleLookupChoiceField;\n\n\nexport class MultipleAppLookupControl extends AppLookupControl\n{\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (search.value === null)\n\t\t\t\treturn value.length === 0;\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let item of value)\n\t\t\t\t{\n\t\t\t\t\tif (item.search(search.value))\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleAppLookupControl.prototype.type = \"multipleapplookup\";\nMultipleAppLookupControl.prototype.fieldtype = MultipleAppLookupField;\n\n\nexport class MultipleAppLookupSelectControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/select')\";\n\n};\n\nMultipleAppLookupSelectControl.prototype.subtype = \"select\";\nMultipleAppLookupSelectControl.prototype.fieldtype = MultipleAppLookupSelectField;\nMultipleAppLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nexport class MultipleAppLookupCheckboxControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/checkbox')\";\n\n};\n\nMultipleAppLookupCheckboxControl.prototype.subtype = \"checkbox\";\nMultipleAppLookupCheckboxControl.prototype.fieldtype = MultipleAppLookupCheckboxField;\n\n\nexport class MultipleAppLookupChoiceControl extends MultipleAppLookupControl\n{\n\tstatic classdoc = \"A LivingApps multiple applookup field (type 'multipleapplookup/choice')\";\n};\n\nMultipleAppLookupChoiceControl.prototype.subtype = \"choice\";\nMultipleAppLookupChoiceControl.prototype.fieldtype = MultipleAppLookupChoiceField;\n\n\nexport class GeoControl extends Control\n{\n\tstatic classdoc = \"A LivingApps geo field (type 'geo')\";\n};\n\nGeoControl.prototype.type = \"geo\";\nGeoControl.prototype.fieldtype = GeoField;\nGeoControl.prototype._cssclass_root = \"llft-element\";\n\n\nexport class FileControl extends Control\n{\n\tstatic classdoc = \"A LivingApps upload field (type 'file')\";\n};\n\nFileControl.prototype.type = \"file\";\nFileControl.prototype.fieldtype = FileField;\nFileControl.prototype._cssclass_root = \"llft-element\";\n\n\nexport class FileSignatureControl extends FileControl\n{\n\tstatic classdoc = \"A LivingApps signature image field (type 'file/signature')\";\n};\n\nFileSignatureControl.prototype.subtype = \"signature\";\nFileSignatureControl.prototype.fieldtype = FileSignatureField;\n\n\nexport class ButtonControl extends Control\n{\n};\n\nButtonControl.prototype.type = \"button\";\n\n\nexport class LookupItem extends Base\n{\n\tstatic classdoc = \"An option in a lookup control/field\";\n\n\tget label()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn this._label;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn this._label;\n\t\tlet label = view_lookupitem.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tget visible()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn true;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn true;\n\t\treturn view_lookupitem.visible;\n\t}\n\n\t_view_lookupitem()\n\t{\n\t\tlet identifier = this.control.identifier;\n\t\tlet active_view = this.control.app.active_view;\n\t\tif (active_view !== null && active_view.controls !== null)\n\t\t{\n\t\t\tlet view_control = active_view.controls.get(identifier);\n\t\t\tif (view_control !== undefined && view_control.lookupdata !== undefined && view_control.lookupdata !== null)\n\t\t\t{\n\t\t\t\tlet view_lookupitem = view_control.lookupdata.get(this.key);\n\t\t\t\tif (view_lookupitem !== undefined)\n\t\t\t\t\treturn view_lookupitem;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<LookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \"visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nLookupItem.prototype._ul4onattrs = [\"control\", \"key\", \"_label\"];\nLookupItem.prototype._ul4attrs = new Set([\"id\", \"control\", \"key\", \"label\"]);\n\n\nexport class ViewLookupItem extends Base\n{\n\tstatic classdoc = \"View specific information about a lookup item\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<ViewLookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \" visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nViewLookupItem.prototype._ul4onattrs = [\"key\", \"label\", \"visible\"];\nViewLookupItem.prototype._ul4attrs = new Set([\"key\", \"label\", \"visible\"]);\n\n\nexport class LayoutControl extends Base\n{\n\tstatic classdoc = \"A decoration in an input form\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nLayoutControl.prototype._ul4onattrs = [\"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\"];\nLayoutControl.prototype._ul4attrs = new Set([\"id\", \"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\"]);\n\n\nexport class HTMLLayoutControl extends LayoutControl\n{\n\tstatic classdoc = \"HTML decoration in an input form\";\n};\n\nHTMLLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"value\"];\nHTMLLayoutControl.prototype._ul4attrs = new Set([LayoutControl.prototype._ul4attrs, \"value\"]);\n\n\nexport class ImageLayoutControl extends LayoutControl\n{\n\tstatic classdoc = \"An image decoration in an input form\";\n};\n\nImageLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"original\", \"scaled\"];\nImageLayoutControl.prototype._ul4attrs = new Set([LayoutControl.prototype._ul4attrs, \"original\", \"scaled\"]);\n\n\nexport class ButtonLayoutControl extends LayoutControl\n{\n\tstatic classdoc = \"A submit button in an input form\";\n};\n\n\nexport class ViewControl extends Base\n{\n\tstatic classdoc = \"Contains view specific information aboutn a control\";\n\n\tget mode()\n\t{\n\t\treturn this._mode ? \"display\" : \"edit\";\n\t}\n};\n\nViewControl.prototype._ul4onattrs = [\"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"_mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"];\nViewControl.prototype._ul4attrs = new Set([\"id\", \"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"]);\n\n\nexport class User extends Base\n{\n\tstatic classdoc = \"A LivingApps user/account\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<User id=\" + ul4._repr(this.id) + \" firstname=\" + ul4._repr(this.firstname) + \" surname=\" + ul4._repr(this.surname) + \" email=\" + ul4._repr(this.email) + \">\";\n\t}\n};\n\nUser.prototype._ul4onattrs = [\"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"avatarsmall\", \"avatarlarge\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"];\nUser.prototype._ul4attrs = new Set([\"id\", \"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"avatarsmall\", \"avatarlarge\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"]);\n\n\nexport class File extends Base\n{\n\tstatic classdoc = \"An uploaded file\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<File id=\" + ul4._repr(this.id) + \" url=\" + ul4._repr(this.url) + \" filename=\" + ul4._repr(this.filename) + \">\";\n\t}\n\n\tget archive_url()\n\t{\n\t\tif (this.archive ==- null)\n\t\t\treturn this.url;\n\t\treturn this.archive.url + \"/\" + this.filename;\n\t}\n};\n\nFile.prototype._ul4onattrs = [\"url\", \"filename\", \"mimetype\", \"width\", \"height\", \"internalid\", \"createdat\", \"size\", \"archive\"];\nFile.prototype._ul4attrs = new Set([\"id\", \"url\", \"archive_url\", \"filename\", \"mimetype\", \"width\", \"height\", \"size\", \"archive\", \"createdat\"]);\n\n\nexport class Geo extends Base\n{\n\tstatic classdoc = \"Geographical coordinates and location information\";\n\n\tconstructor(lat, long, info)\n\t{\n\t\tsuper(null);\n\t\tthis.lat = lat;\n\t\tthis.long = long;\n\t\tthis.info = info;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Geo lat=\" + ul4._repr(this.lat) + \" long=\" + ul4._repr(this.long) + \" info=\" + ul4._repr(this.info) + \">\";\n\t}\n};\n\nGeo.prototype._ul4onattrs = [\"lat\", \"long\", \"info\"];\nGeo.prototype._ul4attrs = new Set([\"lat\", \"long\", \"info\"]);\n\n\nexport class Attachment extends Base\n{\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" label=\" + ul4._repr(this.label) + \">\";\n\t}\n};\n\nAttachment.prototype._ul4onattrs = [\"record\", \"label\", \"active\"];\nAttachment.prototype._ul4attrs = new Set([\"id\", \"record\", \"label\", \"active\"]);\n\n\nexport class NoteAttachment extends Attachment\n{\n\tstatic classdoc = \"A note attachment of a record\";\n\n};\n\nNoteAttachment.prototype.type = \"noteattachment\";\nNoteAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nNoteAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class URLAttachment extends Attachment\n{\n\tstatic classdoc = \"A URL attachment of a record\";\n\n};\n\nURLAttachment.prototype.type = \"urlattachment\";\nURLAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nURLAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class FileAttachment extends Attachment\n{\n\tstatic classdoc = \"A file attachment of a record\";\n\n};\n\nFileAttachment.prototype.type = \"fileattachment\";\nFileAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nFileAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class ImageAttachment extends Attachment\n{\n\tstatic classdoc = \"An image attachment of a record\";\n\n};\n\nImageAttachment.prototype.type = \"imageattachment\";\nImageAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"original\", \"thumb\", \"small\", \"medium\",\"large\"];\nImageAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"original\", \"thumb\", \"small\", \"medium\", \"large\"]);\n\n\nexport class JSONAttachment extends Attachment\n{\n\tstatic classdoc = \"A JSON attachment of a record\";\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"value\")\n\t\t\treturn ul4._asjson(this.value);\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"value\")\n\t\t\tthis.value = ul4._fromjson(value);\n\t\telse\n\t\t\tthis[name] = value\n\t}\n};\n\nJSONAttachment.prototype.type = \"jsonattachment\";\nJSONAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nJSONAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nexport class Installation extends Base\n{\n\tstatic classdoc = \"The installation that created an app\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Installation id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nInstallation.prototype._ul4onattrs = [\"name\"];\nInstallation.prototype._ul4attrs = new Set([\"id\", \"name\"]);\n\n\nexport class Category extends Base\n{\n\tstatic classdoc = \"A navigation category\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [];\n\t\tlet category = this;\n\t\twhile (category !== null)\n\t\t{\n\t\t\tv.splice(0, 0, category.identifier);\n\t\t\tcategory = category.parent;\n\t\t}\n\t\treturn \"<Category id=\" + ul4._repr(this.id) + \" identifierpath=\" + ul4._repr(v.join(\"/\")) +  + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nCategory.prototype._ul4onattrs = [\"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"];\nCategory.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"]);\n\n\nexport class KeyView extends Base\n{\n\tstatic classdoc = \"Object granting access to a view template\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<KeyView id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nKeyView.prototype._ul4onattrs = [\"identifier\", \"name\", \"key\", \"user\"];\nKeyView.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"key\", \"user\"]);\n\n\nexport class AppParameter extends Base\n{\n\tstatic classdoc = \"A parameter of a LivingApps application\";\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<AppParameter id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nAppParameter.prototype._ul4onattrs = [\"app\", \"identifier\", \"description\", \"value\"];\nAppParameter.prototype._ul4attrs = new Set([\"id\", \"app\", \"identifier\", \"description\", \"value\"]);\n\n\nlet classes = [\n\tGlobals,\n\tFlashMessage,\n\tApp,\n\tView,\n\tDataSource,\n\tRecord,\n\tBoolControl,\n\tIntControl,\n\tNumberControl,\n\tTextControl,\n\tEmailControl,\n\tURLControl,\n\tTelControl,\n\tTextAreaControl,\n\tDateControl,\n\tDatetimeMinuteControl,\n\tDatetimeSecondControl,\n\tLookupControl,\n\tLookupSelectControl,\n\tLookupRadioControl,\n\tLookupChoiceControl,\n\tAppLookupControl,\n\tAppLookupSelectControl,\n\tAppLookupRadioControl,\n\tAppLookupChoiceControl,\n\tMultipleLookupControl,\n\tMultipleLookupSelectControl,\n\tMultipleLookupCheckboxControl,\n\tMultipleLookupChoiceControl,\n\tMultipleAppLookupControl,\n\tMultipleAppLookupSelectControl,\n\tMultipleAppLookupCheckboxControl,\n\tMultipleAppLookupChoiceControl,\n\tGeoControl,\n\tFileControl,\n\tFileSignatureControl,\n\tButtonControl,\n\tField,\n\tBoolField,\n\tStringField,\n\tEmailField,\n\tURLField,\n\tTelField,\n\tTextAreaField,\n\tHTMLField,\n\tIntField,\n\tNumberField,\n\tGeoField,\n\tFileField,\n\tFileSignatureField,\n\tDateFieldBase,\n\tDateField,\n\tDatetimeMinuteField,\n\tDatetimeSecondField,\n\tLookupFieldBase,\n\tLookupField,\n\tMultipleLookupField,\n\tAppLookupFieldBase,\n\tAppLookupField,\n\tMultipleAppLookupField,\n\tLookupItem,\n\tViewLookupItem,\n\tLayoutControl,\n\tHTMLLayoutControl,\n\tImageLayoutControl,\n\tButtonLayoutControl,\n\tViewControl,\n\tUser,\n\tFile,\n\tGeo,\n\tNoteAttachment,\n\tURLAttachment,\n\tFileAttachment,\n\tImageAttachment,\n\tJSONAttachment,\n\tInstallation,\n\tCategory,\n\tKeyView,\n\tAppParameter\n];\n\nfor (let constructor of classes)\n{\n\tul4.register(\"de.livinglogic.livingapi.\" + constructor.name.toLowerCase(), constructor);\n}\n"],"names":["Base","id","this","encoder","i","_ul4onattrs","length","dump","_dumpUL4ONAttr","name","decoder","iter","loadcontent","iteritem","next","done","_loadUL4ONAttr","value","_setDefaultUL4ONAttr","ul4","symbols","getattr","_ul4attrs","has","realvalue","bind","_ul4_name","_ul4_signature","_ul4_needsobject","_ul4_needscontext","AttributeError","repr","constructor","Proto","Handler","record","Globals","version","hostname","platform","user","lang","app","maxdbactions","maxtemplateruntime","flashmessages","handler","url","width","height","type","enlarge","gravity","quality","rotate","blur","sharpen","format","cache","filename","File","encodeURIComponent","result","rotatet","_repr","geo1","geo2","sqsin","x","Math","sin","sqcos","sqsos","cos","deg2rad","PI","flat","lat1","lat","long1","lat2","F","G","l","S","C","w","atan","sqrt","D","T","H2","prototype","Set","FlashMessage","title","call","App","values","globals","save","active_view","Map","layout_controls","Record","_ismap","keys","identifier","fields","ArgumentError","_make_fields","_isobject","TypeError","_list","dicttype","items","startsWith","controls","substr","get","params","_active_view","view","views","ValueError","View","expose","insert","DataSource","setattr","createdat","createdby","updatedat","updatedby","updatecount","_sparsevalues","_values","_fields","children","attachments","errors","_sparsefielderrors","_sparsefieldlookupdata","_is_deleted","_is_new","defaults","lookupdata","control","field","fieldtype","set","_sparselookupdata","mode","v","priority","is_empty","push","state","join","is_dirty","has_errors","entries","key","search","fieldsearch","_bool","update","Field","_label","_lookupdate","_value","_this4","_in_form","_dirty","_enabled","_visible","_get_dom_value","oldvalue","change","_validate","_ne","_set_dom_value","document","querySelector","_sel_label","textContent","label","_set_dom_label","_islist","searchvalue","_type","minlength","maxlength","_cssclass_root","_sel_root","_cssclass_control","_sel_control","el","style","transition","overflowY","scrollHeight","_show","_hide","disabled","querySelectorAll","s","visible","BoolField","required","msg_field_required","msg_bool_truerequired","msg_field_wrong_type","checked","IntField","test","parseInt","_parse","msg_number_format","round","testvalue","NumberField","seps","commas","dots","c","convert","replace","floatvalue","parseFloat","isNaN","_bound_value","precision","_round","minimum","maximum","toFixed","StringField","msg_string_tooshort","msg_string_toolong","EmailField","msg_email_format","URLField","URL","exc","msg_url_format","protocol","TelField","msg_tel_format","TextAreaField","HTMLField","GeoField","Geo","FileField","FileSignatureField","DateFieldBase","year","month","day","hour","minute","second","ispm","_int","len","min","max","substring","toLowerCase","Date","_convert","Date_","_date","formatstrings_parse","msg_date_format","date","_format","formatstring","DateField","getFullYear","getMonth","getDate","DatetimeMinuteField","setSeconds","setMilliseconds","DatetimeSecondField","LookupFieldBase","lookupitem","undefined","autoexpandable","search_lookupitem","msg_lookup_unknownkey","LookupItem","msg_lookup_wrongitem","LookupField","nonekey","_find_lookupitem","LookupRadioField","node","getAttribute","LookupSelectField","LookupChoiceField","MultipleLookupField","islist","Object","toString","newvalue","singlechange","MultipleLookupCheckboxField","add","MultipleLookupSelectField","option","selected","MultipleLookupChoiceField","AppLookupFieldBase","_lookupdata","lookup_app","records","msg_applookup_unknownkey","msg_applookup_wrongrecord","AppLookupField","_find_record","AppLookupSelectField","AppLookupRadioField","AppLookupChoiceField","MultipleAppLookupField","MultipleAppLookupCheckboxField","MultipleAppLookupSelectField","MultipleAppLookupChoiceField","Control","subtype","view_control","_view_control","top","left","liveupdate","tabindex","labelpos","labelwidth","autoalign","BoolControl","_logsearch","operator","IntControl","PlaceholderControl","placeholder","NumberControl","minvalue","maxvalue","StringControl","gender","firstname","surname","email","streetname","streetnumber","street","zip","phone","fax","company","city","summary","interests","personal_website","company_website","position","department","today","_user_placeholder","indexOf","TextControl","EmailControl","URLControl","TelControl","TextAreaControl","encrypted","HTMLControl","DateControl","_formatstrings","DatetimeMinuteControl","DatetimeSecondControl","language","now","LookupControl","lookupnonekey","lookupnonelabel","LookupSelectControl","LookupRadioControl","LookupChoiceControl","AppLookupControl","AppLookupSelectControl","AppLookupRadioControl","AppLookupChoiceControl","MultipleLookupControl","defaultValue","MultipleLookupCheckboxControl","MultipleLookupSelectControl","MultipleLookupChoiceControl","MultipleAppLookupControl","MultipleAppLookupSelectControl","MultipleAppLookupCheckboxControl","MultipleAppLookupChoiceControl","GeoControl","FileControl","FileSignatureControl","ButtonControl","view_lookupitem","_view_lookupitem","ViewLookupItem","LayoutControl","HTMLLayoutControl","ImageLayoutControl","ButtonLayoutControl","ViewControl","_mode","User","archive","long","info","Attachment","NoteAttachment","URLAttachment","FileAttachment","ImageAttachment","JSONAttachment","_asjson","_fromjson","Installation","Category","category","splice","parent","KeyView","AppParameter","register"],"mappings":"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AO,WAOxE1E,EAAIC,QAAQW,SAJDmZ,mNAIZ,uBAEQ,oBAAsB/Z,EAAI6C,MAAM9D,KAAKD,IAAM,eAAiBkB,EAAI6C,MAAM9D,KAAKyG,YAAc,sBANhE3G,mBAArBkb,cAEM,2CAQnBA,GAAatV,UAAUvF,YAAc,CAAC,MAAO,aAAc,cAAe,SAC1E6a,GAAatV,UAAUtE,UAAY,IAAIuE,IAAI,CAAC,KAAM,MAAO,aAAc,cAAe,UAqFtF,IAlFA,YAAc,CACbzD,EACA0D,EACAG,EACA4B,EACAG,EACAxB,EACA4O,GACAG,GACAG,GACAyB,GACAC,GACAC,GACAC,GACAC,GACAG,GACAE,GACAC,GACAG,GACAG,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAG,GACAD,GACAE,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACA/O,EACAyC,EACA6B,EACAG,EACAE,EACAK,EACAE,EACAC,EACApC,EACAO,EACA8B,EACAE,EACAC,EACAC,EACAuB,EACAI,EACAG,EACAC,EACAQ,EACAQ,GACAY,GACAM,GACAK,GACAjC,GACAqH,GACAC,GACAC,GACAC,GACAC,GACAC,GACAE,GACApW,GACAgM,GACAyK,GACAC,GACAC,GACAC,GACAC,GACAG,GACAC,GACAI,GACAC,sBAID,KADSlZ,UAERb,EAAIga,SAAS,4BAA8BnZ,GAAYvB,KAAKmQ,cAAe5O"}