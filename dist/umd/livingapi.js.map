{"version":3,"file":"livingapi.js","sources":["../../node_modules/dompurify/src/utils.js","../../node_modules/dompurify/src/tags.js","../../node_modules/dompurify/src/attrs.js","../../node_modules/dompurify/src/regexp.js","../../node_modules/dompurify/src/purify.js","../../src/livingapi.js"],"sourcesContent":["const {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n} = Object;\n\nlet { freeze, seal, create } = Object; // eslint-disable-line import/no-mutable-exports\nlet { apply, construct } = typeof Reflect !== 'undefined' && Reflect;\n\nif (!freeze) {\n  freeze = function (x) {\n    return x;\n  };\n}\n\nif (!seal) {\n  seal = function (x) {\n    return x;\n  };\n}\n\nif (!apply) {\n  apply = function (fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\n\nif (!construct) {\n  construct = function (Func, args) {\n    return new Func(...args);\n  };\n}\n\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayIndexOf = unapply(Array.prototype.indexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySlice = unapply(Array.prototype.slice);\n\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\n\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\n\nconst regExpTest = unapply(RegExp.prototype.test);\n\nconst typeErrorCreate = unconstruct(TypeError);\n\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param {Function} func - The function to be wrapped and called.\n * @returns {Function} A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return (thisArg, ...args) => apply(func, thisArg, args);\n}\n\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param {Function} func - The constructor function to be wrapped and called.\n * @returns {Function} A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(func) {\n  return (...args) => construct(func, args);\n}\n\n/**\n * Add properties to a lookup table\n *\n * @param {Object} set - The set to which elements will be added.\n * @param {Array} array - The array containing elements to be added to the set.\n * @param {Function} transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns {Object} The modified set with added elements.\n */\nfunction addToSet(set, array, transformCaseFunc = stringToLowerCase) {\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n\n        element = lcElement;\n      }\n    }\n\n    set[element] = true;\n  }\n\n  return set;\n}\n\n/**\n * Clean up an array to harden against CSPP\n *\n * @param {Array} array - The array to be cleaned.\n * @returns {Array} The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n\n  return array;\n}\n\n/**\n * Shallow clone an object\n *\n * @param {Object} object - The object to be cloned.\n * @returns {Object} A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (\n        value &&\n        typeof value === 'object' &&\n        value.constructor === Object\n      ) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n\n  return newObject;\n}\n\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param {Object} object - The object to look up the getter function in its prototype chain.\n * @param {String} prop - The property name for which to find the getter function.\n * @returns {Function} The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n\n    object = getPrototypeOf(object);\n  }\n\n  function fallbackValue() {\n    return null;\n  }\n\n  return fallbackValue;\n}\n\nexport {\n  // Array\n  arrayForEach,\n  arrayIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySlice,\n  // Object\n  entries,\n  freeze,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n  isFrozen,\n  setPrototypeOf,\n  seal,\n  clone,\n  create,\n  objectHasOwnProperty,\n  // RegExp\n  regExpTest,\n  // String\n  stringIndexOf,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringTrim,\n  // Errors\n  typeErrorCreate,\n  // Other\n  lookupGetter,\n  addToSet,\n  // Reflect\n  unapply,\n  unconstruct,\n};\n","import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'a',\n  'abbr',\n  'acronym',\n  'address',\n  'area',\n  'article',\n  'aside',\n  'audio',\n  'b',\n  'bdi',\n  'bdo',\n  'big',\n  'blink',\n  'blockquote',\n  'body',\n  'br',\n  'button',\n  'canvas',\n  'caption',\n  'center',\n  'cite',\n  'code',\n  'col',\n  'colgroup',\n  'content',\n  'data',\n  'datalist',\n  'dd',\n  'decorator',\n  'del',\n  'details',\n  'dfn',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'element',\n  'em',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'font',\n  'footer',\n  'form',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hgroup',\n  'hr',\n  'html',\n  'i',\n  'img',\n  'input',\n  'ins',\n  'kbd',\n  'label',\n  'legend',\n  'li',\n  'main',\n  'map',\n  'mark',\n  'marquee',\n  'menu',\n  'menuitem',\n  'meter',\n  'nav',\n  'nobr',\n  'ol',\n  'optgroup',\n  'option',\n  'output',\n  'p',\n  'picture',\n  'pre',\n  'progress',\n  'q',\n  'rp',\n  'rt',\n  'ruby',\n  's',\n  'samp',\n  'section',\n  'select',\n  'shadow',\n  'small',\n  'source',\n  'spacer',\n  'span',\n  'strike',\n  'strong',\n  'style',\n  'sub',\n  'summary',\n  'sup',\n  'table',\n  'tbody',\n  'td',\n  'template',\n  'textarea',\n  'tfoot',\n  'th',\n  'thead',\n  'time',\n  'tr',\n  'track',\n  'tt',\n  'u',\n  'ul',\n  'var',\n  'video',\n  'wbr',\n]);\n\n// SVG\nexport const svg = freeze([\n  'svg',\n  'a',\n  'altglyph',\n  'altglyphdef',\n  'altglyphitem',\n  'animatecolor',\n  'animatemotion',\n  'animatetransform',\n  'circle',\n  'clippath',\n  'defs',\n  'desc',\n  'ellipse',\n  'filter',\n  'font',\n  'g',\n  'glyph',\n  'glyphref',\n  'hkern',\n  'image',\n  'line',\n  'lineargradient',\n  'marker',\n  'mask',\n  'metadata',\n  'mpath',\n  'path',\n  'pattern',\n  'polygon',\n  'polyline',\n  'radialgradient',\n  'rect',\n  'stop',\n  'style',\n  'switch',\n  'symbol',\n  'text',\n  'textpath',\n  'title',\n  'tref',\n  'tspan',\n  'view',\n  'vkern',\n]);\n\nexport const svgFilters = freeze([\n  'feBlend',\n  'feColorMatrix',\n  'feComponentTransfer',\n  'feComposite',\n  'feConvolveMatrix',\n  'feDiffuseLighting',\n  'feDisplacementMap',\n  'feDistantLight',\n  'feDropShadow',\n  'feFlood',\n  'feFuncA',\n  'feFuncB',\n  'feFuncG',\n  'feFuncR',\n  'feGaussianBlur',\n  'feImage',\n  'feMerge',\n  'feMergeNode',\n  'feMorphology',\n  'feOffset',\n  'fePointLight',\n  'feSpecularLighting',\n  'feSpotLight',\n  'feTile',\n  'feTurbulence',\n]);\n\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nexport const svgDisallowed = freeze([\n  'animate',\n  'color-profile',\n  'cursor',\n  'discard',\n  'font-face',\n  'font-face-format',\n  'font-face-name',\n  'font-face-src',\n  'font-face-uri',\n  'foreignobject',\n  'hatch',\n  'hatchpath',\n  'mesh',\n  'meshgradient',\n  'meshpatch',\n  'meshrow',\n  'missing-glyph',\n  'script',\n  'set',\n  'solidcolor',\n  'unknown',\n  'use',\n]);\n\nexport const mathMl = freeze([\n  'math',\n  'menclose',\n  'merror',\n  'mfenced',\n  'mfrac',\n  'mglyph',\n  'mi',\n  'mlabeledtr',\n  'mmultiscripts',\n  'mn',\n  'mo',\n  'mover',\n  'mpadded',\n  'mphantom',\n  'mroot',\n  'mrow',\n  'ms',\n  'mspace',\n  'msqrt',\n  'mstyle',\n  'msub',\n  'msup',\n  'msubsup',\n  'mtable',\n  'mtd',\n  'mtext',\n  'mtr',\n  'munder',\n  'munderover',\n  'mprescripts',\n]);\n\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nexport const mathMlDisallowed = freeze([\n  'maction',\n  'maligngroup',\n  'malignmark',\n  'mlongdiv',\n  'mscarries',\n  'mscarry',\n  'msgroup',\n  'mstack',\n  'msline',\n  'msrow',\n  'semantics',\n  'annotation',\n  'annotation-xml',\n  'mprescripts',\n  'none',\n]);\n\nexport const text = freeze(['#text']);\n","import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'accept',\n  'action',\n  'align',\n  'alt',\n  'autocapitalize',\n  'autocomplete',\n  'autopictureinpicture',\n  'autoplay',\n  'background',\n  'bgcolor',\n  'border',\n  'capture',\n  'cellpadding',\n  'cellspacing',\n  'checked',\n  'cite',\n  'class',\n  'clear',\n  'color',\n  'cols',\n  'colspan',\n  'controls',\n  'controlslist',\n  'coords',\n  'crossorigin',\n  'datetime',\n  'decoding',\n  'default',\n  'dir',\n  'disabled',\n  'disablepictureinpicture',\n  'disableremoteplayback',\n  'download',\n  'draggable',\n  'enctype',\n  'enterkeyhint',\n  'face',\n  'for',\n  'headers',\n  'height',\n  'hidden',\n  'high',\n  'href',\n  'hreflang',\n  'id',\n  'inputmode',\n  'integrity',\n  'ismap',\n  'kind',\n  'label',\n  'lang',\n  'list',\n  'loading',\n  'loop',\n  'low',\n  'max',\n  'maxlength',\n  'media',\n  'method',\n  'min',\n  'minlength',\n  'multiple',\n  'muted',\n  'name',\n  'nonce',\n  'noshade',\n  'novalidate',\n  'nowrap',\n  'open',\n  'optimum',\n  'pattern',\n  'placeholder',\n  'playsinline',\n  'poster',\n  'preload',\n  'pubdate',\n  'radiogroup',\n  'readonly',\n  'rel',\n  'required',\n  'rev',\n  'reversed',\n  'role',\n  'rows',\n  'rowspan',\n  'spellcheck',\n  'scope',\n  'selected',\n  'shape',\n  'size',\n  'sizes',\n  'span',\n  'srclang',\n  'start',\n  'src',\n  'srcset',\n  'step',\n  'style',\n  'summary',\n  'tabindex',\n  'title',\n  'translate',\n  'type',\n  'usemap',\n  'valign',\n  'value',\n  'width',\n  'xmlns',\n  'slot',\n]);\n\nexport const svg = freeze([\n  'accent-height',\n  'accumulate',\n  'additive',\n  'alignment-baseline',\n  'ascent',\n  'attributename',\n  'attributetype',\n  'azimuth',\n  'basefrequency',\n  'baseline-shift',\n  'begin',\n  'bias',\n  'by',\n  'class',\n  'clip',\n  'clippathunits',\n  'clip-path',\n  'clip-rule',\n  'color',\n  'color-interpolation',\n  'color-interpolation-filters',\n  'color-profile',\n  'color-rendering',\n  'cx',\n  'cy',\n  'd',\n  'dx',\n  'dy',\n  'diffuseconstant',\n  'direction',\n  'display',\n  'divisor',\n  'dur',\n  'edgemode',\n  'elevation',\n  'end',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'filter',\n  'filterunits',\n  'flood-color',\n  'flood-opacity',\n  'font-family',\n  'font-size',\n  'font-size-adjust',\n  'font-stretch',\n  'font-style',\n  'font-variant',\n  'font-weight',\n  'fx',\n  'fy',\n  'g1',\n  'g2',\n  'glyph-name',\n  'glyphref',\n  'gradientunits',\n  'gradienttransform',\n  'height',\n  'href',\n  'id',\n  'image-rendering',\n  'in',\n  'in2',\n  'k',\n  'k1',\n  'k2',\n  'k3',\n  'k4',\n  'kerning',\n  'keypoints',\n  'keysplines',\n  'keytimes',\n  'lang',\n  'lengthadjust',\n  'letter-spacing',\n  'kernelmatrix',\n  'kernelunitlength',\n  'lighting-color',\n  'local',\n  'marker-end',\n  'marker-mid',\n  'marker-start',\n  'markerheight',\n  'markerunits',\n  'markerwidth',\n  'maskcontentunits',\n  'maskunits',\n  'max',\n  'mask',\n  'media',\n  'method',\n  'mode',\n  'min',\n  'name',\n  'numoctaves',\n  'offset',\n  'operator',\n  'opacity',\n  'order',\n  'orient',\n  'orientation',\n  'origin',\n  'overflow',\n  'paint-order',\n  'path',\n  'pathlength',\n  'patterncontentunits',\n  'patterntransform',\n  'patternunits',\n  'points',\n  'preservealpha',\n  'preserveaspectratio',\n  'primitiveunits',\n  'r',\n  'rx',\n  'ry',\n  'radius',\n  'refx',\n  'refy',\n  'repeatcount',\n  'repeatdur',\n  'restart',\n  'result',\n  'rotate',\n  'scale',\n  'seed',\n  'shape-rendering',\n  'specularconstant',\n  'specularexponent',\n  'spreadmethod',\n  'startoffset',\n  'stddeviation',\n  'stitchtiles',\n  'stop-color',\n  'stop-opacity',\n  'stroke-dasharray',\n  'stroke-dashoffset',\n  'stroke-linecap',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke',\n  'stroke-width',\n  'style',\n  'surfacescale',\n  'systemlanguage',\n  'tabindex',\n  'targetx',\n  'targety',\n  'transform',\n  'transform-origin',\n  'text-anchor',\n  'text-decoration',\n  'text-rendering',\n  'textlength',\n  'type',\n  'u1',\n  'u2',\n  'unicode',\n  'values',\n  'viewbox',\n  'visibility',\n  'version',\n  'vert-adv-y',\n  'vert-origin-x',\n  'vert-origin-y',\n  'width',\n  'word-spacing',\n  'wrap',\n  'writing-mode',\n  'xchannelselector',\n  'ychannelselector',\n  'x',\n  'x1',\n  'x2',\n  'xmlns',\n  'y',\n  'y1',\n  'y2',\n  'z',\n  'zoomandpan',\n]);\n\nexport const mathMl = freeze([\n  'accent',\n  'accentunder',\n  'align',\n  'bevelled',\n  'close',\n  'columnsalign',\n  'columnlines',\n  'columnspan',\n  'denomalign',\n  'depth',\n  'dir',\n  'display',\n  'displaystyle',\n  'encoding',\n  'fence',\n  'frame',\n  'height',\n  'href',\n  'id',\n  'largeop',\n  'length',\n  'linethickness',\n  'lspace',\n  'lquote',\n  'mathbackground',\n  'mathcolor',\n  'mathsize',\n  'mathvariant',\n  'maxsize',\n  'minsize',\n  'movablelimits',\n  'notation',\n  'numalign',\n  'open',\n  'rowalign',\n  'rowlines',\n  'rowspacing',\n  'rowspan',\n  'rspace',\n  'rquote',\n  'scriptlevel',\n  'scriptminsize',\n  'scriptsizemultiplier',\n  'selection',\n  'separator',\n  'separators',\n  'stretchy',\n  'subscriptshift',\n  'supscriptshift',\n  'symmetric',\n  'voffset',\n  'width',\n  'xmlns',\n]);\n\nexport const xml = freeze([\n  'xlink:href',\n  'xml:id',\n  'xlink:title',\n  'xml:space',\n  'xmlns:xlink',\n]);\n","import { seal } from './utils.js';\n\n// eslint-disable-next-line unicorn/better-regex\nexport const MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nexport const ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nexport const TMPLIT_EXPR = seal(/\\${[\\w\\W]*}/gm);\nexport const DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\nexport const ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nexport const IS_ALLOWED_URI = seal(\n  /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nexport const IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nexport const ATTR_WHITESPACE = seal(\n  /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nexport const DOCTYPE_NAME = seal(/^html$/i);\n","import * as TAGS from './tags.js';\nimport * as ATTRS from './attrs.js';\nimport * as EXPRESSIONS from './regexp.js';\nimport {\n  addToSet,\n  clone,\n  entries,\n  freeze,\n  arrayForEach,\n  arrayPop,\n  arrayPush,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringIndexOf,\n  stringTrim,\n  regExpTest,\n  typeErrorCreate,\n  lookupGetter,\n  create,\n  objectHasOwnProperty,\n} from './utils.js';\n\nconst getGlobal = function () {\n  return typeof window === 'undefined' ? null : window;\n};\n\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param {TrustedTypePolicyFactory} trustedTypes The policy factory.\n * @param {HTMLScriptElement} purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return {TrustedTypePolicy} The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function (trustedTypes, purifyHostElement) {\n  if (\n    typeof trustedTypes !== 'object' ||\n    typeof trustedTypes.createPolicy !== 'function'\n  ) {\n    return null;\n  }\n\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      },\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn(\n      'TrustedTypes policy ' + policyName + ' could not be created.'\n    );\n    return null;\n  }\n};\n\nfunction createDOMPurify(window = getGlobal()) {\n  const DOMPurify = (root) => createDOMPurify(root);\n\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n  DOMPurify.version = VERSION;\n\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n  DOMPurify.removed = [];\n\n  if (!window || !window.document || window.document.nodeType !== 9) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n\n    return DOMPurify;\n  }\n\n  let { document } = window;\n\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes,\n  } = window;\n\n  const ElementPrototype = Element.prototype;\n\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName,\n  } = document;\n  const { importNode } = originalDocument;\n\n  let hooks = {};\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported =\n    typeof entries === 'function' &&\n    typeof getParentNode === 'function' &&\n    implementation &&\n    implementation.createHTMLDocument !== undefined;\n\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n  } = EXPRESSIONS;\n\n  let { IS_ALLOWED_URI } = EXPRESSIONS;\n\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [\n    ...TAGS.html,\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.mathMl,\n    ...TAGS.text,\n  ]);\n\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [\n    ...ATTRS.html,\n    ...ATTRS.svg,\n    ...ATTRS.mathMl,\n    ...ATTRS.xml,\n  ]);\n\n  /*\n   * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(\n    create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false,\n      },\n    })\n  );\n\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, [\n    'annotation-xml',\n    'audio',\n    'colgroup',\n    'desc',\n    'foreignobject',\n    'head',\n    'iframe',\n    'math',\n    'mi',\n    'mn',\n    'mo',\n    'ms',\n    'mtext',\n    'noembed',\n    'noframes',\n    'noscript',\n    'plaintext',\n    'script',\n    'style',\n    'svg',\n    'template',\n    'thead',\n    'title',\n    'video',\n    'xmp',\n  ]);\n\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, [\n    'audio',\n    'video',\n    'img',\n    'source',\n    'image',\n    'track',\n  ]);\n\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, [\n    'alt',\n    'class',\n    'for',\n    'id',\n    'label',\n    'name',\n    'pattern',\n    'placeholder',\n    'role',\n    'summary',\n    'title',\n    'value',\n    'style',\n    'xmlns',\n  ]);\n\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet(\n    {},\n    [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE],\n    stringToString\n  );\n\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n\n  const formElement = document.createElement('form');\n\n  const isRegexOrFunction = function (testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n\n  /**\n   * _parseConfig\n   *\n   * @param  {Object} cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function (cfg = {}) {\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n\n    PARSER_MEDIA_TYPE =\n      // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1\n        ? DEFAULT_PARSER_MEDIA_TYPE\n        : cfg.PARSER_MEDIA_TYPE;\n\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc =\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml'\n        ? stringToString\n        : stringToLowerCase;\n\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS')\n      ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc)\n      : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR')\n      ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc)\n      : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES')\n      ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString)\n      : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR')\n      ? addToSet(\n          clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent\n          cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent\n          transformCaseFunc // eslint-disable-line indent\n        ) // eslint-disable-line indent\n      : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS')\n      ? addToSet(\n          clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent\n          cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent\n          transformCaseFunc // eslint-disable-line indent\n        ) // eslint-disable-line indent\n      : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS')\n      ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc)\n      : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS')\n      ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc)\n      : {};\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR')\n      ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc)\n      : {};\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES')\n      ? cfg.USE_PROFILES\n      : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI = cfg.ALLOWED_URI_REGEXP || EXPRESSIONS.IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements ===\n        'boolean'\n    ) {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements =\n        cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, TAGS.text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, TAGS.html);\n        addToSet(ALLOWED_ATTR, ATTRS.html);\n      }\n\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svgFilters);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, TAGS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n    }\n\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.'\n        );\n      }\n\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.'\n        );\n      }\n\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(\n          trustedTypes,\n          currentScript\n        );\n      }\n\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n\n    CONFIG = cfg;\n  };\n\n  const MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, [\n    'mi',\n    'mo',\n    'mn',\n    'ms',\n    'mtext',\n  ]);\n\n  const HTML_INTEGRATION_POINTS = addToSet({}, [\n    'foreignobject',\n    'desc',\n    'title',\n    'annotation-xml',\n  ]);\n\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, [\n    'title',\n    'style',\n    'font',\n    'a',\n    'script',\n  ]);\n\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.svgDisallowed,\n  ]);\n  const ALL_MATHML_TAGS = addToSet({}, [\n    ...TAGS.mathMl,\n    ...TAGS.mathMlDisallowed,\n  ]);\n\n  /**\n   * @param  {Element} element a DOM element whose namespace is being checked\n   * @returns {boolean} Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function (element) {\n    let parent = getParentNode(element);\n\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template',\n      };\n    }\n\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return (\n          tagName === 'svg' &&\n          (parentTagName === 'annotation-xml' ||\n            MATHML_TEXT_INTEGRATION_POINTS[parentTagName])\n        );\n      }\n\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (\n        parent.namespaceURI === SVG_NAMESPACE &&\n        !HTML_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      if (\n        parent.namespaceURI === MATHML_NAMESPACE &&\n        !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return (\n        !ALL_MATHML_TAGS[tagName] &&\n        (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName])\n      );\n    }\n\n    // For XHTML and XML documents that support custom namespaces\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      ALLOWED_NAMESPACES[element.namespaceURI]\n    ) {\n      return true;\n    }\n\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n\n  /**\n   * _forceRemove\n   *\n   * @param  {Node} node a DOM node\n   */\n  const _forceRemove = function (node) {\n    arrayPush(DOMPurify.removed, { element: node });\n\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      node.parentNode.removeChild(node);\n    } catch (_) {\n      node.remove();\n    }\n  };\n\n  /**\n   * _removeAttribute\n   *\n   * @param  {String} name an Attribute name\n   * @param  {Node} node a DOM node\n   */\n  const _removeAttribute = function (name, node) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: node.getAttributeNode(name),\n        from: node,\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: node,\n      });\n    }\n\n    node.removeAttribute(name);\n\n    // We void attribute values for unremovable \"is\"\" attributes\n    if (name === 'is' && !ALLOWED_ATTR[name]) {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(node);\n        } catch (_) {}\n      } else {\n        try {\n          node.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n\n  /**\n   * _initDocument\n   *\n   * @param  {String} dirty a string of dirty markup\n   * @return {Document} a DOM, filled with the dirty markup\n   */\n  const _initDocument = function (dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      NAMESPACE === HTML_NAMESPACE\n    ) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty =\n        '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' +\n        dirty +\n        '</body></html>';\n    }\n\n    const dirtyPayload = trustedTypesPolicy\n      ? trustedTypesPolicy.createHTML(dirty)\n      : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT\n          ? emptyHTML\n          : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n\n    const body = doc.body || doc.documentElement;\n\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(\n        document.createTextNode(leadingWhitespace),\n        body.childNodes[0] || null\n      );\n    }\n\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(\n        doc,\n        WHOLE_DOCUMENT ? 'html' : 'body'\n      )[0];\n    }\n\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param  {Node} root The root element or node to start traversing on.\n   * @return {NodeIterator} The created NodeIterator\n   */\n  const _createNodeIterator = function (root) {\n    return createNodeIterator.call(\n      root.ownerDocument || root,\n      root,\n      // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT,\n      null\n    );\n  };\n\n  /**\n   * _isClobbered\n   *\n   * @param  {Node} elm element to check for clobbering attacks\n   * @return {Boolean} true if clobbered, false if safe\n   */\n  const _isClobbered = function (elm) {\n    return (\n      elm instanceof HTMLFormElement &&\n      (typeof elm.nodeName !== 'string' ||\n        typeof elm.textContent !== 'string' ||\n        typeof elm.removeChild !== 'function' ||\n        !(elm.attributes instanceof NamedNodeMap) ||\n        typeof elm.removeAttribute !== 'function' ||\n        typeof elm.setAttribute !== 'function' ||\n        typeof elm.namespaceURI !== 'string' ||\n        typeof elm.insertBefore !== 'function' ||\n        typeof elm.hasChildNodes !== 'function')\n    );\n  };\n\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param  {Node} object object to check whether it's a DOM node\n   * @return {Boolean} true is object is a DOM node\n   */\n  const _isNode = function (object) {\n    return typeof Node === 'function' && object instanceof Node;\n  };\n\n  /**\n   * _executeHook\n   * Execute user configurable hooks\n   *\n   * @param  {String} entryPoint  Name of the hook's entry point\n   * @param  {Node} currentNode node to work on with the hook\n   * @param  {Object} data additional hook parameters\n   */\n  const _executeHook = function (entryPoint, currentNode, data) {\n    if (!hooks[entryPoint]) {\n      return;\n    }\n\n    arrayForEach(hooks[entryPoint], (hook) => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  };\n\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   *\n   * @param   {Node} currentNode to check for permission to exist\n   * @return  {Boolean} true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function (currentNode) {\n    let content = null;\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeElements', currentNode, null);\n\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n\n    /* Execute a hook if present */\n    _executeHook('uponSanitizeElement', currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS,\n    });\n\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (\n      currentNode.hasChildNodes() &&\n      !_isNode(currentNode.firstElementChild) &&\n      regExpTest(/<[/\\w]/g, currentNode.innerHTML) &&\n      regExpTest(/<[/\\w]/g, currentNode.textContent)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n          regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)\n        ) {\n          return false;\n        }\n\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)\n        ) {\n          return false;\n        }\n      }\n\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n\n          for (let i = childCount - 1; i >= 0; --i) {\n            parentNode.insertBefore(\n              cloneNode(childNodes[i], true),\n              getNextSibling(currentNode)\n            );\n          }\n        }\n      }\n\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if (\n      (tagName === 'noscript' ||\n        tagName === 'noembed' ||\n        tagName === 'noframes') &&\n      regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n        content = stringReplace(content, expr, ' ');\n      });\n\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, { element: currentNode.cloneNode() });\n        currentNode.textContent = content;\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeElements', currentNode, null);\n\n    return false;\n  };\n\n  /**\n   * _isValidAttribute\n   *\n   * @param  {string} lcTag Lowercase tag name of containing element.\n   * @param  {string} lcName Lowercase attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function (lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (\n      SANITIZE_DOM &&\n      (lcName === 'id' || lcName === 'name') &&\n      (value in document || value in formElement)\n    ) {\n      return false;\n    }\n\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (\n      ALLOW_DATA_ATTR &&\n      !FORBID_ATTR[lcName] &&\n      regExpTest(DATA_ATTR, lcName)\n    ) {\n      // This attribute is safe\n    } else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) {\n      // This attribute is safe\n      /* Otherwise, check the name is permitted */\n    } else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n        // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        (_isBasicCustomElement(lcTag) &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))) &&\n          ((CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName)) ||\n            (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)))) ||\n        // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        (lcName === 'is' &&\n          CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))))\n      ) {\n        // If user has supplied a regexp or function in CUSTOM_ELEMENT_HANDLING.tagNameCheck, we need to also allow derived custom elements using the same tagName test.\n        // Additionally, we need to allow attributes passing the CUSTOM_ELEMENT_HANDLING.attributeNameCheck user has configured, as custom elements can define these at their own discretion.\n      } else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) {\n      // This attribute is safe\n      /* Check no script, data or unknown possibly unsafe URI\n        unless we know URI values are safe for that attribute */\n    } else if (\n      regExpTest(IS_ALLOWED_URI, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Keep image data URIs alive if src/xlink:href is allowed */\n      /* Further prevent gadget XSS for dynamically built script tags */\n    } else if (\n      (lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') &&\n      lcTag !== 'script' &&\n      stringIndexOf(value, 'data:') === 0 &&\n      DATA_URI_TAGS[lcTag]\n    ) {\n      // This attribute is safe\n      /* Allow unknown protocols: This provides support for links that\n        are handled by protocol handlers which may be unknown ahead of\n        time, e.g. fb:, spotify: */\n    } else if (\n      ALLOW_UNKNOWN_PROTOCOLS &&\n      !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Check for binary attributes */\n    } else if (value) {\n      return false;\n    } else {\n      // Binary attributes are safe at this point\n      /* Anything else, presume unsafe, do not add it back */\n    }\n\n    return true;\n  };\n\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param {string} tagName name of the tag of the node to sanitize\n   * @returns {boolean} Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function (tagName) {\n    return tagName !== 'annotation-xml' && tagName.indexOf('-') > 0;\n  };\n\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param  {Node} currentNode to sanitize\n   */\n  const _sanitizeAttributes = function (currentNode) {\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n    const { attributes } = currentNode;\n\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes) {\n      return;\n    }\n\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n    };\n    let l = attributes.length;\n\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const { name, namespaceURI, value: attrValue } = attr;\n      const lcName = transformCaseFunc(name);\n\n      let value = name === 'value' ? attrValue : stringTrim(attrValue);\n\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n\n      /* Remove attribute */\n      _removeAttribute(name, currentNode);\n\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        continue;\n      }\n\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        continue;\n      }\n\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n\n      /* Handle attributes that require Trusted Types */\n      if (\n        trustedTypesPolicy &&\n        typeof trustedTypes === 'object' &&\n        typeof trustedTypes.getAttributeType === 'function'\n      ) {\n        if (namespaceURI) {\n          /* Namespaces are not yet supported, see https://bugs.chromium.org/p/chromium/issues/detail?id=1305293 */\n        } else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML': {\n              value = trustedTypesPolicy.createHTML(value);\n              break;\n            }\n\n            case 'TrustedScriptURL': {\n              value = trustedTypesPolicy.createScriptURL(value);\n              break;\n            }\n\n            default: {\n              break;\n            }\n          }\n        }\n      }\n\n      /* Handle invalid data-* attribute set by try-catching it */\n      try {\n        if (namespaceURI) {\n          currentNode.setAttributeNS(namespaceURI, name, value);\n        } else {\n          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n          currentNode.setAttribute(name, value);\n        }\n\n        arrayPop(DOMPurify.removed);\n      } catch (_) {}\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeAttributes', currentNode, null);\n  };\n\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param  {DocumentFragment} fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function (fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n    while ((shadowNode = shadowIterator.nextNode())) {\n      /* Execute a hook if present */\n      _executeHook('uponSanitizeShadowNode', shadowNode, null);\n\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(shadowNode)) {\n        continue;\n      }\n\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(shadowNode);\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeShadowDOM', fragment, null);\n  };\n\n  /**\n   * Sanitize\n   * Public method providing core sanitation functionality\n   *\n   * @param {String|Node} dirty string or DOM node\n   * @param {Object} cfg object\n   */\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty, cfg = {}) {\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate(\n            'root node is forbidden and cannot be sanitized in-place'\n          );\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (\n        !RETURN_DOM &&\n        !SAFE_FOR_TEMPLATES &&\n        !WHOLE_DOCUMENT &&\n        // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1\n      ) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n          ? trustedTypesPolicy.createHTML(dirty)\n          : dirty;\n      }\n\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n\n    /* Now start iterating over the created document */\n    while ((currentNode = nodeIterator.nextNode())) {\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(currentNode)) {\n        continue;\n      }\n\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(currentNode);\n    }\n\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n\n      return returnNode;\n    }\n\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n    /* Serialize doctype if allowed */\n    if (\n      WHOLE_DOCUMENT &&\n      ALLOWED_TAGS['!doctype'] &&\n      body.ownerDocument &&\n      body.ownerDocument.doctype &&\n      body.ownerDocument.doctype.name &&\n      regExpTest(EXPRESSIONS.DOCTYPE_NAME, body.ownerDocument.doctype.name)\n    ) {\n      serializedHTML =\n        '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n      ? trustedTypesPolicy.createHTML(serializedHTML)\n      : serializedHTML;\n  };\n\n  /**\n   * Public method to set the configuration once\n   * setConfig\n   *\n   * @param {Object} cfg configuration object\n   */\n  DOMPurify.setConfig = function (cfg = {}) {\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n\n  /**\n   * Public method to remove the configuration\n   * clearConfig\n   *\n   */\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n\n  /**\n   * Public method to check if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   * isValidAttribute\n   *\n   * @param  {String} tag Tag name of containing element.\n   * @param  {String} attr Attribute name.\n   * @param  {String} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n   */\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n\n  /**\n   * AddHook\n   * Public method to add DOMPurify hooks\n   *\n   * @param {String} entryPoint entry point for the hook to add\n   * @param {Function} hookFunction function to execute\n   */\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n\n    hooks[entryPoint] = hooks[entryPoint] || [];\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n\n  /**\n   * RemoveHook\n   * Public method to remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if more are present)\n   *\n   * @param {String} entryPoint entry point for the hook to remove\n   * @return {Function} removed(popped) hook\n   */\n  DOMPurify.removeHook = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      return arrayPop(hooks[entryPoint]);\n    }\n  };\n\n  /**\n   * RemoveHooks\n   * Public method to remove all DOMPurify hooks at a given entryPoint\n   *\n   * @param  {String} entryPoint entry point for the hooks to remove\n   */\n  DOMPurify.removeHooks = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      hooks[entryPoint] = [];\n    }\n  };\n\n  /**\n   * RemoveAllHooks\n   * Public method to remove all DOMPurify hooks\n   */\n  DOMPurify.removeAllHooks = function () {\n    hooks = {};\n  };\n\n  return DOMPurify;\n}\n\nexport default createDOMPurify();\n","/*!\n * LivingAPI JavaScript Library\n * https://my.living-apps.de/docs/LivingAPI.html\n *\n * Copyright 2017-2023 by LivingLogic AG, Bayreuth/Germany\n * Copyright 2017-2023 by Walter Dörwald\n *\n * All Rights Reserved\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n// Version of this Javascript package\nimport { version } from '../package.json';\n\nexport { version };\n\nimport * as ul4 from '@livinglogic/ul4';\nimport DOMPurify from 'dompurify';\n\n\nexport function element(name, ...args)\n{\n\tlet dom_node = document.createElement(name);\n\tfor (let arg of args)\n\t{\n\t\tif (typeof(arg) === \"string\")\n\t\t\tdom_node.appendChild(document.createTextNode(arg));\n\t\tlet ismap = arg instanceof Map;\n\t\tlet isobject = ul4._isobject(arg);\n\t\tif (ismap || isobject)\n\t\t{\n\t\t\tif (isobject)\n\t\t\t\targ = Object.entries(arg);\n\t\t\tfor (let [name, value] of arg)\n\t\t\t{\n\t\t\t\tif (value !== null)\n\t\t\t\t\tdom_node.setAttribute(name, value);\n\t\t\t}\n\t\t}\n\t}\n\treturn dom_node;\n}\n\n\nfunction _append_param_to_url(urlparams, name, value)\n{\n\tif (ul4._islist(value))\n\t{\n\t\tfor (let v of value)\n\t\t\t_append_param_to_url(urlparams, name, v);\n\t}\n\telse if (typeof(value) === \"string\")\n\t\turlparams.append(name, value);\n\telse if (value !== null)\n\t\turlparams.append(name, ul4._str(value));\n}\n\nexport function url_with_params(url, ...params)\n{\n\tlet urlparams = new URLSearchParams();\n\n\tfor (let param of params)\n\t{\n\t\tif (ul4._islist(param) && param.length == 2)\n\t\t{\n\t\t\t_append_param_to_url(urlparams, ...param);\n\t\t}\n\t\telse if (Object.prototype.toString.call(param) === \"[object Object]\" && !(param instanceof ul4.Proto))\n\t\t{\n\t\t\tfor (let name in param)\n\t\t\t\t_append_param_to_url(urlparams, name, param[name]);\n\t\t}\n\t\telse if (param !== null && typeof(param) === \"object\" && typeof(param.__proto__) === \"object\" && param.__proto__ === Map.prototype)\n\t\t{\n\t\t\tfor (let [name, value] of param)\n\t\t\t\t_append_param_to_url(urlparams, name, value);\n\t\t}\n\t}\n\turlparams = urlparams.toString().replace(\"+\", \"%20\");\n\tif (urlparams.length > 0)\n\t\turl += \"?\" + urlparams;\n\treturn url;\n}\n\n/*\n\t\tlet urlparams = new URLSearchParams({\"template\": identifier});\n\t\tfor (let [name, value] of params)\n\t\t{\n\t\t\tif (Object.prototype.toString.call(v) === \"[object Array]\")\n\t\t\t{\n\t\t\t\tfor (let [n, v])\n\t\t\t}\n\t\t\turlparams.append()\n*/\n\nexport class Base extends ul4.Proto\n{\n\tconstructor(id)\n\t{\n\t\tsuper();\n\t\tthis.id = id;\n\t}\n\n\tget ul4onid()\n\t{\n\t\treturn this.id;\n\t}\n\n\tul4ondump(encoder)\n\t{\n\t\tfor (let i = 0; i < this._ul4onattrs.length; ++i)\n\t\t\tencoder.dump(this._dumpUL4ONAttr(this._ul4onattrs[i]));\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\treturn this[name];\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tlet i = 0;\n\t\tfor (let iter = decoder.loadcontent(); ; ++i)\n\t\t{\n\t\t\tlet iteritem = iter.next();\n\t\t\tif (iteritem.done)\n\t\t\t\tbreak;\n\t\t\tif (i < this._ul4onattrs.length)\n\t\t\t\tthis._loadUL4ONAttr(this._ul4onattrs[i], iteritem.value);\n\t\t}\n\t\tfor (; i < this._ul4onattrs.length; ++i)\n\t\t\tthis._setDefaultUL4ONAttr(this._ul4onattrs[i]);\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tthis[name] = value;\n\t}\n\n\t_setDefaultUL4ONAttr(name)\n\t{\n\t\tthis[name] = null;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (this._ul4attrs.has(name))\n\t\t{\n\t\t\tlet value = this[name];\n\t\t\tif (typeof(value) === \"function\")\n\t\t\t{\n\t\t\t\tlet realvalue = value.bind(this);\n\t\t\t\trealvalue._ul4_name = value._ul4_name || value.name;\n\t\t\t\trealvalue._ul4_signature = value._ul4_signature;\n\t\t\t\trealvalue._ul4_needsobject = value._ul4_needsobject;\n\t\t\t\trealvalue._ul4_needscontext = value._ul4_needscontext;\n\t\t\t\treturn realvalue;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\t\telse if (name.startsWith(\"x_\"))\n\t\t{\n\t\t\treturn this.hasOwnProperty(name) ? this[name] : null;\n\t\t}\n\t\tthrow new ul4.AttributeError(this, name);\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name.startsWith(\"x_\"))\n\t\t{\n\t\t\tthis[name] = value;\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.AttributeError(this, name);\n\t}\n\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \">\";\n\t}\n\n\ttoString()\n\t{\n\t\treturn this[ul4.symbols.repr]();\n\t}\n};\n\n\nexport class Handler\n{\n\tsave(record)\n\t{\n\t}\n\n\tdelete(record)\n\t{\n\t}\n};\n\n\nclass GlobalsType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Globals;\n\t}\n};\n\nlet globalstype = new GlobalsType(\"la\", \"Globals\", \"Global information\");\n\n\nexport class Globals extends Base\n{\n\tconstructor(id)\n\t{\n\t\tsuper(id);\n\t\tthis.version = null;\n\t\tthis.hostname = null;\n\t\tthis.platform = null;\n\t\tthis.user = null;\n\t\tthis.lang = null;\n\t\tthis.datasources = null;\n\t\tthis.app = null;\n\t\tthis.record = null;\n\t\tthis.mode = null;\n\t\tthis.maxdbactions = null;\n\t\tthis.maxtemplateruntime = null;\n\t\tthis.flashmessages = null;\n\t\tthis.view_template_id = null;\n\t\tthis.email_template_id = null;\n\t\tthis.handler = new Handler();\n\t\tthis._log_stack = [];\n\t\tthis._current_geo = null;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn globalstype;\n\t}\n\n\t// distance between two geo coordinates (see https://de.wikipedia.org/wiki/Orthodrome#Genauere_Formel_zur_Abstandsberechnung_auf_der_Erde)\n\tdist(geo1, geo2)\n\t{\n\t\tlet sqsin = function sqsin(x) {x = Math.sin(x); return x*x};\n\t\tlet sqcos = function sqsos(x) {x = Math.cos(x); return x*x};\n\t\tconst deg2rad = Math.PI/180; // Conversion factor degree -> radians\n\t\tconst radius = 6378.137; // Equatorial radius of earth in km\n\t\tconst flat = 1/298.257223563; // Earth flattening\n\n\t\tconst lat1 = geo1.lat * deg2rad;\n\t\tconst long1 = geo1.long * deg2rad;\n\t\tconst lat2 = geo2.lat * deg2rad;\n\t\tconst long2 = geo2.long * deg2rad;\n\t\tconst F = (lat1 + lat2)/2;\n\t\tconst G = (lat1 - lat2)/2;\n\t\tconst l = (long1 - long2)/2;\n\t\tconst S = sqsin(G) * sqcos(l) + sqcos(F) * sqsin(l);\n\t\tconst C = sqcos(G) * sqcos(l) + sqsin(F) * sqsin(l);\n\t\tconst w = Math.atan(Math.sqrt(S/C));\n\t\tconst D = 2 * w * radius;\n\t\tif (D === 0.0)\n\t\t\t/* The \"correction\" calculation below would fail if the raw distance is 0 */\n\t\t\treturn D;\n\t\tconst T = Math.sqrt(S*C)/w;\n\t\tconst H1 = (3*T-1)/(2*C);\n\t\tconst H2 = (3*T+1)/(2*S);\n\t\tconst s = D * (1 + flat * H1 * sqsin(F) * sqcos(G) - flat * H2 * sqcos(F) * sqsin(G));\n\t\treturn s;\n\t}\n\n\tscaled_url(image, width, height, type=\"fill\", enlarge=true, gravity=\"sm\", quality=null, rotate=null, blur=null, sharpen=null, format=null, cache=true)\n\t{\n\t\tlet filename = null;\n\n\t\tif (image instanceof File)\n\t\t{\n\t\t\timage = \"https://\" + this.hostname + image.archive_url;\n\t\t\tfilename = encodeURIComponent(image.filename);\n\t\t\tif (filename != image.filename)\n\t\t\t\tfilename = null;\n\t\t}\n\n\t\tlet result = \"\";\n\n\t\tif (cache)\n\t\t\tresult += \"/imgproxycache/insecure\";\n\t\telse\n\t\t\tresult += \"/imgproxy/insecure\";\n\n\t\tif (type !== \"fit\")\n\t\t\tresult += \"/rt:\" + type;\n\n\t\tif (width !== null && width !== undefined)\n\t\t\tresult += \"/w:\" + width;\n\n\t\tif (height !== null && height !== undefined)\n\t\t\tresult += \"/h:\" + height;\n\n\t\tif (enlarge)\n\t\t\tresult += \"/el:1\";\n\n\t\tif (gravity !== null && gravity !== undefined)\n\t\t\tresult += \"/g:\" + gravity;\n\n\t\tif (quality !== null && quality !== undefined)\n\t\t\tresult += \"/q:\" + quality;\n\n\t\tif (rotate !== null && rotate % 360 != 0)\n\t\t\tresult += \"/rot:\" + rotatet;\n\n\t\tif (blur !== null && blur !== undefined)\n\t\t\tresult += \"/bl:\" + blur;\n\n\t\tif (sharpen !== null && sharpen !== undefined)\n\t\t\tresult += \"/sh:\" + sharpen;\n\n\t\tif (format !== null && format !== undefined)\n\t\t\tresult += \"/f:\" + format;\n\n\t\tif (filename !== null && filename !== undefined)\n\t\t\tresult += \"/fn:\" + filename;\n\n\t\tresult += \"/plain/\" + encodeURIComponent(image);\n\n\t\treturn result;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Globals version=\" + ul4._repr(this.version) + \" mode=\" + ul4._repr(this.mode) + \">\";\n\t}\n\n\tcurrent_geo()\n\t{\n\t\treturn this._current_geo;\n\t}\n\n\tset_current_geo(position)\n\t{\n\t\tthis._current_geo = new Geo(this, position.coords.latitude, position.coords.longitude);\n\t}\n\n\t_in_form()\n\t{\n\t\treturn this.mode !== null && this.mode.startsWith(\"form/\");\n\t}\n\n\tmsg_bool(value)\n\t{\n\t\tswitch (value)\n\t\t{\n\t\t\tcase true:\n\t\t\t\treturn this.msg_bool_true();\n\t\t\tcase false:\n\t\t\t\treturn this.msg_bool_false();\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tmsg_bool_true(value)\n\t{\n\t\tswitch (this.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn \"Ja\";\n\t\t\tdefault:\n\t\t\t\treturn \"Yes\";\n\t\t}\n\t}\n\n\tmsg_bool_false(value)\n\t{\n\t\tswitch (this.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn \"Nein\";\n\t\t\tdefault:\n\t\t\t\treturn \"No\";\n\t\t}\n\t}\n\n\tmsg_no_fields()\n\t{\n\t\tswitch (this.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn \"(Keine Felder gefunden)\";\n\t\t\tdefault:\n\t\t\t\treturn \"(No fields found)\";\n\t\t}\n\t}\n\n\tmsg_nothing_selected()\n\t{\n\t\tswitch (this.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn \"(Nichts ausgewählt)\";\n\t\t\tdefault:\n\t\t\t\treturn \"(Nothing selected)\";\n\t\t}\n\t}\n\n\t_make_log_message(messages)\n\t{\n\t\treturn messages\n\t\t\t.map(m => typeof(m) !== \"string\" ? ul4._repr(m) : m)\n\t\t\t.join(\" \")\n\t\t;\n\t}\n\n\tbegin_logging(header)\n\t{\n\t\tthis._log_stack.push({header: header, output: false});\n\t}\n\n\tend_logging()\n\t{\n\t\tif (this._log_stack)\n\t\t{\n\t\t\tif (this._log_stack[this._log_stack.length-1].output && console && console.groupEnd)\n\t\t\t\tconsole.groupEnd();\n\t\t\tthis._log_stack.pop();\n\t\t}\n\t}\n\n\tgroup_logging(header, callback)\n\t{\n\t\tthis.begin_logging(header);\n\t\ttry\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.end_logging();\n\t\t}\n\t}\n\n\t_start_log_message()\n\t{\n\t\tfor (let level of this._log_stack)\n\t\t{\n\t\t\tif (!level.output)\n\t\t\t{\n\t\t\t\tif (console && console.group)\n\t\t\t\t\tconsole.group(level.header)\n\t\t\t\tlevel.output = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tlog_debug(...message)\n\t{\n\t\tthis._start_log_message();\n\t\tif (console && console.debug)\n\t\t\tconsole.debug(this._make_log_message(message))\n\t}\n\n\tlog_info(...message)\n\t{\n\t\tthis._start_log_message();\n\t\tif (console && console.info)\n\t\t\tconsole.info(this._make_log_message(message))\n\t}\n\n\tlog_warning(...message)\n\t{\n\t\tthis._start_log_message();\n\t\tif (console && console.warn)\n\t\t\tconsole.warn(this._make_log_message(message))\n\t}\n\n\tlog_error(...message)\n\t{\n\t\tthis._start_log_message();\n\t\tif (console && console.error)\n\t\t\tconsole.error(this._make_log_message(message))\n\t}\n\n\tmy_apps_url()\n\t{\n\t\treturn \"/apps.htm\";\n\t}\n\n\tmy_tasks_url()\n\t{\n\t\treturn \"/xist4c/web/aufgaben_id_393_.htm\";\n\t}\n\n\tcatalog_url()\n\t{\n\t\treturn \"/katalog/home.htm\";\n\t}\n\n\tchats_url()\n\t{\n\t\treturn \"/chats.htm\";\n\t}\n\n\tprofile_url()\n\t{\n\t\treturn \"/profil/index.htm\";\n\t}\n\n\taccount_url()\n\t{\n\t\treturn \"/account.htm\";\n\t}\n\n\tlogout_url()\n\t{\n\t\treturn \"/login.htm?logout=standardCug\";\n\t}\n};\n\nGlobals.prototype._ul4onattrs = [\"version\", \"platform\", \"user\", \"maxdbactions\", \"maxtemplateruntime\", \"lang\", \"datasources\", \"hostname\", \"app\", \"record\", \"mode\", \"view_template_id\", \"email_template_id\", \"view_id\"];\nGlobals.prototype._ul4attrs = new Set([\"version\", \"hostname\", \"platform\", \"user\", \"lang\", \"datasources\", \"app\", \"record\", \"maxdbactions\", \"maxtemplateruntime\", \"flashmessages\", \"mode\", \"scaled_url\", \"dist\", \"current_geo\", \"log_debug\", \"log_info\", \"log_warning\", \"log_error\", \"my_apps_url\", \"my_tasks_url\", \"catalog_url\", \"chats_url\", \"profile_url\", \"account_url\", \"logout_url\"]);\nul4.expose(Globals.prototype.log_debug, [\"message\", \"*\"]);\nul4.expose(Globals.prototype.log_info, [\"message\", \"*\"]);\nul4.expose(Globals.prototype.log_warning, [\"message\", \"*\"]);\nul4.expose(Globals.prototype.log_error, [\"message\", \"*\"]);\nul4.expose(Globals.prototype.dist, [\"geo1\", \"pk\", \"geo2\", \"pk\"]);\nul4.expose(Globals.prototype.current_geo, []);\nul4.expose(Globals.prototype.scaled_url, [\n\t\"image\", \"p\",\n\t\"width\", \"p\",\n\t\"height\", \"p\",\n\t\"type\", \"k=\", \"fill\",\n\t\"enlarge\", \"k=\", true,\n\t\"gravity\", \"k=\", \"sm\",\n\t\"quality\", \"k=\", null,\n\t\"rotate\", \"k=\", null,\n\t\"blur\", \"k=\", null,\n\t\"sharpen\", \"k=\", null,\n\t\"format\", \"k=\", null,\n\t\"cache\", \"k=\", true\n]);\n\n\nclass FlashMessageType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FlashMessage;\n\t}\n};\n\nlet flashmessagetype = new FlashMessageType(\"la\", \"FlashMessage\", \"A flash message in a web page\");\n\n\nexport class FlashMessage extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn flashmessagetype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<FlashMessage type=\" + ul4._repr(this.type) + \" title=\" + ul4._repr(this.title) + \">\";\n\t}\n};\n\nFlashMessage.prototype._ul4onattrs = [\"timestamp\", \"type\", \"title\", \"message\"];\nFlashMessage.prototype._ul4attrs = new Set([\"timestamp\", \"type\", \"title\", \"message\"]);\n\n\nclass AppType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof App;\n\t}\n};\n\nlet apptype = new AppType(\"la\", \"App\", \"A LivingApps application\");\n\n\nexport class App extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn apptype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<App id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n\n\tinsert(values={})\n\t{\n\t\tlet record = this[ul4.symbols.call](values);\n\t\tthis.globals.handler.save(this);\n\t\treturn record;\n\t}\n\n\ttemplate_url(identifier, record=null, params)\n\t{\n\t\tlet url = \"/gateway/apps/\" + this.id;\n\t\tif (record !== null)\n\t\t\turl += \"/\" + record.id;\n\t\treturn url_with_params(url, ['template', identifier], params);\n\t}\n\n\tnew_embedded_url(params)\n\t{\n\t\tlet url = \"/dateneingabe/\" + this.id + \"/new\";\n\t\treturn url_with_params(url, params);\n\t}\n\n\tnew_standalone_url(params)\n\t{\n\t\tlet url = \"/gateway/apps/\" + this.id + \"/new\";\n\t\treturn url_with_params(url, params);\n\t}\n\n\thome_url()\n\t{\n\t\treturn \"/apps/\" + this.id + \".htm\";\n\t}\n\n\tdatamanagement_url()\n\t{\n\t\treturn \"/_id_36_.htm?uuid=\" + this.id + \"&dId=\" + this.id + \"&resetInfo=true&templateIdentifier=created_\" + this.id;\n\t}\n\n\timport_url()\n\t{\n\t\treturn \"/import-export/\"+ this.id + \".htm\";\n\t}\n\n\ttasks_url()\n\t{\n\t\treturn \"/_id_1073_.htm?uuid=\" + this.id + \"&dId=\" + this.id + \"&p_tpl_uuid=\" + this.id + \"&resetInfo=true&templateIdentifier=created_task_\" + this.id;\n\t}\n\n\t// formbuilder_url()\n\t// {\n\t// \tlet lang = this.globals.lang\n\t// \tif (!lang)\n\t// \t\tlang = \"de\"\n\t// \tlet tpl_id = \"???\"\n\t// \tlet cl_id = \"???\"\n\t// \treturn \"/formbuilder/index.html?lang=\" + lang + \"&searchDescription=\" + tpl_id + \"&p_tpl_uuid=\" + this.id + \"&p_cl_id=\" + cl_id;\n\t// }\n\n\t// tasks_config_url()\n\t// {\n\t// \tlet tpl_id = \"???\"\n\t// \treturn \"/konfiguration/aufgaben.htm?com.livinglogic.cms.apps.search.model.SearchState.search_submit=true&searchDescription=\" + tpl_id + \"&dId=\" + this.id;\n\t// }\n\n\tdatamanagement_config_url()\n\t{\n\t\treturn \"/datenmanagement-konfigurieren/\" + this.id + \".htm\";\n\t}\n\n\tpermissions_url()\n\t{\n\t\treturn \"/_id_833_.htm?uuid=\" + this.id + \"&dId=\" + this.id + \"&resetInfo=true\";\n\t}\n\n\tdatamanageview_url(identifier)\n\t{\n\t\treturn \"/_id_36_.htm?uuid=\" + this.id + \"&dId=\" + this.id + \"&resetInfo=true&templateIdentifier=created_\" + this.id + \"_datamanage_master_\" + identifier;\n\t}\n\n\tget layout_controls()\n\t{\n\t\tif (this.active_view === null)\n\t\t\treturn new Map();\n\t\treturn this.active_view.layout_controls;\n\t}\n\n\t[ul4.symbols.call](values={})\n\t{\n\t\tlet record = new Record(null, this);\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let identifier of values.keys())\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, values, null, null);\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let identifier in values)\n\t\t\t{\n\t\t\t\tif (!record.fields.has(identifier))\n\t\t\t\t\tthrow new ul4.ArgumentError(ul4._repr(this) + \"() get an unexpected keyword argument \" + ul4._repr(identifier));\n\t\t\t}\n\t\t\trecord._make_fields(true, new Map(ul4._list(ul4.dicttype.items(values))), null, null);\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\t\treturn record;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t{\n\t\t\tif (!this.controls.has(name.substr(2)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.controls.get(name.substr(2));\n\t\t}\n\t\telse if (name.startsWith(\"lc_\"))\n\t\t{\n\t\t\tif (this.layout_controls === null || !this.layout_controls.has(name.substr(3)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.layout_controls.get(name.substr(3));\n\t\t}\n\t\telse if (name.startsWith(\"p_\") && this.params !== null)\n\t\t{\n\t\t\tif (!this.params.has(name.substr(2)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.params.get(name.substr(2));\n\t\t}\n\t\telse if (name.startsWith(\"pv_\") && this.params !== null)\n\t\t{\n\t\t\tif (!this.params.has(name.substr(3)))\n\t\t\t\tthrow new ul4.AttributeError(this, name);\n\t\t\treturn this.params.get(name.substr(3)).value;\n\t\t}\n\t\telse\n\t\t\treturn super[ul4.symbols.getattr](name);\n\t}\n\n\tget active_view()\n\t{\n\t\treturn this._active_view;\n\t}\n\n\tset active_view(view)\n\t{\n\t\tif (view === null)\n\t\t\t;\n\t\telse if (typeof(view) === \"string\")\n\t\t{\n\t\t\tif (this.views !== null && this.views.has(view))\n\t\t\t\tview = this.views.get(view);\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" not found!\");\n\t\t}\n\t\telse if (view instanceof View)\n\t\t{\n\t\t\tif (view.app === this)\n\t\t\t\t;\n\t\t\telse\n\t\t\t\tthrow new ul4.ValueError(\"View \" + ul4._repr(view) + \" belongs to the wrong app!\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new ul4.TypeError(ul4._repr(view) + \" is not a view!\");\n\t\t}\n\n\t\tthis._active_view = view;\n\t}\n\n\tget layout_controls()\n\t{\n\t\tif (this.active_views === null)\n\t\t\treturn new Map();\n\t\treturn this.active_view.layout_controls;\n\t}\n};\n\n\nApp.prototype._ul4onattrs = [\"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"image\", \"createdby\", \"controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"datamanagement_identifier\", \"basetable\", \"primarykey\", \"insertprocedure\", \"updateprocedure\", \"deleteprocedure\", \"templates\", \"createdat\", \"updatedat\", \"updatedby\", \"superid\", \"favorite\", \"_active_view\", \"datasource\", \"menus\", \"panels\"];\nApp.prototype._ul4attrs = new Set([\"id\", \"globals\", \"name\", \"description\", \"lang\", \"startlink\", \"image\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"controls\", \"layout_controls\", \"records\", \"recordcount\", \"installation\", \"categories\", \"params\", \"views\", \"menus\", \"panels\", \"datasource\", \"datamanagement_identifier\", \"insert\", \"favorite\", \"_active_view\", \"template_url\", \"new_embedded_url\", \"new_standalone_url\", \"home_url\", \"datamanagement_url\", \"import_url\", \"tasks_url\", /*\"formbuilder_url\", \"tasks_config_url\",*/ \"datamanagement_config_url\", \"permissions_url\", \"datamanageview_url\"]);\nul4.expose(App.prototype[ul4.symbols.call], [\"values\", \"**\"], {\"needsobject\": true});\nul4.expose(App.prototype.insert, [\"values\", \"**\"], {\"needsobject\": true});\nul4.expose(App.prototype.template_url, [\"identifier\", \"p\", \"record\", \"p=\", null, \"params\", \"**\"]);\nul4.expose(App.prototype.new_embedded_url, [\"params\", \"**\"]);\nul4.expose(App.prototype.new_standalone_url, [\"params\", \"**\"]);\n\n\nclass ViewType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof View;\n\t}\n};\n\nlet viewtype = new ViewType(\"la\", \"View\", \"An input form for a LivingViews application\");\n\n\nexport class View extends Base\n{\n\tget globals()\n\t{\n\t\treturn this.app.globals;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn viewtype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<View id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nView.prototype._ul4onattrs = [\"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\", \"login_required\", \"result_page\", \"use_geo\"];\nView.prototype._ul4attrs = new Set([\"id\", \"name\", \"combined_type\", \"app\", \"order\", \"width\", \"height\", \"start\", \"end\", \"controls\", \"layout_controls\", \"lang\", \"login_required\", \"result_page\", \"use_geo\"]);\n\n\nclass DataSourceType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DataSource;\n\t}\n};\n\nlet datasourcetype = new DataSourceType(\"la\", \"DataSource\", \"The data resulting from a data source configuration\");\n\n\nexport class DataSource extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datasourcetype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<DataSource id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nDataSource.prototype._ul4onattrs = [\"identifier\", \"app\", \"apps\"];\nDataSource.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"app\", \"apps\"]);\n\n\nclass RecordType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Record;\n\t}\n};\n\nlet recordtype = new RecordType(\"la\", \"Record\", \"A record of a LivingApp application\");\n\n\nexport class Record extends Base\n{\n\tconstructor(id, app)\n\t{\n\t\tsuper(id);\n\t\tthis.app = app;\n\t\tthis.createdat = null;\n\t\tthis.createdby = null;\n\t\tthis.updatedat = null;\n\t\tthis.updatedby = null;\n\t\tthis.updatecount = 0;\n\t\tthis._sparsevalues = new Map();\n\t\tthis._values = null;\n\t\tthis._fields = null;\n\t\tthis.children = new Map();\n\t\tthis.attachments = null;\n\t\tthis.errors = [];\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparsefieldlookupdata = null;\n\t\tthis._is_deleted = false;\n\t\tthis._is_new = true;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn recordtype;\n\t}\n\n\tas_text(maxlevel=3, controls=null)\n\t{\n\t\tif (maxlevel == 0)\n\t\t\treturn \"...\";\n\t\tlet fields = [];\n\t\tfor (let [identifier, control] of (controls || this.app.controls))\n\t\t{\n\t\t\tif (controls !== null || control.priority)\n\t\t\t{\n\t\t\t\tlet fieldvalue = this.fields.get(identifier).value_as_text(maxlevel-1);\n\t\t\t\tif (fieldvalue !== null)\n\t\t\t\t\tfields.push([control.label, fieldvalue]);\n\t\t\t}\n\t\t}\n\t\tif (fields.length === 0)\n\t\t\treturn this.globals.msg_no_fields();\n\t\telse if (fields.length === 1)\n\t\t\treturn fields[0][1];\n\t\tlet result = [];\n\t\tfor (let [label, fieldvalue] of fields)\n\t\t\tresult.push(label + \": \" + fieldvalue);\n\t\treturn result.join(\", \");\n\t}\n\n\t_make_fields(defaults, values, errors, lookupdata)\n\t{\n\t\tlet fields = new Map();\n\n\t\tfor (let control of this.app.controls.values())\n\t\t{\n\t\t\tlet identifier = control.identifier;\n\t\t\tlet value = null;\n\t\t\tif (values !== null)\n\t\t\t{\n\t\t\t\tif (defaults && !values.has(identifier))\n\t\t\t\t\tvalue = control.default;\n\t\t\t\telse if (values.has(identifier))\n\t\t\t\t\tvalue = values.get(identifier);\n\t\t\t}\n\t\t\tlet field = new control.fieldtype(control, this, value);\n\t\t\tfields.set(identifier, field);\n\t\t\tif (errors !== null && errors.has(identifier))\n\t\t\t\tfield.errors = errors.get(identifier);\n\t\t\tif (lookupdata !== null && lookupdata.has(identifier))\n\t\t\t\tfield.lookupdata = lookupdata.get(identifier);\n\t\t}\n\n\t\tthis._fields = fields;\n\t\tthis._sparsevalues = null;\n\t\tthis._sparsefielderrors = null;\n\t\tthis._sparselookupdata = null;\n\t}\n\n\t_in_form()\n\t{\n\t\tlet globals = this.app.globals;\n\n\t\treturn globals._in_form() && this === globals.record;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [\"<Record id=\", ul4._repr(this.id)];\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.control.priority && !field.is_empty())\n\t\t\t{\n\t\t\t\tv.push(\" v_\");\n\t\t\t\tv.push(field.control.identifier);\n\t\t\t\tv.push(\"=\");\n\t\t\t\tv.push(ul4._repr(field.value)); // FIXME: This might lead to infinite recursions\n\t\t\t}\n\t\t}\n\t\tv.push(\" state=\");\n\t\tv.push(ul4._repr(this.state));\n\t\tv.push(\">\");\n\t\treturn v.join(\"\");\n\t}\n\n\tget state()\n\t{\n\t\tif (this._is_deleted)\n\t\t\treturn \"deleted\";\n\t\telse if (this._is_new)\n\t\t\treturn \"new\";\n\t\telse if (this.is_dirty())\n\t\t\treturn \"dirty\";\n\t\telse\n\t\t\treturn \"saved\";\n\t}\n\n\tget values()\n\t{\n\t\tif (this._values === null)\n\t\t{\n\t\t\tthis._values = new Map();\n\t\t\tfor (let field of this.fields.values())\n\t\t\t{\n\t\t\t\tthis._values.set(field.control.identifier, field.value);\n\t\t\t}\n\t\t}\n\t\treturn this._values;\n\t}\n\n\tget fields()\n\t{\n\t\tif (this._fields === null)\n\t\t\tthis._make_fields(false, this._sparsevalues, this._sparsefielderrors, this._sparsefieldlookupdata)\n\t\treturn this._fields;\n\t}\n\n\tis_dirty()\n\t{\n\t\tif (this.id === null)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.is_dirty())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\thas_errors()\n\t{\n\t\tif (this.errors.length !== 0)\n\t\t\treturn true;\n\t\tfor (let field of this.fields.values())\n\t\t{\n\t\t\tif (field.has_errors())\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\tlet result = this.app.globals.handler.delete(this);\n\t\tthis._is_deleted = true;\n\t\treturn result;\n\t}\n\n\tsave()\n\t{\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\tupdate(values={})\n\t{\n\t\tif (ul4._ismap(values))\n\t\t{\n\t\t\tfor (let [key, value] of values.entries())\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\tfields.get(key).value = value;\n\t\t\t}\n\t\t}\n\t\telse if (ul4._isobject(values))\n\t\t{\n\t\t\tfor (let key in values)\n\t\t\t{\n\t\t\t\tif (!this.fields.has(key))\n\t\t\t\t\tthrow new ul4.ArgumentError(\"update() get an unexpected keyword argument \" + ul4._repr(key));\n\t\t\t\trecord.fields.get(key).value = values[key];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthrow new ul4.TypeError(\"values must be an object or a Map\");\n\n\t\tthis.app.globals.handler.save(this);\n\t}\n\n\ttemplate_url(identifier, params)\n\t{\n\t\tlet url = \"/gateway/apps/\" + this.app.id + \"/\" + this.id;\n\t\treturn url_with_params(url, ['template', identifier], params);\n\t}\n\n\tedit_embedded_url(params)\n\t{\n\t\tlet url = \"/dateneingabe/\" + this.app.id + \"/\" + this.id + \"/edit\";\n\t\treturn url_with_params(url, params);\n\t}\n\n\tedit_standalone_url(params)\n\t{\n\t\tlet url = \"/gateway/apps/\" + this.app.id + \"/\" + this.id + \"/edit\";\n\t\treturn url_with_params(url, params);\n\t}\n\n\tsearch(search)\n\t{\n\t\tfor (let identifier in search)\n\t\t{\n\t\t\tlet fieldsearch = search[identifier];\n\t\t\tif (ul4._bool(fieldsearch))\n\t\t\t{\n\t\t\t\tif (!this.fields.get(identifier).search(fieldsearch))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tul4onload(decoder)\n\t{\n\t\tsuper.ul4onload(decoder);\n\t\tthis._is_new = false;\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"values\")\n\t\t\treturn this._sparsevalues;\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"values\")\n\t\t{\n\t\t\tthis._sparsevalues = value;\n\t\t\tthis._values = null;\n\t\t\tthis._fields = null;\n\t\t}\n\t\telse\n\t\t\tthis[name] = value;\n\t}\n\n\t[ul4.symbols.getattr](name)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\treturn this.children.get(name.substr(2))\n\t\telse if (name.startsWith(\"f_\"))\n\t\t\treturn this.fields.get(name.substr(2))\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\treturn this.fields.get(name.substr(2)).value\n\t\telse\n\t\t\treturn super[ul4.symbols.getattr](name);\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name.startsWith(\"c_\"))\n\t\t\tthis.children[name.substr(2)] = value;\n\t\telse if (name.startsWith(\"v_\"))\n\t\t\tthis.fields.get(name.substr(2)).value = value;\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\n\nRecord.prototype._ul4onattrs = [\"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"_sparsevalues\", \"attachments\", \"children\", \"errors\", \"_sparsefielderrors\", \"_sparsefieldlookupdata\"];\nRecord.prototype._ul4attrs = new Set([\"id\", \"app\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\", \"updatecount\", \"values\", \"fields\", \"attachments\", \"children\", \"errors\", \"template_url\", \"edit_embedded_url\", \"edit_standalone_url\"]);\nul4.expose(Record.prototype.is_dirty, []);\nul4.expose(Record.prototype.has_errors, []);\nul4.expose(Record.prototype.delete, []);\nul4.expose(Record.prototype.save, []);\nul4.expose(Record.prototype.update, [\"values\", \"**\"], {\"needsobject\": true});\nul4.expose(Record.prototype.template_url, [\"identifier\", \"p\", \"params\", \"**\"]);\nul4.expose(Record.prototype.edit_embedded_url, [\"params\", \"**\"]);\nul4.expose(Record.prototype.edit_standalone_url, [\"params\", \"**\"]);\n\n\nclass FieldType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Field;\n\t}\n};\n\nlet fieldtype = new FieldType(\"la\", \"Field\", \"Holds the value of a field of a record (and related information)\");\n\n\nexport class Field extends Base\n{\n\tconstructor(control, record, value)\n\t{\n\t\tsuper(null);\n\t\tthis.control = control;\n\t\tthis.record = record;\n\t\tthis._label = null;\n\t\tthis._lookupdata = null;\n\t\tthis.errors = [];\n\t\tthis._value = null;\n\t\tif (!this._in_form())\n\t\t\tthis.value = value;\n\t\tthis._dirty = false;\n\t\tthis._enabled = true;\n\t\tthis._writable = true;\n\t\tthis._visible = true;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn fieldtype;\n\t}\n\n\tget value()\n\t{\n\t\tif (this._in_form())\n\t\t\treturn this._get_dom_value();\n\t\treturn this._value;\n\t}\n\n\tset value(value)\n\t{\n\t\tlet oldvalue = this._value;\n\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\n\t\tif (ul4._ne(oldvalue, change.value))\n\t\t{\n\t\t\tif (this.record._values !== null)\n\t\t\t\tthis.record._values.set(this.control.identifier, change.value);\n\t\t\tthis._value = change.value;\n\t\t\tthis._dirty = true;\n\t\t}\n\t\tthis.errors = change.errors;\n\t\tif (this._in_form())\n\t\t\tthis._set_dom_value(this._value);\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\treturn null;\n\t}\n\n\t_validate(change)\n\t{\n\t\t// Do nothing, i.e. accept the value unchanged and without errors\n\t}\n\n\t_set_dom_label()\n\t{\n\t\tif (this._in_form())\n\t\t\tthis._dom_label.textContent = this.label;\n\t}\n\n\tget label()\n\t{\n\t\treturn this._label ?? this.control.label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t\tthis._set_dom_label();\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.control.globals;\n\t}\n\n\tis_empty()\n\t{\n\t\treturn this._value === null;\n\t}\n\n\tis_dirty()\n\t{\n\t\treturn this._dirty;\n\t}\n\n\thas_errors()\n\t{\n\t\treturn this.errors.length !== 0;\n\t}\n\n\tadd_error(error)\n\t{\n\t\tthis.errors.push(error);\n\t}\n\n\tset_error(error)\n\t{\n\t\tif (error !== null)\n\t\t\tthis.errors = [error];\n\t\telse\n\t\t\tthis.errors = [];\n\t}\n\n\tsearch(searchvalue)\n\t{\n\t\treturn this.control.search(this.value, searchvalue);\n\t}\n\n\tmsg_field_required(value)\n\t{\n\t\tswitch (this.globals.lang)\n\t\t{\n\t\t\tcase \"de\":\n\t\t\t\treturn `\"${this.label}\" wird benötigt!`;\n\t\t\tdefault:\n\t\t\t\treturn `\"${this.label}\" is required!`;\n\t\t}\n\t}\n\n\tmsg_field_wrong_type(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support the type ${ul4._type(value).name}!`;\n\t}\n\n\tmsg_bool_truerequired(value)\n\t{\n\t\treturn `\"${this.label}\" only accepts \"Yes\"!`;\n\t}\n\n\tmsg_string_tooshort(value)\n\t{\n\t\treturn `\"${this.label}\" is too short. You must use at least ${this.control.minlength} characters!`;\n\t}\n\n\tmsg_string_toolong(value)\n\t{\n\t\treturn `\"${this.label}\" is too long. You may use at most ${this.control.maxlength} characters!`;\n\t}\n\n\tmsg_email_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid email address!`;\n\t}\n\n\tmsg_url_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid URL!`;\n\t}\n\n\tmsg_tel_format(value)\n\t{\n\t\treturn `\"${this.label}\" must be a valid phone number!`;\n\t}\n\n\tmsg_date_format(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support this date format!`;\n\t}\n\n\tmsg_number_format(value)\n\t{\n\t\treturn `\"${this.label}\" doesn't support this number format!`;\n\t}\n\n\tmsg_lookup_wrongitem(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" doesn't belong to this lookup!`;\n\t}\n\n\tmsg_lookup_unknownkey(value)\n\t{\n\t\treturn `The option ${ul4._repr(value)} for \"${this.label}\" is unknown!`;\n\t}\n\n\tmsg_applookup_wrongrecord(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" doesn't belong to the correct app!`;\n\t}\n\n\tmsg_applookup_unknownkey(value)\n\t{\n\t\treturn `The record ${ul4._repr(value)} for \"${this.label}\" can't be found!`;\n\t}\n\n\t/*\n\tThe following methods are used in the input form.\n\n\tI.e. they are expected to be executed inside a browser.\n\t*/\n\t_in_form()\n\t{\n\t\treturn this.record._in_form();\n\t}\n\n\tget _sel_root()\n\t{\n\t\treturn \"#livingapps-form .\" + this.control._cssclass_root + \".llft-id-\" + this.control.identifier;\n\t}\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label span\";\n\t}\n\n\tget _sel_control()\n\t{\n\t\treturn this._sel_root + \" \" + this.control._cssclass_control;\n\t}\n\n\tget _dom_root()\n\t{\n\t\treturn document.querySelector(this._sel_root);\n\t}\n\n\tget _dom_label()\n\t{\n\t\treturn document.querySelector(this._sel_label);\n\t}\n\n\tget _dom_control()\n\t{\n\t\treturn document.querySelector(this._sel_control);\n\t}\n\n\tget _dom_controls()\n\t{\n\t\treturn document.querySelectorAll(this._sel_control);\n\t}\n\n\t_get_dom_value()\n\t{\n\t\treturn this._dom_control.value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tthis._dom_control.value = value !== null ? value : \"\";\n\t}\n\n\tget visible()\n\t{\n\t\treturn this._visible;\n\t}\n\n\tset visible(value)\n\t{\n\t\tif (this._in_form())\n\t\t\tthis._dom_root.hidden = !value;\n\t\tthis._visible = value;\n\t}\n\n\tget enabled()\n\t{\n\t\tif (this._in_form())\n\t\t\treturn !this._dom_root.classList.contains(\"llft-control-readonly\");\n\t\telse\n\t\t\treturn this._enabled;\n\t}\n\n\tset enabled(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tlet disabled = !value;\n\t\t\tfor (let node of this._dom_controls)\n\t\t\t\tnode.disabled = disabled;\n\t\t\tthis._dom_root.classList.toggle(\"llft-control-readonly\", disabled);\n\t\t}\n\t\tthis._enabled = value;\n\t}\n\n\tget writable()\n\t{\n\t\treturn this._writable;\n\t}\n\n\tset writable(value)\n\t{\n\t\tthis._writable = value;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet s = \"<\" + this.constructor.name + \" identifier=\";\n\t\ts += ul4._repr(this.control.identifier)\n\t\tif (this._dirty)\n\t\t\ts += \" is_dirty()=True\";\n\t\tif (this.errors.length > 0)\n\t\t\ts += \" has_errors()=True\";\n\t\ts += \">\"\n\t\treturn s;\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"value\")\n\t\t\tthis.value = value;\n\t\telse if (name === \"visible\")\n\t\t\tthis.visible = ul4._bool(value);\n\t\telse if (name === \"enabled\")\n\t\t\tthis.enabled = ul4._bool(value);\n\t\telse if (name === \"writable\")\n\t\t\tthis.writable = ul4._bool(value);\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\n\nField.prototype._ul4onattrs = [\"control\", \"record\", \"label\", \"value\", \"errors\", \"_visible\", \"_enabled\", \"_writable\"];\nField.prototype._ul4attrs = new Set([\"control\", \"record\", \"label\", \"value\", \"errors\", \"visible\", \"enabled\", \"writable\"]);\nField.prototype._inputevent = \"input\";\n\n\nclass BoolFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof BoolField;\n\t}\n};\n\nlet boolfieldtype = new BoolFieldType(\"la\", \"BoolField\", \"Holds the value of a bool field of a record (and related information)\");\n\n\nexport class BoolField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn boolfieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) === \"boolean\")\n\t\t{\n\t\t\tif (this.control.required && !change.value)\n\t\t\t\tchange.errors.push(this.msg_bool_truerequired(change.value));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\treturn this._dom_control.checked;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tthis._dom_control.checked = value;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\treturn this.globals.msg_bool(this.value);\n\t}\n};\n\n\nclass IntFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof IntField;\n\t}\n};\n\nlet intfieldtype = new IntFieldType(\"la\", \"IntField\", \"Holds the value of an int field of a record (and related information)\");\n\n\nexport class IntField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn intfieldtype;\n\t}\n\n\t_parse(value)\n\t{\n\t\tif (/^\\s*[-+]?\\d+\\s*$/.test(value))\n\t\t\treturn parseInt(value);\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = this._parse(change.value);\n\t\t\tif (value !== null)\n\t\t\t\tchange.value = value;\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_number_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse if (typeof(change.value) === \"number\")\n\t\t{\n\t\t\tif (Math.round(change.value) !== change.value)\n\t\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\t\t// Keep original floating point number\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tlet testvalue = this._parse(value);\n\t\t\tif (testvalue !== null)\n\t\t\t\tvalue = testvalue;\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tsuper._set_dom_value(value !== null ? value + \"\" : \"\");\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\treturn value != null ? value + \"\" : null;\n\t}\n\n\tget writable()\n\t{\n\t\treturn this._writable;\n\t}\n\n\tset writable(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tlet readonly = !value;\n\t\t\tfor (let node of this._dom_controls)\n\t\t\t\tnode.readOnly = readonly;\n\t\t}\n\t\tsuper.writable = value;\n\t}\n};\n\n\nclass NumberFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof NumberField;\n\t}\n};\n\nlet numberfieldtype = new NumberFieldType(\"la\", \"NumberField\", \"Holds the value of a number field of a record (and related information)\");\n\n\nexport class NumberField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn numberfieldtype;\n\t}\n\n\t_parse(value)\n\t{\n\t\tif (value === null)\n\t\t\treturn null;\n\n\t\t// Try to ignore thousands separators and return the value as a number\n\t\tlet testvalue = value;\n\t\t// Count decimal delimiters\n\t\tlet seps = \"\";\n\t\tlet commas = 0;\n\t\tlet dots = 0\n\t\tfor (let i = 0; i < value.length; ++i)\n\t\t{\n\t\t\tlet c = value[i];\n\t\t\tif (c == \",\")\n\t\t\t{\n\t\t\t\tcommas++;\n\t\t\t\tseps += c;\n\t\t\t}\n\t\t\telse if (c == \".\")\n\t\t\t{\n\t\t\t\tdots++;\n\t\t\t\tseps += c;\n\t\t\t}\n\t\t}\n\t\tlet convert = null;\n\t\tif (commas == 0)\n\t\t{\n\t\t\tif (dots <= 1)\n\t\t\t\t; // nothing to do\n\t\t\telse\n\t\t\t\tconvert = \"de\";\n\t\t}\n\t\telse if (commas == 1)\n\t\t{\n\t\t\tif (dots == 1)\n\t\t\t\tconvert = (seps == \".,\") ? \"de\" : \"en\";\n\t\t\telse\n\t\t\t\tconvert = \"de\";\n\t\t}\n\t\telse // commas > 1\n\t\t{\n\t\t\tif (dots <= 1)\n\t\t\t\tconvert = \"en\";\n\t\t\telse\n\t\t\t\treturn null; // We can't guess what the user meant\n\t\t}\n\n\t\tif (convert === \"de\")\n\t\t\ttestvalue = testvalue.replace(/\\./g, \"\").replace(/,/g, \".\");\n\t\telse if (convert === \"en\")\n\t\t\ttestvalue = testvalue.replace(/,/g, \"\");\n\t\tlet floatvalue = parseFloat(testvalue);\n\t\tif (isNaN(floatvalue))\n\t\t\treturn value;\n\t\treturn floatvalue;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = this._parse(change.value);\n\t\t\tif (value !== null)\n\t\t\t{\n\t\t\t\tvalue = this._bound_value(value);\n\t\t\t\tif (this.control.precision !== null)\n\t\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\t\tchange.value = value;\n\t\t\t}\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_number_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse if (typeof(change.value) === \"number\")\n\t\t{\n\t\t\tlet value = this._bound_value(change.value);\n\t\t\tif (this.control.precision !== null)\n\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\tchange.value = value;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_bound_value(value)\n\t{\n\t\tif (this.control.minimum !== null)\n\t\t{\n\t\t\tif (value < this.control.minimum)\n\t\t\t\tvalue = this.control.minimum;\n\t\t}\n\t\tif (this.control.maximum !== null)\n\t\t{\n\t\t\tif (value > this.control.maximum)\n\t\t\t\tvalue = this.control.maximum;\n\t\t}\n\t\treturn value;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tif (typeof(value) == \"string\")\n\t\t\t{\n\t\t\t\tlet testvalue = this._parse(value);\n\t\t\t\tif (testvalue !== null)\n\t\t\t\t\tvalue = testvalue;\n\t\t\t}\n\t\t\tif (typeof(value) === \"number\")\n\t\t\t{\n\t\t\t\tif (this.control.precision !== null)\n\t\t\t\t\tvalue = ul4._round(value, this.control.precision);\n\t\t\t\tvalue = this._bound_value(value);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = null;\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (typeof(value) === \"number\")\n\t\t{\n\t\t\tvalue = this._bound_value(value);\n\t\t\tif (this.control.precision !== null)\n\t\t\t\tvalue = value.toFixed(this.control.precision);\n\t\t}\n\t\telse if (value === null)\n\t\t\tvalue = \"\";\n\t\tvalue += \"\";\n\t\tif (this.globals.lang == \"de\" && this.control.precision === null)\n\t\t\tvalue = value.replace(\".\", \",\");\n\t\tsuper._set_dom_value(value);\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (value === null)\n\t\t\treturn null;\n\t\tif (this.control.precision !== null)\n\t\t\treturn value.toFixed(this.control.precision);\n\t\treturn value.toString();\n\t}\n\n\tget writable()\n\t{\n\t\treturn this._writable;\n\t}\n\n\tset writable(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tlet readonly = !value;\n\t\t\tfor (let node of this._dom_controls)\n\t\t\t\tnode.readOnly = readonly;\n\t\t}\n\t\tsuper.writable = value;\n\t}\n};\n\n\nclass StringFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof StringField;\n\t}\n};\n\nlet stringfieldtype = new StringFieldType(\"la\", \"StringField\", \"Holds the value of a string field of a record (and related information)\");\n\n\nexport class StringField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn stringfieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet minlength = this.control.minlength;\n\t\t\tlet maxlength = this.control.maxlength;\n\t\t\tif (minlength !== null && change.value.length < minlength)\n\t\t\t\tchange.errors.push(this.msg_string_tooshort(change.value))\n\t\t\tif (maxlength !== null && change.value.length > maxlength)\n\t\t\t\tchange.errors.push(this.msg_string_toolong(change.value))\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\tget writable()\n\t{\n\t\treturn this._writable;\n\t}\n\n\tset writable(value)\n\t{\n\t\tif (this._in_form())\n\t\t{\n\t\t\tlet readonly = !value;\n\t\t\tfor (let node of this._dom_controls)\n\t\t\t\tnode.readOnly = readonly;\n\t\t}\n\t\tsuper.writable = value;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\treturn this.value;\n\t}\n};\n\n\nclass PasswordFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof PasswordField;\n\t}\n};\n\nlet passwordfieldtype = new PasswordFieldType(\"la\", \"PasswordField\", \"Holds the value of a string/password field of a record (and related information)\");\n\n\nexport class PasswordField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn passwordfieldtype;\n\t}\n};\n\n\nclass EmailFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof EmailField;\n\t}\n};\n\nlet emailfieldtype = new EmailFieldType(\"la\", \"EmailField\", \"Holds the value of a string/email field of a record (and related information)\");\n\n\nexport class EmailField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn emailfieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/i;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_email_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nclass URLFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof URLField;\n\t}\n};\n\nlet urlfieldtype = new URLFieldType(\"la\", \"URLField\", \"Holds the value of a string/url field of a record (and related information)\");\n\n\nexport class URLField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn urlfieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tlet url = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\turl = new URL(change.value);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t\tif (url !== null && url.protocol !== \"http:\" && url.protocol !== \"https:\")\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_url_format(change.value));\n\t\t\t}\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nclass TelFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof TelField;\n\t}\n};\n\nlet telfieldtype = new TelFieldType(\"la\", \"TelField\", \"Holds the value of a string/tel field of a record (and related information)\");\n\n\nexport class TelField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn telfieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (typeof(change.value) === \"string\" && change.value.length > 0)\n\t\t{\n\t\t\tconst re = /^\\\\+?[0-9 /()-]+$/;\n\t\t\tif (!re.test(change.value))\n\t\t\t\tchange.errors.push(this.msg_tel_format(change.value));\n\t\t}\n\t\tsuper._validate(change);\n\t}\n};\n\n\nclass TextAreaFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof TextAreaField;\n\t}\n};\n\nlet textareafieldtype = new TextAreaFieldType(\"la\", \"TextAreaField\", \"Holds the value of a string/textarea field of a record (and related information)\");\n\n\nexport class TextAreaField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn textareafieldtype;\n\t}\n};\n\n\nclass HTMLFieldType extends StringFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof HTMLField;\n\t}\n};\n\nlet htmlfieldtype = new HTMLFieldType(\"la\", \"HTMLField\", \"Holds the value of a string/html field of a record (and related information)\");\n\n\nexport class HTMLField extends StringField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn htmlfieldtype;\n\t}\n};\n\n\nclass GeoFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof GeoField;\n\t}\n};\n\nlet geofieldtype = new GeoFieldType(\"la\", \"GeoField\", \"Holds the value of a geo field of a record (and related information)\");\n\n\nexport class GeoField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn geofieldtype;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tfor (let dom_node of this._dom_controls)\n\t\t{\n\t\t\tif (dom_node.id.endsWith(\"_geoinfo\"))\n\t\t\t{\n\t\t\t\tlet value = dom_node.value;\n\t\t\t\tif (value)\n\t\t\t\t{\n\t\t\t\t\tvalue = JSON.parse(value);\n\t\t\t\t\treturn new Geo(\n\t\t\t\t\t\tthis.globals,\n\t\t\t\t\t\tvalue.geometry.coordinates[0],\n\t\t\t\t\t\tvalue.geometry.coordinates[1],\n\t\t\t\t\t\tvalue.properties.formatted_address\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (value === null)\n\t\t{\n\t\t\tfor (let dom_node of this._dom_controls)\n\t\t\t{\n\t\t\t\tdom_node.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let dom_node of this._dom_controls)\n\t\t\t{\n\t\t\t\tif (dom_node.id.endsWith(\"_geoinfo\"))\n\t\t\t\t{\n\t\t\t\t\tlet dom_value = {\n\t\t\t\t\t\t\"type\": \"Feature\",\n\t\t\t\t\t\t\"geometry\": {\n\t\t\t\t\t\t\t\"coordinates\": [\n\t\t\t\t\t\t\t\tvalue.lat,\n\t\t\t\t\t\t\t\tvalue.long\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\t\"formatted_address\": value.info\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tdom_node.value = ul4._asjson(dom_value);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tdom_node.value = value.info;\n\t\t\t}\n\t\t}\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (this.value === null)\n\t\t\treturn null;\n\t\t// FIXME: Show N/S and W/E? Show arc minutes/seconds?\n\t\tlet result = value.lat.toFixed(5) + \", \" + value.long.toFixed(5);\n\t\tif (value.info !== null)\n\t\t\tresult += \" (\" + value.info + \")\";\n\t\treturn result;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof Geo))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\nGeoField.prototype._inputevent = \"llgeo\";\n\n\nclass FileFieldType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FileField;\n\t}\n};\n\nlet filefieldtype = new FileFieldType(\"la\", \"FileField\", \"Holds the value of a file field of a record (and related information)\");\n\n\nexport class FileField extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn filefieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (!(change.value instanceof File))\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\t// Always return `null``\n\t\treturn null;\n\t}\n\n\t_set_dom_value()\n\t{\n\t\t// Do nothing\n\t}\n};\n\n\nclass FileSignatureFieldType extends FileFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FileSignatureField;\n\t}\n};\n\nlet filesignaturefieldtype = new FileSignatureFieldType(\"la\", \"FileSignatureField\", \"Holds the value of a file/signature field of a record (and related information)\");\n\n\nexport class FileSignatureField extends FileField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn filesignaturefieldtype;\n\t}\n\n\t_validate(change)\n\t{\n\t\t// FIXME: Implement handling of data URLs.\n\t\tsuper._validate(change);\n\t}\n};\n\n\nclass DateFieldBaseType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DateFieldBase;\n\t}\n};\n\nlet datefieldbasetype = new DateFieldBaseType(\"la\", \"DateFieldBase\", \"Holds the value of a date field of a record (and related information)\");\n\n\nexport class DateFieldBase extends Field\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datefieldbasetype;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (value === null)\n\t\t\treturn null;\n\t\tif (typeof(value) === \"string\")\n\t\t\treturn value;\n\t\treturn ul4._format(value, this.control.formatstring())\n\t}\n\n\t_parse(value, format)\n\t{\n\t\tlet year = null, month = null, day = null, hour = 0, minute = 0, second = 0, ispm = null;\n\n\t\tfunction _int(v, len, min, max)\n\t\t{\n\t\t\tv = v.substring(0, len);\n\t\t\tif (v.length != len)\n\t\t\t\treturn null;\n\t\t\tv = parseInt(v, 10);\n\t\t\tif (isNaN(v) || v < min || v > max)\n\t\t\t\treturn null;\n\t\t\treturn v;\n\t\t}\n\n\t\twhile (value)\n\t\t{\n\t\t\t// Are both `value` and `format` not `null`,\n\t\t\t// i.e. neither `value` nor `format` is exhaused?\n\t\t\tif (!format)\n\t\t\t\treturn null;\n\t\t\tif (format.startsWith(\"%Y\"))\n\t\t\t{\n\t\t\t\tyear = _int(value, 4);\n\t\t\t\tif (year === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(4);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%y\"))\n\t\t\t{\n\t\t\t\tyear = _int(value, 2);\n\t\t\t\tif (year === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%m\"))\n\t\t\t{\n\t\t\t\tmonth = _int(value, 2);\n\t\t\t\tif (month === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%d\"))\n\t\t\t{\n\t\t\t\tday = _int(value, 2);\n\t\t\t\tif (day === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%H\"))\n\t\t\t{\n\t\t\t\thour = _int(value, 2);\n\t\t\t\tif (hour === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%I\"))\n\t\t\t{\n\t\t\t\thour = _int(value, 2);\n\t\t\t\tif (hour === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%M\"))\n\t\t\t{\n\t\t\t\tminute = _int(value, 2);\n\t\t\t\tif (minute === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%S\"))\n\t\t\t{\n\t\t\t\tsecond = _int(value, 2);\n\t\t\t\tif (second === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%p\"))\n\t\t\t{\n\t\t\t\tif (value.toLowerCase().startsWith(\"pm\"))\n\t\t\t\t\tispm = true;\n\t\t\t\telse if (value.toLowerCase().startsWith(\"am\"))\n\t\t\t\t\tispm = false;\n\t\t\t\telse\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%%\"))\n\t\t\t{\n\t\t\t\tif (!value.startsWith(\"%\"))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse if (format.startsWith(\"%z\"))\n\t\t\t{\n\t\t\t\tif (!value.startsWith(\"-\") && !value.startsWith(\"+\"))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tlet _tzhour = _int(value, 2);\n\t\t\t\tif (_tzhour === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tif (!value.startsWith(\":\"))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tlet _tzminute = _int(value, 2);\n\t\t\t\tif (_tzminute === null)\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(2);\n\t\t\t\tformat = format.substring(2);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!value.startsWith(format.substring(0, 1)))\n\t\t\t\t\treturn null;\n\t\t\t\tvalue = value.substring(1);\n\t\t\t\tformat = format.substring(1);\n\t\t\t}\n\t\t}\n\t\t// Are both `value` and `format` `null`?\n\t\t// I.e. both `value` and `format` must be exhausted, otherwise ...\n\t\tif (format)\n\t\t\t// ... `format` has remaining content that the value didn't provide\n\t\t\treturn null;\n\n\t\t// Check existance of values and their range\n\t\tif (year === null)\n\t\t\treturn null;\n\t\tif (month === null || month < 1 || month > 12)\n\t\t\treturn null;\n\t\tif (day === null || day < 1 || day > 31) // FIXME: Use the actuall number of days\n\t\t\treturn null;\n\t\tif (ispm === null)\n\t\t{\n\t\t\tif (hour < 0 || hour > 23)\n\t\t\t\treturn null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (hour < 0 || hour > 11)\n\t\t\t\treturn null;\n\t\t\tif (ispm)\n\t\t\t\thour += 12;\n\t\t}\n\t\tif (minute < 0 || minute > 59)\n\t\t\treturn null;\n\t\tif (minute < 0 || minute > 59)\n\t\t\treturn null;\n\t\tif (second < 0 || second > 60)\n\t\t\treturn null;\n\t\treturn new Date(year, month-1, day, hour, minute, second);\n\t}\n\n\t_validate(change)\n\t{\n\t\tif (change.value === null || change.value === \"\")\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse if (change.value instanceof Date)\n\t\t{\n\t\t\tchange.value = this._convert(change.value);\n\t\t}\n\t\telse if (change.value instanceof ul4.Date_)\n\t\t{\n\t\t\tchange.value = this._convert(change.value._date);\n\t\t}\n\t\telse if (typeof(change.value) === \"string\")\n\t\t{\n\t\t\tlet value = null;\n\t\t\tfor (let format of this.control.formatstrings_parse())\n\t\t\t{\n\t\t\t\tvalue = this._parse(change.value, format);\n\t\t\t\tif (value !== null)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (value !== null)\n\t\t\t\tchange.value = this._convert(value);\n\t\t\telse\n\t\t\t\tchange.errors.push(this.msg_date_format(change.value));\n\t\t\t\t// Keep original invalid string\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(change.value));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (!value)\n\t\t\treturn null;\n\n\t\tfor (let format of this.control.formatstrings_parse())\n\t\t{\n\t\t\tlet date = this._parse(value, format);\n\t\t\tif (date !== null)\n\t\t\t\treturn this._convert(date);\n\t\t}\n\t\treturn null;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (value !== null)\n\t\t\tvalue = ul4._format(value, this.control.formatstring(), this.globals.lang);\n\t\telse\n\t\t\tvalue = \"\";\n\t\tsuper._set_dom_value(value);\n\t}\n};\n\n\nclass DateFieldType extends DateFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DateField;\n\t}\n};\n\nlet datefieldtype = new DateFieldType(\"la\", \"DateField\", \"Holds the value of a date/date field of a record (and related information)\");\n\n\nexport class DateField extends DateFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datefieldtype;\n\t}\n\n\t_convert(date)\n\t{\n\t\treturn new ul4.Date_(date.getFullYear(), date.getMonth()+1, date.getDate());\n\t}\n};\n\n\nclass DatetimeMinuteFieldType extends DateFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DatetimeMinuteField;\n\t}\n};\n\nlet datetimeminutefieldtype = new DatetimeMinuteFieldType(\"la\", \"DatetimeMinuteField\", \"Holds the value of a date/datetimeminute field of a record (and related information)\");\n\n\nexport class DatetimeMinuteField extends DateFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datetimeminutefieldtype;\n\t}\n\n\t_convert(date)\n\t{\n\t\t// Get rid of seconds and milliseconds, this modifies the object passed in.\n\t\tdate.setSeconds(0);\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n\nclass DatetimeSecondFieldType extends DateFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DatetimeSecondField;\n\t}\n};\n\nlet datetimesecondfieldtype = new DatetimeSecondFieldType(\"la\", \"DatetimeSecondField\", \"Holds the value of a date/datetimesecond field of a record (and related information)\");\n\n\nexport class DatetimeSecondField extends DateFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datetimesecondfieldtype;\n\t}\n\n\t_convert(date)\n\t{\n\t\t// Get rid of milliseconds, this modifies the object passed in.\n\t\tdate.setMilliseconds(0);\n\t\treturn date;\n\t}\n};\n\n/*\n`ChoiceFieldBase` is used as the base class for all `lookup`, `multiplelookup`,\n`applookup` and `multipleapplookup` fields.\n\nSince the inheritance hierarchy follows the data model *not* which HTML element\nis used for editing, we would have to implement the same DOM interaction logic\nin multiple classes (i.e. we would have to handle a HTML `select` element in\n`LookupSelectField`, `MultipleLookupSelectField`, `AppLookupSelectField`\nand `MultipleAppLookupSelectField`).\n\nTo solve this problem, all methods that handle HTML elements are implemented in\nthis class. Subclasses then simply call the appropriate method.\n*/\nexport class ChoiceFieldBase extends Field\n{\n\t_make_option(selected, value, label)\n\t{\n\t\tlet option = element(\n\t\t\t\"option\",\n\t\t\tlabel,\n\t\t\t{\n\t\t\t\t\"value\": value,\n\t\t\t\t\"class\": value === this.control.none_key ? \"la-none-option\" : null,\n\t\t\t\t\"selected\": selected ? \"selected\" : null,\n\t\t\t}\n\t\t);\n\t\treturn option;\n\t}\n\n\t_set_dom_lookupdata_select(lookupdata)\n\t{\n\t\tif (lookupdata === null)\n\t\t\tlookupdata = this.control.lookup_data;\n\t\tif (ul4._isobject(lookupdata))\n\t\t\tlookupdata = new Map(Object.entries(lookupdata));\n\n\t\tlet none_selected = false;\n\t\tlet selected = new Set();\n\t\tfor (let dom_option of this._dom_control.querySelectorAll(\"option:checked\"))\n\t\t{\n\t\t\tlet value = dom_option.getAttribute(\"value\");\n\t\t\tif (lookupdata.has(value))\n\t\t\t\tselected.add(value);\n\t\t\telse if (value === this.control.none_key)\n\t\t\t\tnone_selected = true;\n\t\t}\n\n\t\tlet new_children = [];\n\t\tif (this.control.none_key !== null)\n\t\t{\n\t\t\tnew_children.push(\n\t\t\t\tthis._make_option(\n\t\t\t\t\tnone_selected,\n\t\t\t\t\tthis.control.none_key,\n\t\t\t\t\tthis.control.none_label !== null ? this.control.none_label : this.globals.msg_nothing_selected()\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tfor (let [key, value] of lookupdata)\n\t\t{\n\t\t\tnew_children.push(\n\t\t\t\tthis._make_option(\n\t\t\t\t\tselected.has(key),\n\t\t\t\t\tkey,\n\t\t\t\t\tthis._make_label(value)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\tthis._dom_control.replaceChildren(...new_children);\n\t}\n\n\t_set_dom_lookupdata_input(lookupdata)\n\t{\n\t\tif (lookupdata === null)\n\t\t\tlookupdata = this.control.lookupdata;\n\t\telse if (ul4._isobject(lookupdata))\n\t\t\tlookupdata = new Map(Object.entries(lookupdata));\n\n\t\tlet none_selected = false;\n\t\tlet selected = new Set();\n\t\tfor (let dom_input of this._dom_controls)\n\t\t{\n\t\t\tlet value = dom_input.getAttribute(\"value\");\n\t\t\tif (dom_input.checked)\n\t\t\t{\n\t\t\t\tif (lookupdata.has(value))\n\t\t\t\t\tselected.add(value);\n\t\t\t\telse if (value === this.control.none_key)\n\t\t\t\t\tnone_selected = true;\n\n\t\t\t}\n\t\t}\n\n\t\tlet dom_none_input = this._dom_root.querySelector(\"input[value=\" + this.control.none_key + \"]\");\n\t\tif (dom_none_input !== null)\n\t\t\tdom_none_input.checked = none_selected;\n\n\t\tfor (let [key, item] of this.control.lookupdata)\n\t\t{\n\t\t\tlet dom_input = this._dom_root.querySelector(\"input[value=\" + key + \"]\");\n\t\t\tlet dom_label = this._dom_root.querySelector(\"label[for=\" + dom_input.id + \"]\")\n\n\t\t\tif (lookupdata.has(key))\n\t\t\t{\n\t\t\t\tdom_input.style.display = \"inline\";\n\t\t\t\tdom_label.style.display = \"inline\";\n\t\t\t\tdom_label.innerText = this._make_label(lookupdata.get(key));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdom_input.style.display = \"none\";\n\t\t\t\tdom_label.style.display = \"none\";\n\t\t\t\tdom_label.checked = false;\n\t\t\t}\n\t\t}\n\t}\n};\n\n\nclass LookupFieldBaseType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupFieldBase;\n\t}\n};\n\nlet lookupfieldbasetype = new LookupFieldBaseType(\"la\", \"LookupFieldBase\", \"Base type of LookupField and MultipleLookupField\");\n\n\nexport class LookupFieldBase extends ChoiceFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupfieldbasetype;\n\t}\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdata !== null)\n\t\t\treturn this._lookupdata;\n\t\telse\n\t\t\treturn this.control.lookupdata;\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tif (this._in_form())\n\t\t\tthis._set_dom_lookupdata(value);\n\t\tthis._lookupdata = value;\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t}\n\n\t_make_label(value)\n\t{\n\t\tif (typeof(value) === \"string\")\n\t\t\treturn value;\n\t\telse if (value instanceof LookupItem)\n\t\t\treturn value.label;\n\t\telse\n\t\t\treturn ul4._str(value);\n\t}\n\n\t_find_lookupitem(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\t// If `lookupdata` is `null`, this probably an interface,\n\t\t\t// so we can't validate anything (note that interfaces will however go\n\t\t\t// away in the future)\n\t\t\tif (this.lookupdata === null)\n\t\t\t\treturn;\n\t\t\tlet lookupitem = this.control.lookupdata.get(v);\n\t\t\tif (lookupitem === undefined)\n\t\t\t{\n\t\t\t\t// If the lookup control is auto expandable,\n\t\t\t\t// the user may have given us a label\n\t\t\t\tif (this.control.autoexpandable)\n\t\t\t\t{\n\t\t\t\t\t// Search for the LookupItem with that label\n\t\t\t\t\tfor (let search_lookupitem of this.lookupdata.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (v === search_lookupitem.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchange.value = search_lookupitem;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// If we couldn't find the label, keep the label as it is.\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchange.errors.push(this.msg_lookup_unknownkey(v))\n\t\t\t\t\tchange.value = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = lookupitem;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof LookupItem)\n\t\t{\n\t\t\tlet value = this.control.lookupdata.get(v.key);\n\t\t\tif (value !== v)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_lookup_wrongitem(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n};\n\n\nclass LookupFieldType extends LookupFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupField;\n\t}\n};\n\nlet lookupfieldtype = new LookupFieldType(\"la\", \"LookupField\", \"Holds the value of a lookup field of a record (and related information)\");\n\n\nexport class LookupField extends LookupFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupfieldtype;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (value === null)\n\t\t\treturn null;\n\t\treturn value.label;\n\t}\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (v === null || v === \"\" || this.control.none_key === v)\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t}\n\t}\n};\n\n\nclass LookupRadioFieldType extends LookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupRadioField;\n\t}\n};\n\nlet lookupradiofieldtype = new LookupRadioFieldType(\"la\", \"LookupRadioField\", \"Holds the value of a lookup/radio field of a record (and related information)\");\n\n\nexport class LookupRadioField extends LookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupradiofieldtype;\n\t}\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tfor (let node of this._dom_controls)\n\t\t{\n\t\t\tif (node.checked)\n\t\t\t{\n\t\t\t\tlet key = node.getAttribute(\"value\");\n\t\t\t\treturn this.control.lookupdata.get(key);\n\t\t\t}\n\n\t\t}\n\t\treturn null;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tif (value instanceof LookupItem)\n\t\t\tvalue = value.key;\n\t\tif (value === null)\n\t\t\tvalue = this.control.none_key;\n\n\t\tfor (let node of this._dom_controls)\n\t\t\tnode.checked = node.getAttribute(\"value\") === value;\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_input(lookupdata);\n\t}\n};\n\n\nclass LookupSelectFieldType extends LookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupSelectField;\n\t}\n};\n\nlet lookupselectfieldtype = new LookupSelectFieldType(\"la\", \"LookupSelectField\", \"Holds the value of a lookup/select field of a record (and related information)\");\n\n\nexport class LookupSelectField extends LookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupselectfieldtype;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\t\tif (value)\n\t\t{\n\t\t\tif (value === this.control.none_key)\n\t\t\t\tvalue = null;\n\t\t\telse\n\t\t\t\tvalue = this.control.lookupdata.get(value);\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tsuper._set_dom_value(change.value != null ? change.value.key : this.control.none_key);\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_select(lookupdata);\n\t}\n};\n\n\nclass LookupChoiceFieldType extends LookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupChoiceField;\n\t}\n};\n\nlet lookupchoicefieldtype = new LookupChoiceFieldType(\"la\", \"LookupChoiceField\", \"Holds the value of a lookup/choice field of a record (and related information)\");\n\n\nexport class LookupChoiceField extends LookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupchoicefieldtype;\n\t}\n};\n\n\nclass MultipleLookupFieldType extends LookupFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupField;\n\t}\n};\n\nlet multiplelookupfieldtype = new MultipleLookupFieldType(\"la\", \"MultipleLookupField\", \"Holds the value of a multiple lookup field of a record (and related information)\");\n\n\nexport class MultipleLookupField extends LookupFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupfieldtype;\n\t}\n\n\tis_empty()\n\t{\n\t\treturn this._value.length === 0;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (value === null || value.length === 0)\n\t\t\treturn null;\n\t\treturn value.map(item => item.label).join(\", \");\n\t}\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.none_key === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_lookupitem(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_lookupitem(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nclass MultipleLookupCheckboxFieldType extends MultipleLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupCheckboxField;\n\t}\n};\n\nlet multiplelookupcheckboxfieldtype = new MultipleLookupCheckboxFieldType(\"la\", \"MultipleLookupCheckboxField\", \"Holds the value of a multiplelookup/radio field of a record (and related information)\");\n\n\nexport class MultipleLookupCheckboxField extends MultipleLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupcheckboxfieldtype;\n\t}\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = [];\n\t\tfor (let node of this._dom_controls)\n\t\t{\n\t\t\tif (node.checked)\n\t\t\t{\n\t\t\t\tlet key = node.getAttribute(\"value\");\n\t\t\t\tvalue.push(this.control.lookupdata.get(key));\n\t\t\t}\n\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tlet values = new Set();\n\t\tfor (let value of change.value)\n\t\t\tvalues.add(value.key);\n\n\t\tfor (let node of this._dom_controls)\n\t\t\tnode.checked = values.has(node.getAttribute(\"value\"));\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_input(lookupdata);\n\t}\n};\n\n\nclass MultipleLookupSelectFieldType extends MultipleLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupSelectField;\n\t}\n};\n\nlet multiplelookupselectfieldtype = new MultipleLookupSelectFieldType(\"la\", \"MultipleLookupSelectField\", \"Holds the value of a multiplelookup/select field of a record (and related information)\");\n\nexport class MultipleLookupSelectField extends MultipleLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupselectfieldtype;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = [];\n\t\tfor (let option of this._dom_control.querySelectorAll(\"option\"))\n\t\t{\n\t\t\tif (option.selected)\n\t\t\t\tvalue.push(this.control.lookupdata.get(option.getAttribute(\"value\")));\n\t\t}\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tlet values = new Set();\n\t\tfor (let value of change.value)\n\t\t\tvalues.add(value.key);\n\t\tfor (let option of this._dom_control.querySelectorAll(\"option\"))\n\t\t\toption.selected = values.has(option.getAttribute(\"value\"));\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_select(lookupdata);\n\t}\n};\n\n\nclass MultipleLookupChoiceFieldType extends MultipleLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupChoiceField;\n\t}\n};\n\nlet multiplelookupchoicefieldtype = new MultipleLookupChoiceFieldType(\"la\", \"MultipleLookupChoiceField\", \"Holds the value of a multiplelookup/choice field of a record (and related information)\");\n\n\nexport class MultipleLookupChoiceField extends MultipleLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupchoicefieldtype;\n\t}\n};\n\n\nclass AppLookupFieldBaseType extends FieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupFieldBase;\n\t}\n};\n\nlet applookupfieldbasetype = new AppLookupFieldBaseType(\"la\", \"AppLookupFieldBase\", \"Base type of AppLookupField and MultipleAppLookupField\");\n\n\nexport class AppLookupFieldBase extends ChoiceFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupfieldbasetype;\n\t}\n\n\tget lookupdata()\n\t{\n\t\tif (this._lookupdata !== null)\n\t\t\treturn this._lookupdata;\n\t\telse\n\t\t{\n\t\t\tif (this.control.lookup_app.records !== null)\n\t\t\t\treturn this.control.lookup_app.records;\n\t\t}\n\t\treturn new Map();\n\t}\n\n\tset lookupdata(value)\n\t{\n\t\tif (this._in_form())\n\t\t\tthis._set_dom_lookupdata(value);\n\t\tthis._lookupdata = value;\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t}\n\n\t_make_label(value)\n\t{\n\t\tif (typeof(value) === \"string\")\n\t\t\treturn value;\n\t\telse if (value instanceof Record)\n\t\t\treturn value.as_text(this.control.lookup_controls);\n\t\telse\n\t\t\treturn ul4._str(value);\n\t}\n\n\t_find_record(change)\n\t{\n\t\tlet v = change.value;\n\t\tif (typeof(v) === \"string\")\n\t\t{\n\t\t\tlet record = this.control.lookup_app.records !== null ?\n\t\t\t\tthis.control.lookup_app.records.get(v) :\n\t\t\t\tundefined\n\t\t\t;\n\n\t\t\tif (record === undefined)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_unknownkey(v))\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tchange.value = record;\n\t\t\t}\n\t\t}\n\t\telse if (v instanceof Record)\n\t\t{\n\t\t\tif (v.app !== this.control.lookup_app)\n\t\t\t{\n\t\t\t\tchange.errors.push(this.msg_applookup_wrongrecord(v));\n\t\t\t\tchange.value = null;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tchange.errors.push(this.msg_field_wrong_type(v));\n\t\t\tchange.value = null;\n\t\t}\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"lookupdata\")\n\t\t\tthis.lookupdata = value;\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\nAppLookupFieldBase.prototype._ul4attrs = new Set([...Field.prototype._ul4attrs, \"lookupdata\"]);\n\n\n\nclass AppLookupFieldType extends AppLookupFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupField;\n\t}\n};\n\nlet applookupfieldtype = new AppLookupFieldType(\"la\", \"AppLookupField\", \"Holds the value of a applookup field of a record (and related information)\");\n\n\nexport class AppLookupField extends AppLookupFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupfieldtype;\n\t}\n\n\tvalue_as_text(maxlevel=3)\n\t{\n\t\tlet value = this.value;\n\t\tif (value === null)\n\t\t\treturn null;\n\t\treturn \"(\" + this.value.as_text(maxlevel) + \")\";\n\t}\n\n\t_validate(change)\n\t{\n\t\tthis._find_record(change);\n\t}\n};\n\n\nclass AppLookupSelectFieldType extends AppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupSelectField;\n\t}\n};\n\nlet applookupselectfieldtype = new AppLookupSelectFieldType(\"la\", \"AppLookupSelectField\", \"Holds the value of a `applookup`/`select` field of a record (and related information)\");\n\n\nexport class AppLookupSelectField extends AppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupselectfieldtype;\n\t}\n\n\t_get_dom_value()\n\t{\n\t\tlet value = super._get_dom_value();\n\n\t\tif (this.control.lookup_app.records !== null)\n\t\t{\n\t\t\tvalue = this.control.lookup_app.records.get(value);\n\t\t\tif (value === undefined)\n\t\t\t\tvalue = null;\n\t\t}\n\t\telse\n\t\t\tvalue = null;\n\t\treturn value;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet change = {value: value, errors: []};\n\t\tthis._validate(change);\n\t\tsuper._set_dom_value(change.value != null ? change.value.id : this.control.none_key);\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_select(lookupdata);\n\t}\n};\n\n\nclass AppLookupRadioFieldType extends AppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupRadioField;\n\t}\n};\n\nlet applookupradiofieldtype = new AppLookupRadioFieldType(\"la\", \"AppLookupRadioField\", \"Holds the value of a `applookup`/`radio` field of a record (and related information)\");\n\n\nexport class AppLookupRadioField extends AppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupradiofieldtype;\n\t}\n};\n\n\nclass AppLookupChoiceFieldType extends AppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupChoiceField;\n\t}\n};\n\nlet applookupchoicefieldtype = new AppLookupChoiceFieldType(\"la\", \"AppLookupChoiceField\", \"Holds the value of a `applookup`/`choice` field of a record (and related information)\");\n\n\nexport class AppLookupChoiceField extends AppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupchoicefieldtype;\n\t}\n};\n\n\nclass MultipleAppLookupFieldType extends AppLookupFieldBaseType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupField;\n\t}\n};\n\nlet multipleapplookupfieldtype = new MultipleAppLookupFieldType(\"la\", \"MultipleAppLookupField\", \"Holds the value of a multiple applookup field of a record (and related information)\");\n\n\nexport class MultipleAppLookupField extends AppLookupFieldBase\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupfieldtype;\n\t}\n\n\tis_empty()\n\t{\n\t\treturn this._value.length === 0;\n\t}\n\n\t_validate(change)\n\t{\n\t\tlet v = change.value;\n\t\tlet islist = (Object.prototype.toString.call(v) === \"[object Array]\");\n\n\t\tif (v === null || v === \"\" || this.control.none_key === v || (islist && v.length === 0))\n\t\t{\n\t\t\tif (this.control.required)\n\t\t\t\tchange.errors.push(this.msg_field_required(v));\n\t\t\tchange.value = [];\n\t\t}\n\t\telse if (islist)\n\t\t{\n\t\t\tlet newvalue = [];\n\t\t\tfor (let item of v)\n\t\t\t{\n\t\t\t\tlet singlechange = {value: item, errors: []};\n\t\t\t\tthis._find_record(singlechange);\n\t\t\t\tif (singlechange.errors.length > 0)\n\t\t\t\t\tchange.errors = [...change.errors, ...singlechange.errors];\n\t\t\t\telse\n\t\t\t\t\tnewvalue.push(singlechange.value);\n\t\t\t}\n\t\t\tchange.value = newvalue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._find_record(change);\n\t\t\tif (change.errors.length > 0)\n\t\t\t\tchange.value = [];\n\t\t\telse\n\t\t\t\tchange.value = [change.value];\n\t\t}\n\t}\n};\n\n\nclass MultipleAppLookupCheckboxFieldType extends MultipleAppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupCheckboxField;\n\t}\n};\n\nlet multipleapplookupcheckboxfieldtype = new MultipleAppLookupCheckboxFieldType(\"la\", \"MultipleAppLookupCheckboxField\", \"Holds the value of a `multipleapplookup`/`checkbox` field of a record (and related information)\");\n\n\nexport class MultipleAppLookupCheckboxField extends MultipleAppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupcheckboxfieldtype;\n\t}\n};\n\n\nclass MultipleAppLookupSelectFieldType extends MultipleAppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupSelectField;\n\t}\n};\n\nlet multipleapplookupselectfieldtype = new MultipleAppLookupSelectFieldType(\"la\", \"MultipleAppLookupSelectField\", \"Holds the value of a `multipleapplookup`/`select` field of a record (and related information)\");\n\n\nexport class MultipleAppLookupSelectField extends MultipleAppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupselectfieldtype;\n\t}\n\n\t_set_dom_lookupdata(lookupdata)\n\t{\n\t\tthis._set_dom_lookupdata_select(lookupdata);\n\t}\n};\n\n\nclass MultipleAppLookupChoiceFieldType extends MultipleAppLookupFieldType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupChoiceField;\n\t}\n};\n\nlet multipleapplookupchoicefieldtype = new MultipleAppLookupChoiceFieldType(\"la\", \"MultipleAppLookupChoiceField\", \"Holds the value of a `multipleapplookup`/`choice` field of a record (and related information)\");\n\n\nexport class MultipleAppLookupChoiceField extends MultipleAppLookupField\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupchoicefieldtype;\n\t}\n};\n\n\nclass ControlType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Control;\n\t}\n};\n\nlet controltype = new ControlType(\"la\", \"Control\", \"Metainformation about a field in a LivingApps application\");\n\n\nexport class Control extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn controltype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.app.globals;\n\t}\n\n\tget fulltype()\n\t{\n\t\treturn this.subtype ? this.type + \"/\" + this.subtype : this.type;\n\t}\n\n\tget label()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn this._label;\n\t\tlet label = view_control.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tset label(value)\n\t{\n\t\tthis._label = value;\n\t}\n\n\tget default()\n\t{\n\t\treturn null;\n\t}\n\n\tget top()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.top : null;\n\t}\n\n\tget left()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.left : null;\n\t}\n\n\tget width()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.width : null;\n\t}\n\n\tget height()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.height : null;\n\t}\n\n\tget z_index()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.z_index : null;\n\t}\n\n\tget liveupdate()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.liveupdate : false;\n\t}\n\n\tget tabindex()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.tabindex : null;\n\t}\n\n\tget required()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.required : false;\n\t}\n\n\tget mode()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (this.app._active_view !== null && view_control === null)\n\t\t\treturn null;\n\t\tif (this.app.globals.mode === null)\n\t\t\treturn \"display\";\n\t\treturn view_control !== null ? view_control.mode : \"edit\";\n\t}\n\n\tget labelpos()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelpos : \"left\";\n\t}\n\n\tget labelwidth()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.labelwidth : null;\n\t}\n\n\tget autoalign()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null ? view_control.autoalign : true;\n\t}\n\n\tget in_active_view()\n\t{\n\t\tlet view_control = this._view_control();\n\t\treturn view_control !== null;\n\t}\n\n\t_view_control()\n\t{\n\t\tif (this.app._active_view === null)\n\t\t\treturn null;\n\t\tlet view_control = this.app._active_view.controls.get(this.identifier);\n\t\treturn view_control ?? null;\n\t}\n\n\t_logsearch(value, search)\n\t{\n\t\t//console.log(\"Searching for \" + ul4._repr(search.value) + \" in \" + ul4._repr(this) + \" with operator \" + search.operator + \" in value \" + ul4._repr(value));\n\t}\n\n\t// base implemntation, always returns ``false`` (i.e. \"not found\")\n\t// ``value`` is the value of the field\n\t// ``search`` is an object with information what we're searching for\n\t// keys in ``search`` are: ``operator`` (and ``value`` (if required by the operator))\n\tsearch(value, search)\n\t{\n\t\treturn false;\n\t}\n};\n\nControl.prototype.type = null;\nControl.prototype.subtype = null;\nControl.prototype._ul4onattrs = [\"identifier\", \"fieldname\", \"app\", \"_label\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\"];\nControl.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"fieldname\", \"app\", \"priority\", \"order\", \"ininsertprocedure\", \"inupdateprocedure\", \"fulltype\", \"label\", \"top\", \"left\", \"width\", \"height\", \"z_index\", \"liveupdate\", \"tabindex\", \"required\", \"mode\", \"labelpos\", \"autoalign\", \"in_active_view\"]);\nControl.prototype._cssclass_root = \"llft-control\";\nControl.prototype._cssclass_control = \"input\";\n\n\nclass BoolControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof BoolControl;\n\t}\n};\n\nlet boolcontroltype = new BoolControlType(\"la\", \"BoolControl\", \"A LivingApps boolean field (type 'bool')\");\n\n\nexport class BoolControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn boolcontroltype;\n\t}\n\n\t// ``search`` must by ``null``, ``false`` or ``true``\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nBoolControl.prototype.type = \"bool\";\nBoolControl.prototype.fieldtype = BoolField;\n\n\nclass IntControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof IntControl;\n\t}\n};\n\nlet intcontroltype = new IntControlType(\"la\", \"IntControl\", \"A LivingApps integer field (type 'int')\");\n\n\nexport class IntControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn intcontroltype;\n\t}\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nIntControl.prototype.type = \"int\";\nIntControl.prototype.fieldtype = IntField;\n\n\nclass PlaceholderControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof PlaceholderControld;\n\t}\n};\n\nlet placeholdercontroltype = new PlaceholderControlType(\"la\", \"PlaceholderControl\", \"A LivingApps field that has a placeholder\");\n\n\nclass PlaceholderControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn placeholdercontroltype;\n\t}\n\n\tget placeholder()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.placeholder;\n\t}\n};\n\nPlaceholderControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"placeholder\"]);\n\n\nclass NumberControlType extends PlaceholderControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof NumberControl;\n\t}\n};\n\nlet numbercontroltype = new NumberControlType(\"la\", \"NumberControl\", \"A LivingApps number field (type 'number')\");\n\n\nexport class NumberControl extends PlaceholderControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn numbercontroltype;\n\t}\n\n\t// ``search.value`` must by ``null`` or an integer\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"range\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn false;\n\t\t\treturn (search.minvalue === null || search.minvalue <= value) && (search.maxvalue === null || value < search.maxvalue);\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nNumberControl.prototype.type = \"number\";\nNumberControl.prototype.fieldtype = NumberField;\nNumberControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"precision\", \"minimum\", \"maximum\"];\nNumberControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"precision\", \"minimum\", \"maximum\"]);\n\n\nclass StringControlType extends PlaceholderControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof StringControl;\n\t}\n};\n\nlet stringcontroltype = new StringControlType(\"la\", \"StringControl\", \"A LivingApps number field (type 'string')\");\n\n\nexport class StringControl extends PlaceholderControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn stringcontroltype;\n\t}\n\n\t_user_placeholder(user, placeholder)\n\t{\n\t\tif (placeholder === null)\n\t\t\treturn null;\n\t\tswitch (placeholder)\n\t\t{\n\t\t\tcase \"{gender}\":\n\t\t\t\treturn user !== null ? user.gender : null;\n\t\t\tcase \"{title}\":\n\t\t\t\treturn user !== null ? user.title : null;\n\t\t\tcase \"{firstname}\":\n\t\t\t\treturn user !== null ? user.firstname : null;\n\t\t\tcase \"{surname}\":\n\t\t\t\treturn user !== null ? user.surname : null;\n\t\t\tcase \"{account}\":\n\t\t\t\treturn user !== null ? user.email : null;\n\t\t\tcase \"{streetname}\":\n\t\t\t\treturn user !== null ? user.streetname : null;\n\t\t\tcase \"{streetnumber}\":\n\t\t\t\treturn user !== null ? user.streetnumber : null;\n\t\t\tcase \"{street}\":\n\t\t\t\tif (user === null)\n\t\t\t\t\treturn null;\n\t\t\t\telse if (user.street === null)\n\t\t\t\t\treturn user.streetnumber;\n\t\t\t\telse if (user.streetnumber === null)\n\t\t\t\t\treturn user.street;\n\t\t\t\telse\n\t\t\t\t\treturn user.street + \" \" + user.streetnumber;\n\t\t\tcase \"{zip}\":\n\t\t\t\treturn user !== null ? user.zip : null;\n\t\t\tcase \"{phone}\":\n\t\t\t\treturn user !== null ? user.phone : null;\n\t\t\tcase \"{fax}\":\n\t\t\t\treturn user !== null ? user.fax : null;\n\t\t\tcase \"{company}\":\n\t\t\t\treturn user !== null ? user.company : null;\n\t\t\tcase \"{city}\":\n\t\t\t\treturn user !== null ? user.city : null;\n\t\t\tcase \"{summary}\":\n\t\t\t\treturn user !== null ? user.summary : null;\n\t\t\tcase \"{interests}\":\n\t\t\t\treturn user !== null ? user.interests : null;\n\t\t\tcase \"{personal_website}\":\n\t\t\t\treturn user !== null ? user.personal_website : null;\n\t\t\tcase \"{company_website}\":\n\t\t\t\treturn user !== null ? user.company_website : null;\n\t\t\tcase \"{position}\":\n\t\t\t\treturn user !== null ? user.position : null;\n\t\t\tcase \"{department}\":\n\t\t\t\treturn user !== null ? user.department : null;\n\t\t\tcase \"{today}\":\n\t\t\t\treturn ul4.today();\n\t\t\tdefault:\n\t\t\t\treturn placeholder;\n\t\t}\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this._user_placeholder(this.app.globals.user, view_control.default);\n\t}\n\n\tget minlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 0;\n\t\tlet minlength = view_control.minlength;\n\t\tif (minlength === null || minlength < 0)\n\t\t\treturn 0;\n\t\treturn minlength;\n\t}\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn 4000;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength === null || maxlength < 0 || maxlength > 4000)\n\t\t\treturn 4000;\n\t\treturn maxlength;\n\t}\n\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\t\tif (search.operator === \"equals\")\n\t\t\treturn search.value === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (search.value === null || value === null)\n\t\t\t\treturn search.value === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(search.value.toLowerCase()) >= 0;\n\t\t}\n\t}\n};\n\nStringControl.prototype.type = \"string\";\n\n\nclass TextControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof TextControl;\n\t}\n};\n\nlet textcontroltype = new TextControlType(\"la\", \"TextControl\", \"A LivingApps text field (type 'string/text')\");\n\n\nexport class TextControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn textcontroltype;\n\t}\n};\n\nTextControl.prototype.subtype = \"text\";\nTextControl.prototype.fieldtype = StringField;\n\n\nclass PasswordControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof PasswordControl;\n\t}\n};\n\nlet passwordcontroltype = new PasswordControlType(\"la\", \"PasswordControl\", \"A LivingApps password field (type 'string/password')\");\n\n\nexport class PasswordControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn passwordcontroltype;\n\t}\n};\n\nPasswordControl.prototype.subtype = \"password\";\nPasswordControl.prototype.fieldtype = PasswordField;\n\n\nclass EmailControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof EmailControl;\n\t}\n};\n\nlet emailcontroltype = new EmailControlType(\"la\", \"EmailControl\", \"A LivingApps email field (type 'string/email')\");\n\n\nexport class EmailControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn emailcontroltype;\n\t}\n};\n\nEmailControl.prototype.subtype = \"email\";\nEmailControl.prototype.fieldtype = EmailField;\n\n\nclass URLControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof URLControl;\n\t}\n};\n\nlet urlcontroltype = new URLControlType(\"la\", \"URLControl\", \"A LivingApps URL field (type 'string/url')\");\n\n\nexport class URLControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn urlcontroltype;\n\t}\n};\n\nURLControl.prototype.subtype = \"url\";\nURLControl.prototype.fieldtype = URLField;\n\n\nclass TelControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof TelControl;\n\t}\n};\n\nlet telcontroltype = new TelControlType(\"la\", \"TelControl\", \"A LivingApps phone number field (type 'string/tel')\");\n\n\nexport class TelControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn telcontroltype;\n\t}\n};\n\nTelControl.prototype.subtype = \"tel\";\nTelControl.prototype.fieldtype = TelField;\n\n\nclass TextAreaControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof TextAreaControl;\n\t}\n};\n\nlet textareacontroltype = new TextAreaControlType(\"la\", \"TextAreaControl\", \"A LivingApps textarea field (type 'string/textarea')\");\n\n\nexport class TextAreaControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn textareacontroltype;\n\t}\n\n\tget maxlength()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\t// We only get the encrypted text in encryption mode, so we can't check its length\n\t\tif (this.encrypted !== null)\n\t\t\treturn null;\n\t\tlet maxlength = view_control.maxlength;\n\t\tif (maxlength < 0)\n\t\t\treturn null;\n\t\treturn maxlength;\n\t}\n};\n\nTextAreaControl.prototype.subtype = \"textarea\";\nTextAreaControl.prototype.fieldtype = TextAreaField;\nTextAreaControl.prototype._ul4onattrs = [...StringControl.prototype._ul4onattrs, \"encrypted\"];\nTextAreaControl.prototype._ul4attrs = new Set([...StringControl.prototype._ul4attrs, \"encrypted\"]);\nTextAreaControl.prototype._cssclass_control = \"textarea\";\n\n\nclass HTMLControlType extends StringControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof HTMLControl;\n\t}\n};\n\nlet htmlcontroltype = new HTMLControlType(\"la\", \"HTMLControl\", \"A LivingApps HTML field (type 'string/html')\");\n\n\nexport class HTMLControl extends StringControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn htmlcontroltype;\n\t}\n};\n\nHTMLControl.prototype.subtype = \"html\";\nHTMLControl.prototype.fieldtype = HTMLField;\n\n\nclass DateControlType extends PlaceholderControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DateControl;\n\t}\n};\n\nlet datecontroltype = new DateControlType(\"la\", \"DateControl\", \"A LivingApps date field (type 'date/date')\");\n\n\nexport class DateControl extends PlaceholderControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datecontroltype;\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn view_control.default === \"{today}\" ? ul4.today() : null;\n\t}\n\n\tformatstring(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\t\treturn this._formatstrings[lang];\n\t}\n\n\tformatstrings_parse(lang)\n\t{\n\t\tlang = lang || this.globals.lang;\n\t\tif (lang !== \"de\" && lang !== \"fr\" && lang !== \"it\")\n\t\t\tlang = \"en\";\n\n\t\treturn [\n\t\t\t...this._formatstrings_parse[lang],\n\t\t\t...this._formatstrings_parse[\"intl\"]\n\t\t];\n\t}\n\n\t// searchvalue must be ``null``, a ``Date`` object or a string\n\tsearch(value, search)\n\t{\n\t\tthis._logsearch(value, search);\n\n\t\tlet searchvalue = search.value;\n\t\tif (Object.prototype.toString.call(searchvalue) == \"[object Date]\")\n\t\t\tsearchvalue = ul4._format(searchvalue, this.formatstring(), this.app.language);\n\t\tif (value !== null)\n\t\t\tvalue = ul4._format(value, this.formatstring(), this.app.language);\n\n\t\tif (search.operator === \"equals\")\n\t\t\treturn searchvalue === value;\n\t\telse if (search.operator === \"contains\")\n\t\t{\n\t\t\tif (searchvalue === null || value === null)\n\t\t\t\treturn searchvalue === value;\n\t\t\telse\n\t\t\t\treturn value.toLowerCase().indexOf(searchvalue.toLowerCase()) >= 0;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nDateControl.prototype.type = \"date\";\nDateControl.prototype.subtype = \"date\";\nDateControl.prototype.fieldtype = DateField;\nDateControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y\",\n\t\"fr\": \"%d.%m.%Y\",\n\t\"it\": \"%d.%m.%Y\",\n\t\"en\": \"%m/%d/%Y\",\n\t\"intl\": \"%Y-%m-%d\"\n};\n\nlet _suffixes = [\n\t\"\",\n\t\" %H:%M\",\n\t\"T%H:%M\",\n\t\" %H:%M:%S\",\n\t\"T%H:%M:%S\",\n\t\" %H:%M:%S.%f\",\n\t\"T%H:%M:%S.%f\",\n\t\" %H:%M%z\",\n\t\"T%H:%M%z\",\n\t\" %H:%M:%S%z\",\n\t\"T%H:%M:%S%z\",\n\t\" %H:%M:%S.%f%z\",\n\t\"T%H:%M:%S.%f%z\",\n\t\" %H:%M %z\",\n\t\"T%H:%M %z\",\n\t\" %H:%M:%S %z\",\n\t\"T%H:%M:%S %z\",\n\t\" %H:%M:%S.%f %z\",\n\t\"T%H:%M:%S.%f %z\"\n]\n\nDateControl.prototype._formatstrings_parse = {\n\t\"en\": _suffixes.map(s => \"%m/%d/%Y\" + s),\n\t\"de\": _suffixes.map(s => \"%d.%m.%Y\" + s),\n\t\"fr\": _suffixes.map(s => \"%d.%m.%Y\" + s),\n\t\"it\": _suffixes.map(s => \"%d.%m.%Y\" + s),\n\t\"intl\": _suffixes.map(s => \"%Y-%m-%d\" + s)\n};\n\n\nclass DatetimeMinuteControlType extends DateControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DatetimeMinuteControl;\n\t}\n};\n\nlet datetimeminutecontroltype = new DatetimeMinuteControlType(\"la\", \"DatetimeMinuteControl\", \"A LivingApps date field (type 'date/datetimeminute')\");\n\n\nexport class DatetimeMinuteControl extends DateControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datetimeminutecontroltype;\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setSeconds(0);\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n};\n\nDatetimeMinuteControl.prototype.subtype = \"datetimeminute\";\nDatetimeMinuteControl.prototype.fieldtype = DatetimeMinuteField;\nDatetimeMinuteControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y %H:%M\",\n\t\"fr\": \"%d.%m.%Y %H:%M\",\n\t\"it\": \"%d.%m.%Y %H:%M\",\n\t\"en\": \"%m/%d/%Y %H:%M\",\n\t\"intl\": \"%Y-%m-%d %H:%M\"\n};\n\n\nclass DatetimeSecondControlType extends DateControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof DatetimeSecondControl;\n\t}\n};\n\nlet datetimesecondcontroltype = new DatetimeSecondControlType(\"la\", \"DatetimeSecondControl\", \"A LivingApps date field (type 'date/datetimesecond')\");\n\n\nexport class DatetimeSecondControl extends DateControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn datetimesecondcontroltype;\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tif (view_control.default === \"{today}\")\n\t\t{\n\t\t\tlet now = new Date();\n\t\t\tnow.setMilliseconds(0);\n\t\t\treturn now;\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t}\n};\n\nDatetimeSecondControl.prototype.subtype = \"datetimesecond\";\nDatetimeSecondControl.prototype.fieldtype = DatetimeSecondField;\nDatetimeSecondControl.prototype._formatstrings = {\n\t\"de\": \"%d.%m.%Y %H:%M:%S\",\n\t\"fr\": \"%d.%m.%Y %H:%M:%S\",\n\t\"it\": \"%d.%m.%Y %H:%M:%S\",\n\t\"en\": \"%m/%d/%Y %H:%M:%S\",\n\t\"intl\": \"%Y-%m-%d %H:%M:%S\"\n};\n\n\nclass LookupControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupControl;\n\t}\n};\n\nlet lookupcontroltype = new LookupControlType(\"la\", \"LookupControl\", \"A LivingApps date field (type 'lookup')\");\n\n\nexport class LookupControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupcontroltype;\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\treturn this.lookupdata.get(view_control) ?? null;\n\t}\n\n\tget autoexpandable()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn false;\n\t\treturn view_control.autoexpandable;\n\t}\n\n\tget none_key()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonekey;\n\t}\n\n\tget none_label()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonelabel;\n\t}\n\n\t// ``search.value`` must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (value === null)\n\t\t\t\treturn search.value === null;\n\t\t\telse\n\t\t\t\treturn value.key === search.value;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nLookupControl.prototype.type = \"lookup\";\nLookupControl.prototype.fieldtype = LookupField;\nLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookupdata\"];\nLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookupdata\"]);\n\n\nclass LookupSelectControlType extends LookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupSelectControl;\n\t}\n};\n\nlet lookupselectcontroltype = new LookupSelectControlType(\"la\", \"LookupSelectControl\", \"A LivingApps lookup field (type 'lookup/select')\");\n\n\nexport class LookupSelectControl extends LookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupselectcontroltype;\n\t}\n};\n\nLookupSelectControl.prototype.subtype = \"select\";\nLookupSelectControl.prototype.fieldtype = LookupSelectField;\nLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nclass LookupRadioControlType extends LookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupRadioControl;\n\t}\n};\n\nlet lookupradiocontroltype = new LookupRadioControlType(\"la\", \"LookupRadioControl\", \"A LivingApps lookup field (type 'lookup/radio')\");\n\n\nexport class LookupRadioControl extends LookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupradiocontroltype;\n\t}\n};\n\nLookupRadioControl.prototype.subtype = \"radio\";\nLookupRadioControl.prototype.fieldtype = LookupRadioField;\nLookupRadioControl.prototype._cssclass_root = \"llft-element\";\n\n\nclass LookupChoiceControlType extends LookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupChoiceControl;\n\t}\n};\n\nlet lookupchoicecontroltype = new LookupChoiceControlType(\"la\", \"LookupChoiceControl\", \"A LivingApps lookup field (type 'lookup/choice')\");\n\n\nexport class LookupChoiceControl extends LookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupchoicecontroltype;\n\t}\n};\n\nLookupChoiceControl.prototype.subtype = \"choice\";\nLookupChoiceControl.prototype.fieldtype = LookupChoiceField;\n\n\nclass AppLookupControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupControl;\n\t}\n};\n\nlet applookupcontroltype = new AppLookupControlType(\"la\", \"AppLookupControl\", \"A LivingApps lookup field (type 'applookup')\");\n\n\nexport class AppLookupControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupcontroltype;\n\t}\n\n\tget lookupdata()\n\t{\n\t\tif (this.lookup_app !== null && this.lookup_app.records !== null)\n\t\t\treturn this.lookup_app.records;\n\t\telse\n\t\t\treturn new Map();\n\t}\n\n\tget none_key()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonekey;\n\t}\n\n\tget none_label()\n\t{\n\t\tlet view_control = this._view_control();\n\t\tif (view_control === null)\n\t\t\treturn null;\n\t\treturn view_control.lookupnonelabel;\n\t}\n\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (value === null || search.value === null)\n\t\t\treturn value === search.value;\n\t\telse\n\t\t\treturn value.search(search);\n\t}\n};\n\nAppLookupControl.prototype.type = \"applookup\";\nAppLookupControl.prototype.fieldtype = AppLookupField;\nAppLookupControl.prototype._ul4onattrs = [...Control.prototype._ul4onattrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"];\nAppLookupControl.prototype._ul4attrs = new Set([...Control.prototype._ul4attrs, \"lookup_app\", \"lookup_controls\", \"local_master_control\", \"local_detail_controls\", \"remote_master_control\"]);\n\n\nclass AppLookupSelectControlType extends AppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupSelectControl;\n\t}\n};\n\nlet applookupselectcontroltype = new AppLookupSelectControlType(\"la\", \"AppLookupSelectControl\", \"A LivingApps applookup field (type 'applookup/select')\");\n\n\nexport class AppLookupSelectControl extends AppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupselectcontroltype;\n\t}\n};\n\nAppLookupSelectControl.prototype.subtype = \"select\";\nAppLookupSelectControl.prototype.fieldtype = AppLookupSelectField;\nAppLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nclass AppLookupRadioControlType extends AppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupRadioControl;\n\t}\n};\n\nlet applookupradiocontroltype = new AppLookupRadioControlType(\"la\", \"AppLookupRadioControl\", \"A LivingApps applookup field (type 'applookup/radio')\");\n\n\nexport class AppLookupRadioControl extends AppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupradiocontroltype;\n\t}\n};\n\nAppLookupRadioControl.prototype.subtype = \"radio\";\nAppLookupRadioControl.prototype.fieldtype = AppLookupRadioField;\n\n\nclass AppLookupChoiceControlType extends AppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppLookupChoiceControl;\n\t}\n};\n\nlet applookupchoicecontroltype = new AppLookupChoiceControlType(\"la\", \"AppLookupChoiceControl\", \"A LivingApps applookup field (type 'applookup/choice')\");\n\n\nexport class AppLookupChoiceControl extends AppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn applookupchoicecontroltype;\n\t}\n};\n\nAppLookupChoiceControl.prototype.subtype = \"choice\";\nAppLookupChoiceControl.prototype.fieldtype = AppLookupChoiceField;\n\n\nclass MultipleLookupControlType extends LookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupControl;\n\t}\n};\n\nlet multiplelookupcontroltype = new MultipleLookupControlType(\"la\", \"MultipleLookupControl\", \"A LivingApps multiple applookup field (type 'multipleapplookup')\");\n\n\nexport class MultipleLookupControl extends LookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupcontroltype;\n\t}\n\n\tget default()\n\t{\n\t\tlet view_control = this._view_control();\n\n\t\tif (view_control === null)\n\t\t\treturn null;\n\n\t\tlet defaultValue = this.lookupdata.get(view_control)\n\n\t\treturn (defaultValue !== undefined) ? [defaultValue] : [];\n\t}\n\n\t// search.value must be ``null`` or a ``LookupItem`` key\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tfor (let item of value)\n\t\t\t{\n\t\t\t\tif (item.key === search.value)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleLookupControl.prototype.type = \"multiplelookup\";\nMultipleLookupControl.prototype.fieldtype = MultipleLookupField;\n\n\nclass MultipleLookupCheckboxControlType extends MultipleLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupCheckboxControl;\n\t}\n};\n\nlet multiplelookupcheckboxcontroltype = new MultipleLookupCheckboxControlType(\"la\", \"MultipleLookupCheckboxControl\", \"A LivingApps multiplelookup field (type 'multiplelookup/checkbox')\");\n\n\nexport class MultipleLookupCheckboxControl extends MultipleLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupcheckboxcontroltype;\n\t}\n\n\tget _sel_label()\n\t{\n\t\treturn this._sel_root + \" label:not([for]) > span\";\n\t}\n};\n\nMultipleLookupCheckboxControl.prototype.subtype = \"checkbox\";\nMultipleLookupCheckboxControl.prototype.fieldtype = MultipleLookupCheckboxField;\nMultipleLookupCheckboxControl.prototype._cssclass_root = \"llft-element\";\n\n\nclass MultipleLookupSelectControlType extends MultipleLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupSelectControl;\n\t}\n};\n\nlet multiplelookupselectcontroltype = new MultipleLookupSelectControlType(\"la\", \"MultipleLookupSelectControl\", \"A LivingApps multiplelookup field (type 'multiplelookup/select')\");\n\n\nexport class MultipleLookupSelectControl extends MultipleLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupselectcontroltype;\n\t}\n};\n\nMultipleLookupSelectControl.prototype.subtype = \"select\";\nMultipleLookupSelectControl.prototype.fieldtype = MultipleLookupSelectField;\nMultipleLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nclass MultipleLookupChoiceControlType extends MultipleLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleLookupChoiceControl;\n\t}\n};\n\nlet multiplelookupchoicecontroltype = new MultipleLookupChoiceControlType(\"la\", \"MultipleLookupChoiceControl\", \"A LivingApps multiplelookup field (type 'multiplelookup/choice')\");\n\n\nexport class MultipleLookupChoiceControl extends MultipleLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multiplelookupchoicecontroltype;\n\t}\n};\n\nMultipleLookupChoiceControl.prototype.subtype = \"choice\";\nMultipleLookupChoiceControl.prototype.fieldtype = MultipleLookupChoiceField;\n\n\nclass MultipleAppLookupControlType extends AppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupControl;\n\t}\n};\n\nlet multipleapplookupcontroltype = new MultipleAppLookupControlType(\"la\", \"MultipleAppLookupControl\", \"A LivingApps multiple applookup field (type 'multipleapplookup')\");\n\n\nexport class MultipleAppLookupControl extends AppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupcontroltype;\n\t}\n\n\t// ``search.value`` must be an object containing the search criteria for the referenced record\n\tsearch(value, search)\n\t{\n\t\tif (search.operator === \"equals\")\n\t\t{\n\t\t\tif (search.value === null)\n\t\t\t\treturn value.length === 0;\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let item of value)\n\t\t\t\t{\n\t\t\t\t\tif (item.search(search.value))\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\treturn false;\n\t}\n};\n\nMultipleAppLookupControl.prototype.type = \"multipleapplookup\";\nMultipleAppLookupControl.prototype.fieldtype = MultipleAppLookupField;\n\n\nclass MultipleAppLookupSelectControlType extends MultipleAppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupSelectControl;\n\t}\n};\n\nlet multipleapplookupselectcontroltype = new MultipleAppLookupSelectControlType(\"la\", \"MultipleAppLookupSelectControl\", \"A LivingApps multiple applookup field (type 'multipleapplookup/select')\");\n\n\nexport class MultipleAppLookupSelectControl extends MultipleAppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupselectcontroltype;\n\t}\n};\n\nMultipleAppLookupSelectControl.prototype.subtype = \"select\";\nMultipleAppLookupSelectControl.prototype.fieldtype = MultipleAppLookupSelectField;\nMultipleAppLookupSelectControl.prototype._cssclass_control = \"select\";\n\n\nclass MultipleAppLookupCheckboxControlType extends MultipleAppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupCheckboxControl;\n\t}\n};\n\nlet multipleapplookupcheckboxcontroltype = new MultipleAppLookupCheckboxControlType(\"la\", \"MultipleAppLookupCheckboxControl\", \"A LivingApps multiple applookup field (type 'multipleapplookup/checkbox')\");\n\n\nexport class MultipleAppLookupCheckboxControl extends MultipleAppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupcheckboxcontroltype;\n\t}\n};\n\nMultipleAppLookupCheckboxControl.prototype.subtype = \"checkbox\";\nMultipleAppLookupCheckboxControl.prototype.fieldtype = MultipleAppLookupCheckboxField;\n\n\nclass MultipleAppLookupChoiceControlType extends MultipleAppLookupControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MultipleAppLookupChoiceControl;\n\t}\n};\n\nlet multipleapplookupchoicecontroltype = new MultipleAppLookupChoiceControlType(\"la\", \"MultipleAppLookupChoiceControl\", \"A LivingApps multiple applookup field (type 'multipleapplookup/choice')\");\n\n\nexport class MultipleAppLookupChoiceControl extends MultipleAppLookupControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn multipleapplookupchoicecontroltype;\n\t}\n};\n\nMultipleAppLookupChoiceControl.prototype.subtype = \"choice\";\nMultipleAppLookupChoiceControl.prototype.fieldtype = MultipleAppLookupChoiceField;\n\n\nclass GeoControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof GeoControl;\n\t}\n};\n\nlet geocontroltype = new GeoControlType(\"la\", \"GeoControl\", \"A LivingApps geo field (type 'geo')\");\n\n\nexport class GeoControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn geocontroltype;\n\t}\n};\n\nGeoControl.prototype.type = \"geo\";\nGeoControl.prototype.fieldtype = GeoField;\nGeoControl.prototype._cssclass_root = \"llft-element\";\n\n\nclass FileControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FileControl;\n\t}\n};\n\nlet filecontroltype = new FileControlType(\"la\", \"FileControl\", \"A LivingApps upload field (type 'file')\");\n\n\nexport class FileControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn filecontroltype;\n\t}\n};\n\nFileControl.prototype.type = \"file\";\nFileControl.prototype.fieldtype = FileField;\nFileControl.prototype._cssclass_root = \"llft-element\";\n\n\nclass FileSignatureControlType extends FileControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FileSignatureControl;\n\t}\n};\n\nlet filesignaturecontroltype = new FileSignatureControlType(\"la\", \"FileSignatureControl\", \"A LivingApps signature image field (type 'file/signature')\");\n\n\nexport class FileSignatureControl extends FileControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn filesignaturecontroltype;\n\t}\n};\n\nFileSignatureControl.prototype.subtype = \"signature\";\nFileSignatureControl.prototype.fieldtype = FileSignatureField;\n\n\nclass ButtonControlType extends ControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof ButtonControl;\n\t}\n};\n\nlet buttoncontroltype = new ButtonControlType(\"la\", \"ButtonControl\", \"A submit button\");\n\n\nexport class ButtonControl extends Control\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn buttoncontroltype;\n\t}\n};\n\nButtonControl.prototype.type = \"button\";\n\n\nclass LookupItemType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LookupItem;\n\t}\n};\n\nlet lookupitemtype = new LookupItemType(\"la\", \"LookupItem\", \"An option in a lookup control/field\");\n\n\nexport class LookupItem extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn lookupitemtype;\n\t}\n\n\tget label()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn this._label;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn this._label;\n\t\tlet label = view_lookupitem.label;\n\t\tif (label === null)\n\t\t\treturn this._label;\n\t\treturn label;\n\t}\n\n\tget visible()\n\t{\n\t\tif (this.control === null)\n\t\t\treturn true;\n\t\tlet view_lookupitem = this._view_lookupitem();\n\t\tif (view_lookupitem === null)\n\t\t\treturn true;\n\t\treturn view_lookupitem.visible;\n\t}\n\n\t_view_lookupitem()\n\t{\n\t\tlet identifier = this.control.identifier;\n\t\tlet active_view = this.control.app.active_view;\n\t\tif (active_view !== null && active_view.controls !== null)\n\t\t{\n\t\t\tlet view_control = active_view.controls.get(identifier);\n\t\t\tif (view_control !== undefined && view_control.lookupdata !== undefined && view_control.lookupdata !== null)\n\t\t\t{\n\t\t\t\tlet view_lookupitem = view_control.lookupdata.get(this.key);\n\t\t\t\tif (view_lookupitem !== undefined)\n\t\t\t\t\treturn view_lookupitem;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<LookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \"visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nLookupItem.prototype._ul4onattrs = [\"control\", \"key\", \"_label\"];\nLookupItem.prototype._ul4attrs = new Set([\"id\", \"control\", \"key\", \"label\"]);\n\n\nclass ViewLookupItemType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof ViewLookupItem;\n\t}\n};\n\nlet viewlookupitemtype = new ViewLookupItemType(\"la\", \"ViewLookupItem\", \"View specific information about a lookup item\");\n\n\nexport class ViewLookupItem extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn viewlookupitemtype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet repr = \"<ViewLookupItem key=\" + ul4._repr(this.key) + \" label=\" + ul4._repr(this.label);\n\t\tif (!this.visible)\n\t\t\trepr += \" visible=False\"\n\t\treturn repr + \">\";\n\t}\n};\n\nViewLookupItem.prototype._ul4onattrs = [\"key\", \"label\", \"visible\"];\nViewLookupItem.prototype._ul4attrs = new Set([\"key\", \"label\", \"visible\"]);\n\n\nclass LayoutControlType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof LayoutControl;\n\t}\n};\n\nlet layoutcontroltype = new LayoutControlType(\"la\", \"LayoutControl\", \"A decoration in an input form\");\n\n\nexport class LayoutControl extends Base\n{\n\tLayoutControl()\n\t{\n\t\tthis.label = null;\n\t\tthis.identifier = null;\n\t\tthis.view = null;\n\t\tthis.top = null;\n\t\tthis.left = null;\n\t\tthis.width = null;\n\t\tthis.height = null;\n\t\tthis._visible = true;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn layoutcontroltype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget globals()\n\t{\n\t\treturn this.view.globals;\n\t}\n\n\tget _sel_root()\n\t{\n\t\treturn \"#livingapps-form .llft-element.llft-id-\" + this.identifier;\n\t}\n\n\tget _dom_root()\n\t{\n\t\treturn document.querySelector(this._sel_root);\n\t}\n\n\tget visible()\n\t{\n\t\treturn this._visible ?? true;\n\t}\n\n\tset visible(value)\n\t{\n\t\tif (this.globals._in_form())\n\t\t\tthis._dom_root.hidden = !value;\n\t\tthis._visible = value;\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"visible\")\n\t\t\tthis.visible = ul4._bool(value);\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\n\nLayoutControl.prototype._ul4onattrs = [\"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\"];\nLayoutControl.prototype._ul4attrs = new Set([\"id\", \"label\", \"identifier\", \"view\", \"top\", \"left\", \"width\", \"height\", \"visible\"]);\n\n\nclass HTMLLayoutControlType extends LayoutControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof HTMLLayoutControl;\n\t}\n};\n\nlet htmllayoutcontroltype = new HTMLLayoutControlType(\"la\", \"HTMLLayoutControl\", \"HTML decoration in an input form\");\n\n\nexport class HTMLLayoutControl extends LayoutControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn htmllayoutcontroltype;\n\t}\n\n\tget value()\n\t{\n\t\treturn this._value;\n\t}\n\n\tset value(value)\n\t{\n\t\tthis._value = value;\n\t\tif (this.globals._in_form())\n\t\t\tthis._set_dom_value(this._value);\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tthis._dom_root.innerHTML = DOMPurify.sanitize(value);\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"value\")\n\t\t\tthis.value = value;\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\n\nHTMLLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"_value\", \"_visible\"];\nHTMLLayoutControl.prototype._ul4attrs = new Set([...LayoutControl.prototype._ul4attrs, \"value\"]);\n\n\nclass ImageLayoutControlType extends LayoutControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof ImageLayoutControl;\n\t}\n};\n\nlet imagelayoutcontroltype = new ImageLayoutControlType(\"la\", \"ImageLayoutControl\", \"An image decoration in an input form\");\n\n\nexport class ImageLayoutControl extends LayoutControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn imagelayoutcontroltype;\n\t}\n\n\tget image()\n\t{\n\t\treturn this._image;\n\t}\n\n\tset image(image)\n\t{\n\t\tthis._image = image;\n\t\tif (this.globals._in_form())\n\t\t\tthis._set_dom_value(this._image);\n\t}\n\n\tget original()\n\t{\n\t\treturn this.image;\n\t}\n\n\tset original(original)\n\t{\n\t\tthis.image = image;\n\t}\n\n\t_set_dom_value(value)\n\t{\n\t\tlet img = this._dom_root.querySelector(\"img\");\n\t\tif (img !== null)\n\t\t{\n\t\t\tlet url = (value === null) ?\n\t\t\t\t\"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\" :\n\t\t\t\tthis.globals.scaled_url(value, this.width, this.height);\n\t\t\timg.setAttribute(\"src\", url);\n\t\t}\n\t}\n\n\t[ul4.symbols.setattr](name, value)\n\t{\n\t\tif (name === \"original\")\n\t\t\tthis.original = value;\n\t\telse if (name === \"image\")\n\t\t\tthis.image = value;\n\t\telse\n\t\t\tsuper[ul4.symbols.setattr](name, value);\n\t}\n};\n\nImageLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"_image\", \"_visible\"];\nImageLayoutControl.prototype._ul4attrs = new Set([...LayoutControl.prototype._ul4attrs, \"image\", \"original\"]);\n\n\nclass ButtonLayoutControlType extends LayoutControlType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof ButtonLayoutControl;\n\t}\n};\n\nlet buttonlayoutcontroltype = new ButtonLayoutControlType(\"la\", \"ButtonLayoutControl\", \"A submit button in an input form\");\n\n\nexport class ButtonLayoutControl extends LayoutControl\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn buttonlayoutcontroltype;\n\t}\n};\n\nButtonLayoutControl.prototype._ul4onattrs = [...LayoutControl.prototype._ul4onattrs, \"original\", \"scaled\", \"_visible\"];\n\n\nclass ViewControlType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof ViewControl;\n\t}\n};\n\nlet viewcontroltype = new ViewControlType(\"la\", \"ViewControl\", \"Contains view specific information about a control\");\n\n\nexport class ViewControl extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn viewcontroltype;\n\t}\n\n\tget mode()\n\t{\n\t\treturn this._mode ? \"display\" : \"edit\";\n\t}\n};\n\nViewControl.prototype._ul4onattrs = [\"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"z_index\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"_mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"];\nViewControl.prototype._ul4attrs = new Set([\"id\", \"view\", \"control\", \"top\", \"left\", \"width\", \"height\", \"z_index\", \"liveupdate\", \"default\", \"tabindex\", \"minlength\", \"maxlength\", \"required\", \"placeholder\", \"mode\", \"labelpos\", \"lookupnonekey\", \"lookupnonelabel\", \"label\", \"autoalign\", \"labelwidth\", \"lookupdata\", \"autoexpandable\"]);\n\n\nclass UserType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof User;\n\t}\n};\n\nlet usertype = new UserType(\"la\", \"User\", \"A LivingApps user/account\");\n\n\nexport class User extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn usertype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<User id=\" + ul4._repr(this.id) + \" firstname=\" + ul4._repr(this.firstname) + \" surname=\" + ul4._repr(this.surname) + \" email=\" + ul4._repr(this.email) + \">\";\n\t}\n};\n\nUser.prototype._ul4onattrs = [\"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"image\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"];\nUser.prototype._ul4attrs = new Set([\"id\", \"_id\", \"gender\", \"title\", \"firstname\", \"surname\", \"initials\", \"email\", \"streetname\", \"streetnumber\", \"zip\", \"city\", \"phone\", \"fax\", \"lang\", \"image\", \"summary\", \"interests\", \"personalwebsite\", \"companywebsite\", \"company\", \"position\", \"department\", \"keyviews\"]);\n\n\nclass FileType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof File;\n\t}\n};\n\nlet filetype = new FileType(\"la\", \"File\", \"An uploaded file\");\n\n\nexport class File extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn filetype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<File url=\" + ul4._repr(this.url) + \" filename=\" + ul4._repr(this.filename) + \">\";\n\t}\n\n\tget url()\n\t{\n\t\treturn \"/files/\" + this.contextid + \"/\" + this.id;\n\t}\n\n\tget archive_url()\n\t{\n\t\tif (this.archive === null)\n\t\t\treturn this.url;\n\t\treturn this.archive.url + \"/\" + this.filename;\n\t}\n};\n\nFile.prototype._ul4onattrs = [\"globals\", \"filename\", \"mimetype\", \"width\", \"height\", \"internal_id\", \"createdat\", \"size\", \"duration\", \"geo\", \"storagefilename\", \"archive\", \"context_id\"];\nFile.prototype._ul4attrs = new Set([\"globals\", \"id\", \"internal_id\", \"url\", \"archive_url\", \"filename\", \"mimetype\", \"width\", \"height\", \"size\", \"duration\", \"geo\", \"archive\", \"createdat\", \"context_id\"]);\n\n\nclass GeoType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Geo;\n\t}\n};\n\nlet geotype = new GeoType(\"la\", \"Geo\", \"Geographical coordinates and location information\");\n\n\nexport class Geo extends Base\n{\n\tconstructor(globals, lat, long, info=null)\n\t{\n\t\tsuper(null);\n\t\tthis.globals = globals;\n\t\tthis.lat = lat;\n\t\tthis.long = long;\n\t\tthis.info = info;\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn geotype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Geo lat=\" + ul4._repr(this.lat) + \" long=\" + ul4._repr(this.long) + \" info=\" + ul4._repr(this.info) + \">\";\n\t}\n};\n\nGeo.prototype._ul4onattrs = [\"globals\", \"lat\", \"long\", \"info\"];\nGeo.prototype._ul4attrs = new Set([\"globals\", \"lat\", \"long\", \"info\"]);\n\n\nclass AttachmentType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Attachment;\n\t}\n};\n\nlet attachmenttype = new AttachmentType(\"la\", \"Attachment\", \"An attachment of a record\");\n\n\nexport class Attachment extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn attachmenttype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" id=\" + ul4._repr(this.id) + \" label=\" + ul4._repr(this.label) + \">\";\n\t}\n};\n\nAttachment.prototype._ul4onattrs = [\"record\", \"label\", \"active\"];\nAttachment.prototype._ul4attrs = new Set([\"id\", \"record\", \"label\", \"active\"]);\n\n\nclass NoteAttachmentType extends AttachmentType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof NoteAttachment;\n\t}\n};\n\nlet noteattachmenttype = new NoteAttachmentType(\"la\", \"NoteAttachment\", \"A note attachment of a record\");\n\n\nexport class NoteAttachment extends Attachment\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn noteattachmenttype;\n\t}\n};\n\nNoteAttachment.prototype.type = \"noteattachment\";\nNoteAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nNoteAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nclass URLAttachmentType extends AttachmentType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof URLAttachment;\n\t}\n};\n\nlet urlattachmenttype = new URLAttachmentType(\"la\", \"URLAttachment\", \"A URL attachment of a record\");\n\n\nexport class URLAttachment extends Attachment\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn urlattachmenttype;\n\t}\n};\n\nURLAttachment.prototype.type = \"urlattachment\";\nURLAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nURLAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nclass FileAttachmentType extends AttachmentType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof FileAttachment;\n\t}\n};\n\nlet fileattachmenttype = new FileAttachmentType(\"la\", \"FileAttachment\", \"A file attachment of a record\");\n\n\nexport class FileAttachment extends Attachment\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn fileattachmenttype;\n\t}\n};\n\nFileAttachment.prototype.type = \"fileattachment\";\nFileAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nFileAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nclass JSONAttachmentType extends AttachmentType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof JSONAttachment;\n\t}\n};\n\nlet jsonattachmenttype = new JSONAttachmentType(\"la\", \"JSONAttachment\", \"A JSON attachment of a record\");\n\n\nexport class JSONAttachment extends Attachment\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn jsonattachmenttype;\n\t}\n\n\t_dumpUL4ONAttr(name)\n\t{\n\t\tif (name === \"value\")\n\t\t\treturn ul4._asjson(this.value);\n\t\telse\n\t\t\treturn this[name];\n\t}\n\n\t_loadUL4ONAttr(name, value)\n\t{\n\t\tif (name === \"value\")\n\t\t\tthis.value = ul4._fromjson(value);\n\t\telse\n\t\t\tthis[name] = value\n\t}\n};\n\nJSONAttachment.prototype.type = \"jsonattachment\";\nJSONAttachment.prototype._ul4onattrs = [...Attachment.prototype._ul4onattrs, \"value\"];\nJSONAttachment.prototype._ul4attrs = new Set([...Attachment.prototype._ul4onattrs, \"value\"]);\n\n\nclass InstallationType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Installation;\n\t}\n};\n\nlet installationtype = new InstallationType(\"la\", \"Installation\", \"The installation that created an app\");\n\n\nexport class Installation extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn installationtype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Installation id=\" + ul4._repr(this.id) + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nInstallation.prototype._ul4onattrs = [\"name\"];\nInstallation.prototype._ul4attrs = new Set([\"id\", \"name\"]);\n\n\nclass CategoryType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Category;\n\t}\n};\n\nlet categorytype = new CategoryType(\"la\", \"Category\", \"A navigation category\");\n\n\nexport class Category extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn categorytype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\tlet v = [];\n\t\tlet category = this;\n\t\twhile (category !== null)\n\t\t{\n\t\t\tv.splice(0, 0, category.identifier);\n\t\t\tcategory = category.parent;\n\t\t}\n\t\treturn \"<Category id=\" + ul4._repr(this.id) + \" identifierpath=\" + ul4._repr(v.join(\"/\")) +  + \" name=\" + ul4._repr(this.name) + \">\";\n\t}\n};\n\nCategory.prototype._ul4onattrs = [\"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"];\nCategory.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"order\", \"parent\", \"children\", \"apps\"]);\n\n\nclass KeyViewType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof KeyView;\n\t}\n};\n\nlet keyviewtype = new KeyViewType(\"la\", \"KeyView\", \"Object granting access to a view template\");\n\n\nexport class KeyView extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn keyviewtype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<KeyView id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n};\n\nKeyView.prototype._ul4onattrs = [\"identifier\", \"name\", \"key\", \"user\"];\nKeyView.prototype._ul4attrs = new Set([\"id\", \"identifier\", \"name\", \"key\", \"user\"]);\n\n\nclass AppParameterType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof AppParameter;\n\t}\n};\n\nlet appparametertype = new AppParameterType(\"la\", \"AppParameter\", \"A parameter of a LivingApps application\");\n\n\nexport class AppParameter extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn appparametertype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<AppParameter id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget app()\n\t{\n\t\tif (this.owner instanceof App)\n\t\t\treturn this.owner;\n\t\treturn null;\n\t}\n};\n\nAppParameter.prototype._ul4onattrs = [\"owner\", \"parent\", \"type\", \"order\", \"identifier\", \"description\", \"value\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\"];\nAppParameter.prototype._ul4attrs = new Set([\"id\", \"owner\", \"parent\", \"app\", \"type\", \"order\", \"identifier\", \"description\", \"value\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\"]);\n\n\nclass MutableAppParameterType extends AppParameterType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MutableAppParameter;\n\t}\n};\n\nlet mutableappparametertype = new MutableAppParameterType(\"la\", \"MutableAppParameter\", \"A mutable parameter of a LivingApps application\");\n\n\nexport class MutableAppParameter extends AppParameter\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn mutableappparametertype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<MutableAppParameter id=\" + ul4._repr(this.id) + \" identifier=\" + ul4._repr(this.identifier) + \">\";\n\t}\n\n\tget app()\n\t{\n\t\tif (this.owner instanceof App)\n\t\t\treturn this.owner;\n\t\treturn null;\n\t}\n};\n\nclass MenuItemType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof MenuItem;\n\t}\n};\n\nlet menuitemtype = new MenuItemType(\"la\", \"MenuItem\", \"An additional menu item in an app that links to a target page.\");\n\n\nexport class MenuItem extends Base\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn menuitemtype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<MenuItem id=\" + ul4._repr(this.id) + \"identifier=\" + ul4._repr(this.identifier) + \" label=\" + ul4._repr(this.label) + \" type=\" + ul4._repr(this.type) + \">\";\n\t}\n};\n\nMenuItem.prototype._ul4onattrs = [\"app\", \"identifier\", \"label\", \"type\", \"icon\", \"title\", \"target\", \"cssclass\", \"url\", \"order\", \"start_time\", \"end_time\", \"on_app_overview_page\", \"on_app_detail_page\", \"on_form_page\", \"on_iframe_page\", \"on_custom_overview_page\", \"accessible\", \"children\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\"];\nMenuItem.prototype._ul4attrs = new Set([\"id\", \"app\", \"identifier\", \"label\", \"type\", \"icon\", \"title\", \"target\", \"cssclass\", \"url\", \"order\", \"start_time\", \"end_time\", \"on_app_overview_page\", \"on_app_detail_page\", \"on_form_page\", \"on_iframe_page\", \"on_custom_overview_page\", \"accessible\", \"children\", \"createdat\", \"createdby\", \"updatedat\", \"updatedby\"]);\n\n\nclass PanelType extends MenuItemType\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Panel;\n\t}\n};\n\nlet paneltype = new MenuItemType(\"la\", \"Panel\", \"An additional panel in an app that is displayed on various LivingApps pages and links to a target page.\");\n\n\nexport class Panel extends MenuItem\n{\n\t[ul4.symbols.type]()\n\t{\n\t\treturn paneltype;\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<Panel id=\" + ul4._repr(this.id) + \"identifier=\" + ul4._repr(this.identifier) + \" label=\" + ul4._repr(this.label) + \" type=\" + ul4._repr(this.type) + \">\";\n\t}\n};\n\nPanel.prototype._ul4onattrs = [...MenuItem.prototype._ul4onattrs, \"description\", \"description_url\", \"image\", \"row\", \"column\", \"width\", \"height\", \"header_type\", \"header_background\", \"text_color\", \"background_color1\", \"background_color2\"];\nPanel.prototype._ul4attrs = new Set([...MenuItem.prototype._ul4attrs, \"description\", \"description_url\", \"image\", \"row\", \"column\", \"width\", \"height\"]);\n\n\nclass FormType extends ul4.Type\n{\n\tinstancecheck(obj)\n\t{\n\t\treturn obj instanceof Form;\n\t}\n};\n\nlet formtype = new FormType(\"la\", \"Form\", \"The input form.\");\n\nexport class Form extends ul4.Proto\n{\n\tconstructor(globals, template)\n\t{\n\t\tsuper();\n\t\tthis.globals = globals;\n\t\tthis.template = template;\n\t\tthis._geo_wired = false;\n\n\t\tfor (let field of globals.record.fields.values())\n\t\t\tthis.wire_field(field);\n\t\tthis.render_template(null);\n\t}\n\n\t[ul4.symbols.type]()\n\t{\n\t\treturn formtype;\n\t}\n\n\tget _dom_button()\n\t{\n\t\treturn document.querySelector(this._sel_form + \" \" + this._sel_button);\n\t}\n\n\tget enabled()\n\t{\n\t\treturn !this._dom_button.disabled;\n\t}\n\n\tset enabled(value)\n\t{\n\t\tthis._dom_button.disabled = !value;\n\t}\n\n\t[ul4.symbols.getattr](key)\n\t{\n\t\tif (key === \"enabled\")\n\t\t\treturn this.enabled;\n\t\telse\n\t\t\tthrow new ul4.AttributeError(this, key);\n\t}\n\n\t[ul4.symbols.setattr](key, value)\n\t{\n\t\tif (key === \"enabled\")\n\t\t\tthis.enabled = ul4._bool(value);\n\t\telse\n\t\t\tthrow new ul4.AttributeError(this, key);\n\t}\n\n\t[ul4.symbols.repr]()\n\t{\n\t\treturn \"<\" + this.constructor.name + \" enabled=\" + ul4._repr(this.enabled) + \">\";\n\t}\n\n\ttoString()\n\t{\n\t\treturn this[ul4.symbols.repr]();\n\t}\n\n\trender_template(identifier)\n\t{\n\t\tlet vars = {\n\t\t\t\"datasources\": this.globals.datasources,\n\t\t\t\"record\": this.globals.record,\n\t\t\t\"app\": this.globals.app,\n\t\t\t\"fields\": this.globals.record.fields,\n\t\t\t\"identifier\": identifier\n\t\t};\n\n\t\tlet globalVars = {\n\t\t\t\"globals\": this.globals,\n\t\t\t\"form\": this,\n\t\t\t\"la\": module\n\t\t};\n\n\t\tlet msg = \"LivingApps update template: \";\n\t\tif (identifier === null)\n\t\t\tmsg += \"Initialization\";\n\t\telse\n\t\t\tmsg += \"Value change in \" + ul4._repr(identifier);\n\n\t\tthis.globals.group_logging(msg, () => {\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.template.renders(vars, globalVars);\n\t\t\t}\n\t\t\tcatch (exc)\n\t\t\t{\n\t\t\t\tif (console && console.error)\n\t\t\t\t{\n\t\t\t\t\tthis.globals._start_log_message();\n\t\t\t\t\tif (console.group)\n\t\t\t\t\t\tconsole.group(\"UL4 stacktrace\");\n\t\t\t\t\tul4.report_exc(exc);\n\t\t\t\t\tif (console.groupEnd)\n\t\t\t\t\t\tconsole.groupEnd();\n\n\t\t\t\t\tif (console.groupCollapsed)\n\t\t\t\t\t\tconsole.groupCollapsed(\"Javascript stacktrace\");\n\t\t\t\t\tconsole.error(exc);\n\t\t\t\t\tif (console.groupEnd)\n\t\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\twire_geo()\n\t{\n\t\tif (this._geo_wired)\n\t\t\treturn;\n\n\t\tif (this.globals.app.active_view !== null && navigator.geolocation)\n\t\t{\n\t\t\tlet use_geo = this.globals.app.active_view.use_geo;\n\t\t\tif (use_geo === \"once\" || use_geo === \"watch\")\n\t\t\t{\n\t\t\t\tnavigator.geolocation.getCurrentPosition((position) => {\n\t\t\t\t\tthis.globals.mode = this.globals.mode.substring(0, this.globals.mode.lastIndexOf(\"/\") + 1) + \"geo\";\n\t\t\t\t\tthis.globals.set_current_geo(position);\n\t\t\t\t\tthis.render_template(null);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (use_geo === \"watch\")\n\t\t\t{\n\t\t\t\tnavigator.geolocation.watchPosition((position) => {\n\t\t\t\t\tthis.globals.mode = this.globals.mode.substring(0, this.globals.mode.lastIndexOf(\"/\") + 1) + \"geo\";\n\t\t\t\t\tthis.globals.set_current_geo(position);\n\t\t\t\t\tthis.render_template(null);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tthis._geo_wired = true;\n\t}\n\n\twire_field(field)\n\t{\n\t\tfor (let dom_node of field._dom_controls)\n\t\t{\n\t\t\tdom_node.addEventListener(field._inputevent, (event) => {\n\t\t\t\tthis.wire_geo();\n\t\t\t\tthis.globals.mode = this.globals.mode.substring(0, this.globals.mode.lastIndexOf(\"/\") + 1) + \"input\";\n\t\t\t\tthis.render_template(field.control.identifier);\n\t\t\t});\n\t\t}\n\t}\n};\n\nForm.prototype._ul4attrs = new Set([\"enabled\"]);\nForm.prototype._sel_form = \"#livingapps-form form\";\nForm.prototype._sel_button = \"[type=submit]\";\n\n\nlet classes = [\n\tGlobals,\n\tFlashMessage,\n\tApp,\n\tView,\n\tMenuItem,\n\tPanel,\n\tDataSource,\n\tRecord,\n\tBoolControl,\n\tIntControl,\n\tNumberControl,\n\tTextControl,\n\tEmailControl,\n\tURLControl,\n\tTelControl,\n\tTextAreaControl,\n\tDateControl,\n\tDatetimeMinuteControl,\n\tDatetimeSecondControl,\n\tLookupControl,\n\tLookupSelectControl,\n\tLookupRadioControl,\n\tLookupChoiceControl,\n\tAppLookupControl,\n\tAppLookupSelectControl,\n\tAppLookupRadioControl,\n\tAppLookupChoiceControl,\n\tMultipleLookupControl,\n\tMultipleLookupSelectControl,\n\tMultipleLookupCheckboxControl,\n\tMultipleLookupChoiceControl,\n\tMultipleAppLookupControl,\n\tMultipleAppLookupSelectControl,\n\tMultipleAppLookupCheckboxControl,\n\tMultipleAppLookupChoiceControl,\n\tGeoControl,\n\tFileControl,\n\tFileSignatureControl,\n\tButtonControl,\n\tField,\n\tBoolField,\n\tStringField,\n\tEmailField,\n\tURLField,\n\tTelField,\n\tTextAreaField,\n\tHTMLField,\n\tIntField,\n\tNumberField,\n\tGeoField,\n\tFileField,\n\tFileSignatureField,\n\tDateFieldBase,\n\tDateField,\n\tDatetimeMinuteField,\n\tDatetimeSecondField,\n\tLookupFieldBase,\n\tLookupField,\n\tMultipleLookupField,\n\tAppLookupFieldBase,\n\tAppLookupField,\n\tMultipleAppLookupField,\n\tLookupItem,\n\tViewLookupItem,\n\tLayoutControl,\n\tHTMLLayoutControl,\n\tImageLayoutControl,\n\tButtonLayoutControl,\n\tViewControl,\n\tUser,\n\tFile,\n\tGeo,\n\tNoteAttachment,\n\tURLAttachment,\n\tFileAttachment,\n\tJSONAttachment,\n\tInstallation,\n\tCategory,\n\tKeyView,\n\tAppParameter,\n\tMutableAppParameter\n];\n\nfor (let constructor of classes)\n{\n\tul4.register(\"de.livinglogic.livingapi.\" + constructor.name.toLowerCase(), constructor);\n}\n\nexport const module = new ul4.Module(\n\t\"la\",\n\t\"LivingAPI types\",\n\t{\n\t\tFlashMessage: FlashMessage,\n\t\tFile: File,\n\t\tGeo: Geo,\n\t\tUser: User,\n\t\tKeyView: KeyView,\n\t\tGlobals: Globals,\n\t\tApp: App,\n\t\tTextControl: TextControl,\n\t\tURLControl: URLControl,\n\t\tEmailControl: EmailControl,\n\t\tPasswordControl: PasswordControl,\n\t\tTelControl: TelControl,\n\t\tTextAreaControl: TextAreaControl,\n\t\tHTMLControl: HTMLControl,\n\t\tIntControl: IntControl,\n\t\tNumberControl: NumberControl,\n\t\tDateControl: DateControl,\n\t\tDatetimeMinuteControl: DatetimeMinuteControl,\n\t\tDatetimeSecondControl: DatetimeSecondControl,\n\t\tBoolControl: BoolControl,\n\t\tLookupSelectControl: LookupSelectControl,\n\t\tLookupRadioControl: LookupRadioControl,\n\t\tLookupChoiceControl: LookupChoiceControl,\n\t\tAppLookupSelectControl: AppLookupSelectControl,\n\t\tAppLookupRadioControl: AppLookupRadioControl,\n\t\tAppLookupChoiceControl: AppLookupChoiceControl,\n\t\tMultipleLookupSelectControl: MultipleLookupSelectControl,\n\t\tMultipleLookupCheckboxControl: MultipleLookupCheckboxControl,\n\t\tMultipleLookupChoiceControl: MultipleLookupChoiceControl,\n\t\tMultipleAppLookupSelectControl: MultipleAppLookupSelectControl,\n\t\tMultipleAppLookupCheckboxControl: MultipleAppLookupCheckboxControl,\n\t\tMultipleAppLookupChoiceControl: MultipleAppLookupChoiceControl,\n\t\tFileControl: FileControl,\n\t\tFileSignatureControl: FileSignatureControl,\n\t\tGeoControl: GeoControl,\n\t\tViewControl: ViewControl,\n\t\tRecord: Record,\n\t\tFileAttachment: FileAttachment,\n\t\tURLAttachment: URLAttachment,\n\t\tNoteAttachment: NoteAttachment,\n\t\tJSONAttachment: JSONAttachment,\n\t\tInstallation: Installation,\n\t\tHTMLLayoutControl: HTMLLayoutControl,\n\t\tImageLayoutControl: ImageLayoutControl,\n\t\tButtonLayoutControl: ButtonLayoutControl,\n\t\tView: View,\n\t\tDataSource: DataSource,\n\t\tLookupItem: LookupItem,\n\t\tViewLookupItem: ViewLookupItem,\n\t\tCategory: Category,\n\t\tAppParameter: AppParameter,\n\t\tMutableAppParameter: MutableAppParameter,\n\t\tMenuItem: MenuItem,\n\t\tPanel: Panel,\n\t}\n);\n"],"names":["entries","setPrototypeOf","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","Object","freeze","seal","create","apply","construct","Reflect","x","fun","thisValue","args","Func","arrayForEach","unapply","Array","prototype","forEach","arrayPop","pop","arrayPush","push","stringToLowerCase","String","toLowerCase","stringToString","toString","stringMatch","match","stringReplace","replace","stringIndexOf","indexOf","stringTrim","trim","objectHasOwnProperty","hasOwnProperty","regExpTest","RegExp","test","typeErrorCreate","unconstruct","func","_len2","arguments","length","_key2","TypeError","thisArg","_len","_key","addToSet","set","array","transformCaseFunc","undefined","l","element","lcElement","cleanArray","index","clone","object","newObject","property","value","isArray","constructor","lookupGetter","prop","desc","get","fallbackValue","html","svg","svgFilters","svgDisallowed","mathMl","mathMlDisallowed","text","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","getGlobal","window","_createTrustedTypesPolicy","trustedTypes","purifyHostElement","createPolicy","suffix","ATTR_NAME","hasAttribute","getAttribute","policyName","createHTML","createScriptURL","scriptUrl","_","console","warn","createDOMPurify","DOMPurify","root","version","VERSION","removed","document","nodeType","isSupported","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","createElement","content","ownerDocument","trustedTypesPolicy","emptyHTML","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","createHTMLDocument","EXPRESSIONS","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","ATTRS","CUSTOM_ELEMENT_HANDLING","tagNameCheck","writable","configurable","enumerable","attributeNameCheck","allowCustomizedBuiltInElements","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","SANITIZE_NAMED_PROPS_PREFIX","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","DEFAULT_PARSER_MEDIA_TYPE","CONFIG","formElement","isRegexOrFunction","testValue","Function","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","TRUSTED_TYPES_POLICY","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","ALL_SVG_TAGS","ALL_MATHML_TAGS","_checkValidNamespace","parent","tagName","namespaceURI","parentTagName","Boolean","_forceRemove","node","parentNode","removeChild","remove","_removeAttribute","name","attribute","getAttributeNode","from","removeAttribute","setAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","parseFromString","documentElement","createDocument","innerHTML","body","insertBefore","createTextNode","childNodes","call","_createNodeIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","_isClobbered","elm","nodeName","textContent","attributes","hasChildNodes","_isNode","_executeHook","entryPoint","currentNode","data","hook","_sanitizeElements","allowedTags","firstElementChild","_isBasicCustomElement","i","expr","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","attr","forceKeepAttr","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","sanitize","importedNode","returnNode","appendChild","firstChild","nodeIterator","shadowroot","shadowrootmode","serializedHTML","outerHTML","doctype","setConfig","clearConfig","isValidAttribute","tag","addHook","hookFunction","removeHook","removeHooks","removeAllHooks","dom_node","arg","ismap","Map","isobject","ul4","_isobject","_append_param_to_url","urlparams","_islist","append","_str","url_with_params","url","URLSearchParams","params","param","Proto","_typeof","__proto__","Base","id","this","encoder","_ul4onattrs","dump","_dumpUL4ONAttr","decoder","iter","loadcontent","iteritem","next","done","_loadUL4ONAttr","_setDefaultUL4ONAttr","symbols","getattr","_ul4attrs","has","realvalue","bind","_ul4_name","_ul4_signature","_ul4_needsobject","_ul4_needscontext","startsWith","AttributeError","setattr","repr","Handler","record","globalstype","obj","Globals","Type","hostname","platform","user","lang","datasources","app","mode","maxdbactions","maxtemplateruntime","flashmessages","view_template_id","email_template_id","handler","_log_stack","_current_geo","type","geo1","geo2","sqsin","Math","sin","sqcos","sqsos","cos","deg2rad","PI","flat","lat1","lat","long1","lat2","F","G","S","C","w","atan","sqrt","D","T","H2","image","width","height","enlarge","gravity","quality","rotate","blur","sharpen","format","cache","filename","File","archive_url","encodeURIComponent","result","rotatet","_repr","position","Geo","coords","latitude","longitude","msg_bool_true","msg_bool_false","messages","map","m","join","header","output","groupEnd","callback","begin_logging","end_logging","level","group","_start_log_message","message","debug","_make_log_message","info","error","Set","expose","log_debug","log_info","log_warning","log_error","dist","current_geo","scaled_url","flashmessagetype","FlashMessage","title","apptype","App","values","globals","save","identifier","active_view","layout_controls","Record","_ismap","keys","fields","ArgumentError","_make_fields","_list","dicttype","items","controls","substr","_active_view","view","views","ValueError","View","active_views","insert","template_url","new_embedded_url","new_standalone_url","viewtype","datasourcetype","DataSource","recordtype","createdat","createdby","updatedat","updatedby","updatecount","_sparsevalues","_values","_fields","children","attachments","errors","_sparsefielderrors","_sparsefieldlookupdata","_is_deleted","_is_new","maxlevel","control","priority","fieldvalue","value_as_text","label","msg_no_fields","defaults","lookupdata","field","fieldtype","_sparselookupdata","_in_form","v","is_empty","state","is_dirty","has_errors","key","search","fieldsearch","_bool","_get","update","edit_embedded_url","edit_standalone_url","FieldType","Field","_label","_lookupdata","_value","_this4","_dirty","_enabled","_writable","_visible","_get_dom_value","oldvalue","change","_validate","_ne","_set_dom_value","_dom_label","_set_dom_label","searchvalue","_type","minlength","maxlength","_cssclass_root","_sel_root","_cssclass_control","querySelector","_sel_label","_sel_control","querySelectorAll","_dom_control","_dom_root","hidden","classList","contains","disabled","_dom_controls","toggle","s","visible","enabled","_inputevent","boolfieldtype","BoolField","required","msg_field_required","msg_bool_truerequired","msg_field_wrong_type","checked","msg_bool","intfieldtype","IntField","parseInt","_parse","msg_number_format","round","testvalue","readonly","readOnly","numberfieldtype","NumberField","seps","commas","dots","c","convert","floatvalue","parseFloat","isNaN","_bound_value","precision","_round","minimum","maximum","toFixed","StringFieldType","StringField","stringfieldtype","msg_string_tooshort","msg_string_toolong","passwordfieldtype","PasswordField","emailfieldtype","EmailField","msg_email_format","urlfieldtype","URLField","URL","exc","msg_url_format","protocol","telfieldtype","TelField","msg_tel_format","textareafieldtype","TextAreaField","htmlfieldtype","HTMLField","geofieldtype","GeoField","endsWith","JSON","parse","geometry","coordinates","properties","formatted_address","dom_value","_asjson","FileFieldType","FileField","filefieldtype","filesignaturefieldtype","FileSignatureField","DateFieldBaseType","DateFieldBase","datefieldbasetype","_format","formatstring","year","month","day","hour","minute","second","ispm","_int","len","min","max","substring","Date","_convert","Date_","_date","formatstrings_parse","msg_date_format","date","datefieldtype","DateField","getFullYear","getMonth","getDate","datetimeminutefieldtype","DatetimeMinuteField","setSeconds","setMilliseconds","datetimesecondfieldtype","DatetimeSecondField","ChoiceFieldBase","selected","none_key","lookup_data","none_selected","add","new_children","_make_option","none_label","msg_nothing_selected","_make_label","replaceChildren","dom_input","dom_none_input","dom_label","style","display","innerText","LookupFieldBaseType","LookupFieldBase","lookupfieldbasetype","_set_dom_lookupdata","LookupItem","lookupitem","autoexpandable","search_lookupitem","msg_lookup_unknownkey","msg_lookup_wrongitem","LookupFieldType","LookupField","lookupfieldtype","_find_lookupitem","lookupradiofieldtype","LookupRadioField","_set_dom_lookupdata_input","lookupselectfieldtype","LookupSelectField","_set_dom_lookupdata_select","lookupchoicefieldtype","LookupChoiceField","MultipleLookupFieldType","MultipleLookupField","multiplelookupfieldtype","item","islist","newvalue","singlechange","multiplelookupcheckboxfieldtype","MultipleLookupCheckboxField","multiplelookupselectfieldtype","MultipleLookupSelectField","option","multiplelookupchoicefieldtype","MultipleLookupChoiceField","AppLookupFieldBaseType","AppLookupFieldBase","applookupfieldbasetype","lookup_app","records","as_text","lookup_controls","msg_applookup_unknownkey","msg_applookup_wrongrecord","AppLookupFieldType","AppLookupField","applookupfieldtype","_find_record","applookupselectfieldtype","AppLookupSelectField","applookupradiofieldtype","AppLookupRadioField","applookupchoicefieldtype","AppLookupChoiceField","MultipleAppLookupFieldType","MultipleAppLookupField","multipleapplookupfieldtype","multipleapplookupcheckboxfieldtype","MultipleAppLookupCheckboxField","multipleapplookupselectfieldtype","MultipleAppLookupSelectField","multipleapplookupchoicefieldtype","MultipleAppLookupChoiceField","ControlType","Control","controltype","subtype","view_control","_view_control","top","left","z_index","liveupdate","tabindex","labelpos","labelwidth","autoalign","boolcontroltype","BoolControl","_logsearch","operator","intcontroltype","IntControl","PlaceholderControlType","PlaceholderControld","placeholdercontroltype","PlaceholderControl","placeholder","numbercontroltype","NumberControl","minvalue","maxvalue","StringControlType","StringControl","stringcontroltype","gender","firstname","surname","email","streetname","streetnumber","street","zip","phone","fax","company","city","summary","interests","personal_website","company_website","department","today","_user_placeholder","textcontroltype","TextControl","passwordcontroltype","PasswordControl","emailcontroltype","EmailControl","urlcontroltype","URLControl","telcontroltype","TelControl","textareacontroltype","TextAreaControl","encrypted","htmlcontroltype","HTMLControl","DateControlType","DateControl","datecontroltype","_formatstrings","_formatstrings_parse","language","_suffixes","datetimeminutecontroltype","DatetimeMinuteControl","now","datetimesecondcontroltype","DatetimeSecondControl","LookupControlType","LookupControl","lookupcontroltype","lookupnonekey","lookupnonelabel","lookupselectcontroltype","LookupSelectControl","lookupradiocontroltype","LookupRadioControl","lookupchoicecontroltype","LookupChoiceControl","AppLookupControlType","AppLookupControl","applookupcontroltype","applookupselectcontroltype","AppLookupSelectControl","applookupradiocontroltype","AppLookupRadioControl","applookupchoicecontroltype","AppLookupChoiceControl","MultipleLookupControlType","MultipleLookupControl","multiplelookupcontroltype","defaultValue","multiplelookupcheckboxcontroltype","MultipleLookupCheckboxControl","multiplelookupselectcontroltype","MultipleLookupSelectControl","multiplelookupchoicecontroltype","MultipleLookupChoiceControl","MultipleAppLookupControlType","MultipleAppLookupControl","multipleapplookupcontroltype","multipleapplookupselectcontroltype","MultipleAppLookupSelectControl","multipleapplookupcheckboxcontroltype","MultipleAppLookupCheckboxControl","multipleapplookupchoicecontroltype","MultipleAppLookupChoiceControl","geocontroltype","GeoControl","FileControlType","FileControl","filecontroltype","filesignaturecontroltype","FileSignatureControl","buttoncontroltype","ButtonControl","lookupitemtype","view_lookupitem","_view_lookupitem","viewlookupitemtype","ViewLookupItem","LayoutControlType","LayoutControl","layoutcontroltype","htmllayoutcontroltype","HTMLLayoutControl","imagelayoutcontroltype","ImageLayoutControl","_image","original","img","buttonlayoutcontroltype","ButtonLayoutControl","viewcontroltype","ViewControl","_mode","usertype","User","filetype","contextid","archive","geotype","long","AttachmentType","Attachment","attachmenttype","noteattachmenttype","NoteAttachment","urlattachmenttype","URLAttachment","fileattachmenttype","FileAttachment","jsonattachmenttype","JSONAttachment","_fromjson","installationtype","Installation","categorytype","Category","category","splice","keyviewtype","KeyView","AppParameterType","AppParameter","appparametertype","owner","mutableappparametertype","MutableAppParameter","MenuItemType","MenuItem","menuitemtype","paneltype","Panel","formtype","Form","_geo_wired","wire_field","render_template","_sel_form","_sel_button","_dom_button","vars","globalVars","module","msg","group_logging","_this7","renders","report_exc","groupCollapsed","navigator","geolocation","use_geo","getCurrentPosition","_this8","lastIndexOf","set_current_geo","watchPosition","addEventListener","event","_this9","wire_geo","register","Module"],"mappings":"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CA,UACA,OACA,WACA,QACA,MACA,OACA,KACA,WACA,SACA,SACA,IACA,UACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,UACA,SACA,SACA,QACA,SACA,SACA,OACA,SACA,SACA,QACA,MACA,UACA,MACA,QACA,QACA,KACA,WACA,WACA,QACA,KACA,QACA,OACA,KACA,QACA,KACA,IACA,KACA,MACA,QACA,QAIWwE,EAAMxE,EAAO,CACxB,MACA,IACA,WACA,cACA,eACA,eACA,gBACA,mBACA,SACA,WACA,OACA,OACA,UACA,SACA,OACA,IACA,QACA,WACA,QACA,QACA,OACA,iBACA,SACA,OACA,WACA,QACA,OACA,UACA,UACA,WACA,iBACA,OACA,OACA,QACA,SACA,SACA,OACA,WACA,QACA,OACA,QACA,OACA,UAGWyE,EAAazE,EAAO,CAC/B,UACA,gBACA,sBACA,cACA,mBACA,oBACA,oBACA,iBACA,eACA,UACA,UACA,UACA,UACA,UACA,iBACA,UACA,UACA,cACA,eACA,WACA,eACA,qBACA,cACA,SACA,iBAOW0E,EAAgB1E,EAAO,CAClC,UACA,gBACA,SACA,UACA,YACA,mBACA,iBACA,gBACA,gBACA,gBACA,QACA,YACA,OACA,eACA,YACA,UACA,gBACA,SACA,MACA,aACA,UACA,QAGW2E,EAAS3E,EAAO,CAC3B,OACA,WACA,SACA,UACA,QACA,SACA,KACA,aACA,gBACA,KACA,KACA,QACA,UACA,WACA,QACA,OACA,KACA,SACA,QACA,SACA,OACA,OACA,UACA,SACA,MACA,QACA,MACA,SACA,aACA,gBAKW4E,EAAmB5E,EAAO,CACrC,UACA,cACA,aACA,WACA,YACA,UACA,UACA,SACA,SACA,QACA,YACA,aACA,iBACA,cACA,SAGW6E,EAAO7E,EAAO,CAAC,UCrRfuE,EAAOvE,EAAO,CACzB,SACA,SACA,QACA,MACA,iBACA,eACA,uBACA,WACA,aACA,UACA,SACA,UACA,cACA,cACA,UACA,OACA,QACA,QACA,QACA,OACA,UACA,WACA,eACA,SACA,cACA,WACA,WACA,UACA,MACA,WACA,0BACA,wBACA,WACA,YACA,UACA,eACA,OACA,MACA,UACA,SACA,SACA,OACA,OACA,WACA,KACA,YACA,YACA,QACA,OACA,QACA,OACA,OACA,UACA,OACA,MACA,MACA,YACA,QACA,SACA,MACA,YACA,WACA,QACA,OACA,QACA,UACA,aACA,SACA,OACA,UACA,UACA,cACA,cACA,SACA,UACA,UACA,aACA,WACA,MACA,WACA,MACA,WACA,OACA,OACA,UACA,aACA,QACA,WACA,QACA,OACA,QACA,OACA,UACA,QACA,MACA,SACA,OACA,QACA,UACA,WACA,QACA,YACA,OACA,SACA,SACA,QACA,QACA,QACA,SAGWwE,EAAMxE,EAAO,CACxB,gBACA,aACA,WACA,qBACA,SACA,gBACA,gBACA,UACA,gBACA,iBACA,QACA,OACA,KACA,QACA,OACA,gBACA,YACA,YACA,QACA,sBACA,8BACA,gBACA,kBACA,KACA,KACA,IACA,KACA,KACA,kBACA,YACA,UACA,UACA,MACA,WACA,YACA,MACA,OACA,eACA,YACA,SACA,cACA,cACA,gBACA,cACA,YACA,mBACA,eACA,aACA,eACA,cACA,KACA,KACA,KACA,KACA,aACA,WACA,gBACA,oBACA,SACA,OACA,KACA,kBACA,KACA,MACA,IACA,KACA,KACA,KACA,KACA,UACA,YACA,aACA,WACA,OACA,eACA,iBACA,eACA,mBACA,iBACA,QACA,aACA,aACA,eACA,eACA,cACA,cACA,mBACA,YACA,MACA,OACA,QACA,SACA,OACA,MACA,OACA,aACA,SACA,WACA,UACA,QACA,SACA,cACA,SACA,WACA,cACA,OACA,aACA,sBACA,mBACA,eACA,SACA,gBACA,sBACA,iBACA,IACA,KACA,KACA,SACA,OACA,OACA,cACA,YACA,UACA,SACA,SACA,QACA,OACA,kBACA,mBACA,mBACA,eACA,cACA,eACA,cACA,aACA,eACA,mBACA,oBACA,iBACA,kBACA,oBACA,iBACA,SACA,eACA,QACA,eACA,iBACA,WACA,UACA,UACA,YACA,mBACA,cACA,kBACA,iBACA,aACA,OACA,KACA,KACA,UACA,SACA,UACA,aACA,UACA,aACA,gBACA,gBACA,QACA,eACA,OACA,eACA,mBACA,mBACA,IACA,KACA,KACA,QACA,IACA,KACA,KACA,IACA,eAGW2E,EAAS3E,EAAO,CAC3B,SACA,cACA,QACA,WACA,QACA,eACA,cACA,aACA,aACA,QACA,MACA,UACA,eACA,WACA,QACA,QACA,SACA,OACA,KACA,UACA,SACA,gBACA,SACA,SACA,iBACA,YACA,WACA,cACA,UACA,UACA,gBACA,WACA,WACA,OACA,WACA,WACA,aACA,UACA,SACA,SACA,cACA,gBACA,uBACA,YACA,YACA,aACA,WACA,iBACA,iBACA,YACA,UACA,QACA,UAGW8E,EAAM9E,EAAO,CACxB,aACA,SACA,cACA,YACA,gBCrWW+E,EAAgB9E,EAAK,6BACrB+E,EAAW/E,EAAK,yBAChBgF,EAAchF,EAAK,iBACnBiF,EAAYjF,EAAK,8BACjBkF,EAAYlF,EAAK,kBACjBmF,EAAiBnF,EAC5B,6FAEWoF,EAAoBpF,EAAK,yBACzBqF,EAAkBrF,EAC7B,+DAEWsF,EAAetF,EAAK,wLCSjC,MAAMuF,EAAY,SAAZA,YACJ,MAAyB,oBAAXC,OAAyB,KAAOA,QAW1CC,EAA4B,SAA5BA,0BAAsCC,EAAcC,GACxD,GAC0B,iBAAjBD,GAC8B,mBAA9BA,EAAaE,aAEpB,OAAO,KAMT,IAAIC,EAAS,KACb,MAAMC,EAAY,wBACdH,GAAqBA,EAAkBI,aAAaD,KACtDD,EAASF,EAAkBK,aAAaF,IAG1C,MAAMG,EAAa,aAAeJ,EAAS,IAAMA,EAAS,IAE1D,IACE,OAAOH,EAAaE,aAAaK,EAAY,CAC3CC,WAAW5B,GACFA,EAET6B,gBAAgBC,GACPA,IAGX,MAAOC,GAOP,OAHAC,QAAQC,KACN,uBAAyBN,EAAa,0BAEjC,OA4hDX,MAxhDA,SAASO,kBAAsC,IAAtBhB,EAAM/C,UAAAC,OAAAD,QAAAW,IAAAX,UAAAW,GAAAX,UAAG8C,GAAAA,IAChC,MAAMkB,UAAaC,GAASF,gBAAgBE,GAc5C,GARAD,UAAUE,QAAUC,QAMpBH,UAAUI,QAAU,IAEfrB,IAAWA,EAAOsB,UAAyC,IAA7BtB,EAAOsB,SAASC,SAKjD,OAFAN,UAAUO,aAAc,EAEjBP,UAGT,IAAIK,SAAEA,GAAatB,EAEnB,MAAMyB,EAAmBH,EACnBI,EAAgBD,EAAiBC,eACjCC,iBACJA,EAAgBC,oBAChBA,EAAmBC,KACnBA,EAAIC,QACJA,EAAOC,WACPA,EAAUC,aACVA,EAAehC,EAAOgC,cAAgBhC,EAAOiC,gBAAeC,gBAC5DA,EAAeC,UACfA,EAASjC,aACTA,GACEF,EAEEoC,EAAmBN,EAAQzG,UAE3BgH,EAAY5D,aAAa2D,EAAkB,aAC3CE,EAAiB7D,aAAa2D,EAAkB,eAChDG,EAAgB9D,aAAa2D,EAAkB,cAC/CI,EAAgB/D,aAAa2D,EAAkB,cAQrD,GAAmC,mBAAxBR,EAAoC,CAC7C,MAAMa,EAAWnB,EAASoB,cAAc,YACpCD,EAASE,SAAWF,EAASE,QAAQC,gBACvCtB,EAAWmB,EAASE,QAAQC,eAIhC,IAAIC,EACAC,EAAY,GAEhB,MAAMC,eACJA,EAAcC,mBACdA,EAAkBC,uBAClBA,GAAsBC,qBACtBA,IACE5B,GACE6B,WAAEA,IAAe1B,EAEvB,IAAI2B,GAAQ,GAKZnC,UAAUO,YACW,mBAAZvH,GACkB,mBAAlBuI,GACPO,QACsCnF,IAAtCmF,EAAeM,mBAEjB,MAAM/D,cACJA,GAAaC,SACbA,GAAQC,YACRA,GAAWC,UACXA,GAASC,UACTA,GAASE,kBACTA,GAAiBC,gBACjBA,IACEyD,EAEJ,mBAAM3D,IAAmB2D,EAQrBC,GAAe,KACnB,MAAMC,GAAuBhG,SAAS,GAAI,IACrCiG,KACAA,KACAA,KACAA,KACAA,IAIL,IAAIC,GAAe,KACnB,MAAMC,GAAuBnG,SAAS,GAAI,IACrCoG,KACAA,KACAA,KACAA,IASL,IAAIC,GAA0BvJ,OAAOE,KACnCC,EAAO,KAAM,CACXqJ,aAAc,CACZC,UAAU,EACVC,cAAc,EACdC,YAAY,EACZ3F,MAAO,MAET4F,mBAAoB,CAClBH,UAAU,EACVC,cAAc,EACdC,YAAY,EACZ3F,MAAO,MAET6F,+BAAgC,CAC9BJ,UAAU,EACVC,cAAc,EACdC,YAAY,EACZ3F,OAAO,MAMT8F,GAAc,KAGdC,GAAc,KAGdC,IAAkB,EAGlBC,IAAkB,EAGlBC,IAA0B,EAI1BC,IAA2B,EAK3BC,IAAqB,EAGrBC,IAAiB,EAGjBC,IAAa,EAIbC,IAAa,EAMbC,IAAa,EAIbC,IAAsB,EAItBC,IAAsB,EAKtBC,IAAe,EAefC,IAAuB,EAC3B,MAAMC,GAA8B,gBAGpC,IAAIC,IAAe,EAIfC,IAAW,EAGXC,GAAe,GAGfC,GAAkB,KACtB,MAAMC,GAA0BhI,SAAS,GAAI,CAC3C,iBACA,QACA,WACA,OACA,gBACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,QACA,UACA,WACA,WACA,YACA,SACA,QACA,MACA,WACA,QACA,QACA,QACA,QAIF,IAAIiI,GAAgB,KACpB,MAAMC,GAAwBlI,SAAS,GAAI,CACzC,QACA,QACA,MACA,SACA,QACA,UAIF,IAAImI,GAAsB,KAC1B,MAAMC,GAA8BpI,SAAS,GAAI,CAC/C,MACA,QACA,MACA,KACA,QACA,OACA,UACA,cACA,OACA,UACA,QACA,QACA,QACA,UAGIqI,GAAmB,qCACnBC,GAAgB,6BAChBC,GAAiB,+BAEvB,IAAIC,GAAYD,GACZE,IAAiB,EAGjBC,GAAqB,KACzB,MAAMC,GAA6B3I,SACjC,GACA,CAACqI,GAAkBC,GAAeC,IAClCjK,GAIF,IAAIsK,GAAoB,KACxB,MAAMC,GAA+B,CAAC,wBAAyB,aACzDC,GAA4B,YAClC,IAAI3I,GAAoB,KAGpB4I,GAAS,KAKb,MAAMC,GAAclF,EAASoB,cAAc,QAErC+D,GAAoB,SAApBA,kBAA8BC,GAClC,OAAOA,aAAqB/J,QAAU+J,aAAqBC,UASvDC,GAAe,SAAfA,eAAmC,IAAVC,EAAG5J,UAAAC,OAAA,QAAAU,IAAAX,UAAA,GAAAA,UAAA,GAAG,GACnC,IAAIsJ,IAAUA,KAAWM,EAAzB,CAuLA,GAlLKA,GAAsB,iBAARA,IACjBA,EAAM,IAIRA,EAAM3I,MAAM2I,GAEZT,IAEmE,IAAjEC,GAA6BhK,QAAQwK,EAAIT,mBACrCE,GACAO,EAAIT,kBAGVzI,GACwB,0BAAtByI,GACItK,EACAH,EAGN4H,GAAe/G,EAAqBqK,EAAK,gBACrCrJ,SAAS,GAAIqJ,EAAItD,aAAc5F,IAC/B6F,GACJE,GAAelH,EAAqBqK,EAAK,gBACrCrJ,SAAS,GAAIqJ,EAAInD,aAAc/F,IAC/BgG,GACJuC,GAAqB1J,EAAqBqK,EAAK,sBAC3CrJ,SAAS,GAAIqJ,EAAIX,mBAAoBpK,GACrCqK,GACJR,GAAsBnJ,EAAqBqK,EAAK,qBAC5CrJ,SACEU,MAAM0H,IACNiB,EAAIC,kBACJnJ,IAEFiI,GACJH,GAAgBjJ,EAAqBqK,EAAK,qBACtCrJ,SACEU,MAAMwH,IACNmB,EAAIE,kBACJpJ,IAEF+H,GACJH,GAAkB/I,EAAqBqK,EAAK,mBACxCrJ,SAAS,GAAIqJ,EAAItB,gBAAiB5H,IAClC6H,GACJpB,GAAc5H,EAAqBqK,EAAK,eACpCrJ,SAAS,GAAIqJ,EAAIzC,YAAazG,IAC9B,GACJ0G,GAAc7H,EAAqBqK,EAAK,eACpCrJ,SAAS,GAAIqJ,EAAIxC,YAAa1G,IAC9B,GACJ2H,KAAe9I,EAAqBqK,EAAK,iBACrCA,EAAIvB,aAERhB,IAA0C,IAAxBuC,EAAIvC,gBACtBC,IAA0C,IAAxBsC,EAAItC,gBACtBC,GAA0BqC,EAAIrC,0BAA2B,EACzDC,IAA4D,IAAjCoC,EAAIpC,yBAC/BC,GAAqBmC,EAAInC,qBAAsB,EAC/CC,GAAiBkC,EAAIlC,iBAAkB,EACvCG,GAAa+B,EAAI/B,aAAc,EAC/BC,GAAsB8B,EAAI9B,sBAAuB,EACjDC,GAAsB6B,EAAI7B,sBAAuB,EACjDH,GAAagC,EAAIhC,aAAc,EAC/BI,IAAoC,IAArB4B,EAAI5B,aACnBC,GAAuB2B,EAAI3B,uBAAwB,EACnDE,IAAoC,IAArByB,EAAIzB,aACnBC,GAAWwB,EAAIxB,WAAY,EAC3B1F,GAAiBkH,EAAIG,oBAAsB1D,EAC3C0C,GAAYa,EAAIb,WAAaD,GAC7BlC,GAA0BgD,EAAIhD,yBAA2B,GAEvDgD,EAAIhD,yBACJ4C,GAAkBI,EAAIhD,wBAAwBC,gBAE9CD,GAAwBC,aACtB+C,EAAIhD,wBAAwBC,cAI9B+C,EAAIhD,yBACJ4C,GAAkBI,EAAIhD,wBAAwBK,sBAE9CL,GAAwBK,mBACtB2C,EAAIhD,wBAAwBK,oBAI9B2C,EAAIhD,yBAEF,kBADKgD,EAAIhD,wBAAwBM,iCAGnCN,GAAwBM,+BACtB0C,EAAIhD,wBAAwBM,gCAG5BO,KACFH,IAAkB,GAGhBQ,KACFD,IAAa,GAIXQ,KACF/B,GAAe/F,SAAS,GAAIiG,GAC5BC,GAAe,IACW,IAAtB4B,GAAaxG,OACftB,SAAS+F,GAAcE,GACvBjG,SAASkG,GAAcE,KAGA,IAArB0B,GAAavG,MACfvB,SAAS+F,GAAcE,GACvBjG,SAASkG,GAAcE,GACvBpG,SAASkG,GAAcE,KAGO,IAA5B0B,GAAatG,aACfxB,SAAS+F,GAAcE,GACvBjG,SAASkG,GAAcE,GACvBpG,SAASkG,GAAcE,KAGG,IAAxB0B,GAAapG,SACf1B,SAAS+F,GAAcE,GACvBjG,SAASkG,GAAcE,GACvBpG,SAASkG,GAAcE,KAKvBiD,EAAII,WACF1D,KAAiBC,KACnBD,GAAerF,MAAMqF,KAGvB/F,SAAS+F,GAAcsD,EAAII,SAAUtJ,KAGnCkJ,EAAIK,WACFxD,KAAiBC,KACnBD,GAAexF,MAAMwF,KAGvBlG,SAASkG,GAAcmD,EAAIK,SAAUvJ,KAGnCkJ,EAAIC,mBACNtJ,SAASmI,GAAqBkB,EAAIC,kBAAmBnJ,IAGnDkJ,EAAItB,kBACFA,KAAoBC,KACtBD,GAAkBrH,MAAMqH,KAG1B/H,SAAS+H,GAAiBsB,EAAItB,gBAAiB5H,KAI7CyH,KACF7B,GAAa,UAAW,GAItBoB,IACFnH,SAAS+F,GAAc,CAAC,OAAQ,OAAQ,SAItCA,GAAa4D,QACf3J,SAAS+F,GAAc,CAAC,iBACjBa,GAAYgD,OAGjBP,EAAIQ,qBAAsB,CAC5B,GAAmD,mBAAxCR,EAAIQ,qBAAqB3G,WAClC,MAAM7D,EACJ,+EAIJ,GAAwD,mBAA7CgK,EAAIQ,qBAAqB1G,gBAClC,MAAM9D,EACJ,oFAKJgG,EAAqBgE,EAAIQ,qBAGzBvE,EAAYD,EAAmBnC,WAAW,cAGf9C,IAAvBiF,IACFA,EAAqB5C,EACnBC,EACAwB,IAKuB,OAAvBmB,GAAoD,iBAAdC,IACxCA,EAAYD,EAAmBnC,WAAW,KAM1CnG,GACFA,EAAOsM,GAGTN,GAASM,IAGLS,GAAiC9J,SAAS,GAAI,CAClD,KACA,KACA,KACA,KACA,UAGI+J,GAA0B/J,SAAS,GAAI,CAC3C,gBACA,OACA,QACA,mBAOIgK,GAA+BhK,SAAS,GAAI,CAChD,QACA,QACA,OACA,IACA,WAMIiK,GAAejK,SAAS,GAAI,IAC7BiG,KACAA,KACAA,IAECiE,GAAkBlK,SAAS,GAAI,IAChCiG,KACAA,IASCkE,GAAuB,SAAvBA,qBAAiC7J,GACrC,IAAI8J,EAASpF,EAAc1E,GAItB8J,GAAWA,EAAOC,UACrBD,EAAS,CACPE,aAAc9B,GACd6B,QAAS,aAIb,MAAMA,EAAUlM,EAAkBmC,EAAQ+J,SACpCE,EAAgBpM,EAAkBiM,EAAOC,SAE/C,QAAK3B,GAAmBpI,EAAQgK,gBAI5BhK,EAAQgK,eAAiBhC,GAIvB8B,EAAOE,eAAiB/B,GACP,QAAZ8B,EAMLD,EAAOE,eAAiBjC,GAEZ,QAAZgC,IACmB,mBAAlBE,GACCT,GAA+BS,IAM9BC,QAAQP,GAAaI,IAG1B/J,EAAQgK,eAAiBjC,GAIvB+B,EAAOE,eAAiB/B,GACP,SAAZ8B,EAKLD,EAAOE,eAAiBhC,GACP,SAAZ+B,GAAsBN,GAAwBQ,GAKhDC,QAAQN,GAAgBG,IAG7B/J,EAAQgK,eAAiB/B,KAKzB6B,EAAOE,eAAiBhC,KACvByB,GAAwBQ,QAMzBH,EAAOE,eAAiBjC,KACvByB,GAA+BS,OAQ/BL,GAAgBG,KAChBL,GAA6BK,KAAaJ,GAAaI,QAMpC,0BAAtBzB,KACAF,GAAmBpI,EAAQgK,iBAiBzBG,GAAe,SAAfA,aAAyBC,GAC7BzM,EAAUwF,UAAUI,QAAS,CAAEvD,QAASoK,IAExC,IAEEA,EAAKC,WAAWC,YAAYF,GAC5B,MAAOrH,GACPqH,EAAKG,WAUHC,GAAmB,SAAnBA,iBAA6BC,EAAML,GACvC,IACEzM,EAAUwF,UAAUI,QAAS,CAC3BmH,UAAWN,EAAKO,iBAAiBF,GACjCG,KAAMR,IAER,MAAOrH,GACPpF,EAAUwF,UAAUI,QAAS,CAC3BmH,UAAW,KACXE,KAAMR,IAOV,GAHAA,EAAKS,gBAAgBJ,GAGR,OAATA,IAAkB7E,GAAa6E,GACjC,GAAIzD,IAAcC,GAChB,IACEkD,GAAaC,GACb,MAAOrH,SAET,IACEqH,EAAKU,aAAaL,EAAM,IACxB,MAAO1H,MAWTgI,GAAgB,SAAhBA,cAA0BC,GAE9B,IAAIC,EAAM,KACNC,EAAoB,KAExB,GAAInE,GACFiE,EAAQ,oBAAsBA,MACzB,CAEL,MAAMG,EAAUjN,EAAY8M,EAAO,eACnCE,EAAoBC,GAAWA,EAAQ,GAIjB,0BAAtB7C,IACAJ,KAAcD,KAGd+C,EACE,iEACAA,EACA,kBAGJ,MAAMI,EAAerG,EACjBA,EAAmBnC,WAAWoI,GAC9BA,EAKJ,GAAI9C,KAAcD,GAChB,IACEgD,GAAM,IAAI5G,GAAYgH,gBAAgBD,EAAc9C,IACpD,MAAOvF,IAIX,IAAKkI,IAAQA,EAAIK,gBAAiB,CAChCL,EAAMhG,EAAesG,eAAerD,GAAW,WAAY,MAC3D,IACE+C,EAAIK,gBAAgBE,UAAYrD,GAC5BnD,EACAoG,EACJ,MAAOrI,KAKX,MAAM0I,EAAOR,EAAIQ,MAAQR,EAAIK,gBAU7B,OARIN,GAASE,GACXO,EAAKC,aACHlI,EAASmI,eAAeT,GACxBO,EAAKG,WAAW,IAAM,MAKtB1D,KAAcD,GACT7C,GAAqByG,KAC1BZ,EACApE,GAAiB,OAAS,QAC1B,GAGGA,GAAiBoE,EAAIK,gBAAkBG,GAS1CK,GAAsB,SAAtBA,oBAAgC1I,GACpC,OAAO8B,EAAmB2G,KACxBzI,EAAK0B,eAAiB1B,EACtBA,EAEAa,EAAW8H,aAAe9H,EAAW+H,aAAe/H,EAAWgI,UAC/D,OAUEC,GAAe,SAAfA,aAAyBC,GAC7B,OACEA,aAAe/H,IACU,iBAAjB+H,EAAIC,UACiB,iBAApBD,EAAIE,aACgB,mBAApBF,EAAI7B,eACT6B,EAAIG,sBAAsBpI,IACG,mBAAxBiI,EAAItB,iBACiB,mBAArBsB,EAAIrB,cACiB,iBAArBqB,EAAInC,cACiB,mBAArBmC,EAAIT,cACkB,mBAAtBS,EAAII,gBAUXC,GAAU,SAAVA,QAAoBnM,GACxB,MAAuB,mBAAT0D,GAAuB1D,aAAkB0D,GAWnD0I,GAAe,SAAfA,aAAyBC,EAAYC,EAAaC,GACjDtH,GAAMoH,IAIXtP,EAAakI,GAAMoH,IAAcG,IAC/BA,EAAKhB,KAAK1I,UAAWwJ,EAAaC,EAAMnE,QActCqE,GAAoB,SAApBA,kBAA8BH,GAClC,IAAI9H,EAAU,KAMd,GAHA4H,GAAa,yBAA0BE,EAAa,MAGhDT,GAAaS,GAEf,OADAxC,GAAawC,IACN,EAIT,MAAM5C,EAAUlK,GAAkB8M,EAAYP,UAS9C,GANAK,GAAa,sBAAuBE,EAAa,CAC/C5C,QAAAA,EACAgD,YAAatH,KAKbkH,EAAYJ,kBACXC,GAAQG,EAAYK,oBACrBpO,EAAW,UAAW+N,EAAYnB,YAClC5M,EAAW,UAAW+N,EAAYN,aAGlC,OADAlC,GAAawC,IACN,EAIT,IAAKlH,GAAasE,IAAYzD,GAAYyD,GAAU,CAElD,IAAKzD,GAAYyD,IAAYkD,GAAsBlD,GAAU,CAC3D,GACEhE,GAAwBC,wBAAwBnH,QAChDD,EAAWmH,GAAwBC,aAAc+D,GAEjD,OAAO,EAGT,GACEhE,GAAwBC,wBAAwB6C,UAChD9C,GAAwBC,aAAa+D,GAErC,OAAO,EAKX,GAAIzC,KAAiBG,GAAgBsC,GAAU,CAC7C,MAAMM,EAAa3F,EAAciI,IAAgBA,EAAYtC,WACvDuB,EAAanH,EAAckI,IAAgBA,EAAYf,WAE7D,GAAIA,GAAcvB,EAAY,CAG5B,IAAK,IAAI6C,EAFUtB,EAAWxM,OAEJ,EAAG8N,GAAK,IAAKA,EACrC7C,EAAWqB,aACTnH,EAAUqH,EAAWsB,IAAI,GACzB1I,EAAemI,KAOvB,OADAxC,GAAawC,IACN,EAIT,OAAIA,aAAuB3I,IAAY6F,GAAqB8C,IAC1DxC,GAAawC,IACN,GAKM,aAAZ5C,GACa,YAAZA,GACY,aAAZA,IACFnL,EAAW,8BAA+B+N,EAAYnB,YAOpD5E,IAA+C,IAAzB+F,EAAYlJ,WAEpCoB,EAAU8H,EAAYN,YAEtBjP,EAAa,CAACoE,GAAeC,GAAUC,KAAeyL,IACpDtI,EAAUzG,EAAcyG,EAASsI,EAAM,QAGrCR,EAAYN,cAAgBxH,IAC9BlH,EAAUwF,UAAUI,QAAS,CAAEvD,QAAS2M,EAAYpI,cACpDoI,EAAYN,YAAcxH,IAK9B4H,GAAa,wBAAyBE,EAAa,OAE5C,IAtBLxC,GAAawC,IACN,IAiCLS,GAAoB,SAApBA,kBAA8BC,EAAOC,EAAQ9M,GAEjD,GACE2G,KACY,OAAXmG,GAA8B,SAAXA,KACnB9M,KAASgD,GAAYhD,KAASkI,IAE/B,OAAO,EAOT,GACEjC,KACCF,GAAY+G,IACb1O,EAAW+C,GAAW2L,SAGjB,GAAI9G,IAAmB5H,EAAWgD,GAAW0L,SAG7C,IAAK1H,GAAa0H,IAAW/G,GAAY+G,IAC9C,KAIGL,GAAsBI,KACnBtH,GAAwBC,wBAAwBnH,QAChDD,EAAWmH,GAAwBC,aAAcqH,IAChDtH,GAAwBC,wBAAwB6C,UAC/C9C,GAAwBC,aAAaqH,MACvCtH,GAAwBK,8BAA8BvH,QACtDD,EAAWmH,GAAwBK,mBAAoBkH,IACtDvH,GAAwBK,8BAA8ByC,UACrD9C,GAAwBK,mBAAmBkH,KAGrC,OAAXA,GACCvH,GAAwBM,iCACtBN,GAAwBC,wBAAwBnH,QAChDD,EAAWmH,GAAwBC,aAAcxF,IAChDuF,GAAwBC,wBAAwB6C,UAC/C9C,GAAwBC,aAAaxF,KAK3C,OAAO,OAGJ,GAAIqH,GAAoByF,SAIxB,GACL1O,EAAWiD,GAAgBzD,EAAcoC,EAAOuB,GAAiB,WAK5D,GACO,QAAXuL,GAA+B,eAAXA,GAAsC,SAAXA,GACtC,WAAVD,GACkC,IAAlC/O,EAAckC,EAAO,WACrBmH,GAAc0F,IAMT,GACL3G,KACC9H,EAAWkD,GAAmB1D,EAAcoC,EAAOuB,GAAiB,WAIhE,GAAIvB,EACT,OAAO,OAMT,OAAO,GAWHyM,GAAwB,SAAxBA,sBAAkClD,GACtC,MAAmB,mBAAZA,GAAgCA,EAAQxL,QAAQ,KAAO,GAa1DgP,GAAsB,SAAtBA,oBAAgCZ,GAEpCF,GAAa,2BAA4BE,EAAa,MAEtD,MAAML,WAAEA,GAAeK,EAGvB,IAAKL,EACH,OAGF,MAAMkB,EAAY,CAChBC,SAAU,GACVC,UAAW,GACXC,UAAU,EACVC,kBAAmBhI,IAErB,IAAI7F,EAAIuM,EAAWlN,OAGnB,KAAOW,KAAK,CACV,MAAM8N,EAAOvB,EAAWvM,IAClB0K,KAAEA,EAAIT,aAAEA,EAAcxJ,MAAOkN,GAAcG,EAC3CP,EAASzN,GAAkB4K,GAEjC,IAAIjK,EAAiB,UAATiK,EAAmBiD,EAAYlP,EAAWkP,GAUtD,GAPAF,EAAUC,SAAWH,EACrBE,EAAUE,UAAYlN,EACtBgN,EAAUG,UAAW,EACrBH,EAAUM,mBAAgBhO,EAC1B2M,GAAa,wBAAyBE,EAAaa,GACnDhN,EAAQgN,EAAUE,UAEdF,EAAUM,cACZ,SAOF,GAHAtD,GAAiBC,EAAMkC,IAGlBa,EAAUG,SACb,SAIF,IAAKhH,IAA4B/H,EAAW,OAAQ4B,GAAQ,CAC1DgK,GAAiBC,EAAMkC,GACvB,SAIE/F,IACFxJ,EAAa,CAACoE,GAAeC,GAAUC,KAAeyL,IACpD3M,EAAQpC,EAAcoC,EAAO2M,EAAM,QAKvC,MAAME,EAAQxN,GAAkB8M,EAAYP,UAC5C,GAAKgB,GAAkBC,EAAOC,EAAQ9M,GAAtC,CAgBA,IATI4G,IAAoC,OAAXkG,GAA8B,SAAXA,IAE9C9C,GAAiBC,EAAMkC,GAGvBnM,EAAQ6G,GAA8B7G,GAKtCuE,GACwB,iBAAjB3C,GACkC,mBAAlCA,EAAa2L,iBAEpB,GAAI/D,QAGF,OAAQ5H,EAAa2L,iBAAiBV,EAAOC,IAC3C,IAAK,cACH9M,EAAQuE,EAAmBnC,WAAWpC,GACtC,MAGF,IAAK,mBACHA,EAAQuE,EAAmBlC,gBAAgBrC,GAYnD,IACMwJ,EACF2C,EAAYqB,eAAehE,EAAcS,EAAMjK,GAG/CmM,EAAY7B,aAAaL,EAAMjK,GAGjC/C,EAAS0F,UAAUI,SACnB,MAAOR,MAIX0J,GAAa,0BAA2BE,EAAa,OAQjDsB,GAAqB,SAArBA,mBAA+BC,GACnC,IAAIC,EAAa,KACjB,MAAMC,EAAiBtC,GAAoBoC,GAK3C,IAFAzB,GAAa,0BAA2ByB,EAAU,MAE1CC,EAAaC,EAAeC,YAElC5B,GAAa,yBAA0B0B,EAAY,MAG/CrB,GAAkBqB,KAKlBA,EAAWtJ,mBAAmBhB,GAChCoK,mBAAmBE,EAAWtJ,SAIhC0I,GAAoBY,IAItB1B,GAAa,yBAA0ByB,EAAU,OAoRnD,OAzQA/K,UAAUmL,SAAW,SAAUtD,GAAiB,IAAVjC,EAAG5J,UAAAC,OAAA,QAAAU,IAAAX,UAAA,GAAAA,UAAA,GAAG,GACtCsM,EAAO,KACP8C,EAAe,KACf5B,EAAc,KACd6B,EAAa,KAUjB,GANArG,IAAkB6C,EACd7C,KACF6C,EAAQ,eAIW,iBAAVA,IAAuBwB,GAAQxB,GAAQ,CAChD,GAA8B,mBAAnBA,EAAM/M,SAMf,MAAMc,EAAgB,8BAJtB,GAAqB,iBADrBiM,EAAQA,EAAM/M,YAEZ,MAAMc,EAAgB,mCAQ5B,IAAKoE,UAAUO,YACb,OAAOsH,EAgBT,GAZKlE,IACHgC,GAAaC,GAIf5F,UAAUI,QAAU,GAGC,iBAAVyH,IACTzD,IAAW,GAGTA,IAEF,GAAIyD,EAAMoB,SAAU,CAClB,MAAMrC,EAAUlK,GAAkBmL,EAAMoB,UACxC,IAAK3G,GAAasE,IAAYzD,GAAYyD,GACxC,MAAMhL,EACJ,iEAID,GAAIiM,aAAiBjH,EAG1B0H,EAAOV,GAAc,iBACrBwD,EAAe9C,EAAK3G,cAAcO,WAAW2F,GAAO,GACtB,IAA1BuD,EAAa9K,UAA4C,SAA1B8K,EAAanC,UAGX,SAA1BmC,EAAanC,SADtBX,EAAO8C,EAKP9C,EAAKgD,YAAYF,OAEd,CAEL,IACGvH,KACAJ,KACAC,KAEuB,IAAxBmE,EAAMzM,QAAQ,KAEd,OAAOwG,GAAsBmC,GACzBnC,EAAmBnC,WAAWoI,GAC9BA,EAON,GAHAS,EAAOV,GAAcC,IAGhBS,EACH,OAAOzE,GAAa,KAAOE,GAAsBlC,EAAY,GAK7DyG,GAAQ1E,IACVoD,GAAasB,EAAKiD,YAIpB,MAAMC,EAAe7C,GAAoBvE,GAAWyD,EAAQS,GAG5D,KAAQkB,EAAcgC,EAAaN,YAE7BvB,GAAkBH,KAKlBA,EAAY9H,mBAAmBhB,GACjCoK,GAAmBtB,EAAY9H,SAIjC0I,GAAoBZ,IAItB,GAAIpF,GACF,OAAOyD,EAIT,GAAIhE,GAAY,CACd,GAAIC,GAGF,IAFAuH,EAAarJ,GAAuB0G,KAAKJ,EAAK3G,eAEvC2G,EAAKiD,YAEVF,EAAWC,YAAYhD,EAAKiD,iBAG9BF,EAAa/C,EAcf,OAXI7F,GAAagJ,YAAchJ,GAAaiJ,kBAQ1CL,EAAanJ,GAAWwG,KAAKlI,EAAkB6K,GAAY,IAGtDA,EAGT,IAAIM,EAAiBjI,GAAiB4E,EAAKsD,UAAYtD,EAAKD,UAsB5D,OAlBE3E,IACApB,GAAa,aACbgG,EAAK3G,eACL2G,EAAK3G,cAAckK,SACnBvD,EAAK3G,cAAckK,QAAQvE,MAC3B7L,EAAW4G,EAA0BiG,EAAK3G,cAAckK,QAAQvE,QAEhEqE,EACE,aAAerD,EAAK3G,cAAckK,QAAQvE,KAAO,MAAQqE,GAIzDlI,IACFxJ,EAAa,CAACoE,GAAeC,GAAUC,KAAeyL,IACpD2B,EAAiB1Q,EAAc0Q,EAAgB3B,EAAM,QAIlDpI,GAAsBmC,GACzBnC,EAAmBnC,WAAWkM,GAC9BA,GASN3L,UAAU8L,UAAY,WAAoB,IAAVlG,EAAG5J,UAAAC,OAAA,QAAAU,IAAAX,UAAA,GAAAA,UAAA,GAAG,GACpC2J,GAAaC,GACbjC,IAAa,GAQf3D,UAAU+L,YAAc,WACtBzG,GAAS,KACT3B,IAAa,GAaf3D,UAAUgM,iBAAmB,SAAUC,EAAKvB,EAAMrN,GAE3CiI,IACHK,GAAa,IAGf,MAAMuE,EAAQxN,GAAkBuP,GAC1B9B,EAASzN,GAAkBgO,GACjC,OAAOT,GAAkBC,EAAOC,EAAQ9M,IAU1C2C,UAAUkM,QAAU,SAAU3C,EAAY4C,GACZ,mBAAjBA,IAIXhK,GAAMoH,GAAcpH,GAAMoH,IAAe,GACzC/O,EAAU2H,GAAMoH,GAAa4C,KAW/BnM,UAAUoM,WAAa,SAAU7C,GAC/B,GAAIpH,GAAMoH,GACR,OAAOjP,EAAS6H,GAAMoH,KAU1BvJ,UAAUqM,YAAc,SAAU9C,GAC5BpH,GAAMoH,KACRpH,GAAMoH,GAAc,KAQxBvJ,UAAUsM,eAAiB,WACzBnK,GAAQ,IAGHnC,UAGMD,GC9jDR,SAASlD,QAAQyK,WAEnBiF,EAAWlM,SAASoB,cAAc6F,sBAFNvN,mCAAAA,kCAGhBA,iBAChB,KADSyS,OAEY,iBAATA,GACVD,EAASjB,YAAYjL,SAASmI,eAAegE,QAC1CC,EAAQD,aAAeE,IACvBC,EAAWC,EAAIC,UAAUL,MACzBC,GAASE,EACb,CACKA,IACHH,EAAMnT,OAAOL,QAAQwT,uCACIA,kCAC1B,iCADUlF,OAAMjK,OAED,OAAVA,GACHkP,EAAS5E,aAAaL,EAAMjK,2CAIzBkP,EAIR,SAASO,qBAAqBC,EAAWzF,EAAMjK,MAE1CuP,EAAII,QAAQ3P,GAChB,oCACeA,mCACbyP,qBAAqBC,EAAWzF,+CAEP,iBAAXjK,EACf0P,EAAUE,OAAO3F,EAAMjK,GACL,OAAVA,GACR0P,EAAUE,OAAO3F,EAAMsF,EAAIM,KAAK7P,IAG3B,SAAS8P,gBAAgBC,WAE3BL,EAAY,IAAIM,mCAFmBC,mCAAAA,kCAIrBA,iBAClB,KADSC,UAEJX,EAAII,QAAQO,IAA0B,GAAhBA,EAAMtR,OAE/B6Q,mCAAqBC,6BAAcQ,UAE/B,GAA8C,oBAA1ClU,OAAOe,UAAUU,SAAS4N,KAAK6E,IAAkCA,aAAiBX,EAAIY,OAK1F,GAAc,OAAVD,GAAoC,WAAlBE,QAAOF,IAAmD,WAA5BE,QAAOF,EAAMG,YAA2BH,EAAMG,YAAchB,IAAItS,UACzH,oCAC2BmT,mEAAhBjG,OAAMjK,OACfyP,qBAAqBC,EAAWzF,EAAMjK,6CANlC,IAAIiK,KAAQiG,EAChBT,qBAAqBC,EAAWzF,EAAMiG,EAAMjG,WAQ/CyF,EAAYA,EAAUjS,WAAWI,QAAQ,IAAK,QAChCe,OAAS,IACtBmR,GAAO,IAAML,GACPK,MAcKO,uEAEAC,4DAGNA,GAAKA,iDAGX,sBAEQC,KAAKD,4BAGb,mBAAUE,OAEJ,IAAI/D,EAAI,EAAGA,EAAI8D,KAAKE,YAAY9R,SAAU8N,EAC9C+D,EAAQE,KAAKH,KAAKI,eAAeJ,KAAKE,YAAYhE,mCAGpD,wBAAezC,UAEPuG,KAAKvG,4BAGb,mBAAU4G,WAELnE,EAAI,EACCoE,EAAOD,EAAQE,iBAAmBrE,EAC3C,KACKsE,EAAWF,EAAKG,UAChBD,EAASE,KACZ,MACGxE,EAAI8D,KAAKE,YAAY9R,QACxB4R,KAAKW,eAAeX,KAAKE,YAAYhE,GAAIsE,EAAShR,YAE7C0M,EAAI8D,KAAKE,YAAY9R,SAAU8N,OAChC0E,qBAAqBZ,KAAKE,YAAYhE,kCAG7C,wBAAezC,EAAMjK,QAEfiK,GAAQjK,sCAGd,8BAAqBiK,QAEfA,GAAQ,YAGbsF,EAAI8B,QAAQC,cAAb,eAAsBrH,MAEjBuG,KAAKe,UAAUC,IAAIvH,GACvB,KACKjK,MAAQwQ,KAAKvG,MACK,mBAAXjK,MACX,KACKyR,EAAYzR,MAAM0R,KAAKlB,aAC3BiB,EAAUE,UAAY3R,MAAM2R,WAAa3R,MAAMiK,KAC/CwH,EAAUG,eAAiB5R,MAAM4R,eACjCH,EAAUI,iBAAmB7R,MAAM6R,iBACnCJ,EAAUK,kBAAoB9R,MAAM8R,kBAC7BL,SAEDzR,MAEH,GAAIiK,EAAK8H,WAAW,aAEjBvB,KAAKrS,eAAe8L,GAAQuG,KAAKvG,GAAQ,WAE3C,IAAIsF,EAAIyC,eAAexB,KAAMvG,UAGnCsF,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,OAEvBiK,EAAK8H,WAAW,MAKnB,MAAM,IAAIxC,EAAIyC,eAAexB,KAAMvG,QAH9BA,GAAQjK,SAOduP,EAAI8B,QAAQa,WAAb,uBAEQ,IAAM1B,KAAKtQ,YAAY+J,KAAO,4BAGtC,2BAEQuG,KAAKjB,EAAI8B,QAAQa,kBA1FA3C,EAAIY,OA+FjBgC,6GAEZ,cAAKC,0BAIL,iBAAOA,mBAcJC,EAAc,6NANjB,uBAAcC,UAENA,aAAeC,mBAJEhD,EAAIiD,MAQZ,CAAgB,KAAM,UAAW,sBAGtCD,gFAEAhC,6DAELA,IACD1N,QAAU,OACV4P,SAAW,OACXC,SAAW,OACXC,KAAO,OACPC,KAAO,OACPC,YAAc,OACdC,IAAM,OACNV,OAAS,OACTW,KAAO,OACPC,aAAe,OACfC,mBAAqB,OACrBC,cAAgB,OAChBC,iBAAmB,OACnBC,kBAAoB,OACpBC,QAAU,IAAIlB,IACdmB,WAAa,KACbC,aAAe,yCAGpBhE,EAAI8B,QAAQmC,WAAb,wBAEQnB,sBAIR,cAAKoB,EAAMC,OAENC,EAAQ,SAASA,MAAMpX,UAAIA,EAAIqX,KAAKC,IAAItX,IAAaA,GACrDuX,EAAQ,SAASC,MAAMxX,UAAIA,EAAIqX,KAAKI,IAAIzX,IAAaA,GACnD0X,EAAUL,KAAKM,GAAG,IAElBC,EAAO,EAAE,cAETC,EAAOX,EAAKY,IAAMJ,EAClBK,EAAQb,OAAYQ,EACpBM,EAAOb,EAAKW,IAAMJ,EAElBO,GAAKJ,EAAOG,GAAM,EAClBE,GAAKL,EAAOG,GAAM,EAClBhV,GAAK+U,EAHGZ,OAAYO,GAGA,EACpBS,EAAIf,EAAMc,GAAKX,EAAMvU,GAAKuU,EAAMU,GAAKb,EAAMpU,GAC3CoV,EAAIb,EAAMW,GAAKX,EAAMvU,GAAKoU,EAAMa,GAAKb,EAAMpU,GAC3CqV,EAAIhB,KAAKiB,KAAKjB,KAAKkB,KAAKJ,EAAEC,IAC1BI,EAAI,EAAIH,EAbC,YAcL,IAANG,SAEIA,MACFC,EAAIpB,KAAKkB,KAAKJ,EAAEC,GAAGC,EAEnBK,GAAM,EAAED,EAAE,IAAI,EAAEN,UACZK,GAAK,EAAIZ,IAFP,EAAEa,EAAE,IAAI,EAAEL,IAEShB,EAAMa,GAAKV,EAAMW,GAAKN,EAAOc,EAAKnB,EAAMU,GAAKb,EAAMc,8BAInF,oBAAWS,EAAOC,EAAOC,OAAQ5B,yDAAK,OAAQ6B,6DAAcC,yDAAQ,KAAMC,yDAAQ,KAAMC,yDAAO,KAAMC,yDAAK,KAAMC,yDAAQ,KAAMC,4DAAO,KAAMC,gEAEtIC,EAAW,KAEXX,aAAiBY,KAEpBZ,EAAQ,WAAa1E,KAAKiC,SAAWyC,EAAMa,aAC3CF,EAAWG,mBAAmBd,EAAMW,YACpBX,EAAMW,WACrBA,EAAW,WAGTI,EAAS,UAGZA,GADGL,EACO,0BAEA,qBAEE,QAATpC,IACHyC,GAAU,OAASzC,GAEhB2B,MAAAA,IACHc,GAAU,MAAQd,GAEfC,MAAAA,IACHa,GAAU,MAAQb,GAEfC,IACHY,GAAU,SAEPX,MAAAA,IACHW,GAAU,MAAQX,GAEfC,MAAAA,IACHU,GAAU,MAAQV,GAEJ,OAAXC,GAAmBA,EAAS,KAAO,IACtCS,GAAU,QAAUC,SAEjBT,MAAAA,IACHQ,GAAU,OAASR,GAEhBC,MAAAA,IACHO,GAAU,OAASP,GAEhBC,MAAAA,IACHM,GAAU,MAAQN,GAEfE,MAAAA,IACHI,GAAU,OAASJ,GAEpBI,GAAU,UAAYD,mBAAmBd,UAKzC3F,EAAI8B,QAAQa,WAAb,uBAEQ,oBAAsB3C,EAAI4G,MAAM3F,KAAK3N,SAAW,SAAW0M,EAAI4G,MAAM3F,KAAKuC,MAAQ,+BAG1F,8BAEQvC,KAAK+C,4CAGb,yBAAgB6C,QAEV7C,aAAe,IAAI8C,GAAI7F,KAAM4F,EAASE,OAAOC,SAAUH,EAASE,OAAOE,mCAG7E,2BAEsB,OAAdhG,KAAKuC,MAAiBvC,KAAKuC,KAAKhB,WAAW,iCAGnD,kBAAS/R,UAEAA,QAEF,SACGwQ,KAAKiG,qBACR,SACGjG,KAAKkG,gCAEL,mCAIV,uBAAc1W,UAELwQ,KAAKoC,UAEP,WACG,mBAEA,qCAIV,wBAAe5S,UAENwQ,KAAKoC,UAEP,WACG,qBAEA,mCAIV,gCAESpC,KAAKoC,UAEP,WACG,wCAEA,yDAIV,uCAESpC,KAAKoC,UAEP,WACG,oCAEA,uDAIV,2BAAkB+D,UAEVA,EACLC,KAAI,SAAAC,SAAmB,iBAAPA,EAAkBtH,EAAI4G,MAAMU,GAAKA,KACjDC,KAAK,kCAIR,uBAAcC,QAERzD,WAAWlW,KAAK,CAAC2Z,OAAQA,EAAQC,QAAQ,+BAG/C,uBAEKxG,KAAK8C,aAEJ9C,KAAK8C,WAAW9C,KAAK8C,WAAW1U,OAAO,GAAGoY,QAAUxU,SAAWA,QAAQyU,UAC1EzU,QAAQyU,gBACJ3D,WAAWpW,oCAIlB,uBAAc6Z,EAAQG,QAEhBC,cAAcJ,OAGlBG,iBAIKE,iDAIP,iEAEmB5G,KAAK8C,2CACvB,KADS+D,UAEHA,EAAML,SAENxU,SAAWA,QAAQ8U,OACtB9U,QAAQ8U,MAAMD,EAAMN,QACrBM,EAAML,QAAS,4DAKlB,0BAEMO,gDAFOC,2BAAAA,kBAGRhV,SAAWA,QAAQiV,OACtBjV,QAAQiV,MAAMjH,KAAKkH,kBAAkBF,4BAGvC,yBAEMD,gDAFMC,2BAAAA,kBAGPhV,SAAWA,QAAQmV,MACtBnV,QAAQmV,KAAKnH,KAAKkH,kBAAkBF,+BAGtC,4BAEMD,gDAFSC,2BAAAA,kBAGVhV,SAAWA,QAAQC,MACtBD,QAAQC,KAAK+N,KAAKkH,kBAAkBF,6BAGtC,0BAEMD,gDAFOC,2BAAAA,kBAGRhV,SAAWA,QAAQoV,OACtBpV,QAAQoV,MAAMpH,KAAKkH,kBAAkBF,+BAGvC,6BAEQ,wCAGR,8BAEQ,8DAGR,6BAEQ,6CAGR,2BAEQ,wCAGR,6BAEQ,+CAGR,6BAEQ,yCAGR,4BAEQ,6CA9SoBlH,GAkT7BiC,EAAQxV,UAAU2T,YAAc,CAAC,UAAW,WAAY,OAAQ,eAAgB,qBAAsB,OAAQ,cAAe,WAAY,MAAO,SAAU,OAAQ,mBAAoB,oBAAqB,WAC3M6B,EAAQxV,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,UAAW,WAAY,WAAY,OAAQ,OAAQ,cAAe,MAAO,SAAU,eAAgB,qBAAsB,gBAAiB,OAAQ,aAAc,OAAQ,cAAe,YAAa,WAAY,cAAe,YAAa,cAAe,eAAgB,cAAe,YAAa,cAAe,cAAe,iBACxWC,OAAOvF,EAAQxV,UAAUgb,UAAW,CAAC,UAAW,QAChDD,OAAOvF,EAAQxV,UAAUib,SAAU,CAAC,UAAW,QAC/CF,OAAOvF,EAAQxV,UAAUkb,YAAa,CAAC,UAAW,QAClDH,OAAOvF,EAAQxV,UAAUmb,UAAW,CAAC,UAAW,QAChDJ,OAAOvF,EAAQxV,UAAUob,KAAM,CAAC,OAAQ,KAAM,OAAQ,SACtDL,OAAOvF,EAAQxV,UAAUqb,YAAa,MACtCN,OAAOvF,EAAQxV,UAAUsb,WAAY,CACxC,QAAS,IACT,QAAS,IACT,SAAU,IACV,OAAQ,KAAM,OACd,UAAW,MAAM,EACjB,UAAW,KAAM,KACjB,UAAW,KAAM,KACjB,SAAU,KAAM,KAChB,OAAQ,KAAM,KACd,UAAW,KAAM,KACjB,SAAU,KAAM,KAChB,QAAS,MAAM,QAYZC,GAAmB,sPANtB,uBAAchG,UAENA,aAAeiG,yBAJOhJ,EAAIiD,MAQZ,CAAqB,KAAM,eAAgB,iCAGrD+F,2MAEXhJ,EAAI8B,QAAQmC,WAAb,wBAEQ8E,UAGP/I,EAAI8B,QAAQa,WAAb,uBAEQ,sBAAwB3C,EAAI4G,MAAM3F,KAAKgD,MAAQ,UAAYjE,EAAI4G,MAAM3F,KAAKgI,OAAS,sBAT1DlI,GAalCiI,GAAaxb,UAAU2T,YAAc,CAAC,YAAa,OAAQ,QAAS,WACpE6H,GAAaxb,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,YAAa,OAAQ,QAAS,gBAWtEY,GAAU,yMANb,uBAAcnG,UAENA,aAAeoG,gBAJFnJ,EAAIiD,MAQZ,CAAY,KAAM,MAAO,4BAG1BkG,8JAEXnJ,EAAI8B,QAAQmC,WAAb,wBAEQiF,UAGPlJ,EAAI8B,QAAQa,WAAb,uBAEQ,WAAa3C,EAAI4G,MAAM3F,KAAKD,IAAM,SAAWhB,EAAI4G,MAAM3F,KAAKvG,MAAQ,0BAG5E,sBAAO0O,yDAAO,GAETvG,EAAS5B,KAAKjB,EAAI8B,QAAQhG,MAAMsN,eAC/BC,QAAQvF,QAAQwF,KAAKrI,MACnB4B,8BAGR,sBAAa0G,OAAY1G,yDAAO,KAAMnC,yCAEjCF,EAAM,iBAAmBS,KAAKD,UACnB,OAAX6B,IACHrC,GAAO,IAAMqC,EAAO7B,IACdT,gBAAgBC,EAAK,CAAC,WAAY+I,GAAa7I,mCAGvD,0BAAiBA,UAGTH,gBADG,iBAAmBU,KAAKD,GAAK,OACXN,qCAG7B,4BAAmBA,UAGXH,gBADG,iBAAmBU,KAAKD,GAAK,OACXN,2BAG7B,0BAEQ,SAAWO,KAAKD,GAAK,yCAG7B,oCAEQ,qBAAuBC,KAAKD,GAAK,QAAUC,KAAKD,GAAK,8CAAgDC,KAAKD,6BAGlH,4BAEQ,kBAAmBC,KAAKD,GAAK,gCAGrC,2BAEQ,uBAAyBC,KAAKD,GAAK,QAAUC,KAAKD,GAAK,eAAiBC,KAAKD,GAAK,mDAAqDC,KAAKD,4CAmBpJ,2CAEQ,kCAAoCC,KAAKD,GAAK,sCAGtD,iCAEQ,sBAAwBC,KAAKD,GAAK,QAAUC,KAAKD,GAAK,oDAG9D,4BAAmBuI,SAEX,qBAAuBtI,KAAKD,GAAK,QAAUC,KAAKD,GAAK,8CAAgDC,KAAKD,GAAK,sBAAwBuI,+BAG/I,sBAE0B,OAArBtI,KAAKuI,YACD,IAAI1J,IACLmB,KAAKuI,YAAYC,uBAGxBzJ,EAAI8B,QAAQhG,WAAb,qBAAmBsN,yDAAO,GAErBvG,EAAS,IAAI6G,GAAO,KAAMzI,SAC1BjB,EAAI2J,OAAOP,GACf,oCACwBA,EAAOQ,uCAC9B,KADSL,cAEH1G,EAAOgH,OAAO5H,IAAIsH,GACtB,MAAM,IAAIvJ,EAAI8J,cAAc9J,EAAI4G,MAAM3F,MAAQ,yCAA2CjB,EAAI4G,MAAM2C,mCAErG1G,EAAOkH,cAAa,EAAMX,EAAQ,KAAM,UAEpC,CAAA,IAAIpJ,EAAIC,UAAUmJ,GAUtB,MAAM,IAAIpJ,EAAIzQ,UAAU,yCARnB,IAAIga,KAAcH,MAEjBvG,EAAOgH,OAAO5H,IAAIsH,GACtB,MAAM,IAAIvJ,EAAI8J,cAAc9J,EAAI4G,MAAM3F,MAAQ,yCAA2CjB,EAAI4G,MAAM2C,IAErG1G,EAAOkH,cAAa,EAAM,IAAIjK,IAAIE,EAAIgK,MAAMhK,EAAIiK,SAASC,MAAMd,KAAW,KAAM,aAI1EvG,SAGP7C,EAAI8B,QAAQC,cAAb,eAAsBrH,MAEjBA,EAAK8H,WAAW,MACpB,KACMvB,KAAKkJ,SAASlI,IAAIvH,EAAK0P,OAAO,IAClC,MAAM,IAAIpK,EAAIyC,eAAexB,KAAMvG,UAC7BuG,KAAKkJ,SAASpZ,IAAI2J,EAAK0P,OAAO,IAEjC,GAAI1P,EAAK8H,WAAW,OACzB,IAC8B,OAAzBvB,KAAKwI,kBAA6BxI,KAAKwI,gBAAgBxH,IAAIvH,EAAK0P,OAAO,IAC1E,MAAM,IAAIpK,EAAIyC,eAAexB,KAAMvG,UAC7BuG,KAAKwI,gBAAgB1Y,IAAI2J,EAAK0P,OAAO,IAExC,GAAI1P,EAAK8H,WAAW,OAAyB,OAAhBvB,KAAKP,OACvC,KACMO,KAAKP,OAAOuB,IAAIvH,EAAK0P,OAAO,IAChC,MAAM,IAAIpK,EAAIyC,eAAexB,KAAMvG,UAC7BuG,KAAKP,OAAO3P,IAAI2J,EAAK0P,OAAO,IAE/B,GAAI1P,EAAK8H,WAAW,QAA0B,OAAhBvB,KAAKP,OACxC,KACMO,KAAKP,OAAOuB,IAAIvH,EAAK0P,OAAO,IAChC,MAAM,IAAIpK,EAAIyC,eAAexB,KAAMvG,UAC7BuG,KAAKP,OAAO3P,IAAI2J,EAAK0P,OAAO,IAAI3Z,MAGvC,2CAAauP,EAAI8B,QAAQC,wBAASrH,4BAGpC,sBAEQuG,KAAKoJ,sCAGb,aAAgBC,MAEF,OAATA,QAEC,GAAqB,iBAAVA,EAChB,IACoB,OAAfrJ,KAAKsJ,QAAkBtJ,KAAKsJ,MAAMtI,IAAIqI,GAGzC,MAAM,IAAItK,EAAIwK,WAAW,QAAUxK,EAAI4G,MAAM0D,GAAQ,eAFrDA,EAAOrJ,KAAKsJ,MAAMxZ,IAAIuZ,OAInB,CAAA,KAAIA,aAAgBG,UASlB,IAAIzK,EAAIzQ,UAAUyQ,EAAI4G,MAAM0D,GAAQ,sBAPtCA,EAAK/G,MAAQtC,KAGhB,MAAM,IAAIjB,EAAIwK,WAAW,QAAUxK,EAAI4G,MAAM0D,GAAQ,mCAOlDD,aAAeC,+BAGrB,sBAE2B,OAAtBrJ,KAAKyJ,aACD,IAAI5K,IACLmB,KAAKuI,YAAYC,yBA5LD1I,GAiMzBoI,GAAI3b,UAAU2T,YAAc,CAAC,UAAW,OAAQ,cAAe,OAAQ,YAAa,QAAS,YAAa,WAAY,UAAW,cAAe,eAAgB,aAAc,SAAU,QAAS,4BAA6B,YAAa,aAAc,kBAAmB,kBAAmB,kBAAmB,YAAa,YAAa,YAAa,YAAa,UAAW,WAAY,eAAgB,aAAc,QAAS,UACpagI,GAAI3b,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,UAAW,OAAQ,cAAe,OAAQ,YAAa,QAAS,YAAa,YAAa,YAAa,YAAa,WAAY,kBAAmB,UAAW,cAAe,eAAgB,aAAc,SAAU,QAAS,QAAS,SAAU,aAAc,4BAA6B,SAAU,WAAY,eAAgB,eAAgB,mBAAoB,qBAAsB,WAAY,qBAAsB,aAAc,YAAwD,4BAA6B,kBAAmB,yBACzjBC,OAAOY,GAAI3b,UAAUwS,EAAI8B,QAAQhG,MAAO,CAAC,SAAU,MAAO,cAAgB,MAC1EyM,OAAOY,GAAI3b,UAAUmd,OAAQ,CAAC,SAAU,MAAO,cAAgB,MAC/DpC,OAAOY,GAAI3b,UAAUod,aAAc,CAAC,aAAc,IAAK,SAAU,KAAM,KAAM,SAAU,SACvFrC,OAAOY,GAAI3b,UAAUqd,iBAAkB,CAAC,SAAU,SAClDtC,OAAOY,GAAI3b,UAAUsd,mBAAoB,CAAC,SAAU,WAWpDC,GAAW,8MANd,uBAAchI,UAENA,aAAe0H,iBAJDzK,EAAIiD,MAQZ,CAAa,KAAM,OAAQ,+CAG7BwH,iLAEZ,sBAEQxJ,KAAKsC,IAAI8F,eAGhBrJ,EAAI8B,QAAQmC,WAAb,wBAEQ8G,UAGP/K,EAAI8B,QAAQa,WAAb,uBAEQ,YAAc3C,EAAI4G,MAAM3F,KAAKD,IAAM,SAAWhB,EAAI4G,MAAM3F,KAAKvG,MAAQ,cAdpDqG,GAkB1B0J,GAAKjd,UAAU2T,YAAc,CAAC,OAAQ,gBAAiB,MAAO,QAAS,QAAS,SAAU,QAAS,MAAO,WAAY,kBAAmB,OAAQ,iBAAkB,cAAe,WAClLsJ,GAAKjd,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,OAAQ,gBAAiB,MAAO,QAAS,QAAS,SAAU,QAAS,MAAO,WAAY,kBAAmB,OAAQ,iBAAkB,cAAe,gBAW1L0C,GAAiB,4OANpB,uBAAcjI,UAENA,aAAekI,uBAJKjL,EAAIiD,MAQZ,CAAmB,KAAM,aAAc,uDAG/CgI,iMAEXjL,EAAI8B,QAAQmC,WAAb,wBAEQ+G,UAGPhL,EAAI8B,QAAQa,WAAb,uBAEQ,kBAAoB3C,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,oBAThExI,GAahCkK,GAAWzd,UAAU2T,YAAc,CAAC,aAAc,MAAO,QACzD8J,GAAWzd,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,aAAc,MAAO,aAWjE4C,GAAa,wNANhB,uBAAcnI,UAENA,aAAe2G,mBAJC1J,EAAIiD,MAQZ,CAAe,KAAM,SAAU,uCAGnCyG,8EAEA1I,EAAIuC,4DAETvC,IACDuC,IAAMA,IACN4H,UAAY,OACZC,UAAY,OACZC,UAAY,OACZC,UAAY,OACZC,YAAc,IACdC,cAAgB,IAAI1L,MACpB2L,QAAU,OACVC,QAAU,OACVC,SAAW,IAAI7L,MACf8L,YAAc,OACdC,OAAS,KACTC,mBAAqB,OACrBC,uBAAyB,OACzBC,aAAc,IACdC,SAAU,qCAGfjM,EAAI8B,QAAQmC,WAAb,wBAEQiH,0BAGR,uBAAQgB,yDAAS,EAAG/B,yDAAS,QAEZ,GAAZ+B,EACH,MAAO,YACJrC,EAAS,gCACsBM,GAAYlJ,KAAKsC,IAAI4G,yCACxD,iCADUZ,OAAY4C,UAEJ,OAAbhC,GAAqBgC,EAAQC,SACjC,KACKC,EAAapL,KAAK4I,OAAO9Y,IAAIwY,GAAY+C,cAAcJ,EAAS,GACjD,OAAfG,GACHxC,EAAOhc,KAAK,CAACse,EAAQI,MAAOF,uCAGT,IAAlBxC,EAAOxa,OACV,OAAO4R,KAAKoI,QAAQmD,gBAChB,GAAsB,IAAlB3C,EAAOxa,OACf,OAAOwa,EAAO,GAAG,WACdnD,EAAS,SACmBmD,+CAAtB0C,OAAOF,OAChB3F,EAAO7Y,KAAK0e,EAAQ,KAAOF,UACrB3F,EAAOa,KAAK,kCAGpB,sBAAakF,EAAUrD,EAAQyC,EAAQa,SAElC7C,EAAS,IAAI/J,iCAEGmB,KAAKsC,IAAI4G,SAASf,yCACtC,KADS+C,UAEJ5C,EAAa4C,EAAQ5C,WACrB9Y,EAAQ,KACG,OAAX2Y,IAECqD,IAAarD,EAAOnH,IAAIsH,GAC3B9Y,EAAQ0b,UACA/C,EAAOnH,IAAIsH,KACnB9Y,EAAQ2Y,EAAOrY,IAAIwY,SAEjBoD,EAAQ,IAAIR,EAAQS,UAAUT,EAASlL,KAAMxQ,GACjDoZ,EAAOja,IAAI2Z,EAAYoD,GACR,OAAXd,GAAmBA,EAAO5J,IAAIsH,KACjCoD,EAAMd,OAASA,EAAO9a,IAAIwY,IACR,OAAfmD,GAAuBA,EAAWzK,IAAIsH,KACzCoD,EAAMD,WAAaA,EAAW3b,IAAIwY,wCAG/BmC,QAAU7B,OACV2B,cAAgB,UAChBM,mBAAqB,UACrBe,kBAAoB,6BAG1B,wBAEKxD,EAAUpI,KAAKsC,IAAI8F,eAEhBA,EAAQyD,YAAc7L,OAASoI,EAAQxG,cAG9C7C,EAAI8B,QAAQa,WAAb,uBAEKoK,EAAI,CAAC,cAAe/M,EAAI4G,MAAM3F,KAAKD,kCACrBC,KAAK4I,OAAOT,yCAC9B,KADSuD,UAEJA,EAAMR,QAAQC,WAAaO,EAAMK,aAEpCD,EAAElf,KAAK,OACPkf,EAAElf,KAAK8e,EAAMR,QAAQ5C,YACrBwD,EAAElf,KAAK,KACPkf,EAAElf,KAAKmS,EAAI4G,MAAM+F,EAAMlc,+CAGzBsc,EAAElf,KAAK,WACPkf,EAAElf,KAAKmS,EAAI4G,MAAM3F,KAAKgM,QACtBF,EAAElf,KAAK,KACAkf,EAAExF,KAAK,uBAGf,sBAEKtG,KAAK+K,YACD,UACC/K,KAAKgL,QACN,MACChL,KAAKiM,WACN,QAEA,4BAGT,kBAEsB,OAAjBjM,KAAKwK,QACT,MACMA,QAAU,IAAI3L,uCACDmB,KAAK4I,OAAOT,yCAC9B,KADSuD,eAEHlB,QAAQ7b,IAAI+c,EAAMR,QAAQ5C,WAAYoD,EAAMlc,8CAG5CwQ,KAAKwK,4BAGb,sBAEsB,OAAjBxK,KAAKyK,SACRzK,KAAK8I,cAAa,EAAO9I,KAAKuK,cAAevK,KAAK6K,mBAAoB7K,KAAK8K,wBACrE9K,KAAKyK,gCAGb,uBAEiB,OAAZzK,KAAKD,GACR,OAAO,qCACUC,KAAK4I,OAAOT,yCAC9B,YACW8D,WACT,OAAO,wCAEF,4BAGR,yBAE4B,IAAvBjM,KAAK4K,OAAOxc,OACf,OAAO,qCACU4R,KAAK4I,OAAOT,yCAC9B,YACW+D,aACT,OAAO,wCAEF,wBAGR,uBAEKzG,EAASzF,KAAKsC,IAAI8F,QAAQvF,eAAe7C,kBACxC+K,aAAc,EACZtF,sBAGR,qBAEMnD,IAAI8F,QAAQvF,QAAQwF,KAAKrI,4BAG/B,sBAAOmI,yDAAO,MAETpJ,EAAI2J,OAAOP,GACf,oCAC0BA,EAAOhd,0CAChC,iCADUghB,OAAK3c,WAETwQ,KAAK4I,OAAO5H,IAAImL,GACpB,MAAM,IAAIpN,EAAI8J,cAAc,+CAAiD9J,EAAI4G,MAAMwG,IACxFvD,OAAO9Y,IAAIqc,GAAK3c,MAAQA,sCAGrB,CAAA,IAAIuP,EAAIC,UAAUmJ,GAUtB,MAAM,IAAIpJ,EAAIzQ,UAAU,yCARnB,IAAI6d,KAAOhE,EAChB,KACMnI,KAAK4I,OAAO5H,IAAImL,GACpB,MAAM,IAAIpN,EAAI8J,cAAc,+CAAiD9J,EAAI4G,MAAMwG,IACxFvK,OAAOgH,OAAO9Y,IAAIqc,GAAK3c,MAAQ2Y,EAAOgE,SAMnC7J,IAAI8F,QAAQvF,QAAQwF,KAAKrI,kCAG/B,sBAAasI,EAAY7I,UAGjBH,gBADG,iBAAmBU,KAAKsC,IAAIvC,GAAK,IAAMC,KAAKD,GAC1B,CAAC,WAAYuI,GAAa7I,oCAGvD,2BAAkBA,UAGVH,gBADG,iBAAmBU,KAAKsC,IAAIvC,GAAK,IAAMC,KAAKD,GAAK,QAC/BN,sCAG7B,6BAAoBA,UAGZH,gBADG,iBAAmBU,KAAKsC,IAAIvC,GAAK,IAAMC,KAAKD,GAAK,QAC/BN,yBAG7B,gBAAO2M,OAED,IAAI9D,KAAc8D,EACvB,KACKC,EAAcD,EAAO9D,MACrBvJ,EAAIuN,MAAMD,KAERrM,KAAK4I,OAAO9Y,IAAIwY,GAAY8D,OAAOC,GACvC,OAAO,SAGH,2BAGR,mBAAUhM,sEAEOA,QACX2K,SAAU,gCAGhB,wBAAevR,SAED,WAATA,EACIuG,KAAKuK,cAELvK,KAAKvG,iCAGd,wBAAeA,EAAMjK,GAEP,WAATiK,QAEE8Q,cAAgB/a,OAChBgb,QAAU,UACVC,QAAU,MAGfzK,KAAKvG,GAAQjK,SAGduP,EAAI8B,QAAQC,cAAb,eAAsBrH,UAEjBA,EAAK8H,WAAW,MACZvB,KAAK0K,SAAS5a,IAAI2J,EAAK0P,OAAO,IAC7B1P,EAAK8H,WAAW,MACjBvB,KAAK4I,OAAO9Y,IAAI2J,EAAK0P,OAAO,IAC3B1P,EAAK8H,WAAW,MACjBvB,KAAK4I,OAAO9Y,IAAI2J,EAAK0P,OAAO,IAAI3Z,6CAE1BuP,EAAI8B,QAAQC,wBAASrH,UAGnCsF,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEvBiK,EAAK8H,WAAW,MACnBvB,KAAK0K,SAASjR,EAAK0P,OAAO,IAAM3Z,EACxBiK,EAAK8H,WAAW,MACxBvB,KAAK4I,OAAO9Y,IAAI2J,EAAK0P,OAAO,IAAI3Z,MAAQA,EAExC+c,uCAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,eAtRRsQ,GA0R5B2I,GAAOlc,UAAU2T,YAAc,CAAC,MAAO,YAAa,YAAa,YAAa,YAAa,cAAe,gBAAiB,cAAe,WAAY,SAAU,qBAAsB,0BACtLuI,GAAOlc,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,MAAO,YAAa,YAAa,YAAa,YAAa,cAAe,SAAU,SAAU,cAAe,WAAY,SAAU,eAAgB,oBAAqB,0BAChNC,OAAOmB,GAAOlc,UAAU0f,SAAU,MAClC3E,OAAOmB,GAAOlc,UAAU2f,WAAY,MACpC5E,OAAOmB,GAAOlc,iBAAkB,MAChC+a,OAAOmB,GAAOlc,UAAU8b,KAAM,MAC9Bf,OAAOmB,GAAOlc,UAAUigB,OAAQ,CAAC,SAAU,MAAO,cAAgB,MAClElF,OAAOmB,GAAOlc,UAAUod,aAAc,CAAC,aAAc,IAAK,SAAU,SACpErC,OAAOmB,GAAOlc,UAAUkgB,kBAAmB,CAAC,SAAU,SACtDnF,OAAOmB,GAAOlc,UAAUmgB,oBAAqB,CAAC,SAAU,WAGtDC,kNAEL,uBAAc7K,UAENA,aAAe8K,kBAJA7N,EAAIiD,MAQxB2J,GAAY,IAAIgB,GAAU,KAAM,QAAS,oEAGhCC,2EAEA1B,EAAStJ,EAAQpS,2DAEtB,OACD0b,QAAUA,IACVtJ,OAASA,IACTiL,OAAS,OACTC,YAAc,OACdlC,OAAS,KACTmC,OAAS,KACTC,EAAKnB,aACTmB,EAAKxd,MAAQA,KACTyd,QAAS,IACTC,UAAW,IACXC,WAAY,IACZC,UAAW,oCAGhBrO,EAAI8B,QAAQmC,WAAb,wBAEQ2I,sBAGR,sBAEK3L,KAAK6L,WACD7L,KAAKqN,iBACNrN,KAAK+M,0BAGb,aAAUvd,OAEL8d,EAAWtN,KAAK+M,OAEhBQ,EAAS,CAAC/d,MAAOA,EAAOob,OAAQ,SAC/B4C,UAAUD,GAEXxO,EAAI0O,IAAIH,EAAUC,EAAO/d,SAEA,OAAxBwQ,KAAK4B,OAAO4I,SACfxK,KAAK4B,OAAO4I,QAAQ7b,IAAIqR,KAAKkL,QAAQ5C,WAAYiF,EAAO/d,YACpDud,OAASQ,EAAO/d,WAChByd,QAAS,QAEVrC,OAAS2C,EAAO3C,OACjB5K,KAAK6L,YACR7L,KAAK0N,eAAe1N,KAAK+M,qCAG3B,gCAEQ,8BAGR,mBAAUQ,kCAKV,0BAEKvN,KAAK6L,aACR7L,KAAK2N,WAAWtS,YAAc2E,KAAKsL,0BAGrC,sCAEQtL,KAAK6M,sBAAU7M,KAAKkL,QAAQI,yBAGpC,aAAU9b,QAEJqd,OAASrd,OACToe,sCAGN,sBAEQ5N,KAAKkL,QAAQ9C,gCAGrB,2BAEwB,OAAhBpI,KAAK+M,+BAGb,2BAEQ/M,KAAKiN,iCAGb,6BAE+B,IAAvBjN,KAAK4K,OAAOxc,gCAGpB,mBAAUgZ,QAEJwD,OAAOhe,KAAKwa,4BAGlB,mBAAUA,GAGRpH,KAAK4K,OADQ,OAAVxD,EACW,CAACA,GAED,yBAGhB,gBAAOyG,UAEC7N,KAAKkL,QAAQkB,OAAOpM,KAAKxQ,MAAOqe,qCAGxC,4BAAmBre,UAEVwQ,KAAKoI,QAAQhG,UAEf,sBACOpC,KAAKsL,mDAELtL,KAAKsL,6DAInB,8BAAqB9b,oBAETwQ,KAAKsL,6CAAmCvM,EAAI+O,MAAMte,GAAOiK,+CAGrE,+BAAsBjK,oBAEVwQ,KAAKsL,kEAGjB,6BAAoB9b,oBAERwQ,KAAKsL,uDAA8CtL,KAAKkL,QAAQ6C,4DAG5E,4BAAmBve,oBAEPwQ,KAAKsL,oDAA2CtL,KAAKkL,QAAQ8C,0DAGzE,0BAAiBxe,oBAELwQ,KAAKsL,wEAGjB,wBAAe9b,oBAEHwQ,KAAKsL,8DAGjB,wBAAe9b,oBAEHwQ,KAAKsL,wEAGjB,yBAAgB9b,oBAEJwQ,KAAKsL,+EAGjB,2BAAkB9b,oBAENwQ,KAAKsL,oFAGjB,8BAAqB9b,8BAECuP,EAAI4G,MAAMnW,oBAAewQ,KAAKsL,gFAGpD,+BAAsB9b,8BAEAuP,EAAI4G,MAAMnW,oBAAewQ,KAAKsL,gEAGpD,mCAA0B9b,8BAEJuP,EAAI4G,MAAMnW,oBAAewQ,KAAKsL,uFAGpD,kCAAyB9b,8BAEHuP,EAAI4G,MAAMnW,oBAAewQ,KAAKsL,oDAQpD,2BAEQtL,KAAK4B,OAAOiK,kCAGpB,qBAEQ,qBAAuB7L,KAAKkL,QAAQ+C,eAAiB,YAAcjO,KAAKkL,QAAQ5C,mCAGxF,sBAEQtI,KAAKkO,UAAY,wCAGzB,sBAEQlO,KAAKkO,UAAY,IAAMlO,KAAKkL,QAAQiD,yCAG5C,sBAEQ3b,SAAS4b,cAAcpO,KAAKkO,mCAGpC,sBAEQ1b,SAAS4b,cAAcpO,KAAKqO,sCAGpC,sBAEQ7b,SAAS4b,cAAcpO,KAAKsO,yCAGpC,sBAEQ9b,SAAS+b,iBAAiBvO,KAAKsO,4CAGvC,iCAEQtO,KAAKwO,aAAahf,oCAG1B,wBAAeA,QAETgf,aAAahf,MAAkB,OAAVA,EAAiBA,EAAQ,wBAGpD,sBAEQwQ,KAAKoN,8BAGb,aAAY5d,GAEPwQ,KAAK6L,aACR7L,KAAKyO,UAAUC,QAAUlf,QACrB4d,SAAW5d,uBAGjB,sBAEKwQ,KAAK6L,YACA7L,KAAKyO,UAAUE,UAAUC,SAAS,yBAEnC5O,KAAKkN,8BAGd,aAAY1d,MAEPwQ,KAAK6L,WACT,OACKgD,GAAYrf,+BACCwQ,KAAK8O,uDAChBD,SAAWA,sCACZJ,UAAUE,UAAUI,OAAO,wBAAyBF,QAErD3B,SAAW1d,wBAGjB,sBAEQwQ,KAAKmN,gCAGb,aAAa3d,QAEP2d,UAAY3d,SAGjBuP,EAAI8B,QAAQa,WAAb,qBAEKsN,EAAI,IAAMhP,KAAKtQ,YAAY+J,KAAO,sBACtCuV,GAAKjQ,EAAI4G,MAAM3F,KAAKkL,QAAQ5C,YACxBtI,KAAKiN,SACR+B,GAAK,oBACFhP,KAAK4K,OAAOxc,OAAS,IACxB4gB,GAAK,sBACNA,GAAK,WAILjQ,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEd,UAATiK,EACHuG,KAAKxQ,MAAQA,EACI,YAATiK,EACRuG,KAAKiP,QAAUlQ,EAAIuN,MAAM9c,GACR,YAATiK,EACRuG,KAAKkP,QAAUnQ,EAAIuN,MAAM9c,GACR,aAATiK,EACRuG,KAAK/K,SAAW8J,EAAIuN,MAAM9c,GAE1B+c,sCAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,cAvTTsQ,GA2T3B8M,GAAMrgB,UAAU2T,YAAc,CAAC,UAAW,SAAU,QAAS,QAAS,SAAU,WAAY,WAAY,aACxG0M,GAAMrgB,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,UAAW,SAAU,QAAS,QAAS,SAAU,UAAW,UAAW,aAC5GuF,GAAMrgB,UAAU4iB,YAAc,YAW1BC,GAAgB,uOANnB,uBAActN,UAENA,aAAeuN,sBAJI1C,IAQR,CAAkB,KAAM,YAAa,yEAG5C0C,4LAEXtQ,EAAI8B,QAAQmC,WAAb,wBAEQoM,4BAGR,mBAAU7B,GAEY,OAAjBA,EAAO/d,MAENwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QAElB,kBAAlB+d,EAAO/d,MAElBwQ,KAAKkL,QAAQoE,WAAa/B,EAAO/d,OACpC+d,EAAO3C,OAAOhe,KAAKoT,KAAKwP,sBAAsBjC,EAAO/d,SAItD+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,oCAIjB,iCAEQwQ,KAAKwO,aAAakB,sCAG1B,wBAAelgB,QAETgf,aAAakB,QAAUlgB,+BAG7B,gCAEQwQ,KAAKoI,QAAQuH,SAAS3P,KAAKxQ,sBAtCLod,IAmD3BgD,GAAe,kOANlB,uBAAc9N,UAENA,aAAe+N,qBAJGlD,IAQR,CAAiB,KAAM,WAAY,yEAGzCkD,uLAEX9Q,EAAI8B,QAAQmC,WAAb,wBAEQ4M,yBAGR,gBAAOpgB,SAEF,mBAAmB1B,KAAK0B,GACpBsgB,SAAStgB,GAET,8BAGT,mBAAU+d,MAEY,OAAjBA,EAAO/d,MAENwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,aAE/C,GAA6B,iBAAlB+d,EAAO/d,MACvB,KACKA,EAAQwQ,KAAK+P,OAAOxC,EAAO/d,OACjB,OAAVA,EACH+d,EAAO/d,MAAQA,EAEf+d,EAAO3C,OAAOhe,KAAKoT,KAAKgQ,kBAAkBzC,EAAO/d,YAGjB,iBAAlB+d,EAAO/d,MAElB4T,KAAK6M,MAAM1C,EAAO/d,SAAW+d,EAAO/d,OACvC+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,SAKrD+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,oCAIjB,8BAEKA,gFACAA,EACJ,KACK0gB,EAAYlQ,KAAK+P,OAAOvgB,GACV,OAAd0gB,IACH1gB,EAAQ0gB,UAEH1gB,gCAGR,wBAAeA,6EAEiB,OAAVA,EAAiBA,EAAQ,GAAK,iCAGpD,6BAEKA,EAAQwQ,KAAKxQ,aACD,MAATA,EAAgBA,EAAQ,GAAK,2BAGrC,sBAEQwQ,KAAKmN,gCAGb,aAAa3d,MAERwQ,KAAK6L,WACT,OACKsE,GAAY3gB,+BACCwQ,KAAK8O,uDAChBsB,SAAWD,sFAED3gB,yBAhFWod,IA6F1ByD,GAAkB,iPANrB,uBAAcvO,UAENA,aAAewO,wBAJM3D,IAQR,CAAoB,KAAM,cAAe,2EAGlD2D,sMAEXvR,EAAI8B,QAAQmC,WAAb,wBAEQqN,yBAGR,gBAAO7gB,MAEQ,OAAVA,EACH,OAAO,aAGJ0gB,EAAY1gB,EAEZ+gB,EAAO,GACPC,EAAS,EACTC,EAAO,EACFvU,EAAI,EAAGA,EAAI1M,EAAMpB,SAAU8N,EACpC,KACKwU,EAAIlhB,EAAM0M,GACL,KAALwU,GAEHF,IACAD,GAAQG,GAEK,KAALA,IAERD,IACAF,GAAQG,OAGNC,EAAU,QACA,GAAVH,EAECC,GAAQ,IAGXE,EAAU,WAEP,GAAc,GAAVH,EAGPG,EADW,GAARF,EACgB,MAARF,EAAgB,KAAO,KAExB,eAIPE,GAAQ,GAGX,OAAO,KAFPE,EAAU,KAKI,OAAZA,EACHT,EAAYA,EAAU7iB,QAAQ,MAAO,IAAIA,QAAQ,KAAM,KACnC,OAAZsjB,IACRT,EAAYA,EAAU7iB,QAAQ,KAAM,SACjCujB,EAAaC,WAAWX,UACxBY,MAAMF,GACFphB,EACDohB,2BAGR,mBAAUrD,MAEY,OAAjBA,EAAO/d,OAAmC,KAAjB+d,EAAO/d,MAE/BwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QACnD+d,EAAO/d,MAAQ,UAEX,GAA6B,iBAAlB+d,EAAO/d,MACvB,KACKA,EAAQwQ,KAAK+P,OAAOxC,EAAO/d,OACjB,OAAVA,GAEHA,EAAQwQ,KAAK+Q,aAAavhB,GACK,OAA3BwQ,KAAKkL,QAAQ8F,YAChBxhB,EAAQuP,EAAIkS,OAAOzhB,EAAOwQ,KAAKkL,QAAQ8F,YACxCzD,EAAO/d,MAAQA,GAGf+d,EAAO3C,OAAOhe,KAAKoT,KAAKgQ,kBAAkBzC,EAAO/d,aAG9C,GAA6B,iBAAlB+d,EAAO/d,MACvB,KACKA,EAAQwQ,KAAK+Q,aAAaxD,EAAO/d,OACN,OAA3BwQ,KAAKkL,QAAQ8F,YAChBxhB,EAAQuP,EAAIkS,OAAOzhB,EAAOwQ,KAAKkL,QAAQ8F,YACxCzD,EAAO/d,MAAQA,OAIf+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,iCAIjB,sBAAaA,UAEiB,OAAzBwQ,KAAKkL,QAAQgG,SAEZ1hB,EAAQwQ,KAAKkL,QAAQgG,UACxB1hB,EAAQwQ,KAAKkL,QAAQgG,SAEM,OAAzBlR,KAAKkL,QAAQiG,SAEZ3hB,EAAQwQ,KAAKkL,QAAQiG,UACxB3hB,EAAQwQ,KAAKkL,QAAQiG,SAEhB3hB,gCAGR,8BAEKA,mFACAA,EACJ,IACsB,iBAAVA,EACX,KACK0gB,EAAYlQ,KAAK+P,OAAOvgB,GACV,OAAd0gB,IACH1gB,EAAQ0gB,GAEY,iBAAX1gB,IAEqB,OAA3BwQ,KAAKkL,QAAQ8F,YAChBxhB,EAAQuP,EAAIkS,OAAOzhB,EAAOwQ,KAAKkL,QAAQ8F,YACxCxhB,EAAQwQ,KAAK+Q,aAAavhB,SAI3BA,EAAQ,YACFA,gCAGR,wBAAeA,GAEQ,iBAAXA,GAEVA,EAAQwQ,KAAK+Q,aAAavhB,GACK,OAA3BwQ,KAAKkL,QAAQ8F,YAChBxhB,EAAQA,EAAM4hB,QAAQpR,KAAKkL,QAAQ8F,aAElB,OAAVxhB,IACRA,EAAQ,IACTA,GAAS,GACgB,MAArBwQ,KAAKoI,QAAQhG,MAA2C,OAA3BpC,KAAKkL,QAAQ8F,YAC7CxhB,EAAQA,EAAMnC,QAAQ,IAAK,mFACPmC,gCAGtB,6BAEKA,EAAQwQ,KAAKxQ,aACH,OAAVA,EACI,KACuB,OAA3BwQ,KAAKkL,QAAQ8F,UACTxhB,EAAM4hB,QAAQpR,KAAKkL,QAAQ8F,WAC5BxhB,EAAMvC,iCAGd,sBAEQ+S,KAAKmN,gCAGb,aAAa3d,MAERwQ,KAAK6L,WACT,OACKsE,GAAY3gB,+BACCwQ,KAAK8O,uDAChBsB,SAAWD,yFAED3gB,4BAlLcod,IAuL3ByE,gPAEL,uBAAcvP,UAENA,aAAewP,wBAJM3E,IAQ1B4E,GAAkB,IAAIF,GAAgB,KAAM,cAAe,2EAGlDC,sMAEXvS,EAAI8B,QAAQmC,WAAb,wBAEQuO,4BAGR,mBAAUhE,MAEY,OAAjBA,EAAO/d,OAAmC,KAAjB+d,EAAO/d,MAE/BwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QACnD+d,EAAO/d,MAAQ,UAEX,GAA6B,iBAAlB+d,EAAO/d,MACvB,KACKue,EAAY/N,KAAKkL,QAAQ6C,UACzBC,EAAYhO,KAAKkL,QAAQ8C,UACX,OAAdD,GAAsBR,EAAO/d,MAAMpB,OAAS2f,GAC/CR,EAAO3C,OAAOhe,KAAKoT,KAAKwR,oBAAoBjE,EAAO/d,QAClC,OAAdwe,GAAsBT,EAAO/d,MAAMpB,OAAS4f,GAC/CT,EAAO3C,OAAOhe,KAAKoT,KAAKyR,mBAAmBlE,EAAO/d,aAInD+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,2BAIjB,sBAEQwQ,KAAKmN,gCAGb,aAAa3d,MAERwQ,KAAK6L,WACT,OACKsE,GAAY3gB,+BACCwQ,KAAK8O,uDAChBsB,SAAWD,yFAED3gB,wCAGlB,gCAEQwQ,KAAKxQ,uBAjDmBod,IA8D7B8E,GAAoB,2PANvB,uBAAc5P,UAENA,aAAe6P,0BAJQN,IAQR,CAAsB,KAAM,gBAAiB,oFAGxDM,gNAEX5S,EAAI8B,QAAQmC,WAAb,wBAEQ0O,sBAJ0BJ,IAiB/BM,GAAiB,4OANpB,uBAAc9P,UAENA,aAAe+P,uBAJKR,IAQR,CAAmB,KAAM,aAAc,iFAG/CQ,iMAEX9S,EAAI8B,QAAQmC,WAAb,wBAEQ4O,4BAGR,mBAAUrE,MAEoB,iBAAlBA,EAAO/d,OAAuB+d,EAAO/d,MAAMpB,OAAS,EAC/D,CACY,yJACHN,KAAKyf,EAAO/d,QACnB+d,EAAO3C,OAAOhe,KAAKoT,KAAK8R,iBAAiBvE,EAAO/d,+EAElC+d,mBAfc+D,IA4B5BS,GAAe,kOANlB,uBAAcjQ,UAENA,aAAekQ,qBAJGX,IAQR,CAAiB,KAAM,WAAY,+EAGzCW,uLAEXjT,EAAI8B,QAAQmC,WAAb,wBAEQ+O,4BAGR,mBAAUxE,MAEoB,iBAAlBA,EAAO/d,OAAuB+d,EAAO/d,MAAMpB,OAAS,EAC/D,KACKmR,EAAM,SAGTA,EAAM,IAAI0S,IAAI1E,EAAO/d,OAEtB,MAAO0iB,GAEN3E,EAAO3C,OAAOhe,KAAKoT,KAAKmS,eAAe5E,EAAO/d,QAEnC,OAAR+P,GAAiC,UAAjBA,EAAI6S,UAAyC,WAAjB7S,EAAI6S,UAEnD7E,EAAO3C,OAAOhe,KAAKoT,KAAKmS,eAAe5E,EAAO/d,6EAGhC+d,iBAzBY+D,IAsC1Be,GAAe,kOANlB,uBAAcvQ,UAENA,aAAewQ,qBAJGjB,IAQR,CAAiB,KAAM,WAAY,+EAGzCiB,uLAEXvT,EAAI8B,QAAQmC,WAAb,wBAEQqP,4BAGR,mBAAU9E,MAEoB,iBAAlBA,EAAO/d,OAAuB+d,EAAO/d,MAAMpB,OAAS,EAC/D,CACY,oBACHN,KAAKyf,EAAO/d,QACnB+d,EAAO3C,OAAOhe,KAAKoT,KAAKuS,eAAehF,EAAO/d,6EAEhC+d,iBAfY+D,IA4B1BkB,GAAoB,2PANvB,uBAAc1Q,UAENA,aAAe2Q,0BAJQpB,IAQR,CAAsB,KAAM,gBAAiB,oFAGxDoB,gNAEX1T,EAAI8B,QAAQmC,WAAb,wBAEQwP,sBAJ0BlB,IAiB/BoB,GAAgB,uOANnB,uBAAc5Q,UAENA,aAAe6Q,sBAJItB,IAQR,CAAkB,KAAM,YAAa,gFAG5CsB,4LAEX5T,EAAI8B,QAAQmC,WAAb,wBAEQ0P,kBAJsBpB,IAiB3BsB,GAAe,kOANlB,uBAAc9Q,UAENA,aAAe+Q,qBAJGlG,IAQR,CAAiB,KAAM,WAAY,wEAGzCkG,uLAEX9T,EAAI8B,QAAQmC,WAAb,wBAEQ4P,iCAGR,6DAEsB5S,KAAK8O,8CAC1B,KADSpQ,aAEJA,EAASqB,GAAG+S,SAAS,YACzB,KACKtjB,EAAQkP,EAASlP,SACjBA,SAEHA,EAAQujB,KAAKC,MAAMxjB,GACZ,IAAIqW,GACV7F,KAAKoI,QACL5Y,EAAMyjB,SAASC,YAAY,GAC3B1jB,EAAMyjB,SAASC,YAAY,GAC3B1jB,EAAM2jB,WAAWC,0DAKd,mCAGR,wBAAe5jB,MAEA,OAAVA,EACJ,oCACsBwQ,KAAK8O,8CAC1B,SACUtf,MAAQ,yCAInB,oCACsBwQ,KAAK8O,8CAC1B,KADSpQ,aAEJA,EAASqB,GAAG+S,SAAS,YACzB,KACKO,EAAY,MACP,mBACI,aACI,CACd7jB,EAAMqU,IACNrU,oBAGY,mBACQA,EAAM2X,OAG7BzI,EAASlP,MAAQuP,EAAIuU,QAAQD,QAG7B3U,EAASlP,MAAQA,EAAM2X,mEAK3B,6BAEK3X,EAAQwQ,KAAKxQ,SACE,OAAfwQ,KAAKxQ,MACR,OAAO,SAEJiW,EAASjW,EAAMqU,IAAIuN,QAAQ,GAAK,KAAO5hB,OAAW4hB,QAAQ,UAC3C,OAAf5hB,EAAM2X,OACT1B,GAAU,KAAOjW,EAAM2X,KAAO,KACxB1B,2BAGR,mBAAU8H,GAEY,OAAjBA,EAAO/d,OAAmC,KAAjB+d,EAAO/d,OAE/BwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QACnD+d,EAAO/d,MAAQ,MAEL+d,EAAO/d,iBAAiBqW,KAElC0H,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,oBAvFYod,IA2F9BiG,GAAStmB,UAAU4iB,YAAc,YAG3BoE,sOAEL,uBAAczR,UAENA,aAAe0R,sBAJI7G,IAQxB8G,GAAgB,IAAIF,GAAc,KAAM,YAAa,yEAG5CC,4LAEXzU,EAAI8B,QAAQmC,WAAb,wBAEQyQ,4BAGR,mBAAUlG,GAEY,OAAjBA,EAAO/d,OAAmC,KAAjB+d,EAAO/d,OAE/BwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QACnD+d,EAAO/d,MAAQ,MAEL+d,EAAO/d,iBAAiB8V,KAElCiI,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,oCAIjB,iCAGQ,mCAGR,0CA5B8Bod,IA2C3B8G,GAAyB,oRAN5B,uBAAc5R,UAENA,aAAe6R,+BAJaJ,IAQR,CAA2B,KAAM,qBAAsB,mFAGvEI,yOAEX5U,EAAI8B,QAAQmC,WAAb,wBAEQ0Q,4BAGR,mBAAUnG,kFAGOA,2BAVsBiG,IAelCI,0PAEL,uBAAc9R,UAENA,aAAe+R,0BAJQlH,IAQ5BmH,GAAoB,IAAIF,GAAkB,KAAM,gBAAiB,yEAGxDC,gNAEX9U,EAAI8B,QAAQmC,WAAb,wBAEQ8Q,gCAGR,6BAEKtkB,EAAQwQ,KAAKxQ,aACH,OAAVA,EACI,KACc,iBAAXA,EACHA,EACDuP,EAAIgV,QAAQvkB,EAAOwQ,KAAKkL,QAAQ8I,sCAGxC,gBAAOxkB,EAAO2V,OAET8O,EAAO,KAAMC,EAAQ,KAAMC,EAAM,KAAMC,EAAO,EAAGC,EAAS,EAAGC,EAAS,EAAGC,EAAO,cAE3EC,KAAK1I,EAAG2I,EAAKC,EAAKC,UAE1B7I,EAAIA,EAAE8I,UAAU,EAAGH,IACbrmB,QAAUqmB,EACR,MACR3I,EAAIgE,SAAShE,EAAG,IACZgF,MAAMhF,IAAMA,EAAI4I,GAAO5I,EAAI6I,EACvB,KACD7I,QAGDtc,GACP,KAGM2V,EACJ,OAAO,QACJA,EAAO5D,WAAW,MACtB,IAEc,QADb0S,EAAOO,KAAKhlB,EAAO,IAElB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEc,QADb0S,EAAOO,KAAKhlB,EAAO,IAElB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEe,QADd2S,EAAQM,KAAKhlB,EAAO,IAEnB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEa,QADZ4S,EAAMK,KAAKhlB,EAAO,IAEjB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEc,QADb6S,EAAOI,KAAKhlB,EAAO,IAElB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEc,QADb6S,EAAOI,KAAKhlB,EAAO,IAElB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEgB,QADf8S,EAASG,KAAKhlB,EAAO,IAEpB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IAEgB,QADf+S,EAASE,KAAKhlB,EAAO,IAEpB,OAAO,KACRA,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,IACK/R,EAAMzC,cAAcwU,WAAW,MAClCgT,GAAO,MACH,CAAA,IAAI/kB,EAAMzC,cAAcwU,WAAW,MAGvC,OAAO,KAFPgT,GAAO,EAGR/kB,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,KACM/R,EAAM+R,WAAW,KACrB,OAAO,KACR/R,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,QAEtB,GAAIzP,EAAO5D,WAAW,MAC3B,KACM/R,EAAM+R,WAAW,OAAS/R,EAAM+R,WAAW,KAC/C,OAAO,QAGQ,OADFiT,KADdhlB,EAAQA,EAAMolB,UAAU,GACE,GAEzB,OAAO,UACRplB,EAAQA,EAAMolB,UAAU,IACbrT,WAAW,KACrB,OAAO,QAGU,OADFiT,KADhBhlB,EAAQA,EAAMolB,UAAU,GACI,GAE3B,OAAO,KACRplB,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,OAG3B,KACMplB,EAAM+R,WAAW4D,EAAOyP,UAAU,EAAG,IACzC,OAAO,KACRplB,EAAQA,EAAMolB,UAAU,GACxBzP,EAASA,EAAOyP,UAAU,OAKxBzP,SAEI,QAGK,OAAT8O,EACH,OAAO,QACM,OAAVC,GAAkBA,EAAQ,GAAKA,EAAQ,GAC1C,OAAO,QACI,OAARC,GAAgBA,EAAM,GAAKA,EAAM,UAC7B,QACK,OAATI,MAECH,EAAO,GAAKA,EAAO,GACtB,OAAO,SAGT,IACKA,EAAO,GAAKA,EAAO,GACtB,OAAO,KACJG,IACHH,GAAQ,WAENC,EAAS,GAAKA,EAAS,IAEvBA,EAAS,GAAKA,EAAS,IAEvBC,EAAS,GAAKA,EAAS,GAHnB,KAKD,IAAIO,KAAKZ,EAAMC,EAAM,EAAGC,EAAKC,EAAMC,EAAQC,4BAGnD,mBAAU/G,MAEY,OAAjBA,EAAO/d,OAAmC,KAAjB+d,EAAO/d,MAE/BwQ,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBhC,EAAO/d,QACnD+d,EAAO/d,MAAQ,UAEX,GAAI+d,EAAO/d,iBAAiBqlB,KAEhCtH,EAAO/d,MAAQwQ,KAAK8U,SAASvH,EAAO/d,YAEhC,GAAI+d,EAAO/d,iBAAiBuP,EAAIgW,MAEpCxH,EAAO/d,MAAQwQ,KAAK8U,SAASvH,EAAO/d,MAAMwlB,YAEtC,GAA6B,iBAAlBzH,EAAO/d,MACvB,OACKA,EAAQ,kCACOwQ,KAAKkL,QAAQ+J,sDAChC,KADS9P,aAGM,QADd3V,EAAQwQ,KAAK+P,OAAOxC,EAAO/d,MAAO2V,IAEjC,qCAEY,OAAV3V,EACH+d,EAAO/d,MAAQwQ,KAAK8U,SAAStlB,GAE7B+d,EAAO3C,OAAOhe,KAAKoT,KAAKkV,gBAAgB3H,EAAO/d,aAKhD+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqBlC,EAAO/d,QACpD+d,EAAO/d,MAAQ,mCAIjB,8BAEKA,sFACCA,EACJ,OAAO,wCAEWwQ,KAAKkL,QAAQ+J,sDAChC,KADS9P,UAEJgQ,EAAOnV,KAAK+P,OAAOvgB,EAAO2V,MACjB,OAATgQ,EACH,OAAOnV,KAAK8U,SAASK,yCAEhB,mCAGR,wBAAe3lB,GAGbA,EADa,OAAVA,EACKuP,EAAIgV,QAAQvkB,EAAOwQ,KAAKkL,QAAQ8I,eAAgBhU,KAAKoI,QAAQhG,MAE7D,kFACY5S,sBA/OYod,IA4P/BwI,GAAgB,uOANnB,uBAActT,UAENA,aAAeuT,sBAJIzB,IAQR,CAAkB,KAAM,YAAa,8EAG5CyB,4LAEXtW,EAAI8B,QAAQmC,WAAb,wBAEQoS,2BAGR,kBAASD,UAED,IAAIpW,EAAIgW,MAAMI,EAAKG,cAAeH,EAAKI,WAAW,EAAGJ,EAAKK,0BATpC3B,IAsB3B4B,GAA0B,yRAN7B,uBAAc3T,UAENA,aAAe4T,gCAJc9B,IAQR,CAA4B,KAAM,sBAAuB,wFAG1E8B,8OAEX3W,EAAI8B,QAAQmC,WAAb,wBAEQyS,2BAGR,kBAASN,UAGRA,EAAKQ,WAAW,GAChBR,EAAKS,gBAAgB,GACdT,2BAZgCtB,IAyBrCgC,GAA0B,yRAN7B,uBAAc/T,UAENA,aAAegU,gCAJclC,IAQR,CAA4B,KAAM,sBAAuB,wFAG1EkC,8OAEX/W,EAAI8B,QAAQmC,WAAb,wBAEQ6S,2BAGR,kBAASV,UAGRA,EAAKS,gBAAgB,GACdT,2BAXgCtB,IA4B5BkC,+OAEZ,sBAAaC,EAAUxmB,EAAO8b,UAEhBtc,QACZ,SACAsc,EACA,OACU9b,QACAA,IAAUwQ,KAAKkL,QAAQ+K,SAAW,iBAAmB,cAClDD,EAAW,WAAa,iDAMvC,oCAA2BvK,SAEP,OAAfA,IACHA,EAAazL,KAAKkL,QAAQgL,aACvBnX,EAAIC,UAAUyM,KACjBA,EAAa,IAAI5M,IAAIrT,OAAOL,QAAQsgB,WAEjC0K,GAAgB,EAChBH,EAAW,IAAI3O,iCACIrH,KAAKwO,aAAaD,iBAAiB,kDAC1D,KACK/e,UAAmBkC,aAAa,SAChC+Z,EAAWzK,IAAIxR,GAClBwmB,EAASI,IAAI5mB,GACLA,IAAUwQ,KAAKkL,QAAQ+K,WAC/BE,GAAgB,sCAGdE,EAAe,GACW,OAA1BrW,KAAKkL,QAAQ+K,UAEhBI,EAAazpB,KACZoT,KAAKsW,aACJH,EACAnW,KAAKkL,QAAQ+K,SACe,OAA5BjW,KAAKkL,QAAQqL,WAAsBvW,KAAKkL,QAAQqL,WAAavW,KAAKoI,QAAQoO,4DAKpD/K,kCACzB,iCADUU,OAAK3c,OAEd6mB,EAAazpB,KACZoT,KAAKsW,aACJN,EAAShV,IAAImL,GACbA,EACAnM,KAAKyW,YAAYjnB,4CAIfgf,cAAakI,wBAAmBL,4CAGtC,mCAA0B5K,GAEN,OAAfA,EACHA,EAAazL,KAAKkL,QAAQO,WAClB1M,EAAIC,UAAUyM,KACtBA,EAAa,IAAI5M,IAAIrT,OAAOL,QAAQsgB,WAEjC0K,GAAgB,EAChBH,EAAW,IAAI3O,iCACGrH,KAAK8O,8CAC3B,KADS6H,UAEJnnB,EAAQmnB,EAAUjlB,aAAa,SAC/BilB,EAAUjH,UAETjE,EAAWzK,IAAIxR,GAClBwmB,EAASI,IAAI5mB,GACLA,IAAUwQ,KAAKkL,QAAQ+K,WAC/BE,GAAgB,uCAKfS,EAAiB5W,KAAKyO,UAAUL,cAAc,eAAiBpO,KAAKkL,QAAQ+K,SAAW,KACpE,OAAnBW,IACHA,EAAelH,QAAUyG,sCAEFnW,KAAKkL,QAAQO,2CACrC,iCADUU,OAELwK,QAAY3W,KAAKyO,UAAUL,cAAc,eAAiBjC,EAAM,MAChE0K,EAAY7W,KAAKyO,UAAUL,cAAc,aAAeuI,EAAU5W,GAAK,KAEvE0L,EAAWzK,IAAImL,IAElBwK,EAAUG,MAAMC,QAAU,SAC1BF,EAAUC,MAAMC,QAAU,SAC1BF,EAAUG,UAAYhX,KAAKyW,YAAYhL,EAAW3b,IAAIqc,MAItDwK,EAAUG,MAAMC,QAAU,OAC1BF,EAAUC,MAAMC,QAAU,OAC1BF,EAAUnH,SAAU,wDApGa9C,IA2G/BqK,oQAEL,uBAAcnV,UAENA,aAAeoV,4BAJUvK,IAQ9BwK,GAAsB,IAAIF,GAAoB,KAAM,kBAAmB,oDAG9DC,0NAEXnY,EAAI8B,QAAQmC,WAAb,wBAEQmU,2BAGR,sBAE0B,OAArBnX,KAAK8M,YACD9M,KAAK8M,YAEL9M,KAAKkL,QAAQO,mCAGtB,aAAejc,GAEVwQ,KAAK6L,YACR7L,KAAKoX,oBAAoB5nB,QACrBsd,YAActd,qCAGpB,6BAAoBic,+BAIpB,qBAAYjc,SAEW,iBAAXA,EACHA,EACCA,aAAiB6nB,GAClB7nB,EAAM8b,MAENvM,EAAIM,KAAK7P,mCAGlB,0BAAiB+d,OAEZzB,EAAIyB,EAAO/d,SACG,iBAAPsc,EACX,IAIyB,OAApB9L,KAAKyL,WACR,WACG6L,EAAatX,KAAKkL,QAAQO,WAAW3b,IAAIgc,WAC1Bhd,IAAfwoB,KAICtX,KAAKkL,QAAQqM,eACjB,oCAE+BvX,KAAKyL,WAAWtD,yCAC9C,KADSqP,aAEJ1L,IAAM0L,EAAkBlM,kBAE3BiC,EAAO/d,MAAQgoB,wCAQjBjK,EAAO3C,OAAOhe,KAAKoT,KAAKyX,sBAAsB3L,IAC9CyB,EAAO/d,MAAQ,UAKhB+d,EAAO/d,MAAQ8nB,OAGZ,GAAIxL,aAAauL,GACtB,CACarX,KAAKkL,QAAQO,WAAW3b,IAAIgc,EAAEK,OAC5BL,IAEbyB,EAAO3C,OAAOhe,KAAKoT,KAAK0X,qBAAqB5L,IAC7CyB,EAAO/d,MAAQ,WAKhB+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqB3D,IAC7CyB,EAAO/d,MAAQ,0BAvFmBumB,IA6F/B4B,gPAEL,uBAAc7V,UAENA,aAAe8V,wBAJMX,IAQ1BY,GAAkB,IAAIF,GAAgB,KAAM,cAAe,2EAGlDC,sMAEX7Y,EAAI8B,QAAQmC,WAAb,wBAEQ6U,gCAGR,6BAEKroB,EAAQwQ,KAAKxQ,aACH,OAAVA,EACI,KACDA,EAAM8b,+BAGd,mBAAUiC,OAELzB,EAAIyB,EAAO/d,MACL,OAANsc,GAAoB,KAANA,GAAY9L,KAAKkL,QAAQ+K,WAAanK,GAEnD9L,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBzD,IAC5CyB,EAAO/d,MAAQ,WAIVsoB,iBAAiBvK,oBA1BQ2J,IAwC7Ba,GAAuB,0QAN1B,uBAAcjW,UAENA,aAAekW,6BAJWL,IAQR,CAAyB,KAAM,mBAAoB,iFAGjEK,+NAEXjZ,EAAI8B,QAAQmC,WAAb,wBAEQ+U,2BAGR,sBAEQ/X,KAAKkO,UAAY,yDAGzB,6DAEkBlO,KAAK8O,8CACtB,KADS1V,aAEJA,EAAKsW,QACT,KACKvD,EAAM/S,EAAK1H,aAAa,gBACrBsO,KAAKkL,QAAQO,WAAW3b,IAAIqc,0CAI9B,mCAGR,wBAAe3c,GAEVA,aAAiB6nB,KACpB7nB,EAAQA,EAAM2c,KACD,OAAV3c,IACHA,EAAQwQ,KAAKkL,QAAQ+K,6CAELjW,KAAK8O,mDAAb1V,UACRA,EAAKsW,QAAUtW,EAAK1H,aAAa,WAAalC,qEAGhD,6BAAoBic,QAEdwM,0BAA0BxM,yBAvCKmM,IAoDlCM,GAAwB,+QAN3B,uBAAcpW,UAENA,aAAeqW,8BAJYR,IAQR,CAA0B,KAAM,oBAAqB,kFAGpEQ,oOAEXpZ,EAAI8B,QAAQmC,WAAb,wBAEQkV,iCAGR,8BAEK1oB,6FACAA,IAGFA,EADGA,IAAUwQ,KAAKkL,QAAQ+K,SAClB,KAEAjW,KAAKkL,QAAQO,WAAW3b,IAAIN,IAE/BA,gCAGR,wBAAeA,OAEV+d,EAAS,CAAC/d,MAAOA,EAAOob,OAAQ,SAC/B4C,UAAUD,sFACsB,MAAhBA,EAAO/d,MAAgB+d,EAAO/d,MAAM2c,IAAMnM,KAAKkL,QAAQ+K,6CAG7E,6BAAoBxK,QAEd2M,2BAA2B3M,0BA7BKmM,IA0CnCS,GAAwB,+QAN3B,uBAAcvW,UAENA,aAAewW,8BAJYX,IAQR,CAA0B,KAAM,oBAAqB,kFAGpEW,oOAEXvZ,EAAI8B,QAAQmC,WAAb,wBAEQqV,0BAJ8BT,IASjCW,wRAEL,uBAAczW,UAENA,aAAe0W,gCAJcvB,IAQlCwB,GAA0B,IAAIF,GAAwB,KAAM,sBAAuB,oFAG1EC,8OAEXzZ,EAAI8B,QAAQmC,WAAb,wBAEQyV,2BAGR,2BAE+B,IAAvBzY,KAAK+M,OAAO3e,oCAGpB,6BAEKoB,EAAQwQ,KAAKxQ,aACH,OAAVA,GAAmC,IAAjBA,EAAMpB,OACpB,KACDoB,EAAM4W,KAAI,SAAAsS,UAAQA,EAAKpN,SAAOhF,KAAK,+BAG3C,mBAAUiH,OAELzB,EAAIyB,EAAO/d,MACXmpB,EAAgD,mBAAtCntB,OAAOe,UAAUU,SAAS4N,KAAKiR,MAEnC,OAANA,GAAoB,KAANA,GAAY9L,KAAKkL,QAAQ+K,WAAanK,GAAM6M,GAAuB,IAAb7M,EAAE1d,OAErE4R,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBzD,IAC5CyB,EAAO/d,MAAQ,QAEX,GAAImpB,EACT,OACKC,EAAW,gCACE9M,kCACjB,KACK+M,EAAe,CAACrpB,cAAaob,OAAQ,SACpCkN,iBAAiBe,GAClBA,EAAajO,OAAOxc,OAAS,EAChCmf,EAAO3C,oCAAa2C,EAAO3C,2BAAWiO,EAAajO,SAEnDgO,EAAShsB,KAAKisB,EAAarpB,sCAE7B+d,EAAO/d,MAAQopB,YAIVd,iBAAiBvK,GAClBA,EAAO3C,OAAOxc,OAAS,EAC1Bmf,EAAO/d,MAAQ,GAEf+d,EAAO/d,MAAQ,CAAC+d,EAAO/d,gCAnDc0nB,IAiErC4B,GAAkC,iUANrC,uBAAchX,UAENA,aAAeiX,wCAJsBR,IAQR,CAAoC,KAAM,8BAA+B,yFAGlGQ,sRAEXha,EAAI8B,QAAQmC,WAAb,wBAEQ8V,2BAGR,sBAEQ9Y,KAAKkO,UAAY,yDAGzB,gCAEK1e,EAAQ,gCACKwQ,KAAK8O,8CACtB,KADS1V,aAEJA,EAAKsW,QACT,KACKvD,EAAM/S,EAAK1H,aAAa,SAC5BlC,EAAM5C,KAAKoT,KAAKkL,QAAQO,WAAW3b,IAAIqc,2CAIlC3c,gCAGR,wBAAeA,OAEV+d,EAAS,CAAC/d,MAAOA,EAAOob,OAAQ,SAC/B4C,UAAUD,SACXpF,EAAS,IAAId,iCACCkG,EAAO/d,2CAAhBA,UACR2Y,EAAOiO,IAAI5mB,EAAM2c,uEAEDnM,KAAK8O,mDAAb1V,UACRA,EAAKsW,QAAUvH,EAAOnH,IAAI5H,EAAK1H,aAAa,6EAG9C,6BAAoB+Z,QAEdwM,0BAA0BxM,oCAzCgB+M,IAsD7CQ,GAAgC,uTANnC,uBAAclX,UAENA,aAAemX,sCAJoBV,IAQR,CAAkC,KAAM,4BAA6B,0FAE5FU,4QAEXla,EAAI8B,QAAQmC,WAAb,wBAEQgW,iCAGR,gCAEKxpB,EAAQ,gCACOwQ,KAAKwO,aAAaD,iBAAiB,0CACtD,KADS2K,UAEJA,EAAOlD,UACVxmB,EAAM5C,KAAKoT,KAAKkL,QAAQO,WAAW3b,IAAIopB,EAAOxnB,aAAa,iDAEtDlC,gCAGR,wBAAeA,OAEV+d,EAAS,CAAC/d,MAAOA,EAAOob,OAAQ,SAC/B4C,UAAUD,SACXpF,EAAS,IAAId,iCACCkG,EAAO/d,2CAAhBA,UACR2Y,EAAOiO,IAAI5mB,EAAM2c,uEACCnM,KAAKwO,aAAaD,iBAAiB,+CAA7C2K,UACRA,EAAOlD,SAAW7N,EAAOnH,IAAIkY,EAAOxnB,aAAa,6EAGnD,6BAAoB+Z,QAEd2M,2BAA2B3M,kCA/Ba+M,IA4C3CW,GAAgC,uTANnC,uBAAcrX,UAENA,aAAesX,sCAJoBb,IAQR,CAAkC,KAAM,4BAA6B,0FAG5Fa,4QAEXra,EAAI8B,QAAQmC,WAAb,wBAEQmW,kCAJsCX,IASzCa,mRAEL,uBAAcvX,UAENA,aAAewX,+BAJa3M,IAQjC4M,GAAyB,IAAIF,GAAuB,KAAM,qBAAsB,0DAGvEC,yOAEXva,EAAI8B,QAAQmC,WAAb,wBAEQuW,2BAGR,sBAE0B,OAArBvZ,KAAK8M,YACD9M,KAAK8M,YAG4B,OAApC9M,KAAKkL,QAAQsO,WAAWC,QACpBzZ,KAAKkL,QAAQsO,WAAWC,QAE1B,IAAI5a,4BAGZ,aAAerP,GAEVwQ,KAAK6L,YACR7L,KAAKoX,oBAAoB5nB,QACrBsd,YAActd,qCAGpB,6BAAoBic,+BAIpB,qBAAYjc,SAEW,iBAAXA,EACHA,EACCA,aAAiBiZ,GAClBjZ,EAAMkqB,QAAQ1Z,KAAKkL,QAAQyO,iBAE3B5a,EAAIM,KAAK7P,+BAGlB,sBAAa+d,OAERzB,EAAIyB,EAAO/d,SACG,iBAAPsc,EACX,KACKlK,EAA6C,OAApC5B,KAAKkL,QAAQsO,WAAWC,QACpCzZ,KAAKkL,QAAQsO,WAAWC,QAAQ3pB,IAAIgc,QACpChd,OAGcA,IAAX8S,GAEH2L,EAAO3C,OAAOhe,KAAKoT,KAAK4Z,yBAAyB9N,IACjDyB,EAAO/d,MAAQ,MAIf+d,EAAO/d,MAAQoS,OAGRkK,aAAarD,GAEjBqD,EAAExJ,MAAQtC,KAAKkL,QAAQsO,aAE1BjM,EAAO3C,OAAOhe,KAAKoT,KAAK6Z,0BAA0B/N,IAClDyB,EAAO/d,MAAQ,OAKhB+d,EAAO3C,OAAOhe,KAAKoT,KAAKyP,qBAAqB3D,IAC7CyB,EAAO/d,MAAQ,aAIhBuP,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEd,eAATiK,EACHuG,KAAKyL,WAAajc,EAElB+c,mDAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,2BAhFIumB,IAmFxCuD,GAAmB/sB,UAAUwU,UAAY,IAAIsG,iCAAQuF,GAAMrgB,UAAUwU,YAAW,oBAI1E+Y,+PAEL,uBAAchY,UAENA,aAAeiY,2BAJSV,IAQ7BW,GAAqB,IAAIF,GAAmB,KAAM,iBAAkB,8EAG3DC,qNAEXhb,EAAI8B,QAAQmC,WAAb,wBAEQgX,gCAGR,6BAAc/O,yDAAS,EAElBzb,EAAQwQ,KAAKxQ,aACH,OAAVA,EACI,KACD,IAAMwQ,KAAKxQ,MAAMkqB,QAAQzO,GAAY,6BAG7C,mBAAUsC,QAEJ0M,aAAa1M,uBAjBgB+L,IA8BhCY,GAA2B,8RAN9B,uBAAcpY,UAENA,aAAeqY,iCAJeL,IAQR,CAA6B,KAAM,uBAAwB,yFAG7EK,mPAEXpb,EAAI8B,QAAQmC,WAAb,wBAEQkX,iCAGR,8BAEK1qB,gGAEoC,OAApCwQ,KAAKkL,QAAQsO,WAAWC,aAGb3qB,KADdU,EAAQwQ,KAAKkL,QAAQsO,WAAWC,QAAQ3pB,IAAIN,MAE3CA,EAAQ,MAGTA,EAAQ,KACFA,gCAGR,wBAAeA,OAEV+d,EAAS,CAAC/d,MAAOA,EAAOob,OAAQ,SAC/B4C,UAAUD,yFACsB,MAAhBA,EAAO/d,MAAgB+d,EAAO/d,MAAMuQ,GAAKC,KAAKkL,QAAQ+K,6CAG5E,6BAAoBxK,QAEd2M,2BAA2B3M,6BA/BQsO,IA4CtCK,GAA0B,yRAN7B,uBAActY,UAENA,aAAeuY,gCAJcP,IAQR,CAA4B,KAAM,sBAAuB,wFAG1EO,8OAEXtb,EAAI8B,QAAQmC,WAAb,wBAEQoX,4BAJgCL,IAiBrCO,GAA2B,8RAN9B,uBAAcxY,UAENA,aAAeyY,iCAJeT,IAQR,CAA6B,KAAM,uBAAwB,yFAG7ES,mPAEXxb,EAAI8B,QAAQmC,WAAb,wBAEQsX,6BAJiCP,IASpCS,uSAEL,uBAAc1Y,UAENA,aAAe2Y,mCAJiBpB,IAQrCqB,GAA6B,IAAIF,GAA2B,KAAM,yBAA0B,uFAGnFC,6PAEX1b,EAAI8B,QAAQmC,WAAb,wBAEQ0X,2BAGR,2BAE+B,IAAvB1a,KAAK+M,OAAO3e,gCAGpB,mBAAUmf,OAELzB,EAAIyB,EAAO/d,MACXmpB,EAAgD,mBAAtCntB,OAAOe,UAAUU,SAAS4N,KAAKiR,MAEnC,OAANA,GAAoB,KAANA,GAAY9L,KAAKkL,QAAQ+K,WAAanK,GAAM6M,GAAuB,IAAb7M,EAAE1d,OAErE4R,KAAKkL,QAAQoE,UAChB/B,EAAO3C,OAAOhe,KAAKoT,KAAKuP,mBAAmBzD,IAC5CyB,EAAO/d,MAAQ,QAEX,GAAImpB,EACT,OACKC,EAAW,gCACE9M,kCACjB,KACK+M,EAAe,CAACrpB,cAAaob,OAAQ,SACpCqP,aAAapB,GACdA,EAAajO,OAAOxc,OAAS,EAChCmf,EAAO3C,oCAAa2C,EAAO3C,2BAAWiO,EAAajO,SAEnDgO,EAAShsB,KAAKisB,EAAarpB,sCAE7B+d,EAAO/d,MAAQopB,YAIVqB,aAAa1M,GACdA,EAAO3C,OAAOxc,OAAS,EAC1Bmf,EAAO/d,MAAQ,GAEf+d,EAAO/d,MAAQ,CAAC+d,EAAO/d,mCA3CiB8pB,IAyDxCqB,GAAqC,gVANxC,uBAAc7Y,UAENA,aAAe8Y,2CAJyBJ,IAQR,CAAuC,KAAM,iCAAkC,mGAG3GI,qSAEX7b,EAAI8B,QAAQmC,WAAb,wBAEQ2X,uCAJ2CF,IAiBhDI,GAAmC,sUANtC,uBAAc/Y,UAENA,aAAegZ,yCAJuBN,IAQR,CAAqC,KAAM,+BAAgC,iGAGrGM,2RAEX/b,EAAI8B,QAAQmC,WAAb,wBAEQ6X,sCAGR,6BAAoBpP,QAEd2M,2BAA2B3M,qCATgBgP,IAsB9CM,GAAmC,sUANtC,uBAAcjZ,UAENA,aAAekZ,yCAJuBR,IAQR,CAAqC,KAAM,+BAAgC,iGAGrGQ,2RAEXjc,EAAI8B,QAAQmC,WAAb,wBAEQ+X,qCAJyCN,IAS5CQ,4NAEL,uBAAcnZ,UAENA,aAAeoZ,oBAJEnc,EAAIiD,MAQ1BmZ,GAAc,IAAIF,GAAY,KAAM,UAAW,6DAGtCC,kLAEXnc,EAAI8B,QAAQmC,WAAb,wBAEQmY,UAGPpc,EAAI8B,QAAQa,WAAb,uBAEQ,IAAM1B,KAAKtQ,YAAY+J,KAAO,OAASsF,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,yBAGlH,sBAEQtI,KAAKsC,IAAI8F,8BAGjB,sBAEQpI,KAAKob,QAAUpb,KAAKgD,KAAO,IAAMhD,KAAKob,QAAUpb,KAAKgD,wBAG7D,mBAEKqY,EAAerb,KAAKsb,mBACH,OAAjBD,EACH,OAAOrb,KAAK6M,WACTvB,EAAQ+P,EAAa/P,aACX,OAAVA,EACItL,KAAK6M,OACNvB,qBAGR,aAAU9b,QAEJqd,OAASrd,uBAGf,sBAEQ,sBAGR,mBAEK6rB,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaE,IAAM,uBAGnD,mBAEKF,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaG,KAAO,wBAGpD,mBAEKH,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAa1W,MAAQ,yBAGrD,mBAEK0W,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAazW,OAAS,0BAGtD,mBAEKyW,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaI,QAAU,6BAGvD,mBAEKJ,EAAerb,KAAKsb,uBACA,OAAjBD,GAAwBA,EAAaK,iCAG7C,mBAEKL,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaM,SAAW,2BAGxD,mBAEKN,EAAerb,KAAKsb,uBACA,OAAjBD,GAAwBA,EAAa/L,2BAG7C,mBAEK+L,EAAerb,KAAKsb,uBACM,OAA1Btb,KAAKsC,IAAI8G,cAA0C,OAAjBiS,EAC9B,KACsB,OAA1Brb,KAAKsC,IAAI8F,QAAQ7F,KACb,UACgB,OAAjB8Y,EAAwBA,EAAa9Y,KAAO,6BAGpD,mBAEK8Y,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaO,SAAW,+BAGxD,mBAEKP,EAAerb,KAAKsb,uBACA,OAAjBD,EAAwBA,EAAaQ,WAAa,4BAG1D,mBAEKR,EAAerb,KAAKsb,uBACA,OAAjBD,GAAwBA,EAAaS,sCAG7C,sBAGyB,OADL9b,KAAKsb,6CAIzB,4BAE+B,OAA1Btb,KAAKsC,IAAI8G,aACZ,OAAO,SACJiS,EAAerb,KAAKsC,IAAI8G,aAAaF,SAASpZ,IAAIkQ,KAAKsI,mBACpD+S,MAAAA,EAAAA,EAAgB,+BAGxB,oBAAW7rB,EAAO4c,0BASlB,gBAAO5c,EAAO4c,UAEN,eAhJoBtM,GAoJ7Bob,GAAQ3uB,UAAUyW,KAAO,KACzBkY,GAAQ3uB,UAAU6uB,QAAU,KAC5BF,GAAQ3uB,UAAU2T,YAAc,CAAC,aAAc,YAAa,MAAO,SAAU,WAAY,QAAS,oBAAqB,qBACvHgb,GAAQ3uB,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,aAAc,YAAa,MAAO,WAAY,QAAS,oBAAqB,oBAAqB,WAAY,QAAS,MAAO,OAAQ,QAAS,SAAU,UAAW,aAAc,WAAY,WAAY,OAAQ,WAAY,YAAa,mBACvR6T,GAAQ3uB,UAAU0hB,eAAiB,eACnCiN,GAAQ3uB,UAAU4hB,kBAAoB,YAWlC4N,GAAkB,iPANrB,uBAAcja,UAENA,aAAeka,wBAJMf,IAQR,CAAoB,KAAM,cAAe,4CAGlDe,sMAEXjd,EAAI8B,QAAQmC,WAAb,wBAEQ+Y,yBAIR,gBAAOvsB,EAAO4c,eAER6P,WAAWzsB,EAAO4c,GACC,WAApBA,EAAO8P,UACH9P,EAAO5c,QAAUA,mBAZM0rB,IAkBjCc,GAAYzvB,UAAUyW,KAAO,OAC7BgZ,GAAYzvB,UAAUof,UAAY0D,OAW9B8M,GAAiB,4OANpB,uBAAcra,UAENA,aAAesa,uBAJKnB,IAQR,CAAmB,KAAM,aAAc,2CAG/CmB,iMAEXrd,EAAI8B,QAAQmC,WAAb,wBAEQmZ,yBAIR,gBAAO3sB,EAAO4c,eAER6P,WAAWzsB,EAAO4c,GACC,WAApBA,EAAO8P,UACH9P,EAAO5c,QAAUA,kBAZK0rB,IAkBhCkB,GAAW7vB,UAAUyW,KAAO,MAC5BoZ,GAAW7vB,UAAUof,UAAYkE,OAG3BwM,mRAEL,uBAAcva,UAENA,aAAewa,gDAJarB,IAQjCsB,GAAyB,IAAIF,GAAuB,KAAM,qBAAsB,6CAG9EG,yOAEJzd,EAAI8B,QAAQmC,WAAb,wBAEQuZ,4BAGR,mBAEKlB,EAAerb,KAAKsb,uBACH,OAAjBD,EACI,KACDA,EAAaoB,oCAZWvB,IAgBjCsB,GAAmBjwB,UAAUwU,UAAY,IAAIsG,iCAAQ6T,GAAQ3uB,UAAUwU,YAAW,qBAW9E2b,GAAoB,2PANvB,uBAAc5a,UAENA,aAAe6a,0BAJQN,IAQR,CAAsB,KAAM,gBAAiB,6CAGxDM,gNAEX5d,EAAI8B,QAAQmC,WAAb,wBAEQ0Z,yBAIR,gBAAOltB,EAAO4c,eAER6P,WAAWzsB,EAAO4c,GACC,WAApBA,EAAO8P,SACH9P,EAAO5c,QAAUA,EACI,UAApB4c,EAAO8P,WAED,OAAV1sB,KAEwB,OAApB4c,EAAOwQ,UAAqBxQ,EAAOwQ,UAAYptB,KAA+B,OAApB4c,EAAOyQ,UAAqBrtB,EAAQ4c,EAAOyQ,+BAjB7EL,IAwBnCG,GAAcpwB,UAAUyW,KAAO,SAC/B2Z,GAAcpwB,UAAUof,UAAY2E,GACpCqM,GAAcpwB,UAAU2T,yCAAkBgb,GAAQ3uB,UAAU2T,cAAa,YAAa,UAAW,YACjGyc,GAAcpwB,UAAUwU,UAAY,IAAIsG,iCAAQ6T,GAAQ3uB,UAAUwU,YAAW,YAAa,UAAW,iBAG/F+b,0PAEL,uBAAchb,UAENA,aAAeib,0BAJQV,IAQ5BW,GAAoB,IAAIF,GAAkB,KAAM,gBAAiB,6CAGxDC,gNAEXhe,EAAI8B,QAAQmC,WAAb,wBAEQga,oCAGR,2BAAkB7a,EAAMsa,MAEH,OAAhBA,EACH,OAAO,YACAA,OAEF,kBACY,OAATta,EAAgBA,EAAK8a,OAAS,SACjC,iBACY,OAAT9a,EAAgBA,EAAK6F,MAAQ,SAChC,qBACY,OAAT7F,EAAgBA,EAAK+a,UAAY,SACpC,mBACY,OAAT/a,EAAgBA,EAAKgb,QAAU,SAClC,mBACY,OAAThb,EAAgBA,EAAKib,MAAQ,SAChC,sBACY,OAATjb,EAAgBA,EAAKkb,WAAa,SACrC,wBACY,OAATlb,EAAgBA,EAAKmb,aAAe,SACvC,kBACS,OAATnb,EACI,KACiB,OAAhBA,EAAKob,OACNpb,EAAKmb,aACkB,OAAtBnb,EAAKmb,aACNnb,EAAKob,OAELpb,EAAKob,OAAS,IAAMpb,EAAKmb,iBAC7B,eACY,OAATnb,EAAgBA,EAAKqb,IAAM,SAC9B,iBACY,OAATrb,EAAgBA,EAAKsb,MAAQ,SAChC,eACY,OAATtb,EAAgBA,EAAKub,IAAM,SAC9B,mBACY,OAATvb,EAAgBA,EAAKwb,QAAU,SAClC,gBACY,OAATxb,EAAgBA,EAAKyb,KAAO,SAC/B,mBACY,OAATzb,EAAgBA,EAAK0b,QAAU,SAClC,qBACY,OAAT1b,EAAgBA,EAAK2b,UAAY,SACpC,4BACY,OAAT3b,EAAgBA,EAAK4b,iBAAmB,SAC3C,2BACY,OAAT5b,EAAgBA,EAAK6b,gBAAkB,SAC1C,oBACY,OAAT7b,EAAgBA,EAAKyD,SAAW,SACnC,sBACY,OAATzD,EAAgBA,EAAK8b,WAAa,SACrC,iBACGlf,EAAImf,uBAEJzB,wBAIV,mBAEKpB,EAAerb,KAAKsb,uBAEH,OAAjBD,EACI,KAEDrb,KAAKme,kBAAkBne,KAAKsC,IAAI8F,QAAQjG,KAAMkZ,kCAGtD,mBAEKA,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,MACJtN,EAAYsN,EAAatN,iBACX,OAAdA,GAAsBA,EAAY,EAC9B,EACDA,yBAGR,mBAEKsN,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,QACJrN,EAAYqN,EAAarN,iBACX,OAAdA,GAAsBA,EAAY,GAAKA,EAAY,IAC/C,IACDA,wBAGR,gBAAOxe,EAAO4c,eAER6P,WAAWzsB,EAAO4c,GACC,WAApBA,EAAO8P,SACH9P,EAAO5c,QAAUA,EACI,aAApB4c,EAAO8P,SAEM,OAAjB9P,EAAO5c,OAA4B,OAAVA,EACrB4c,EAAO5c,QAAUA,EAEjBA,EAAMzC,cAAcQ,QAAQ6e,EAAO5c,MAAMzC,gBAAkB,OAL/D,qBAxG4ByvB,IAkHnCO,GAAcxwB,UAAUyW,KAAO,aAW3Bob,GAAkB,iPANrB,uBAActc,UAENA,aAAeuc,wBAJMvB,IAQR,CAAoB,KAAM,cAAe,gDAGlDuB,sMAEXtf,EAAI8B,QAAQmC,WAAb,wBAEQob,oBAJwBrB,IAQjCsB,GAAY9xB,UAAU6uB,QAAU,OAChCiD,GAAY9xB,UAAUof,UAAY2F,OAW9BgN,GAAsB,qQANzB,uBAAcxc,UAENA,aAAeyc,4BAJUzB,IAQR,CAAwB,KAAM,kBAAmB,wDAG9DyB,0NAEXxf,EAAI8B,QAAQmC,WAAb,wBAEQsb,wBAJ4BvB,IAQrCwB,GAAgBhyB,UAAU6uB,QAAU,WACpCmD,GAAgBhyB,UAAUof,UAAYgG,OAWlC6M,GAAmB,sPANtB,uBAAc1c,UAENA,aAAe2c,yBAJO3B,IAQR,CAAqB,KAAM,eAAgB,kDAGrD2B,2MAEX1f,EAAI8B,QAAQmC,WAAb,wBAEQwb,qBAJyBzB,IAQlC0B,GAAalyB,UAAU6uB,QAAU,QACjCqD,GAAalyB,UAAUof,UAAYkG,OAW/B6M,GAAiB,4OANpB,uBAAc5c,UAENA,aAAe6c,uBAJK7B,IAQR,CAAmB,KAAM,aAAc,8CAG/C6B,iMAEX5f,EAAI8B,QAAQmC,WAAb,wBAEQ0b,mBAJuB3B,IAQhC4B,GAAWpyB,UAAU6uB,QAAU,MAC/BuD,GAAWpyB,UAAUof,UAAYqG,OAW7B4M,GAAiB,4OANpB,uBAAc9c,UAENA,aAAe+c,uBAJK/B,IAQR,CAAmB,KAAM,aAAc,uDAG/C+B,iMAEX9f,EAAI8B,QAAQmC,WAAb,wBAEQ4b,mBAJuB7B,IAQhC8B,GAAWtyB,UAAU6uB,QAAU,MAC/ByD,GAAWtyB,UAAUof,UAAY2G,OAW7BwM,GAAsB,qQANzB,uBAAchd,UAENA,aAAeid,4BAJUjC,IAQR,CAAwB,KAAM,kBAAmB,wDAG9DiC,0NAEXhgB,EAAI8B,QAAQmC,WAAb,wBAEQ8b,0BAGR,mBAEKzD,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,QAEe,OAAnBrb,KAAKgf,UACR,OAAO,SACJhR,EAAYqN,EAAarN,iBACzBA,EAAY,EACR,KACDA,uBAnB4B+O,IAuBrCgC,GAAgBxyB,UAAU6uB,QAAU,WACpC2D,GAAgBxyB,UAAUof,UAAY8G,GACtCsM,GAAgBxyB,UAAU2T,yCAAkB6c,GAAcxwB,UAAU2T,cAAa,cACjF6e,GAAgBxyB,UAAUwU,UAAY,IAAIsG,iCAAQ0V,GAAcxwB,UAAUwU,YAAW,eACrFge,GAAgBxyB,UAAU4hB,kBAAoB,eAW1C8Q,GAAkB,iPANrB,uBAAcnd,UAENA,aAAeod,wBAJMpC,IAQR,CAAoB,KAAM,cAAe,gDAGlDoC,sMAEXngB,EAAI8B,QAAQmC,WAAb,wBAEQic,oBAJwBlC,IAQjCmC,GAAY3yB,UAAU6uB,QAAU,OAChC8D,GAAY3yB,UAAUof,UAAYgH,OAG5BwM,gPAEL,uBAAcrd,UAENA,aAAesd,wBAJM/C,IAQ1BgD,GAAkB,IAAIF,GAAgB,KAAM,cAAe,8CAGlDC,sMAEXrgB,EAAI8B,QAAQmC,WAAb,wBAEQqc,wBAGR,mBAEKhE,EAAerb,KAAKsb,uBAEH,OAAjBD,EACI,KAEwB,YAAzBA,UAAqCtc,EAAImf,QAAU,iCAG3D,sBAAa9b,SAIC,QAFbA,EAAOA,GAAQpC,KAAKoI,QAAQhG,OAEE,OAATA,GAA0B,OAATA,IACrCA,EAAO,MACDpC,KAAKsf,eAAeld,sCAG5B,6BAAoBA,SAGN,QADbA,EAAOA,GAAQpC,KAAKoI,QAAQhG,OACE,OAATA,GAA0B,OAATA,IACrCA,EAAO,mCAGJpC,KAAKuf,qBAAqBnd,uBAC1BpC,KAAKuf,qBAAL,6BAKL,gBAAO/vB,EAAO4c,QAER6P,WAAWzsB,EAAO4c,OAEnByB,EAAczB,EAAO5c,YAC0B,iBAA/ChE,OAAOe,UAAUU,SAAS4N,KAAKgT,KAClCA,EAAc9O,EAAIgV,QAAQlG,EAAa7N,KAAKgU,eAAgBhU,KAAKsC,IAAIkd,WACxD,OAAVhwB,IACHA,EAAQuP,EAAIgV,QAAQvkB,EAAOwQ,KAAKgU,eAAgBhU,KAAKsC,IAAIkd,WAElC,WAApBpT,EAAO8P,SACHrO,IAAgBre,EACK,aAApB4c,EAAO8P,WAEK,OAAhBrO,GAAkC,OAAVre,EACpBqe,IAAgBre,EAEhBA,EAAMzC,cAAcQ,QAAQsgB,EAAY9gB,gBAAkB,oBAxDpCyvB,IA+DjC4C,GAAY7yB,UAAUyW,KAAO,OAC7Boc,GAAY7yB,UAAU6uB,QAAU,OAChCgE,GAAY7yB,UAAUof,UAAY0J,GAClC+J,GAAY7yB,UAAU+yB,eAAiB,IAChC,cACA,cACA,cACA,gBACE,YAGT,IAAIG,GAAY,CACf,GACA,SACA,SACA,YACA,YACA,eACA,eACA,WACA,WACA,cACA,cACA,iBACA,iBACA,YACA,YACA,eACA,eACA,kBACA,mBAGDL,GAAY7yB,UAAUgzB,qBAAuB,IACtCE,GAAUrZ,KAAI,SAAA4I,SAAK,WAAaA,QAChCyQ,GAAUrZ,KAAI,SAAA4I,SAAK,WAAaA,QAChCyQ,GAAUrZ,KAAI,SAAA4I,SAAK,WAAaA,QAChCyQ,GAAUrZ,KAAI,SAAA4I,SAAK,WAAaA,UAC9ByQ,GAAUrZ,KAAI,SAAA4I,SAAK,WAAaA,UAYrC0Q,GAA4B,mSAN/B,uBAAc5d,UAENA,aAAe6d,kCAJgBR,IAQR,CAA8B,KAAM,wBAAyB,wDAGhFQ,wPAEX5gB,EAAI8B,QAAQmC,WAAb,wBAEQ0c,wBAGR,mBAEKrE,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,QAEqB,YAAzBA,UACJ,KACKuE,EAAM,IAAI/K,YACd+K,EAAIjK,WAAW,GACfiK,EAAIhK,gBAAgB,GACbgK,EAGP,OAAO,gCAtBiCR,IA0B3CO,GAAsBpzB,UAAU6uB,QAAU,iBAC1CuE,GAAsBpzB,UAAUof,UAAY+J,GAC5CiK,GAAsBpzB,UAAU+yB,eAAiB,IAC1C,oBACA,oBACA,oBACA,sBACE,sBAYLO,GAA4B,mSAN/B,uBAAc/d,UAENA,aAAege,kCAJgBX,IAQR,CAA8B,KAAM,wBAAyB,wDAGhFW,wPAEX/gB,EAAI8B,QAAQmC,WAAb,wBAEQ6c,wBAGR,mBAEKxE,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,QAEqB,YAAzBA,UACJ,KACKuE,EAAM,IAAI/K,YACd+K,EAAIhK,gBAAgB,GACbgK,EAGP,OAAO,gCArBiCR,IAyB3CU,GAAsBvzB,UAAU6uB,QAAU,iBAC1C0E,GAAsBvzB,UAAUof,UAAYmK,GAC5CgK,GAAsBvzB,UAAU+yB,eAAiB,IAC1C,uBACA,uBACA,uBACA,yBACE,yBAIHS,0PAEL,uBAAcje,UAENA,aAAeke,0BAJQ/E,IAQ5BgF,GAAoB,IAAIF,GAAkB,KAAM,gBAAiB,2CAGxDC,gNAEXjhB,EAAI8B,QAAQmC,WAAb,wBAEQid,wBAGR,qBAEK5E,EAAerb,KAAKsb,uBAEH,OAAjBD,EACI,eAEDrb,KAAKyL,WAAW3b,IAAIurB,kBAAiB,iCAG7C,mBAEKA,EAAerb,KAAKsb,uBACH,OAAjBD,GAEGA,EAAa9D,qCAGrB,mBAEK8D,EAAerb,KAAKsb,uBACH,OAAjBD,EACI,KACDA,EAAa6E,sCAGrB,mBAEK7E,EAAerb,KAAKsb,uBACH,OAAjBD,EACI,KACDA,EAAa8E,sCAIrB,gBAAO3wB,EAAO4c,SAEW,WAApBA,EAAO8P,WAEI,OAAV1sB,EACqB,OAAjB4c,EAAO5c,MAEPA,EAAM2c,MAAQC,EAAO5c,0BAjDG0rB,IAwDnC8E,GAAczzB,UAAUyW,KAAO,SAC/Bgd,GAAczzB,UAAUof,UAAYiM,GACpCoI,GAAczzB,UAAU2T,yCAAkBgb,GAAQ3uB,UAAU2T,cAAa,eACzE8f,GAAczzB,UAAUwU,UAAY,IAAIsG,iCAAQ6T,GAAQ3uB,UAAUwU,YAAW,oBAWzEqf,GAA0B,yRAN7B,uBAActe,UAENA,aAAeue,gCAJcN,IAQR,CAA4B,KAAM,sBAAuB,oDAG1EM,8OAEXthB,EAAI8B,QAAQmC,WAAb,wBAEQod,4BAJgCJ,IAQzCK,GAAoB9zB,UAAU6uB,QAAU,SACxCiF,GAAoB9zB,UAAUof,UAAYwM,GAC1CkI,GAAoB9zB,UAAU4hB,kBAAoB,aAW9CmS,GAAyB,oRAN5B,uBAAcxe,UAENA,aAAeye,+BAJaR,IAQR,CAA2B,KAAM,qBAAsB,mDAGvEQ,yOAEXxhB,EAAI8B,QAAQmC,WAAb,wBAEQsd,2BAJ+BN,IAQxCO,GAAmBh0B,UAAU6uB,QAAU,QACvCmF,GAAmBh0B,UAAUof,UAAYqM,GACzCuI,GAAmBh0B,UAAU0hB,eAAiB,mBAW1CuS,GAA0B,yRAN7B,uBAAc1e,UAENA,aAAe2e,gCAJcV,IAQR,CAA4B,KAAM,sBAAuB,oDAG1EU,8OAEX1hB,EAAI8B,QAAQmC,WAAb,wBAEQwd,4BAJgCR,IAQzCS,GAAoBl0B,UAAU6uB,QAAU,SACxCqF,GAAoBl0B,UAAUof,UAAY2M,OAGpCoI,yQAEL,uBAAc5e,UAENA,aAAe6e,6BAJW1F,IAQ/B2F,GAAuB,IAAIF,GAAqB,KAAM,mBAAoB,gDAGjEC,+NAEX5hB,EAAI8B,QAAQmC,WAAb,wBAEQ4d,2BAGR,sBAEyB,OAApB5gB,KAAKwZ,YAAmD,OAA5BxZ,KAAKwZ,WAAWC,QACxCzZ,KAAKwZ,WAAWC,QAEhB,IAAI5a,0BAGb,mBAEKwc,EAAerb,KAAKsb,uBACH,OAAjBD,EACI,KACDA,EAAa6E,sCAGrB,mBAEK7E,EAAerb,KAAKsb,uBACH,OAAjBD,EACI,KACDA,EAAa8E,sCAIrB,gBAAO3wB,EAAO4c,UAEC,OAAV5c,GAAmC,OAAjB4c,EAAO5c,MACrBA,IAAU4c,EAAO5c,MAEjBA,EAAM4c,OAAOA,yBArCe8O,IAyCtCyF,GAAiBp0B,UAAUyW,KAAO,YAClC2d,GAAiBp0B,UAAUof,UAAYoO,GACvC4G,GAAiBp0B,UAAU2T,yCAAkBgb,GAAQ3uB,UAAU2T,cAAa,aAAc,kBAAmB,uBAAwB,wBAAyB,0BAC9JygB,GAAiBp0B,UAAUwU,UAAY,IAAIsG,iCAAQ6T,GAAQ3uB,UAAUwU,YAAW,aAAc,kBAAmB,uBAAwB,wBAAyB,+BAW9J8f,GAA6B,wSANhC,uBAAc/e,UAENA,aAAegf,mCAJiBJ,IAQR,CAA+B,KAAM,yBAA0B,0DAGnFI,6PAEX/hB,EAAI8B,QAAQmC,WAAb,wBAEQ6d,+BAJmCF,IAQ5CG,GAAuBv0B,UAAU6uB,QAAU,SAC3C0F,GAAuBv0B,UAAUof,UAAYwO,GAC7C2G,GAAuBv0B,UAAU4hB,kBAAoB,aAWjD4S,GAA4B,mSAN/B,uBAAcjf,UAENA,aAAekf,kCAJgBN,IAQR,CAA8B,KAAM,wBAAyB,yDAGhFM,wPAEXjiB,EAAI8B,QAAQmC,WAAb,wBAEQ+d,8BAJkCJ,IAQ3CK,GAAsBz0B,UAAU6uB,QAAU,QAC1C4F,GAAsBz0B,UAAUof,UAAY0O,OAWxC4G,GAA6B,wSANhC,uBAAcnf,UAENA,aAAeof,mCAJiBR,IAQR,CAA+B,KAAM,yBAA0B,0DAGnFQ,6PAEXniB,EAAI8B,QAAQmC,WAAb,wBAEQie,+BAJmCN,IAQ5CO,GAAuB30B,UAAU6uB,QAAU,SAC3C8F,GAAuB30B,UAAUof,UAAY4O,OAGvC4G,kSAEL,uBAAcrf,UAENA,aAAesf,kCAJgBrB,IAQpCsB,GAA4B,IAAIF,GAA0B,KAAM,wBAAyB,oEAGhFC,wPAEXriB,EAAI8B,QAAQmC,WAAb,wBAEQqe,wBAGR,mBAEKhG,EAAerb,KAAKsb,mBAEH,OAAjBD,EACH,OAAO,SAEJiG,EAAethB,KAAKyL,WAAW3b,IAAIurB,eAEdvsB,IAAjBwyB,EAA8B,CAACA,GAAgB,yBAIxD,gBAAO9xB,EAAO4c,MAEW,WAApBA,EAAO8P,SACX,oCACkB1sB,kCACjB,YACU2c,MAAQC,EAAO5c,MACvB,OAAO,wCAEF,EAGP,OAAO,6BAhCiCwwB,IAoC3CoB,GAAsB70B,UAAUyW,KAAO,iBACvCoe,GAAsB70B,UAAUof,UAAY6M,OAWxC+I,GAAoC,2UANvC,uBAAczf,UAENA,aAAe0f,0CAJwBL,IAQR,CAAsC,KAAM,gCAAiC,sEAGxGK,gSAEXziB,EAAI8B,QAAQmC,WAAb,wBAEQue,2BAGR,sBAEQvhB,KAAKkO,UAAY,8DATyBkT,IAanDI,GAA8Bj1B,UAAU6uB,QAAU,WAClDoG,GAA8Bj1B,UAAUof,UAAYoN,GACpDyI,GAA8Bj1B,UAAU0hB,eAAiB,mBAWrDwT,GAAkC,iUANrC,uBAAc3f,UAENA,aAAe4f,wCAJsBP,IAQR,CAAoC,KAAM,8BAA+B,oEAGlGO,sRAEX3iB,EAAI8B,QAAQmC,WAAb,wBAEQye,oCAJwCL,IAQjDM,GAA4Bn1B,UAAU6uB,QAAU,SAChDsG,GAA4Bn1B,UAAUof,UAAYsN,GAClDyI,GAA4Bn1B,UAAU4hB,kBAAoB,aAWtDwT,GAAkC,iUANrC,uBAAc7f,UAENA,aAAe8f,wCAJsBT,IAQR,CAAoC,KAAM,8BAA+B,oEAGlGS,sRAEX7iB,EAAI8B,QAAQmC,WAAb,wBAEQ2e,oCAJwCP,IAQjDQ,GAA4Br1B,UAAU6uB,QAAU,SAChDwG,GAA4Br1B,UAAUof,UAAYyN,OAG5CyI,iTAEL,uBAAc/f,UAENA,aAAeggB,qCAJmBpB,IAQvCqB,GAA+B,IAAIF,GAA6B,KAAM,2BAA4B,oEAGzFC,uQAEX/iB,EAAI8B,QAAQmC,WAAb,wBAEQ+e,yBAIR,gBAAOvyB,EAAO4c,MAEW,WAApBA,EAAO8P,SACX,IACsB,OAAjB9P,EAAO5c,MACV,OAAwB,IAAjBA,EAAMpB,0CAGIoB,kCACjB,YACU4c,OAAOA,EAAO5c,OACtB,OAAO,wCAEF,EAIR,OAAO,gCAzBoCmxB,IA6B9CmB,GAAyBv1B,UAAUyW,KAAO,oBAC1C8e,GAAyBv1B,UAAUof,UAAY8O,OAW3CuH,GAAqC,gVANxC,uBAAclgB,UAENA,aAAemgB,2CAJyBJ,IAQR,CAAuC,KAAM,iCAAkC,2EAG3GI,qSAEXljB,EAAI8B,QAAQmC,WAAb,wBAEQgf,uCAJ2CF,IAQpDG,GAA+B11B,UAAU6uB,QAAU,SACnD6G,GAA+B11B,UAAUof,UAAYmP,GACrDmH,GAA+B11B,UAAU4hB,kBAAoB,aAWzD+T,GAAuC,0VAN1C,uBAAcpgB,UAENA,aAAeqgB,6CAJ2BN,IAQR,CAAyC,KAAM,mCAAoC,6EAGjHM,+SAEXpjB,EAAI8B,QAAQmC,WAAb,wBAEQkf,yCAJ6CJ,IAQtDK,GAAiC51B,UAAU6uB,QAAU,WACrD+G,GAAiC51B,UAAUof,UAAYiP,OAWnDwH,GAAqC,gVANxC,uBAActgB,UAENA,aAAeugB,2CAJyBR,IAQR,CAAuC,KAAM,iCAAkC,2EAG3GQ,qSAEXtjB,EAAI8B,QAAQmC,WAAb,wBAEQof,uCAJ2CN,IAQpDO,GAA+B91B,UAAU6uB,QAAU,SACnDiH,GAA+B91B,UAAUof,UAAYqP,OAWjDsH,GAAiB,4OANpB,uBAAcxgB,UAENA,aAAeygB,uBAJKtH,IAQR,CAAmB,KAAM,aAAc,uCAG/CsH,iMAEXxjB,EAAI8B,QAAQmC,WAAb,wBAEQsf,mBAJuBpH,IAQhCqH,GAAWh2B,UAAUyW,KAAO,MAC5Buf,GAAWh2B,UAAUof,UAAYkH,GACjC0P,GAAWh2B,UAAU0hB,eAAiB,mBAGhCuU,gPAEL,uBAAc1gB,UAENA,aAAe2gB,wBAJMxH,IAQ1ByH,GAAkB,IAAIF,GAAgB,KAAM,cAAe,2CAGlDC,sMAEX1jB,EAAI8B,QAAQmC,WAAb,wBAEQ0f,oBAJwBxH,IAQjCuH,GAAYl2B,UAAUyW,KAAO,OAC7Byf,GAAYl2B,UAAUof,UAAY6H,GAClCiP,GAAYl2B,UAAU0hB,eAAiB,mBAWnC0U,GAA2B,8RAN9B,uBAAc7gB,UAENA,aAAe8gB,iCAJeJ,IAQR,CAA6B,KAAM,uBAAwB,8DAG7EI,mPAEX7jB,EAAI8B,QAAQmC,WAAb,wBAEQ2f,6BAJiCF,IAQ1CG,GAAqBr2B,UAAU6uB,QAAU,YACzCwH,GAAqBr2B,UAAUof,UAAYgI,OAWvCkP,GAAoB,2PANvB,uBAAc/gB,UAENA,aAAeghB,0BAJQ7H,IAQR,CAAsB,KAAM,gBAAiB,mBAGxD6H,gNAEX/jB,EAAI8B,QAAQmC,WAAb,wBAEQ6f,sBAJ0B3H,IAQnC4H,GAAcv2B,UAAUyW,KAAO,aAW3B+f,GAAiB,4OANpB,uBAAcjhB,UAENA,aAAeuV,uBAJKtY,EAAIiD,MAQZ,CAAmB,KAAM,aAAc,uCAG/CqV,iMAEXtY,EAAI8B,QAAQmC,WAAb,wBAEQ+f,sBAGR,kBAEsB,OAAjB/iB,KAAKkL,QACR,OAAOlL,KAAK6M,WACTmW,EAAkBhjB,KAAKijB,sBACH,OAApBD,EACH,OAAOhjB,KAAK6M,WACTvB,EAAQ0X,EAAgB1X,aACd,OAAVA,EACItL,KAAK6M,OACNvB,uBAGR,kBAEsB,OAAjBtL,KAAKkL,QACR,OAAO,MACJ8X,EAAkBhjB,KAAKijB,0BACH,OAApBD,GAEGA,EAAgB/T,wCAGxB,gCAEK3G,EAAatI,KAAKkL,QAAQ5C,WAC1BC,EAAcvI,KAAKkL,QAAQ5I,IAAIiG,eACf,OAAhBA,GAAiD,OAAzBA,EAAYW,SACxC,KACKmS,EAAe9S,EAAYW,SAASpZ,IAAIwY,WACvBxZ,IAAjBusB,QAA0DvsB,IAA5BusB,EAAa5P,YAAwD,OAA5B4P,EAAa5P,WACxF,KACKuX,EAAkB3H,EAAa5P,WAAW3b,IAAIkQ,KAAKmM,aAC/Brd,IAApBk0B,EACH,OAAOA,UAGH,YAGPjkB,EAAI8B,QAAQa,WAAb,qBAEKA,EAAO,mBAAqB3C,EAAI4G,MAAM3F,KAAKmM,KAAO,UAAYpN,EAAI4G,MAAM3F,KAAKsL,cAC5EtL,KAAKiP,UACTvN,GAAQ,iBACFA,EAAO,oBApDgB5B,GAwDhCuX,GAAW9qB,UAAU2T,YAAc,CAAC,UAAW,MAAO,UACtDmX,GAAW9qB,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,UAAW,MAAO,cAW9D6b,GAAqB,gQANxB,uBAAcphB,UAENA,aAAeqhB,2BAJSpkB,EAAIiD,MAQZ,CAAuB,KAAM,iBAAkB,iDAG3DmhB,qNAEXpkB,EAAI8B,QAAQmC,WAAb,wBAEQkgB,UAGPnkB,EAAI8B,QAAQa,WAAb,qBAEKA,EAAO,uBAAyB3C,EAAI4G,MAAM3F,KAAKmM,KAAO,UAAYpN,EAAI4G,MAAM3F,KAAKsL,cAChFtL,KAAKiP,UACTvN,GAAQ,kBACFA,EAAO,wBAZoB5B,GAgBpCqjB,GAAe52B,UAAU2T,YAAc,CAAC,MAAO,QAAS,WACxDijB,GAAe52B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,MAAO,QAAS,gBAGxD+b,0PAEL,uBAActhB,UAENA,aAAeuhB,0BAJQtkB,EAAIiD,MAQhCshB,GAAoB,IAAIF,GAAkB,KAAM,gBAAiB,iCAGxDC,sOAEZ,8BAEM/X,MAAQ,UACRhD,WAAa,UACbe,KAAO,UACPkS,IAAM,UACNC,KAAO,UACP7W,MAAQ,UACRC,OAAS,UACTwI,UAAW,SAGhBrO,EAAI8B,QAAQmC,WAAb,wBAEQsgB,UAGPvkB,EAAI8B,QAAQa,WAAb,uBAEQ,IAAM1B,KAAKtQ,YAAY+J,KAAO,OAASsF,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,yBAGlH,sBAEQtI,KAAKqJ,KAAKjB,+BAGlB,qBAEQ,0CAA4CpI,KAAKsI,kCAGzD,sBAEQ9V,SAAS4b,cAAcpO,KAAKkO,gCAGpC,sCAEQlO,KAAKoN,8CAGb,aAAY5d,GAEPwQ,KAAKoI,QAAQyD,aAChB7L,KAAKyO,UAAUC,QAAUlf,QACrB4d,SAAW5d,SAGhBuP,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEd,YAATiK,EACHuG,KAAKiP,QAAUlQ,EAAIuN,MAAM9c,GAEzB+c,8CAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,sBAxDDsQ,GA4DnCujB,GAAc92B,UAAU2T,YAAc,CAAC,QAAS,aAAc,OAAQ,MAAO,OAAQ,QAAS,UAC9FmjB,GAAc92B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,QAAS,aAAc,OAAQ,MAAO,OAAQ,QAAS,SAAU,gBAWhHkc,GAAwB,+QAN3B,uBAAczhB,UAENA,aAAe0hB,8BAJYJ,IAQR,CAA0B,KAAM,oBAAqB,oCAGpEI,oOAEXzkB,EAAI8B,QAAQmC,WAAb,wBAEQugB,sBAGR,sBAEQvjB,KAAK+M,0BAGb,aAAUvd,QAEJud,OAASvd,EACVwQ,KAAKoI,QAAQyD,YAChB7L,KAAK0N,eAAe1N,KAAK+M,sCAG3B,wBAAevd,QAETif,UAAUjU,UAAYrI,EAAUmL,SAAS9N,UAG9CuP,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEd,UAATiK,EACHuG,KAAKxQ,MAAQA,EAEb+c,kDAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,0BA7BG6zB,IAiCvCG,GAAkBj3B,UAAU2T,yCAAkBmjB,GAAc92B,UAAU2T,cAAa,SAAU,aAC7FsjB,GAAkBj3B,UAAUwU,UAAY,IAAIsG,iCAAQgc,GAAc92B,UAAUwU,YAAW,eAWnF0iB,GAAyB,oRAN5B,uBAAc3hB,UAENA,aAAe4hB,+BAJaN,IAQR,CAA2B,KAAM,qBAAsB,wCAGvEM,yOAEX3kB,EAAI8B,QAAQmC,WAAb,wBAEQygB,sBAGR,sBAEQzjB,KAAK2jB,0BAGb,aAAUjf,QAEJif,OAASjf,EACV1E,KAAKoI,QAAQyD,YAChB7L,KAAK0N,eAAe1N,KAAK2jB,8BAG3B,sBAEQ3jB,KAAK0E,4BAGb,aAAakf,QAEPlf,MAAQA,oCAGd,wBAAelV,OAEVq0B,EAAM7jB,KAAKyO,UAAUL,cAAc,UAC3B,OAARyV,EACJ,KACKtkB,EAAiB,OAAV/P,EACV,qFACAwQ,KAAKoI,QAAQP,WAAWrY,EAAOwQ,KAAK2E,MAAO3E,KAAK4E,QACjDif,EAAI/pB,aAAa,MAAOyF,WAIzBR,EAAI8B,QAAQY,cAAb,eAAsBhI,EAAMjK,GAEd,aAATiK,EACHuG,KAAK4jB,SAAWp0B,EACC,UAATiK,EACRuG,KAAK0E,MAAQlV,EAEb+c,mDAAMxN,EAAI8B,QAAQY,wBAAShI,EAAMjK,2BAhDI6zB,IAoDxCK,GAAmBn3B,UAAU2T,yCAAkBmjB,GAAc92B,UAAU2T,cAAa,SAAU,aAC9FwjB,GAAmBn3B,UAAUwU,UAAY,IAAIsG,iCAAQgc,GAAc92B,UAAUwU,YAAW,QAAS,kBAW7F+iB,GAA0B,yRAN7B,uBAAchiB,UAENA,aAAeiiB,gCAJcX,IAQR,CAA4B,KAAM,sBAAuB,oCAG1EW,8OAEXhlB,EAAI8B,QAAQmC,WAAb,wBAEQ8gB,4BAJgCT,IAQzCU,GAAoBx3B,UAAU2T,yCAAkBmjB,GAAc92B,UAAU2T,cAAa,WAAY,SAAU,iBAWvG8jB,GAAkB,iPANrB,uBAAcliB,UAENA,aAAemiB,wBAJMllB,EAAIiD,MAQZ,CAAoB,KAAM,cAAe,sDAGlDiiB,sMAEXllB,EAAI8B,QAAQmC,WAAb,wBAEQghB,qBAGR,sBAEQhkB,KAAKkkB,MAAQ,UAAY,wBATDpkB,GAajCmkB,GAAY13B,UAAU2T,YAAc,CAAC,OAAQ,UAAW,MAAO,OAAQ,QAAS,SAAU,UAAW,aAAc,UAAW,WAAY,YAAa,YAAa,WAAY,cAAe,QAAS,WAAY,gBAAiB,kBAAmB,QAAS,YAAa,aAAc,aAAc,kBAC1S+jB,GAAY13B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,OAAQ,UAAW,MAAO,OAAQ,QAAS,SAAU,UAAW,aAAc,UAAW,WAAY,YAAa,YAAa,WAAY,cAAe,OAAQ,WAAY,gBAAiB,kBAAmB,QAAS,YAAa,aAAc,aAAc,uBAWjT8c,GAAW,8MANd,uBAAcriB,UAENA,aAAesiB,iBAJDrlB,EAAIiD,MAQZ,CAAa,KAAM,OAAQ,6BAG7BoiB,mKAEXrlB,EAAI8B,QAAQmC,WAAb,wBAEQmhB,UAGPplB,EAAI8B,QAAQa,WAAb,uBAEQ,YAAc3C,EAAI4G,MAAM3F,KAAKD,IAAM,cAAgBhB,EAAI4G,MAAM3F,KAAKkd,WAAa,YAAcne,EAAI4G,MAAM3F,KAAKmd,SAAW,UAAYpe,EAAI4G,MAAM3F,KAAKod,OAAS,cAT1Itd,GAa1BskB,GAAK73B,UAAU2T,YAAc,CAAC,MAAO,SAAU,QAAS,YAAa,UAAW,WAAY,QAAS,aAAc,eAAgB,MAAO,OAAQ,QAAS,MAAO,OAAQ,QAAS,UAAW,YAAa,kBAAmB,iBAAkB,UAAW,WAAY,aAAc,YACrRkkB,GAAK73B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,MAAO,SAAU,QAAS,YAAa,UAAW,WAAY,QAAS,aAAc,eAAgB,MAAO,OAAQ,QAAS,MAAO,OAAQ,QAAS,UAAW,YAAa,kBAAmB,iBAAkB,UAAW,WAAY,aAAc,iBAW7Rgd,GAAW,8MANd,uBAAcviB,UAENA,aAAewD,iBAJDvG,EAAIiD,MAQZ,CAAa,KAAM,OAAQ,oBAG7BsD,mKAEXvG,EAAI8B,QAAQmC,WAAb,wBAEQqhB,UAGPtlB,EAAI8B,QAAQa,WAAb,uBAEQ,aAAe3C,EAAI4G,MAAM3F,KAAKT,KAAO,aAAeR,EAAI4G,MAAM3F,KAAKqF,UAAY,qBAGvF,qBAEQ,UAAYrF,KAAKskB,UAAY,IAAMtkB,KAAKD,4BAGhD,sBAEsB,OAAjBC,KAAKukB,QACDvkB,KAAKT,IACNS,KAAKukB,QAAQhlB,IAAM,IAAMS,KAAKqF,mBArBbvF,GAyB1BwF,GAAK/Y,UAAU2T,YAAc,CAAC,UAAW,WAAY,WAAY,QAAS,SAAU,cAAe,YAAa,OAAQ,WAAY,MAAO,kBAAmB,UAAW,cACzKoF,GAAK/Y,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,UAAW,KAAM,cAAe,MAAO,cAAe,WAAY,WAAY,QAAS,SAAU,OAAQ,WAAY,MAAO,UAAW,YAAa,mBAWpLmd,GAAU,yMANb,uBAAc1iB,UAENA,aAAe+D,gBAJF9G,EAAIiD,MAQZ,CAAY,KAAM,MAAO,qDAG1B6D,qEAEAuC,EAASvE,EAAK4gB,SAAMtd,yDAAK,qDAE9B,OACDiB,QAAUA,IACVvE,IAAMA,SACC4gB,IACPtd,KAAOA,kCAGZpI,EAAI8B,QAAQmC,WAAb,wBAEQwhB,UAGPzlB,EAAI8B,QAAQa,WAAb,uBAEQ,YAAc3C,EAAI4G,MAAM3F,KAAK6D,KAAO,SAAW9E,EAAI4G,MAAM3F,WAAa,SAAWjB,EAAI4G,MAAM3F,KAAKmH,MAAQ,aAlBxFrH,GAsBzB+F,GAAItZ,UAAU2T,YAAc,CAAC,UAAW,MAAO,OAAQ,QACvD2F,GAAItZ,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,UAAW,MAAO,OAAQ,aAGvDqd,2OAEL,uBAAc5iB,UAENA,aAAe6iB,uBAJK5lB,EAAIiD,MAQ7B4iB,GAAiB,IAAIF,GAAe,KAAM,aAAc,6BAG/CC,iMAEX5lB,EAAI8B,QAAQmC,WAAb,wBAEQ4hB,UAGP7lB,EAAI8B,QAAQa,WAAb,uBAEQ,IAAM1B,KAAKtQ,YAAY+J,KAAO,OAASsF,EAAI4G,MAAM3F,KAAKD,IAAM,UAAYhB,EAAI4G,MAAM3F,KAAKsL,OAAS,oBATzExL,GAahC6kB,GAAWp4B,UAAU2T,YAAc,CAAC,SAAU,QAAS,UACvDykB,GAAWp4B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,SAAU,QAAS,eAW/Dwd,GAAqB,gQANxB,uBAAc/iB,UAENA,aAAegjB,2BAJSJ,IAQR,CAAuB,KAAM,iBAAkB,iCAG3DI,qNAEX/lB,EAAI8B,QAAQmC,WAAb,wBAEQ6hB,uBAJ2BF,IAQpCG,GAAev4B,UAAUyW,KAAO,iBAChC8hB,GAAev4B,UAAU2T,yCAAkBykB,GAAWp4B,UAAU2T,cAAa,UAC7E4kB,GAAev4B,UAAUwU,UAAY,IAAIsG,iCAAQsd,GAAWp4B,UAAU2T,cAAa,eAW/E6kB,GAAoB,2PANvB,uBAAcjjB,UAENA,aAAekjB,0BAJQN,IAQR,CAAsB,KAAM,gBAAiB,gCAGxDM,gNAEXjmB,EAAI8B,QAAQmC,WAAb,wBAEQ+hB,sBAJ0BJ,IAQnCK,GAAcz4B,UAAUyW,KAAO,gBAC/BgiB,GAAcz4B,UAAU2T,yCAAkBykB,GAAWp4B,UAAU2T,cAAa,UAC5E8kB,GAAcz4B,UAAUwU,UAAY,IAAIsG,iCAAQsd,GAAWp4B,UAAU2T,cAAa,eAW9E+kB,GAAqB,gQANxB,uBAAcnjB,UAENA,aAAeojB,2BAJSR,IAQR,CAAuB,KAAM,iBAAkB,iCAG3DQ,qNAEXnmB,EAAI8B,QAAQmC,WAAb,wBAEQiiB,uBAJ2BN,IAQpCO,GAAe34B,UAAUyW,KAAO,iBAChCkiB,GAAe34B,UAAU2T,yCAAkBykB,GAAWp4B,UAAU2T,cAAa,UAC7EglB,GAAe34B,UAAUwU,UAAY,IAAIsG,iCAAQsd,GAAWp4B,UAAU2T,cAAa,eAW/EilB,GAAqB,gQANxB,uBAAcrjB,UAENA,aAAesjB,2BAJSV,IAQR,CAAuB,KAAM,iBAAkB,iCAG3DU,qNAEXrmB,EAAI8B,QAAQmC,WAAb,wBAEQmiB,iCAGR,wBAAe1rB,SAED,UAATA,EACIsF,EAAIuU,QAAQtT,KAAKxQ,OAEjBwQ,KAAKvG,iCAGd,wBAAeA,EAAMjK,GAEP,UAATiK,EACHuG,KAAKxQ,MAAQuP,EAAIsmB,UAAU71B,GAE3BwQ,KAAKvG,GAAQjK,sBApBoBm1B,IAwBpCS,GAAe74B,UAAUyW,KAAO,iBAChCoiB,GAAe74B,UAAU2T,yCAAkBykB,GAAWp4B,UAAU2T,cAAa,UAC7EklB,GAAe74B,UAAUwU,UAAY,IAAIsG,iCAAQsd,GAAWp4B,UAAU2T,cAAa,eAW/EolB,GAAmB,sPANtB,uBAAcxjB,UAENA,aAAeyjB,yBAJOxmB,EAAIiD,MAQZ,CAAqB,KAAM,eAAgB,wCAGrDujB,2MAEXxmB,EAAI8B,QAAQmC,WAAb,wBAEQsiB,UAGPvmB,EAAI8B,QAAQa,WAAb,uBAEQ,oBAAsB3C,EAAI4G,MAAM3F,KAAKD,IAAM,SAAWhB,EAAI4G,MAAM3F,KAAKvG,MAAQ,sBATpDqG,GAalCylB,GAAah5B,UAAU2T,YAAc,CAAC,QACtCqlB,GAAah5B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,aAW9Cme,GAAe,kOANlB,uBAAc1jB,UAENA,aAAe2jB,qBAJG1mB,EAAIiD,MAQZ,CAAiB,KAAM,WAAY,yBAGzCyjB,uLAEX1mB,EAAI8B,QAAQmC,WAAb,wBAEQwiB,UAGPzmB,EAAI8B,QAAQa,WAAb,yBAEKoK,EAAI,GACJ4Z,EAAW1lB,KACK,OAAb0lB,GAEN5Z,EAAE6Z,OAAO,EAAG,EAAGD,EAASpd,YACxBod,EAAWA,EAAS5sB,aAEd,gBAAkBiG,EAAI4G,MAAM3F,KAAKD,IAAM,mBAAqBhB,EAAI4G,MAAMmG,EAAExF,KAAK,MAAS,IAAavH,EAAI4G,MAAM3F,KAAKvG,MAAQ,kBAhBrGqG,GAoB9B2lB,GAASl5B,UAAU2T,YAAc,CAAC,aAAc,OAAQ,QAAS,SAAU,WAAY,QACvFulB,GAASl5B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,aAAc,OAAQ,QAAS,SAAU,WAAY,aAW/Fue,GAAc,6NANjB,uBAAc9jB,UAENA,aAAe+jB,oBAJE9mB,EAAIiD,MAQZ,CAAgB,KAAM,UAAW,6CAGtC6jB,kLAEX9mB,EAAI8B,QAAQmC,WAAb,wBAEQ4iB,UAGP7mB,EAAI8B,QAAQa,WAAb,uBAEQ,eAAiB3C,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,iBAThExI,GAa7B+lB,GAAQt5B,UAAU2T,YAAc,CAAC,aAAc,OAAQ,MAAO,QAC9D2lB,GAAQt5B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,aAAc,OAAQ,MAAO,aAGpEye,qPAEL,uBAAchkB,UAENA,aAAeikB,yBAJOhnB,EAAIiD,MAQ/BgkB,GAAmB,IAAIF,GAAiB,KAAM,eAAgB,2CAGrDC,2MAEXhnB,EAAI8B,QAAQmC,WAAb,wBAEQgjB,UAGPjnB,EAAI8B,QAAQa,WAAb,uBAEQ,oBAAsB3C,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,qBAGjG,sBAEKtI,KAAKimB,iBAAiB/d,GAClBlI,KAAKimB,MACN,uBAhByBnmB,GAoBlCimB,GAAax5B,UAAU2T,YAAc,CAAC,QAAS,SAAU,OAAQ,QAAS,aAAc,cAAe,QAAS,YAAa,YAAa,YAAa,aACvJ6lB,GAAax5B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,QAAS,SAAU,MAAO,OAAQ,QAAS,aAAc,cAAe,QAAS,YAAa,YAAa,YAAa,kBAWtK6e,GAA0B,yRAN7B,uBAAcpkB,UAENA,aAAeqkB,gCAJcL,IAQR,CAA4B,KAAM,sBAAuB,mDAG1EK,8OAEXpnB,EAAI8B,QAAQmC,WAAb,wBAEQkjB,UAGPnnB,EAAI8B,QAAQa,WAAb,uBAEQ,2BAA6B3C,EAAI4G,MAAM3F,KAAKD,IAAM,eAAiBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,qBAGxG,sBAEKtI,KAAKimB,iBAAiB/d,GAClBlI,KAAKimB,MACN,8BAhBgCF,IAoBnCK,iOAEL,uBAActkB,UAENA,aAAeukB,qBAJGtnB,EAAIiD,MAQ3BskB,GAAe,IAAIF,GAAa,KAAM,WAAY,kEAGzCC,uLAEXtnB,EAAI8B,QAAQmC,WAAb,wBAEQsjB,UAGPvnB,EAAI8B,QAAQa,WAAb,uBAEQ,gBAAkB3C,EAAI4G,MAAM3F,KAAKD,IAAM,cAAgBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,UAAYvJ,EAAI4G,MAAM3F,KAAKsL,OAAS,SAAWvM,EAAI4G,MAAM3F,KAAKgD,MAAQ,kBATrIlD,GAa9BumB,GAAS95B,UAAU2T,YAAc,CAAC,MAAO,aAAc,QAAS,OAAQ,OAAQ,QAAS,SAAU,WAAY,MAAO,QAAS,aAAc,WAAY,uBAAwB,qBAAsB,eAAgB,iBAAkB,0BAA2B,aAAc,WAAY,YAAa,YAAa,YAAa,aACrUmmB,GAAS95B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,KAAM,MAAO,aAAc,QAAS,OAAQ,OAAQ,QAAS,SAAU,WAAY,MAAO,QAAS,aAAc,WAAY,uBAAwB,qBAAsB,eAAgB,iBAAkB,0BAA2B,aAAc,WAAY,YAAa,YAAa,YAAa,cAWjV,IAAIkf,GAAY,IAAIH,GAAa,KAAM,QAAS,2GAGnCI,wKAEXznB,EAAI8B,QAAQmC,WAAb,wBAEQujB,UAGPxnB,EAAI8B,QAAQa,WAAb,uBAEQ,aAAe3C,EAAI4G,MAAM3F,KAAKD,IAAM,cAAgBhB,EAAI4G,MAAM3F,KAAKsI,YAAc,UAAYvJ,EAAI4G,MAAM3F,KAAKsL,OAAS,SAAWvM,EAAI4G,MAAM3F,KAAKgD,MAAQ,eATrIqjB,IAa3BG,GAAMj6B,UAAU2T,yCAAkBmmB,GAAS95B,UAAU2T,cAAa,cAAe,kBAAmB,QAAS,MAAO,SAAU,QAAS,SAAU,cAAe,oBAAqB,aAAc,oBAAqB,sBACxNsmB,GAAMj6B,UAAUwU,UAAY,IAAIsG,iCAAQgf,GAAS95B,UAAUwU,YAAW,cAAe,kBAAmB,QAAS,MAAO,SAAU,QAAS,gBAWvI0lB,GAAW,8MANd,uBAAc3kB,UAENA,aAAe4kB,iBAJD3nB,EAAIiD,MAQZ,CAAa,KAAM,OAAQ,mBAE7B0kB,wEAEAte,EAASzU,qDAGfyU,QAAUA,IACVzU,SAAWA,IACXgzB,YAAa,qCAEAve,EAAQxG,OAAOgH,OAAOT,8CAA/BuD,YACHkb,WAAWlb,2CACZmb,gBAAgB,uCAGrB9nB,EAAI8B,QAAQmC,WAAb,wBAEQyjB,4BAGR,sBAEQj0B,SAAS4b,cAAcpO,KAAK8mB,UAAY,IAAM9mB,KAAK+mB,kCAG3D,sBAES/mB,KAAKgnB,YAAYnY,8BAG1B,aAAYrf,QAENw3B,YAAYnY,UAAYrf,SAG7BuP,EAAI8B,QAAQC,cAAb,eAAsBqL,MAET,YAARA,EACH,OAAOnM,KAAKkP,QAEZ,MAAM,IAAInQ,EAAIyC,eAAexB,KAAMmM,UAGpCpN,EAAI8B,QAAQY,cAAb,eAAsB0K,EAAK3c,MAEd,YAAR2c,EAGH,MAAM,IAAIpN,EAAIyC,eAAexB,KAAMmM,GAFnCnM,KAAKkP,QAAUnQ,EAAIuN,MAAM9c,UAK1BuP,EAAI8B,QAAQa,WAAb,uBAEQ,IAAM1B,KAAKtQ,YAAY+J,KAAO,YAAcsF,EAAI4G,MAAM3F,KAAKkP,SAAW,4BAG9E,2BAEQlP,KAAKjB,EAAI8B,QAAQa,uCAGzB,yBAAgB4G,cAEX2e,EAAO,aACKjnB,KAAKoI,QAAQ/F,mBAClBrC,KAAKoI,QAAQxG,WAChB5B,KAAKoI,QAAQ9F,WACVtC,KAAKoI,QAAQxG,OAAOgH,kBAChBN,GAGX4e,EAAa,SACLlnB,KAAKoI,aACRpI,QACFmnB,IAGHC,EAAM,+BAETA,GADkB,OAAf9e,EACI,iBAEA,mBAAqBvJ,EAAI4G,MAAM2C,QAElCF,QAAQif,cAAcD,GAAK,eAG9BE,EAAK3zB,SAAS4zB,QAAQN,EAAMC,GAE7B,MAAOhV,GAEFlgB,SAAWA,QAAQoV,QAEtBkgB,EAAKlf,QAAQrB,qBACT/U,QAAQ8U,OACX9U,QAAQ8U,MAAM,kBACf/H,EAAIyoB,WAAWtV,GACXlgB,QAAQyU,UACXzU,QAAQyU,WAELzU,QAAQy1B,gBACXz1B,QAAQy1B,eAAe,yBACxBz1B,QAAQoV,MAAM8K,GACVlgB,QAAQyU,UACXzU,QAAQyU,wCAMb,mCAEKzG,KAAK2mB,eAG4B,OAAjC3mB,KAAKoI,QAAQ9F,IAAIiG,aAAwBmf,UAAUC,YACvD,KACKC,EAAU5nB,KAAKoI,QAAQ9F,IAAIiG,YAAYqf,QAC3B,SAAZA,GAAkC,UAAZA,GAEzBF,UAAUC,YAAYE,oBAAmB,SAACjiB,GACzCkiB,EAAK1f,QAAQ7F,KAAOulB,EAAK1f,QAAQ7F,KAAKqS,UAAU,EAAGkT,EAAK1f,QAAQ7F,KAAKwlB,YAAY,KAAO,GAAK,MAC7FD,EAAK1f,QAAQ4f,gBAAgBpiB,GAC7BkiB,EAAKjB,gBAAgB,SAIP,UAAZe,GAEHF,UAAUC,YAAYM,eAAc,SAACriB,GACpCkiB,EAAK1f,QAAQ7F,KAAOulB,EAAK1f,QAAQ7F,KAAKqS,UAAU,EAAGkT,EAAK1f,QAAQ7F,KAAKwlB,YAAY,KAAO,GAAK,MAC7FD,EAAK1f,QAAQ4f,gBAAgBpiB,GAC7BkiB,EAAKjB,gBAAgB,cAInBF,YAAa,6BAGnB,oBAAWjb,6CAEWA,EAAMoD,8CAC3B,SACUoZ,iBAAiBxc,EAAMyD,aAAa,SAACgZ,GAC7CC,EAAKC,WACLD,EAAKhgB,QAAQ7F,KAAO6lB,EAAKhgB,QAAQ7F,KAAKqS,UAAU,EAAGwT,EAAKhgB,QAAQ7F,KAAKwlB,YAAY,KAAO,GAAK,QAC7FK,EAAKvB,gBAAgBnb,EAAMR,QAAQ5C,yDAhJbvJ,EAAIY,OAsJ9B+mB,GAAKn6B,UAAUwU,UAAY,IAAIsG,IAAI,CAAC,YACpCqf,GAAKn6B,UAAUu6B,UAAY,wBAC3BJ,GAAKn6B,UAAUw6B,YAAc,gBAuF7B,IApFA,YAAc,CACbhlB,EACAgG,GACAG,GACAsB,GACA6c,GACAG,GACAxc,GACAvB,GACAuT,GACAI,GACAO,GACA0B,GACAI,GACAE,GACAE,GACAE,GACAK,GACAO,GACAG,GACAE,GACAK,GACAE,GACAE,GACAE,GACAG,GACAE,GACAE,GACAE,GACAM,GACAF,GACAI,GACAE,GACAG,GACAE,GACAE,GACAE,GACAE,GACAG,GACAE,GACAlW,GACAyC,GACAiC,GACAO,GACAG,GACAM,GACAG,GACAE,GACA9C,GACAS,GACAuC,GACAW,GACAG,GACAE,GACAwB,GACAK,GACAI,GACAoB,GACAU,GACAY,GACAc,GACAS,GACAU,GACApD,GACA8L,GACAE,GACAG,GACAE,GACAK,GACAE,GACAG,GACA9e,GACAO,GACAif,GACAE,GACAE,GACAE,GACAG,GACAE,GACAI,GACAE,GACAI,sBAID,KADSz2B,UAERqP,EAAIupB,SAAS,4BAA8B54B,GAAY+J,KAAK1M,cAAe2C,QAG/Dy3B,GAAS,IAAIpoB,EAAIwpB,OAC7B,KACA,kBACA,CACCxgB,aAAcA,GACdzC,KAAMA,GACNO,IAAKA,GACLue,KAAMA,GACNyB,QAASA,GACT9jB,QAASA,EACTmG,IAAKA,GACLmW,YAAaA,GACbM,WAAYA,GACZF,aAAcA,GACdF,gBAAiBA,GACjBM,WAAYA,GACZE,gBAAiBA,GACjBG,YAAaA,GACb9C,WAAYA,GACZO,cAAeA,GACfyC,YAAaA,GACbO,sBAAuBA,GACvBG,sBAAuBA,GACvB9D,YAAaA,GACbqE,oBAAqBA,GACrBE,mBAAoBA,GACpBE,oBAAqBA,GACrBK,uBAAwBA,GACxBE,sBAAuBA,GACvBE,uBAAwBA,GACxBQ,4BAA6BA,GAC7BF,8BAA+BA,GAC/BI,4BAA6BA,GAC7BK,+BAAgCA,GAChCE,iCAAkCA,GAClCE,+BAAgCA,GAChCI,YAAaA,GACbG,qBAAsBA,GACtBL,WAAYA,GACZ0B,YAAaA,GACbxb,OAAQA,GACRyc,eAAgBA,GAChBF,cAAeA,GACfF,eAAgBA,GAChBM,eAAgBA,GAChBG,aAAcA,GACd/B,kBAAmBA,GACnBE,mBAAoBA,GACpBK,oBAAqBA,GACrBva,KAAMA,GACNQ,WAAYA,GACZqN,WAAYA,GACZ8L,eAAgBA,GAChBsC,SAAUA,GACVM,aAAcA,GACdI,oBAAqBA,GACrBE,SAAUA,GACVG,MAAOA"}